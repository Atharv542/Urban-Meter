var gS=(Ke,Ge)=>()=>(Ge||Ke((Ge={exports:{}}).exports,Ge),Ge.exports);var yS=gS((exports,module)=>{(function(){const Ge=document.createElement("link").relList;if(Ge&&Ge.supports&&Ge.supports("modulepreload"))return;for(const Qe of document.querySelectorAll('link[rel="modulepreload"]'))Ye(Qe);new MutationObserver(Qe=>{for(const Je of Qe)if(Je.type==="childList")for(const Mt of Je.addedNodes)Mt.tagName==="LINK"&&Mt.rel==="modulepreload"&&Ye(Mt)}).observe(document,{childList:!0,subtree:!0});function $e(Qe){const Je={};return Qe.integrity&&(Je.integrity=Qe.integrity),Qe.referrerPolicy&&(Je.referrerPolicy=Qe.referrerPolicy),Qe.crossOrigin==="use-credentials"?Je.credentials="include":Qe.crossOrigin==="anonymous"?Je.credentials="omit":Je.credentials="same-origin",Je}function Ye(Qe){if(Qe.ep)return;Qe.ep=!0;const Je=$e(Qe);fetch(Qe.href,Je)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(Ke){return Ke&&Ke.__esModule&&Object.prototype.hasOwnProperty.call(Ke,"default")?Ke.default:Ke}function getAugmentedNamespace(Ke){if(Ke.__esModule)return Ke;var Ge=Ke.default;if(typeof Ge=="function"){var $e=function Ye(){return this instanceof Ye?Reflect.construct(Ge,arguments,this.constructor):Ge.apply(this,arguments)};$e.prototype=Ge.prototype}else $e={};return Object.defineProperty($e,"__esModule",{value:!0}),Object.keys(Ke).forEach(function(Ye){var Qe=Object.getOwnPropertyDescriptor(Ke,Ye);Object.defineProperty($e,Ye,Qe.get?Qe:{enumerable:!0,get:function(){return Ke[Ye]}})}),$e}var jsxRuntime={exports:{}},reactJsxRuntime_production={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production;function requireReactJsxRuntime_production(){if(hasRequiredReactJsxRuntime_production)return reactJsxRuntime_production;hasRequiredReactJsxRuntime_production=1;var Ke=Symbol.for("react.transitional.element"),Ge=Symbol.for("react.fragment");function $e(Ye,Qe,Je){var Mt=null;if(Je!==void 0&&(Mt=""+Je),Qe.key!==void 0&&(Mt=""+Qe.key),"key"in Qe){Je={};for(var nn in Qe)nn!=="key"&&(Je[nn]=Qe[nn])}else Je=Qe;return Qe=Je.ref,{$$typeof:Ke,type:Ye,key:Mt,ref:Qe!==void 0?Qe:null,props:Je}}return reactJsxRuntime_production.Fragment=Ge,reactJsxRuntime_production.jsx=$e,reactJsxRuntime_production.jsxs=$e,reactJsxRuntime_production}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime.exports=requireReactJsxRuntime_production()),jsxRuntime.exports}var jsxRuntimeExports=requireJsxRuntime(),react={exports:{}},react_production={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReact_production;function requireReact_production(){if(hasRequiredReact_production)return react_production;hasRequiredReact_production=1;var Ke=Symbol.for("react.transitional.element"),Ge=Symbol.for("react.portal"),$e=Symbol.for("react.fragment"),Ye=Symbol.for("react.strict_mode"),Qe=Symbol.for("react.profiler"),Je=Symbol.for("react.consumer"),Mt=Symbol.for("react.context"),nn=Symbol.for("react.forward_ref"),an=Symbol.for("react.suspense"),sn=Symbol.for("react.memo"),ln=Symbol.for("react.lazy"),fn=Symbol.iterator;function hn(cp){return cp===null||typeof cp!="object"?null:(cp=fn&&cp[fn]||cp["@@iterator"],typeof cp=="function"?cp:null)}var Xr={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Mi=Object.assign,co={};function lo(cp,Ep,Fp){this.props=cp,this.context=Ep,this.refs=co,this.updater=Fp||Xr}lo.prototype.isReactComponent={},lo.prototype.setState=function(cp,Ep){if(typeof cp!="object"&&typeof cp!="function"&&cp!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,cp,Ep,"setState")},lo.prototype.forceUpdate=function(cp){this.updater.enqueueForceUpdate(this,cp,"forceUpdate")};function uo(){}uo.prototype=lo.prototype;function ho(cp,Ep,Fp){this.props=cp,this.context=Ep,this.refs=co,this.updater=Fp||Xr}var mo=ho.prototype=new uo;mo.constructor=ho,Mi(mo,lo.prototype),mo.isPureReactComponent=!0;var _d=Array.isArray,ep={H:null,A:null,T:null,S:null},rp=Object.prototype.hasOwnProperty;function sp(cp,Ep,Fp,Hp,zp,Gp){return Fp=Gp.ref,{$$typeof:Ke,type:cp,key:Ep,ref:Fp!==void 0?Fp:null,props:Gp}}function op(cp,Ep){return sp(cp.type,Ep,void 0,void 0,void 0,cp.props)}function ip(cp){return typeof cp=="object"&&cp!==null&&cp.$$typeof===Ke}function lp(cp){var Ep={"=":"=0",":":"=2"};return"$"+cp.replace(/[=:]/g,function(Fp){return Ep[Fp]})}var vp=/\/+/g;function gp(cp,Ep){return typeof cp=="object"&&cp!==null&&cp.key!=null?lp(""+cp.key):Ep.toString(36)}function Op(){}function Mp(cp){switch(cp.status){case"fulfilled":return cp.value;case"rejected":throw cp.reason;default:switch(typeof cp.status=="string"?cp.then(Op,Op):(cp.status="pending",cp.then(function(Ep){cp.status==="pending"&&(cp.status="fulfilled",cp.value=Ep)},function(Ep){cp.status==="pending"&&(cp.status="rejected",cp.reason=Ep)})),cp.status){case"fulfilled":return cp.value;case"rejected":throw cp.reason}}throw cp}function Np(cp,Ep,Fp,Hp,zp){var Gp=typeof cp;(Gp==="undefined"||Gp==="boolean")&&(cp=null);var mp=!1;if(cp===null)mp=!0;else switch(Gp){case"bigint":case"string":case"number":mp=!0;break;case"object":switch(cp.$$typeof){case Ke:case Ge:mp=!0;break;case ln:return mp=cp._init,Np(mp(cp._payload),Ep,Fp,Hp,zp)}}if(mp)return zp=zp(cp),mp=Hp===""?"."+gp(cp,0):Hp,_d(zp)?(Fp="",mp!=null&&(Fp=mp.replace(vp,"$&/")+"/"),Np(zp,Ep,Fp,"",function(qp){return qp})):zp!=null&&(ip(zp)&&(zp=op(zp,Fp+(zp.key==null||cp&&cp.key===zp.key?"":(""+zp.key).replace(vp,"$&/")+"/")+mp)),Ep.push(zp)),1;mp=0;var yp=Hp===""?".":Hp+":";if(_d(cp))for(var Tp=0;Tp<cp.length;Tp++)Hp=cp[Tp],Gp=yp+gp(Hp,Tp),mp+=Np(Hp,Ep,Fp,Gp,zp);else if(Tp=hn(cp),typeof Tp=="function")for(cp=Tp.call(cp),Tp=0;!(Hp=cp.next()).done;)Hp=Hp.value,Gp=yp+gp(Hp,Tp++),mp+=Np(Hp,Ep,Fp,Gp,zp);else if(Gp==="object"){if(typeof cp.then=="function")return Np(Mp(cp),Ep,Fp,Hp,zp);throw Ep=String(cp),Error("Objects are not valid as a React child (found: "+(Ep==="[object Object]"?"object with keys {"+Object.keys(cp).join(", ")+"}":Ep)+"). If you meant to render a collection of children, use an array instead.")}return mp}function wp(cp,Ep,Fp){if(cp==null)return cp;var Hp=[],zp=0;return Np(cp,Hp,"","",function(Gp){return Ep.call(Fp,Gp,zp++)}),Hp}function Sp(cp){if(cp._status===-1){var Ep=cp._result;Ep=Ep(),Ep.then(function(Fp){(cp._status===0||cp._status===-1)&&(cp._status=1,cp._result=Fp)},function(Fp){(cp._status===0||cp._status===-1)&&(cp._status=2,cp._result=Fp)}),cp._status===-1&&(cp._status=0,cp._result=Ep)}if(cp._status===1)return cp._result.default;throw cp._result}var Cp=typeof reportError=="function"?reportError:function(cp){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Ep=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof cp=="object"&&cp!==null&&typeof cp.message=="string"?String(cp.message):String(cp),error:cp});if(!window.dispatchEvent(Ep))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",cp);return}console.error(cp)};function Ip(){}return react_production.Children={map:wp,forEach:function(cp,Ep,Fp){wp(cp,function(){Ep.apply(this,arguments)},Fp)},count:function(cp){var Ep=0;return wp(cp,function(){Ep++}),Ep},toArray:function(cp){return wp(cp,function(Ep){return Ep})||[]},only:function(cp){if(!ip(cp))throw Error("React.Children.only expected to receive a single React element child.");return cp}},react_production.Component=lo,react_production.Fragment=$e,react_production.Profiler=Qe,react_production.PureComponent=ho,react_production.StrictMode=Ye,react_production.Suspense=an,react_production.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=ep,react_production.act=function(){throw Error("act(...) is not supported in production builds of React.")},react_production.cache=function(cp){return function(){return cp.apply(null,arguments)}},react_production.cloneElement=function(cp,Ep,Fp){if(cp==null)throw Error("The argument must be a React element, but you passed "+cp+".");var Hp=Mi({},cp.props),zp=cp.key,Gp=void 0;if(Ep!=null)for(mp in Ep.ref!==void 0&&(Gp=void 0),Ep.key!==void 0&&(zp=""+Ep.key),Ep)!rp.call(Ep,mp)||mp==="key"||mp==="__self"||mp==="__source"||mp==="ref"&&Ep.ref===void 0||(Hp[mp]=Ep[mp]);var mp=arguments.length-2;if(mp===1)Hp.children=Fp;else if(1<mp){for(var yp=Array(mp),Tp=0;Tp<mp;Tp++)yp[Tp]=arguments[Tp+2];Hp.children=yp}return sp(cp.type,zp,void 0,void 0,Gp,Hp)},react_production.createContext=function(cp){return cp={$$typeof:Mt,_currentValue:cp,_currentValue2:cp,_threadCount:0,Provider:null,Consumer:null},cp.Provider=cp,cp.Consumer={$$typeof:Je,_context:cp},cp},react_production.createElement=function(cp,Ep,Fp){var Hp,zp={},Gp=null;if(Ep!=null)for(Hp in Ep.key!==void 0&&(Gp=""+Ep.key),Ep)rp.call(Ep,Hp)&&Hp!=="key"&&Hp!=="__self"&&Hp!=="__source"&&(zp[Hp]=Ep[Hp]);var mp=arguments.length-2;if(mp===1)zp.children=Fp;else if(1<mp){for(var yp=Array(mp),Tp=0;Tp<mp;Tp++)yp[Tp]=arguments[Tp+2];zp.children=yp}if(cp&&cp.defaultProps)for(Hp in mp=cp.defaultProps,mp)zp[Hp]===void 0&&(zp[Hp]=mp[Hp]);return sp(cp,Gp,void 0,void 0,null,zp)},react_production.createRef=function(){return{current:null}},react_production.forwardRef=function(cp){return{$$typeof:nn,render:cp}},react_production.isValidElement=ip,react_production.lazy=function(cp){return{$$typeof:ln,_payload:{_status:-1,_result:cp},_init:Sp}},react_production.memo=function(cp,Ep){return{$$typeof:sn,type:cp,compare:Ep===void 0?null:Ep}},react_production.startTransition=function(cp){var Ep=ep.T,Fp={};ep.T=Fp;try{var Hp=cp(),zp=ep.S;zp!==null&&zp(Fp,Hp),typeof Hp=="object"&&Hp!==null&&typeof Hp.then=="function"&&Hp.then(Ip,Cp)}catch(Gp){Cp(Gp)}finally{ep.T=Ep}},react_production.unstable_useCacheRefresh=function(){return ep.H.useCacheRefresh()},react_production.use=function(cp){return ep.H.use(cp)},react_production.useActionState=function(cp,Ep,Fp){return ep.H.useActionState(cp,Ep,Fp)},react_production.useCallback=function(cp,Ep){return ep.H.useCallback(cp,Ep)},react_production.useContext=function(cp){return ep.H.useContext(cp)},react_production.useDebugValue=function(){},react_production.useDeferredValue=function(cp,Ep){return ep.H.useDeferredValue(cp,Ep)},react_production.useEffect=function(cp,Ep){return ep.H.useEffect(cp,Ep)},react_production.useId=function(){return ep.H.useId()},react_production.useImperativeHandle=function(cp,Ep,Fp){return ep.H.useImperativeHandle(cp,Ep,Fp)},react_production.useInsertionEffect=function(cp,Ep){return ep.H.useInsertionEffect(cp,Ep)},react_production.useLayoutEffect=function(cp,Ep){return ep.H.useLayoutEffect(cp,Ep)},react_production.useMemo=function(cp,Ep){return ep.H.useMemo(cp,Ep)},react_production.useOptimistic=function(cp,Ep){return ep.H.useOptimistic(cp,Ep)},react_production.useReducer=function(cp,Ep,Fp){return ep.H.useReducer(cp,Ep,Fp)},react_production.useRef=function(cp){return ep.H.useRef(cp)},react_production.useState=function(cp){return ep.H.useState(cp)},react_production.useSyncExternalStore=function(cp,Ep,Fp){return ep.H.useSyncExternalStore(cp,Ep,Fp)},react_production.useTransition=function(){return ep.H.useTransition()},react_production.version="19.0.0",react_production}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production()),react.exports}var reactExports=requireReact();const React=getDefaultExportFromCjs(reactExports);var client={exports:{}},reactDomClient_production={},scheduler={exports:{}},scheduler_production={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production;function requireScheduler_production(){return hasRequiredScheduler_production||(hasRequiredScheduler_production=1,function(Ke){function Ge(wp,Sp){var Cp=wp.length;wp.push(Sp);e:for(;0<Cp;){var Ip=Cp-1>>>1,cp=wp[Ip];if(0<Qe(cp,Sp))wp[Ip]=Sp,wp[Cp]=cp,Cp=Ip;else break e}}function $e(wp){return wp.length===0?null:wp[0]}function Ye(wp){if(wp.length===0)return null;var Sp=wp[0],Cp=wp.pop();if(Cp!==Sp){wp[0]=Cp;e:for(var Ip=0,cp=wp.length,Ep=cp>>>1;Ip<Ep;){var Fp=2*(Ip+1)-1,Hp=wp[Fp],zp=Fp+1,Gp=wp[zp];if(0>Qe(Hp,Cp))zp<cp&&0>Qe(Gp,Hp)?(wp[Ip]=Gp,wp[zp]=Cp,Ip=zp):(wp[Ip]=Hp,wp[Fp]=Cp,Ip=Fp);else if(zp<cp&&0>Qe(Gp,Cp))wp[Ip]=Gp,wp[zp]=Cp,Ip=zp;else break e}}return Sp}function Qe(wp,Sp){var Cp=wp.sortIndex-Sp.sortIndex;return Cp!==0?Cp:wp.id-Sp.id}if(Ke.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var Je=performance;Ke.unstable_now=function(){return Je.now()}}else{var Mt=Date,nn=Mt.now();Ke.unstable_now=function(){return Mt.now()-nn}}var an=[],sn=[],ln=1,fn=null,hn=3,Xr=!1,Mi=!1,co=!1,lo=typeof setTimeout=="function"?setTimeout:null,uo=typeof clearTimeout=="function"?clearTimeout:null,ho=typeof setImmediate<"u"?setImmediate:null;function mo(wp){for(var Sp=$e(sn);Sp!==null;){if(Sp.callback===null)Ye(sn);else if(Sp.startTime<=wp)Ye(sn),Sp.sortIndex=Sp.expirationTime,Ge(an,Sp);else break;Sp=$e(sn)}}function _d(wp){if(co=!1,mo(wp),!Mi)if($e(an)!==null)Mi=!0,Mp();else{var Sp=$e(sn);Sp!==null&&Np(_d,Sp.startTime-wp)}}var ep=!1,rp=-1,sp=5,op=-1;function ip(){return!(Ke.unstable_now()-op<sp)}function lp(){if(ep){var wp=Ke.unstable_now();op=wp;var Sp=!0;try{e:{Mi=!1,co&&(co=!1,uo(rp),rp=-1),Xr=!0;var Cp=hn;try{t:{for(mo(wp),fn=$e(an);fn!==null&&!(fn.expirationTime>wp&&ip());){var Ip=fn.callback;if(typeof Ip=="function"){fn.callback=null,hn=fn.priorityLevel;var cp=Ip(fn.expirationTime<=wp);if(wp=Ke.unstable_now(),typeof cp=="function"){fn.callback=cp,mo(wp),Sp=!0;break t}fn===$e(an)&&Ye(an),mo(wp)}else Ye(an);fn=$e(an)}if(fn!==null)Sp=!0;else{var Ep=$e(sn);Ep!==null&&Np(_d,Ep.startTime-wp),Sp=!1}}break e}finally{fn=null,hn=Cp,Xr=!1}Sp=void 0}}finally{Sp?vp():ep=!1}}}var vp;if(typeof ho=="function")vp=function(){ho(lp)};else if(typeof MessageChannel<"u"){var gp=new MessageChannel,Op=gp.port2;gp.port1.onmessage=lp,vp=function(){Op.postMessage(null)}}else vp=function(){lo(lp,0)};function Mp(){ep||(ep=!0,vp())}function Np(wp,Sp){rp=lo(function(){wp(Ke.unstable_now())},Sp)}Ke.unstable_IdlePriority=5,Ke.unstable_ImmediatePriority=1,Ke.unstable_LowPriority=4,Ke.unstable_NormalPriority=3,Ke.unstable_Profiling=null,Ke.unstable_UserBlockingPriority=2,Ke.unstable_cancelCallback=function(wp){wp.callback=null},Ke.unstable_continueExecution=function(){Mi||Xr||(Mi=!0,Mp())},Ke.unstable_forceFrameRate=function(wp){0>wp||125<wp?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):sp=0<wp?Math.floor(1e3/wp):5},Ke.unstable_getCurrentPriorityLevel=function(){return hn},Ke.unstable_getFirstCallbackNode=function(){return $e(an)},Ke.unstable_next=function(wp){switch(hn){case 1:case 2:case 3:var Sp=3;break;default:Sp=hn}var Cp=hn;hn=Sp;try{return wp()}finally{hn=Cp}},Ke.unstable_pauseExecution=function(){},Ke.unstable_requestPaint=function(){},Ke.unstable_runWithPriority=function(wp,Sp){switch(wp){case 1:case 2:case 3:case 4:case 5:break;default:wp=3}var Cp=hn;hn=wp;try{return Sp()}finally{hn=Cp}},Ke.unstable_scheduleCallback=function(wp,Sp,Cp){var Ip=Ke.unstable_now();switch(typeof Cp=="object"&&Cp!==null?(Cp=Cp.delay,Cp=typeof Cp=="number"&&0<Cp?Ip+Cp:Ip):Cp=Ip,wp){case 1:var cp=-1;break;case 2:cp=250;break;case 5:cp=1073741823;break;case 4:cp=1e4;break;default:cp=5e3}return cp=Cp+cp,wp={id:ln++,callback:Sp,priorityLevel:wp,startTime:Cp,expirationTime:cp,sortIndex:-1},Cp>Ip?(wp.sortIndex=Cp,Ge(sn,wp),$e(an)===null&&wp===$e(sn)&&(co?(uo(rp),rp=-1):co=!0,Np(_d,Cp-Ip))):(wp.sortIndex=cp,Ge(an,wp),Mi||Xr||(Mi=!0,Mp())),wp},Ke.unstable_shouldYield=ip,Ke.unstable_wrapCallback=function(wp){var Sp=hn;return function(){var Cp=hn;hn=Sp;try{return wp.apply(this,arguments)}finally{hn=Cp}}}}(scheduler_production)),scheduler_production}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production()),scheduler.exports}var reactDom={exports:{}},reactDom_production={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDom_production;function requireReactDom_production(){if(hasRequiredReactDom_production)return reactDom_production;hasRequiredReactDom_production=1;var Ke=requireReact();function Ge(an){var sn="https://react.dev/errors/"+an;if(1<arguments.length){sn+="?args[]="+encodeURIComponent(arguments[1]);for(var ln=2;ln<arguments.length;ln++)sn+="&args[]="+encodeURIComponent(arguments[ln])}return"Minified React error #"+an+"; visit "+sn+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function $e(){}var Ye={d:{f:$e,r:function(){throw Error(Ge(522))},D:$e,C:$e,L:$e,m:$e,X:$e,S:$e,M:$e},p:0,findDOMNode:null},Qe=Symbol.for("react.portal");function Je(an,sn,ln){var fn=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Qe,key:fn==null?null:""+fn,children:an,containerInfo:sn,implementation:ln}}var Mt=Ke.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function nn(an,sn){if(an==="font")return"";if(typeof sn=="string")return sn==="use-credentials"?sn:""}return reactDom_production.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Ye,reactDom_production.createPortal=function(an,sn){var ln=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!sn||sn.nodeType!==1&&sn.nodeType!==9&&sn.nodeType!==11)throw Error(Ge(299));return Je(an,sn,null,ln)},reactDom_production.flushSync=function(an){var sn=Mt.T,ln=Ye.p;try{if(Mt.T=null,Ye.p=2,an)return an()}finally{Mt.T=sn,Ye.p=ln,Ye.d.f()}},reactDom_production.preconnect=function(an,sn){typeof an=="string"&&(sn?(sn=sn.crossOrigin,sn=typeof sn=="string"?sn==="use-credentials"?sn:"":void 0):sn=null,Ye.d.C(an,sn))},reactDom_production.prefetchDNS=function(an){typeof an=="string"&&Ye.d.D(an)},reactDom_production.preinit=function(an,sn){if(typeof an=="string"&&sn&&typeof sn.as=="string"){var ln=sn.as,fn=nn(ln,sn.crossOrigin),hn=typeof sn.integrity=="string"?sn.integrity:void 0,Xr=typeof sn.fetchPriority=="string"?sn.fetchPriority:void 0;ln==="style"?Ye.d.S(an,typeof sn.precedence=="string"?sn.precedence:void 0,{crossOrigin:fn,integrity:hn,fetchPriority:Xr}):ln==="script"&&Ye.d.X(an,{crossOrigin:fn,integrity:hn,fetchPriority:Xr,nonce:typeof sn.nonce=="string"?sn.nonce:void 0})}},reactDom_production.preinitModule=function(an,sn){if(typeof an=="string")if(typeof sn=="object"&&sn!==null){if(sn.as==null||sn.as==="script"){var ln=nn(sn.as,sn.crossOrigin);Ye.d.M(an,{crossOrigin:ln,integrity:typeof sn.integrity=="string"?sn.integrity:void 0,nonce:typeof sn.nonce=="string"?sn.nonce:void 0})}}else sn==null&&Ye.d.M(an)},reactDom_production.preload=function(an,sn){if(typeof an=="string"&&typeof sn=="object"&&sn!==null&&typeof sn.as=="string"){var ln=sn.as,fn=nn(ln,sn.crossOrigin);Ye.d.L(an,ln,{crossOrigin:fn,integrity:typeof sn.integrity=="string"?sn.integrity:void 0,nonce:typeof sn.nonce=="string"?sn.nonce:void 0,type:typeof sn.type=="string"?sn.type:void 0,fetchPriority:typeof sn.fetchPriority=="string"?sn.fetchPriority:void 0,referrerPolicy:typeof sn.referrerPolicy=="string"?sn.referrerPolicy:void 0,imageSrcSet:typeof sn.imageSrcSet=="string"?sn.imageSrcSet:void 0,imageSizes:typeof sn.imageSizes=="string"?sn.imageSizes:void 0,media:typeof sn.media=="string"?sn.media:void 0})}},reactDom_production.preloadModule=function(an,sn){if(typeof an=="string")if(sn){var ln=nn(sn.as,sn.crossOrigin);Ye.d.m(an,{as:typeof sn.as=="string"&&sn.as!=="script"?sn.as:void 0,crossOrigin:ln,integrity:typeof sn.integrity=="string"?sn.integrity:void 0})}else Ye.d.m(an)},reactDom_production.requestFormReset=function(an){Ye.d.r(an)},reactDom_production.unstable_batchedUpdates=function(an,sn){return an(sn)},reactDom_production.useFormState=function(an,sn,ln){return Mt.H.useFormState(an,sn,ln)},reactDom_production.useFormStatus=function(){return Mt.H.useHostTransitionStatus()},reactDom_production.version="19.0.0",reactDom_production}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function Ke(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ke)}catch(Ge){console.error(Ge)}}return Ke(),reactDom.exports=requireReactDom_production(),reactDom.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDomClient_production;function requireReactDomClient_production(){if(hasRequiredReactDomClient_production)return reactDomClient_production;hasRequiredReactDomClient_production=1;var Ke=requireScheduler(),Ge=requireReact(),$e=requireReactDom();function Ye(st){var rn="https://react.dev/errors/"+st;if(1<arguments.length){rn+="?args[]="+encodeURIComponent(arguments[1]);for(var un=2;un<arguments.length;un++)rn+="&args[]="+encodeURIComponent(arguments[un])}return"Minified React error #"+st+"; visit "+rn+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Qe(st){return!(!st||st.nodeType!==1&&st.nodeType!==9&&st.nodeType!==11)}var Je=Symbol.for("react.element"),Mt=Symbol.for("react.transitional.element"),nn=Symbol.for("react.portal"),an=Symbol.for("react.fragment"),sn=Symbol.for("react.strict_mode"),ln=Symbol.for("react.profiler"),fn=Symbol.for("react.provider"),hn=Symbol.for("react.consumer"),Xr=Symbol.for("react.context"),Mi=Symbol.for("react.forward_ref"),co=Symbol.for("react.suspense"),lo=Symbol.for("react.suspense_list"),uo=Symbol.for("react.memo"),ho=Symbol.for("react.lazy"),mo=Symbol.for("react.offscreen"),_d=Symbol.for("react.memo_cache_sentinel"),ep=Symbol.iterator;function rp(st){return st===null||typeof st!="object"?null:(st=ep&&st[ep]||st["@@iterator"],typeof st=="function"?st:null)}var sp=Symbol.for("react.client.reference");function op(st){if(st==null)return null;if(typeof st=="function")return st.$$typeof===sp?null:st.displayName||st.name||null;if(typeof st=="string")return st;switch(st){case an:return"Fragment";case nn:return"Portal";case ln:return"Profiler";case sn:return"StrictMode";case co:return"Suspense";case lo:return"SuspenseList"}if(typeof st=="object")switch(st.$$typeof){case Xr:return(st.displayName||"Context")+".Provider";case hn:return(st._context.displayName||"Context")+".Consumer";case Mi:var rn=st.render;return st=st.displayName,st||(st=rn.displayName||rn.name||"",st=st!==""?"ForwardRef("+st+")":"ForwardRef"),st;case uo:return rn=st.displayName||null,rn!==null?rn:op(st.type)||"Memo";case ho:rn=st._payload,st=st._init;try{return op(st(rn))}catch{}}return null}var ip=Ge.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,lp=Object.assign,vp,gp;function Op(st){if(vp===void 0)try{throw Error()}catch(un){var rn=un.stack.trim().match(/\n( *(at )?)/);vp=rn&&rn[1]||"",gp=-1<un.stack.indexOf(`
    at`)?" (<anonymous>)":-1<un.stack.indexOf("@")?"@unknown:0:0":""}return`
`+vp+st+gp}var Mp=!1;function Np(st,rn){if(!st||Mp)return"";Mp=!0;var un=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var cn={DetermineComponentFrameRoot:function(){try{if(rn){var Wp=function(){throw Error()};if(Object.defineProperty(Wp.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Wp,[])}catch(Lp){var Dp=Lp}Reflect.construct(st,[],Wp)}else{try{Wp.call()}catch(Lp){Dp=Lp}st.call(Wp.prototype)}}else{try{throw Error()}catch(Lp){Dp=Lp}(Wp=st())&&typeof Wp.catch=="function"&&Wp.catch(function(){})}}catch(Lp){if(Lp&&Dp&&typeof Lp.stack=="string")return[Lp.stack,Dp.stack]}return[null,null]}};cn.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var to=Object.getOwnPropertyDescriptor(cn.DetermineComponentFrameRoot,"name");to&&to.configurable&&Object.defineProperty(cn.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var fo=cn.DetermineComponentFrameRoot(),np=fo[0],up=fo[1];if(np&&up){var pp=np.split(`
`),_p=up.split(`
`);for(to=cn=0;cn<pp.length&&!pp[cn].includes("DetermineComponentFrameRoot");)cn++;for(;to<_p.length&&!_p[to].includes("DetermineComponentFrameRoot");)to++;if(cn===pp.length||to===_p.length)for(cn=pp.length-1,to=_p.length-1;1<=cn&&0<=to&&pp[cn]!==_p[to];)to--;for(;1<=cn&&0<=to;cn--,to--)if(pp[cn]!==_p[to]){if(cn!==1||to!==1)do if(cn--,to--,0>to||pp[cn]!==_p[to]){var Up=`
`+pp[cn].replace(" at new "," at ");return st.displayName&&Up.includes("<anonymous>")&&(Up=Up.replace("<anonymous>",st.displayName)),Up}while(1<=cn&&0<=to);break}}}finally{Mp=!1,Error.prepareStackTrace=un}return(un=st?st.displayName||st.name:"")?Op(un):""}function wp(st){switch(st.tag){case 26:case 27:case 5:return Op(st.type);case 16:return Op("Lazy");case 13:return Op("Suspense");case 19:return Op("SuspenseList");case 0:case 15:return st=Np(st.type,!1),st;case 11:return st=Np(st.type.render,!1),st;case 1:return st=Np(st.type,!0),st;default:return""}}function Sp(st){try{var rn="";do rn+=wp(st),st=st.return;while(st);return rn}catch(un){return`
Error generating stack: `+un.message+`
`+un.stack}}function Cp(st){var rn=st,un=st;if(st.alternate)for(;rn.return;)rn=rn.return;else{st=rn;do rn=st,(rn.flags&4098)!==0&&(un=rn.return),st=rn.return;while(st)}return rn.tag===3?un:null}function Ip(st){if(st.tag===13){var rn=st.memoizedState;if(rn===null&&(st=st.alternate,st!==null&&(rn=st.memoizedState)),rn!==null)return rn.dehydrated}return null}function cp(st){if(Cp(st)!==st)throw Error(Ye(188))}function Ep(st){var rn=st.alternate;if(!rn){if(rn=Cp(st),rn===null)throw Error(Ye(188));return rn!==st?null:st}for(var un=st,cn=rn;;){var to=un.return;if(to===null)break;var fo=to.alternate;if(fo===null){if(cn=to.return,cn!==null){un=cn;continue}break}if(to.child===fo.child){for(fo=to.child;fo;){if(fo===un)return cp(to),st;if(fo===cn)return cp(to),rn;fo=fo.sibling}throw Error(Ye(188))}if(un.return!==cn.return)un=to,cn=fo;else{for(var np=!1,up=to.child;up;){if(up===un){np=!0,un=to,cn=fo;break}if(up===cn){np=!0,cn=to,un=fo;break}up=up.sibling}if(!np){for(up=fo.child;up;){if(up===un){np=!0,un=fo,cn=to;break}if(up===cn){np=!0,cn=fo,un=to;break}up=up.sibling}if(!np)throw Error(Ye(189))}}if(un.alternate!==cn)throw Error(Ye(190))}if(un.tag!==3)throw Error(Ye(188));return un.stateNode.current===un?st:rn}function Fp(st){var rn=st.tag;if(rn===5||rn===26||rn===27||rn===6)return st;for(st=st.child;st!==null;){if(rn=Fp(st),rn!==null)return rn;st=st.sibling}return null}var Hp=Array.isArray,zp=$e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Gp={pending:!1,data:null,method:null,action:null},mp=[],yp=-1;function Tp(st){return{current:st}}function qp(st){0>yp||(st.current=mp[yp],mp[yp]=null,yp--)}function $p(st,rn){yp++,mp[yp]=st.current,st.current=rn}var fp=Tp(null),hp=Tp(null),Bp=Tp(null),Vp=Tp(null);function Jp(st,rn){switch($p(Bp,rn),$p(hp,st),$p(fp,null),st=rn.nodeType,st){case 9:case 11:rn=(rn=rn.documentElement)&&(rn=rn.namespaceURI)?k2(rn):0;break;default:if(st=st===8?rn.parentNode:rn,rn=st.tagName,st=st.namespaceURI)st=k2(st),rn=O2(st,rn);else switch(rn){case"svg":rn=1;break;case"math":rn=2;break;default:rn=0}}qp(fp),$p(fp,rn)}function Xp(){qp(fp),qp(hp),qp(Bp)}function tm(st){st.memoizedState!==null&&$p(Vp,st);var rn=fp.current,un=O2(rn,st.type);rn!==un&&($p(hp,st),$p(fp,un))}function bm(st){hp.current===st&&(qp(fp),qp(hp)),Vp.current===st&&(qp(Vp),r0._currentValue=Gp)}var xm=Object.prototype.hasOwnProperty,Wm=Ke.unstable_scheduleCallback,Nm=Ke.unstable_cancelCallback,wm=Ke.unstable_shouldYield,Mm=Ke.unstable_requestPaint,Em=Ke.unstable_now,_m=Ke.unstable_getCurrentPriorityLevel,Km=Ke.unstable_ImmediatePriority,ap=Ke.unstable_UserBlockingPriority,Uo=Ke.unstable_NormalPriority,tp=Ke.unstable_LowPriority,dp=Ke.unstable_IdlePriority,xp=Ke.log,kp=Ke.unstable_setDisableYieldValue,Pp=null,Qp=null;function dm(st){if(Qp&&typeof Qp.onCommitFiberRoot=="function")try{Qp.onCommitFiberRoot(Pp,st,void 0,(st.current.flags&128)===128)}catch{}}function lm(st){if(typeof xp=="function"&&kp(st),Qp&&typeof Qp.setStrictMode=="function")try{Qp.setStrictMode(Pp,st)}catch{}}var om=Math.clz32?Math.clz32:iC,hm=Math.log,rC=Math.LN2;function iC(st){return st>>>=0,st===0?32:31-(hm(st)/rC|0)|0}var u0=128,l0=4194304;function cg(st){var rn=st&42;if(rn!==0)return rn;switch(st&-st){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return st&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return st&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return st}}function c0(st,rn){var un=st.pendingLanes;if(un===0)return 0;var cn=0,to=st.suspendedLanes,fo=st.pingedLanes,np=st.warmLanes;st=st.finishedLanes!==0;var up=un&134217727;return up!==0?(un=up&~to,un!==0?cn=cg(un):(fo&=up,fo!==0?cn=cg(fo):st||(np=up&~np,np!==0&&(cn=cg(np))))):(up=un&~to,up!==0?cn=cg(up):fo!==0?cn=cg(fo):st||(np=un&~np,np!==0&&(cn=cg(np)))),cn===0?0:rn!==0&&rn!==cn&&(rn&to)===0&&(to=cn&-cn,np=rn&-rn,to>=np||to===32&&(np&4194176)!==0)?rn:cn}function dy(st,rn){return(st.pendingLanes&~(st.suspendedLanes&~st.pingedLanes)&rn)===0}function aC(st,rn){switch(st){case 1:case 2:case 4:case 8:return rn+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return rn+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ew(){var st=u0;return u0<<=1,(u0&4194176)===0&&(u0=128),st}function Cw(){var st=l0;return l0<<=1,(l0&62914560)===0&&(l0=4194304),st}function yx(st){for(var rn=[],un=0;31>un;un++)rn.push(st);return rn}function py(st,rn){st.pendingLanes|=rn,rn!==268435456&&(st.suspendedLanes=0,st.pingedLanes=0,st.warmLanes=0)}function oC(st,rn,un,cn,to,fo){var np=st.pendingLanes;st.pendingLanes=un,st.suspendedLanes=0,st.pingedLanes=0,st.warmLanes=0,st.expiredLanes&=un,st.entangledLanes&=un,st.errorRecoveryDisabledLanes&=un,st.shellSuspendCounter=0;var up=st.entanglements,pp=st.expirationTimes,_p=st.hiddenUpdates;for(un=np&~un;0<un;){var Up=31-om(un),Wp=1<<Up;up[Up]=0,pp[Up]=-1;var Dp=_p[Up];if(Dp!==null)for(_p[Up]=null,Up=0;Up<Dp.length;Up++){var Lp=Dp[Up];Lp!==null&&(Lp.lane&=-536870913)}un&=~Wp}cn!==0&&Rw(st,cn,0),fo!==0&&to===0&&st.tag!==0&&(st.suspendedLanes|=fo&~(np&~rn))}function Rw(st,rn,un){st.pendingLanes|=rn,st.suspendedLanes&=~rn;var cn=31-om(rn);st.entangledLanes|=rn,st.entanglements[cn]=st.entanglements[cn]|1073741824|un&4194218}function Sw(st,rn){var un=st.entangledLanes|=rn;for(st=st.entanglements;un;){var cn=31-om(un),to=1<<cn;to&rn|st[cn]&rn&&(st[cn]|=rn),un&=~to}}function Aw(st){return st&=-st,2<st?8<st?(st&134217727)!==0?32:268435456:8:2}function Tw(){var st=zp.p;return st!==0?st:(st=window.event,st===void 0?32:Y2(st.type))}function sC(st,rn){var un=zp.p;try{return zp.p=st,rn()}finally{zp.p=un}}var jv=Math.random().toString(36).slice(2),Vm="__reactFiber$"+jv,Ym="__reactProps$"+jv,Og="__reactContainer$"+jv,bx="__reactEvents$"+jv,uC="__reactListeners$"+jv,lC="__reactHandles$"+jv,Dw="__reactResources$"+jv,my="__reactMarker$"+jv;function xx(st){delete st[Vm],delete st[Ym],delete st[bx],delete st[uC],delete st[lC]}function fg(st){var rn=st[Vm];if(rn)return rn;for(var un=st.parentNode;un;){if(rn=un[Og]||un[Vm]){if(un=rn.alternate,rn.child!==null||un!==null&&un.child!==null)for(st=I2(st);st!==null;){if(un=st[Vm])return un;st=I2(st)}return rn}st=un,un=st.parentNode}return null}function Bg(st){if(st=st[Vm]||st[Og]){var rn=st.tag;if(rn===5||rn===6||rn===13||rn===26||rn===27||rn===3)return st}return null}function vy(st){var rn=st.tag;if(rn===5||rn===26||rn===27||rn===6)return st.stateNode;throw Error(Ye(33))}function Mg(st){var rn=st[Dw];return rn||(rn=st[Dw]={hoistableStyles:new Map,hoistableScripts:new Map}),rn}function Lm(st){st[my]=!0}var Nw=new Set,kw={};function hg(st,rn){Ig(st,rn),Ig(st+"Capture",rn)}function Ig(st,rn){for(kw[st]=rn,st=0;st<rn.length;st++)Nw.add(rn[st])}var Rv=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),cC=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ow={},Bw={};function fC(st){return xm.call(Bw,st)?!0:xm.call(Ow,st)?!1:cC.test(st)?Bw[st]=!0:(Ow[st]=!0,!1)}function f0(st,rn,un){if(fC(rn))if(un===null)st.removeAttribute(rn);else{switch(typeof un){case"undefined":case"function":case"symbol":st.removeAttribute(rn);return;case"boolean":var cn=rn.toLowerCase().slice(0,5);if(cn!=="data-"&&cn!=="aria-"){st.removeAttribute(rn);return}}st.setAttribute(rn,""+un)}}function h0(st,rn,un){if(un===null)st.removeAttribute(rn);else{switch(typeof un){case"undefined":case"function":case"symbol":case"boolean":st.removeAttribute(rn);return}st.setAttribute(rn,""+un)}}function Sv(st,rn,un,cn){if(cn===null)st.removeAttribute(un);else{switch(typeof cn){case"undefined":case"function":case"symbol":case"boolean":st.removeAttribute(un);return}st.setAttributeNS(rn,un,""+cn)}}function iv(st){switch(typeof st){case"bigint":case"boolean":case"number":case"string":case"undefined":return st;case"object":return st;default:return""}}function Mw(st){var rn=st.type;return(st=st.nodeName)&&st.toLowerCase()==="input"&&(rn==="checkbox"||rn==="radio")}function hC(st){var rn=Mw(st)?"checked":"value",un=Object.getOwnPropertyDescriptor(st.constructor.prototype,rn),cn=""+st[rn];if(!st.hasOwnProperty(rn)&&typeof un<"u"&&typeof un.get=="function"&&typeof un.set=="function"){var to=un.get,fo=un.set;return Object.defineProperty(st,rn,{configurable:!0,get:function(){return to.call(this)},set:function(np){cn=""+np,fo.call(this,np)}}),Object.defineProperty(st,rn,{enumerable:un.enumerable}),{getValue:function(){return cn},setValue:function(np){cn=""+np},stopTracking:function(){st._valueTracker=null,delete st[rn]}}}}function d0(st){st._valueTracker||(st._valueTracker=hC(st))}function Iw(st){if(!st)return!1;var rn=st._valueTracker;if(!rn)return!0;var un=rn.getValue(),cn="";return st&&(cn=Mw(st)?st.checked?"true":"false":st.value),st=cn,st!==un?(rn.setValue(st),!0):!1}function p0(st){if(st=st||(typeof document<"u"?document:void 0),typeof st>"u")return null;try{return st.activeElement||st.body}catch{return st.body}}var dC=/[\n"\\]/g;function av(st){return st.replace(dC,function(rn){return"\\"+rn.charCodeAt(0).toString(16)+" "})}function wx(st,rn,un,cn,to,fo,np,up){st.name="",np!=null&&typeof np!="function"&&typeof np!="symbol"&&typeof np!="boolean"?st.type=np:st.removeAttribute("type"),rn!=null?np==="number"?(rn===0&&st.value===""||st.value!=rn)&&(st.value=""+iv(rn)):st.value!==""+iv(rn)&&(st.value=""+iv(rn)):np!=="submit"&&np!=="reset"||st.removeAttribute("value"),rn!=null?_x(st,np,iv(rn)):un!=null?_x(st,np,iv(un)):cn!=null&&st.removeAttribute("value"),to==null&&fo!=null&&(st.defaultChecked=!!fo),to!=null&&(st.checked=to&&typeof to!="function"&&typeof to!="symbol"),up!=null&&typeof up!="function"&&typeof up!="symbol"&&typeof up!="boolean"?st.name=""+iv(up):st.removeAttribute("name")}function Fw(st,rn,un,cn,to,fo,np,up){if(fo!=null&&typeof fo!="function"&&typeof fo!="symbol"&&typeof fo!="boolean"&&(st.type=fo),rn!=null||un!=null){if(!(fo!=="submit"&&fo!=="reset"||rn!=null))return;un=un!=null?""+iv(un):"",rn=rn!=null?""+iv(rn):un,up||rn===st.value||(st.value=rn),st.defaultValue=rn}cn=cn??to,cn=typeof cn!="function"&&typeof cn!="symbol"&&!!cn,st.checked=up?st.checked:!!cn,st.defaultChecked=!!cn,np!=null&&typeof np!="function"&&typeof np!="symbol"&&typeof np!="boolean"&&(st.name=np)}function _x(st,rn,un){rn==="number"&&p0(st.ownerDocument)===st||st.defaultValue===""+un||(st.defaultValue=""+un)}function Fg(st,rn,un,cn){if(st=st.options,rn){rn={};for(var to=0;to<un.length;to++)rn["$"+un[to]]=!0;for(un=0;un<st.length;un++)to=rn.hasOwnProperty("$"+st[un].value),st[un].selected!==to&&(st[un].selected=to),to&&cn&&(st[un].defaultSelected=!0)}else{for(un=""+iv(un),rn=null,to=0;to<st.length;to++){if(st[to].value===un){st[to].selected=!0,cn&&(st[to].defaultSelected=!0);return}rn!==null||st[to].disabled||(rn=st[to])}rn!==null&&(rn.selected=!0)}}function Lw(st,rn,un){if(rn!=null&&(rn=""+iv(rn),rn!==st.value&&(st.value=rn),un==null)){st.defaultValue!==rn&&(st.defaultValue=rn);return}st.defaultValue=un!=null?""+iv(un):""}function Pw(st,rn,un,cn){if(rn==null){if(cn!=null){if(un!=null)throw Error(Ye(92));if(Hp(cn)){if(1<cn.length)throw Error(Ye(93));cn=cn[0]}un=cn}un==null&&(un=""),rn=un}un=iv(rn),st.defaultValue=un,cn=st.textContent,cn===un&&cn!==""&&cn!==null&&(st.value=cn)}function Lg(st,rn){if(rn){var un=st.firstChild;if(un&&un===st.lastChild&&un.nodeType===3){un.nodeValue=rn;return}}st.textContent=rn}var pC=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Uw(st,rn,un){var cn=rn.indexOf("--")===0;un==null||typeof un=="boolean"||un===""?cn?st.setProperty(rn,""):rn==="float"?st.cssFloat="":st[rn]="":cn?st.setProperty(rn,un):typeof un!="number"||un===0||pC.has(rn)?rn==="float"?st.cssFloat=un:st[rn]=(""+un).trim():st[rn]=un+"px"}function Hw(st,rn,un){if(rn!=null&&typeof rn!="object")throw Error(Ye(62));if(st=st.style,un!=null){for(var cn in un)!un.hasOwnProperty(cn)||rn!=null&&rn.hasOwnProperty(cn)||(cn.indexOf("--")===0?st.setProperty(cn,""):cn==="float"?st.cssFloat="":st[cn]="");for(var to in rn)cn=rn[to],rn.hasOwnProperty(to)&&un[to]!==cn&&Uw(st,to,cn)}else for(var fo in rn)rn.hasOwnProperty(fo)&&Uw(st,fo,rn[fo])}function Ex(st){if(st.indexOf("-")===-1)return!1;switch(st){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var mC=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),vC=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function m0(st){return vC.test(""+st)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":st}var Cx=null;function Rx(st){return st=st.target||st.srcElement||window,st.correspondingUseElement&&(st=st.correspondingUseElement),st.nodeType===3?st.parentNode:st}var Pg=null,Ug=null;function zw(st){var rn=Bg(st);if(rn&&(st=rn.stateNode)){var un=st[Ym]||null;e:switch(st=rn.stateNode,rn.type){case"input":if(wx(st,un.value,un.defaultValue,un.defaultValue,un.checked,un.defaultChecked,un.type,un.name),rn=un.name,un.type==="radio"&&rn!=null){for(un=st;un.parentNode;)un=un.parentNode;for(un=un.querySelectorAll('input[name="'+av(""+rn)+'"][type="radio"]'),rn=0;rn<un.length;rn++){var cn=un[rn];if(cn!==st&&cn.form===st.form){var to=cn[Ym]||null;if(!to)throw Error(Ye(90));wx(cn,to.value,to.defaultValue,to.defaultValue,to.checked,to.defaultChecked,to.type,to.name)}}for(rn=0;rn<un.length;rn++)cn=un[rn],cn.form===st.form&&Iw(cn)}break e;case"textarea":Lw(st,un.value,un.defaultValue);break e;case"select":rn=un.value,rn!=null&&Fg(st,!!un.multiple,rn,!1)}}}var Sx=!1;function jw(st,rn,un){if(Sx)return st(rn,un);Sx=!0;try{var cn=st(rn);return cn}finally{if(Sx=!1,(Pg!==null||Ug!==null)&&(Q0(),Pg&&(rn=Pg,st=Ug,Ug=Pg=null,zw(rn),st)))for(rn=0;rn<st.length;rn++)zw(st[rn])}}function gy(st,rn){var un=st.stateNode;if(un===null)return null;var cn=un[Ym]||null;if(cn===null)return null;un=cn[rn];e:switch(rn){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(cn=!cn.disabled)||(st=st.type,cn=!(st==="button"||st==="input"||st==="select"||st==="textarea")),st=!cn;break e;default:st=!1}if(st)return null;if(un&&typeof un!="function")throw Error(Ye(231,rn,typeof un));return un}var Ax=!1;if(Rv)try{var yy={};Object.defineProperty(yy,"passive",{get:function(){Ax=!0}}),window.addEventListener("test",yy,yy),window.removeEventListener("test",yy,yy)}catch{Ax=!1}var qv=null,Tx=null,v0=null;function qw(){if(v0)return v0;var st,rn=Tx,un=rn.length,cn,to="value"in qv?qv.value:qv.textContent,fo=to.length;for(st=0;st<un&&rn[st]===to[st];st++);var np=un-st;for(cn=1;cn<=np&&rn[un-cn]===to[fo-cn];cn++);return v0=to.slice(st,1<cn?1-cn:void 0)}function g0(st){var rn=st.keyCode;return"charCode"in st?(st=st.charCode,st===0&&rn===13&&(st=13)):st=rn,st===10&&(st=13),32<=st||st===13?st:0}function y0(){return!0}function Ww(){return!1}function Zm(st){function rn(un,cn,to,fo,np){this._reactName=un,this._targetInst=to,this.type=cn,this.nativeEvent=fo,this.target=np,this.currentTarget=null;for(var up in st)st.hasOwnProperty(up)&&(un=st[up],this[up]=un?un(fo):fo[up]);return this.isDefaultPrevented=(fo.defaultPrevented!=null?fo.defaultPrevented:fo.returnValue===!1)?y0:Ww,this.isPropagationStopped=Ww,this}return lp(rn.prototype,{preventDefault:function(){this.defaultPrevented=!0;var un=this.nativeEvent;un&&(un.preventDefault?un.preventDefault():typeof un.returnValue!="unknown"&&(un.returnValue=!1),this.isDefaultPrevented=y0)},stopPropagation:function(){var un=this.nativeEvent;un&&(un.stopPropagation?un.stopPropagation():typeof un.cancelBubble!="unknown"&&(un.cancelBubble=!0),this.isPropagationStopped=y0)},persist:function(){},isPersistent:y0}),rn}var dg={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(st){return st.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},b0=Zm(dg),by=lp({},dg,{view:0,detail:0}),gC=Zm(by),Dx,Nx,xy,x0=lp({},by,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ox,button:0,buttons:0,relatedTarget:function(st){return st.relatedTarget===void 0?st.fromElement===st.srcElement?st.toElement:st.fromElement:st.relatedTarget},movementX:function(st){return"movementX"in st?st.movementX:(st!==xy&&(xy&&st.type==="mousemove"?(Dx=st.screenX-xy.screenX,Nx=st.screenY-xy.screenY):Nx=Dx=0,xy=st),Dx)},movementY:function(st){return"movementY"in st?st.movementY:Nx}}),Vw=Zm(x0),yC=lp({},x0,{dataTransfer:0}),bC=Zm(yC),xC=lp({},by,{relatedTarget:0}),kx=Zm(xC),wC=lp({},dg,{animationName:0,elapsedTime:0,pseudoElement:0}),_C=Zm(wC),EC=lp({},dg,{clipboardData:function(st){return"clipboardData"in st?st.clipboardData:window.clipboardData}}),CC=Zm(EC),RC=lp({},dg,{data:0}),$w=Zm(RC),SC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},AC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},TC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function DC(st){var rn=this.nativeEvent;return rn.getModifierState?rn.getModifierState(st):(st=TC[st])?!!rn[st]:!1}function Ox(){return DC}var NC=lp({},by,{key:function(st){if(st.key){var rn=SC[st.key]||st.key;if(rn!=="Unidentified")return rn}return st.type==="keypress"?(st=g0(st),st===13?"Enter":String.fromCharCode(st)):st.type==="keydown"||st.type==="keyup"?AC[st.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ox,charCode:function(st){return st.type==="keypress"?g0(st):0},keyCode:function(st){return st.type==="keydown"||st.type==="keyup"?st.keyCode:0},which:function(st){return st.type==="keypress"?g0(st):st.type==="keydown"||st.type==="keyup"?st.keyCode:0}}),kC=Zm(NC),OC=lp({},x0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Gw=Zm(OC),BC=lp({},by,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ox}),MC=Zm(BC),IC=lp({},dg,{propertyName:0,elapsedTime:0,pseudoElement:0}),FC=Zm(IC),LC=lp({},x0,{deltaX:function(st){return"deltaX"in st?st.deltaX:"wheelDeltaX"in st?-st.wheelDeltaX:0},deltaY:function(st){return"deltaY"in st?st.deltaY:"wheelDeltaY"in st?-st.wheelDeltaY:"wheelDelta"in st?-st.wheelDelta:0},deltaZ:0,deltaMode:0}),PC=Zm(LC),UC=lp({},dg,{newState:0,oldState:0}),HC=Zm(UC),zC=[9,13,27,32],Bx=Rv&&"CompositionEvent"in window,wy=null;Rv&&"documentMode"in document&&(wy=document.documentMode);var jC=Rv&&"TextEvent"in window&&!wy,Xw=Rv&&(!Bx||wy&&8<wy&&11>=wy),Kw=" ",Yw=!1;function Zw(st,rn){switch(st){case"keyup":return zC.indexOf(rn.keyCode)!==-1;case"keydown":return rn.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Qw(st){return st=st.detail,typeof st=="object"&&"data"in st?st.data:null}var Hg=!1;function qC(st,rn){switch(st){case"compositionend":return Qw(rn);case"keypress":return rn.which!==32?null:(Yw=!0,Kw);case"textInput":return st=rn.data,st===Kw&&Yw?null:st;default:return null}}function WC(st,rn){if(Hg)return st==="compositionend"||!Bx&&Zw(st,rn)?(st=qw(),v0=Tx=qv=null,Hg=!1,st):null;switch(st){case"paste":return null;case"keypress":if(!(rn.ctrlKey||rn.altKey||rn.metaKey)||rn.ctrlKey&&rn.altKey){if(rn.char&&1<rn.char.length)return rn.char;if(rn.which)return String.fromCharCode(rn.which)}return null;case"compositionend":return Xw&&rn.locale!=="ko"?null:rn.data;default:return null}}var VC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Jw(st){var rn=st&&st.nodeName&&st.nodeName.toLowerCase();return rn==="input"?!!VC[st.type]:rn==="textarea"}function e_(st,rn,un,cn){Pg?Ug?Ug.push(cn):Ug=[cn]:Pg=cn,rn=nx(rn,"onChange"),0<rn.length&&(un=new b0("onChange","change",null,un,cn),st.push({event:un,listeners:rn}))}var _y=null,Ey=null;function $C(st){S2(st,0)}function w0(st){var rn=vy(st);if(Iw(rn))return st}function t_(st,rn){if(st==="change")return rn}var n_=!1;if(Rv){var Mx;if(Rv){var Ix="oninput"in document;if(!Ix){var r_=document.createElement("div");r_.setAttribute("oninput","return;"),Ix=typeof r_.oninput=="function"}Mx=Ix}else Mx=!1;n_=Mx&&(!document.documentMode||9<document.documentMode)}function i_(){_y&&(_y.detachEvent("onpropertychange",a_),Ey=_y=null)}function a_(st){if(st.propertyName==="value"&&w0(Ey)){var rn=[];e_(rn,Ey,st,Rx(st)),jw($C,rn)}}function GC(st,rn,un){st==="focusin"?(i_(),_y=rn,Ey=un,_y.attachEvent("onpropertychange",a_)):st==="focusout"&&i_()}function XC(st){if(st==="selectionchange"||st==="keyup"||st==="keydown")return w0(Ey)}function KC(st,rn){if(st==="click")return w0(rn)}function YC(st,rn){if(st==="input"||st==="change")return w0(rn)}function ZC(st,rn){return st===rn&&(st!==0||1/st===1/rn)||st!==st&&rn!==rn}var Jm=typeof Object.is=="function"?Object.is:ZC;function Cy(st,rn){if(Jm(st,rn))return!0;if(typeof st!="object"||st===null||typeof rn!="object"||rn===null)return!1;var un=Object.keys(st),cn=Object.keys(rn);if(un.length!==cn.length)return!1;for(cn=0;cn<un.length;cn++){var to=un[cn];if(!xm.call(rn,to)||!Jm(st[to],rn[to]))return!1}return!0}function o_(st){for(;st&&st.firstChild;)st=st.firstChild;return st}function s_(st,rn){var un=o_(st);st=0;for(var cn;un;){if(un.nodeType===3){if(cn=st+un.textContent.length,st<=rn&&cn>=rn)return{node:un,offset:rn-st};st=cn}e:{for(;un;){if(un.nextSibling){un=un.nextSibling;break e}un=un.parentNode}un=void 0}un=o_(un)}}function u_(st,rn){return st&&rn?st===rn?!0:st&&st.nodeType===3?!1:rn&&rn.nodeType===3?u_(st,rn.parentNode):"contains"in st?st.contains(rn):st.compareDocumentPosition?!!(st.compareDocumentPosition(rn)&16):!1:!1}function l_(st){st=st!=null&&st.ownerDocument!=null&&st.ownerDocument.defaultView!=null?st.ownerDocument.defaultView:window;for(var rn=p0(st.document);rn instanceof st.HTMLIFrameElement;){try{var un=typeof rn.contentWindow.location.href=="string"}catch{un=!1}if(un)st=rn.contentWindow;else break;rn=p0(st.document)}return rn}function Fx(st){var rn=st&&st.nodeName&&st.nodeName.toLowerCase();return rn&&(rn==="input"&&(st.type==="text"||st.type==="search"||st.type==="tel"||st.type==="url"||st.type==="password")||rn==="textarea"||st.contentEditable==="true")}function QC(st,rn){var un=l_(rn);rn=st.focusedElem;var cn=st.selectionRange;if(un!==rn&&rn&&rn.ownerDocument&&u_(rn.ownerDocument.documentElement,rn)){if(cn!==null&&Fx(rn)){if(st=cn.start,un=cn.end,un===void 0&&(un=st),"selectionStart"in rn)rn.selectionStart=st,rn.selectionEnd=Math.min(un,rn.value.length);else if(un=(st=rn.ownerDocument||document)&&st.defaultView||window,un.getSelection){un=un.getSelection();var to=rn.textContent.length,fo=Math.min(cn.start,to);cn=cn.end===void 0?fo:Math.min(cn.end,to),!un.extend&&fo>cn&&(to=cn,cn=fo,fo=to),to=s_(rn,fo);var np=s_(rn,cn);to&&np&&(un.rangeCount!==1||un.anchorNode!==to.node||un.anchorOffset!==to.offset||un.focusNode!==np.node||un.focusOffset!==np.offset)&&(st=st.createRange(),st.setStart(to.node,to.offset),un.removeAllRanges(),fo>cn?(un.addRange(st),un.extend(np.node,np.offset)):(st.setEnd(np.node,np.offset),un.addRange(st)))}}for(st=[],un=rn;un=un.parentNode;)un.nodeType===1&&st.push({element:un,left:un.scrollLeft,top:un.scrollTop});for(typeof rn.focus=="function"&&rn.focus(),rn=0;rn<st.length;rn++)un=st[rn],un.element.scrollLeft=un.left,un.element.scrollTop=un.top}}var JC=Rv&&"documentMode"in document&&11>=document.documentMode,zg=null,Lx=null,Ry=null,Px=!1;function c_(st,rn,un){var cn=un.window===un?un.document:un.nodeType===9?un:un.ownerDocument;Px||zg==null||zg!==p0(cn)||(cn=zg,"selectionStart"in cn&&Fx(cn)?cn={start:cn.selectionStart,end:cn.selectionEnd}:(cn=(cn.ownerDocument&&cn.ownerDocument.defaultView||window).getSelection(),cn={anchorNode:cn.anchorNode,anchorOffset:cn.anchorOffset,focusNode:cn.focusNode,focusOffset:cn.focusOffset}),Ry&&Cy(Ry,cn)||(Ry=cn,cn=nx(Lx,"onSelect"),0<cn.length&&(rn=new b0("onSelect","select",null,rn,un),st.push({event:rn,listeners:cn}),rn.target=zg)))}function pg(st,rn){var un={};return un[st.toLowerCase()]=rn.toLowerCase(),un["Webkit"+st]="webkit"+rn,un["Moz"+st]="moz"+rn,un}var jg={animationend:pg("Animation","AnimationEnd"),animationiteration:pg("Animation","AnimationIteration"),animationstart:pg("Animation","AnimationStart"),transitionrun:pg("Transition","TransitionRun"),transitionstart:pg("Transition","TransitionStart"),transitioncancel:pg("Transition","TransitionCancel"),transitionend:pg("Transition","TransitionEnd")},Ux={},f_={};Rv&&(f_=document.createElement("div").style,"AnimationEvent"in window||(delete jg.animationend.animation,delete jg.animationiteration.animation,delete jg.animationstart.animation),"TransitionEvent"in window||delete jg.transitionend.transition);function mg(st){if(Ux[st])return Ux[st];if(!jg[st])return st;var rn=jg[st],un;for(un in rn)if(rn.hasOwnProperty(un)&&un in f_)return Ux[st]=rn[un];return st}var h_=mg("animationend"),d_=mg("animationiteration"),p_=mg("animationstart"),eR=mg("transitionrun"),tR=mg("transitionstart"),nR=mg("transitioncancel"),m_=mg("transitionend"),v_=new Map,g_="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function vv(st,rn){v_.set(st,rn),hg(rn,[st])}var ov=[],qg=0,Hx=0;function _0(){for(var st=qg,rn=Hx=qg=0;rn<st;){var un=ov[rn];ov[rn++]=null;var cn=ov[rn];ov[rn++]=null;var to=ov[rn];ov[rn++]=null;var fo=ov[rn];if(ov[rn++]=null,cn!==null&&to!==null){var np=cn.pending;np===null?to.next=to:(to.next=np.next,np.next=to),cn.pending=to}fo!==0&&y_(un,to,fo)}}function E0(st,rn,un,cn){ov[qg++]=st,ov[qg++]=rn,ov[qg++]=un,ov[qg++]=cn,Hx|=cn,st.lanes|=cn,st=st.alternate,st!==null&&(st.lanes|=cn)}function zx(st,rn,un,cn){return E0(st,rn,un,cn),C0(st)}function Wv(st,rn){return E0(st,null,null,rn),C0(st)}function y_(st,rn,un){st.lanes|=un;var cn=st.alternate;cn!==null&&(cn.lanes|=un);for(var to=!1,fo=st.return;fo!==null;)fo.childLanes|=un,cn=fo.alternate,cn!==null&&(cn.childLanes|=un),fo.tag===22&&(st=fo.stateNode,st===null||st._visibility&1||(to=!0)),st=fo,fo=fo.return;to&&rn!==null&&st.tag===3&&(fo=st.stateNode,to=31-om(un),fo=fo.hiddenUpdates,st=fo[to],st===null?fo[to]=[rn]:st.push(rn),rn.lane=un|536870912)}function C0(st){if(50<Yy)throw Yy=0,G1=null,Error(Ye(185));for(var rn=st.return;rn!==null;)st=rn,rn=st.return;return st.tag===3?st.stateNode:null}var Wg={},b_=new WeakMap;function sv(st,rn){if(typeof st=="object"&&st!==null){var un=b_.get(st);return un!==void 0?un:(rn={value:st,source:rn,stack:Sp(rn)},b_.set(st,rn),rn)}return{value:st,source:rn,stack:Sp(rn)}}var Vg=[],$g=0,R0=null,S0=0,uv=[],lv=0,vg=null,Av=1,Tv="";function gg(st,rn){Vg[$g++]=S0,Vg[$g++]=R0,R0=st,S0=rn}function x_(st,rn,un){uv[lv++]=Av,uv[lv++]=Tv,uv[lv++]=vg,vg=st;var cn=Av;st=Tv;var to=32-om(cn)-1;cn&=~(1<<to),un+=1;var fo=32-om(rn)+to;if(30<fo){var np=to-to%5;fo=(cn&(1<<np)-1).toString(32),cn>>=np,to-=np,Av=1<<32-om(rn)+to|un<<to|cn,Tv=fo+st}else Av=1<<fo|un<<to|cn,Tv=st}function jx(st){st.return!==null&&(gg(st,1),x_(st,1,0))}function qx(st){for(;st===R0;)R0=Vg[--$g],Vg[$g]=null,S0=Vg[--$g],Vg[$g]=null;for(;st===vg;)vg=uv[--lv],uv[lv]=null,Tv=uv[--lv],uv[lv]=null,Av=uv[--lv],uv[lv]=null}var Gm=null,zm=null,cm=!1,gv=null,xv=!1,Wx=Error(Ye(519));function yg(st){var rn=Error(Ye(418,""));throw Ty(sv(rn,st)),Wx}function w_(st){var rn=st.stateNode,un=st.type,cn=st.memoizedProps;switch(rn[Vm]=st,rn[Ym]=cn,un){case"dialog":sm("cancel",rn),sm("close",rn);break;case"iframe":case"object":case"embed":sm("load",rn);break;case"video":case"audio":for(un=0;un<Qy.length;un++)sm(Qy[un],rn);break;case"source":sm("error",rn);break;case"img":case"image":case"link":sm("error",rn),sm("load",rn);break;case"details":sm("toggle",rn);break;case"input":sm("invalid",rn),Fw(rn,cn.value,cn.defaultValue,cn.checked,cn.defaultChecked,cn.type,cn.name,!0),d0(rn);break;case"select":sm("invalid",rn);break;case"textarea":sm("invalid",rn),Pw(rn,cn.value,cn.defaultValue,cn.children),d0(rn)}un=cn.children,typeof un!="string"&&typeof un!="number"&&typeof un!="bigint"||rn.textContent===""+un||cn.suppressHydrationWarning===!0||N2(rn.textContent,un)?(cn.popover!=null&&(sm("beforetoggle",rn),sm("toggle",rn)),cn.onScroll!=null&&sm("scroll",rn),cn.onScrollEnd!=null&&sm("scrollend",rn),cn.onClick!=null&&(rn.onclick=rx),rn=!0):rn=!1,rn||yg(st)}function __(st){for(Gm=st.return;Gm;)switch(Gm.tag){case 3:case 27:xv=!0;return;case 5:case 13:xv=!1;return;default:Gm=Gm.return}}function Sy(st){if(st!==Gm)return!1;if(!cm)return __(st),cm=!0,!1;var rn=!1,un;if((un=st.tag!==3&&st.tag!==27)&&((un=st.tag===5)&&(un=st.type,un=!(un!=="form"&&un!=="button")||cw(st.type,st.memoizedProps)),un=!un),un&&(rn=!0),rn&&zm&&yg(st),__(st),st.tag===13){if(st=st.memoizedState,st=st!==null?st.dehydrated:null,!st)throw Error(Ye(317));e:{for(st=st.nextSibling,rn=0;st;){if(st.nodeType===8)if(un=st.data,un==="/$"){if(rn===0){zm=bv(st.nextSibling);break e}rn--}else un!=="$"&&un!=="$!"&&un!=="$?"||rn++;st=st.nextSibling}zm=null}}else zm=Gm?bv(st.stateNode.nextSibling):null;return!0}function Ay(){zm=Gm=null,cm=!1}function Ty(st){gv===null?gv=[st]:gv.push(st)}var Dy=Error(Ye(460)),E_=Error(Ye(474)),Vx={then:function(){}};function C_(st){return st=st.status,st==="fulfilled"||st==="rejected"}function A0(){}function R_(st,rn,un){switch(un=st[un],un===void 0?st.push(rn):un!==rn&&(rn.then(A0,A0),rn=un),rn.status){case"fulfilled":return rn.value;case"rejected":throw st=rn.reason,st===Dy?Error(Ye(483)):st;default:if(typeof rn.status=="string")rn.then(A0,A0);else{if(st=gm,st!==null&&100<st.shellSuspendCounter)throw Error(Ye(482));st=rn,st.status="pending",st.then(function(cn){if(rn.status==="pending"){var to=rn;to.status="fulfilled",to.value=cn}},function(cn){if(rn.status==="pending"){var to=rn;to.status="rejected",to.reason=cn}})}switch(rn.status){case"fulfilled":return rn.value;case"rejected":throw st=rn.reason,st===Dy?Error(Ye(483)):st}throw Ny=rn,Dy}}var Ny=null;function S_(){if(Ny===null)throw Error(Ye(459));var st=Ny;return Ny=null,st}var Gg=null,ky=0;function T0(st){var rn=ky;return ky+=1,Gg===null&&(Gg=[]),R_(Gg,st,rn)}function Oy(st,rn){rn=rn.props.ref,st.ref=rn!==void 0?rn:null}function D0(st,rn){throw rn.$$typeof===Je?Error(Ye(525)):(st=Object.prototype.toString.call(rn),Error(Ye(31,st==="[object Object]"?"object with keys {"+Object.keys(rn).join(", ")+"}":st)))}function A_(st){var rn=st._init;return rn(st._payload)}function T_(st){function rn(Rp,bp){if(st){var Ap=Rp.deletions;Ap===null?(Rp.deletions=[bp],Rp.flags|=16):Ap.push(bp)}}function un(Rp,bp){if(!st)return null;for(;bp!==null;)rn(Rp,bp),bp=bp.sibling;return null}function cn(Rp){for(var bp=new Map;Rp!==null;)Rp.key!==null?bp.set(Rp.key,Rp):bp.set(Rp.index,Rp),Rp=Rp.sibling;return bp}function to(Rp,bp){return Rp=ng(Rp,bp),Rp.index=0,Rp.sibling=null,Rp}function fo(Rp,bp,Ap){return Rp.index=Ap,st?(Ap=Rp.alternate,Ap!==null?(Ap=Ap.index,Ap<bp?(Rp.flags|=33554434,bp):Ap):(Rp.flags|=33554434,bp)):(Rp.flags|=1048576,bp)}function np(Rp){return st&&Rp.alternate===null&&(Rp.flags|=33554434),Rp}function up(Rp,bp,Ap,jp){return bp===null||bp.tag!==6?(bp=U1(Ap,Rp.mode,jp),bp.return=Rp,bp):(bp=to(bp,Ap),bp.return=Rp,bp)}function pp(Rp,bp,Ap,jp){var Kp=Ap.type;return Kp===an?Up(Rp,bp,Ap.props.children,jp,Ap.key):bp!==null&&(bp.elementType===Kp||typeof Kp=="object"&&Kp!==null&&Kp.$$typeof===ho&&A_(Kp)===bp.type)?(bp=to(bp,Ap.props),Oy(bp,Ap),bp.return=Rp,bp):(bp=G0(Ap.type,Ap.key,Ap.props,null,Rp.mode,jp),Oy(bp,Ap),bp.return=Rp,bp)}function _p(Rp,bp,Ap,jp){return bp===null||bp.tag!==4||bp.stateNode.containerInfo!==Ap.containerInfo||bp.stateNode.implementation!==Ap.implementation?(bp=H1(Ap,Rp.mode,jp),bp.return=Rp,bp):(bp=to(bp,Ap.children||[]),bp.return=Rp,bp)}function Up(Rp,bp,Ap,jp,Kp){return bp===null||bp.tag!==7?(bp=Tg(Ap,Rp.mode,jp,Kp),bp.return=Rp,bp):(bp=to(bp,Ap),bp.return=Rp,bp)}function Wp(Rp,bp,Ap){if(typeof bp=="string"&&bp!==""||typeof bp=="number"||typeof bp=="bigint")return bp=U1(""+bp,Rp.mode,Ap),bp.return=Rp,bp;if(typeof bp=="object"&&bp!==null){switch(bp.$$typeof){case Mt:return Ap=G0(bp.type,bp.key,bp.props,null,Rp.mode,Ap),Oy(Ap,bp),Ap.return=Rp,Ap;case nn:return bp=H1(bp,Rp.mode,Ap),bp.return=Rp,bp;case ho:var jp=bp._init;return bp=jp(bp._payload),Wp(Rp,bp,Ap)}if(Hp(bp)||rp(bp))return bp=Tg(bp,Rp.mode,Ap,null),bp.return=Rp,bp;if(typeof bp.then=="function")return Wp(Rp,T0(bp),Ap);if(bp.$$typeof===Xr)return Wp(Rp,W0(Rp,bp),Ap);D0(Rp,bp)}return null}function Dp(Rp,bp,Ap,jp){var Kp=bp!==null?bp.key:null;if(typeof Ap=="string"&&Ap!==""||typeof Ap=="number"||typeof Ap=="bigint")return Kp!==null?null:up(Rp,bp,""+Ap,jp);if(typeof Ap=="object"&&Ap!==null){switch(Ap.$$typeof){case Mt:return Ap.key===Kp?pp(Rp,bp,Ap,jp):null;case nn:return Ap.key===Kp?_p(Rp,bp,Ap,jp):null;case ho:return Kp=Ap._init,Ap=Kp(Ap._payload),Dp(Rp,bp,Ap,jp)}if(Hp(Ap)||rp(Ap))return Kp!==null?null:Up(Rp,bp,Ap,jp,null);if(typeof Ap.then=="function")return Dp(Rp,bp,T0(Ap),jp);if(Ap.$$typeof===Xr)return Dp(Rp,bp,W0(Rp,Ap),jp);D0(Rp,Ap)}return null}function Lp(Rp,bp,Ap,jp,Kp){if(typeof jp=="string"&&jp!==""||typeof jp=="number"||typeof jp=="bigint")return Rp=Rp.get(Ap)||null,up(bp,Rp,""+jp,Kp);if(typeof jp=="object"&&jp!==null){switch(jp.$$typeof){case Mt:return Rp=Rp.get(jp.key===null?Ap:jp.key)||null,pp(bp,Rp,jp,Kp);case nn:return Rp=Rp.get(jp.key===null?Ap:jp.key)||null,_p(bp,Rp,jp,Kp);case ho:var im=jp._init;return jp=im(jp._payload),Lp(Rp,bp,Ap,jp,Kp)}if(Hp(jp)||rp(jp))return Rp=Rp.get(Ap)||null,Up(bp,Rp,jp,Kp,null);if(typeof jp.then=="function")return Lp(Rp,bp,Ap,T0(jp),Kp);if(jp.$$typeof===Xr)return Lp(Rp,bp,Ap,W0(bp,jp),Kp);D0(bp,jp)}return null}function Yp(Rp,bp,Ap,jp){for(var Kp=null,im=null,Zp=bp,em=bp=0,Hm=null;Zp!==null&&em<Ap.length;em++){Zp.index>em?(Hm=Zp,Zp=null):Hm=Zp.sibling;var fm=Dp(Rp,Zp,Ap[em],jp);if(fm===null){Zp===null&&(Zp=Hm);break}st&&Zp&&fm.alternate===null&&rn(Rp,Zp),bp=fo(fm,bp,em),im===null?Kp=fm:im.sibling=fm,im=fm,Zp=Hm}if(em===Ap.length)return un(Rp,Zp),cm&&gg(Rp,em),Kp;if(Zp===null){for(;em<Ap.length;em++)Zp=Wp(Rp,Ap[em],jp),Zp!==null&&(bp=fo(Zp,bp,em),im===null?Kp=Zp:im.sibling=Zp,im=Zp);return cm&&gg(Rp,em),Kp}for(Zp=cn(Zp);em<Ap.length;em++)Hm=Lp(Zp,Rp,em,Ap[em],jp),Hm!==null&&(st&&Hm.alternate!==null&&Zp.delete(Hm.key===null?em:Hm.key),bp=fo(Hm,bp,em),im===null?Kp=Hm:im.sibling=Hm,im=Hm);return st&&Zp.forEach(function(lg){return rn(Rp,lg)}),cm&&gg(Rp,em),Kp}function nm(Rp,bp,Ap,jp){if(Ap==null)throw Error(Ye(151));for(var Kp=null,im=null,Zp=bp,em=bp=0,Hm=null,fm=Ap.next();Zp!==null&&!fm.done;em++,fm=Ap.next()){Zp.index>em?(Hm=Zp,Zp=null):Hm=Zp.sibling;var lg=Dp(Rp,Zp,fm.value,jp);if(lg===null){Zp===null&&(Zp=Hm);break}st&&Zp&&lg.alternate===null&&rn(Rp,Zp),bp=fo(lg,bp,em),im===null?Kp=lg:im.sibling=lg,im=lg,Zp=Hm}if(fm.done)return un(Rp,Zp),cm&&gg(Rp,em),Kp;if(Zp===null){for(;!fm.done;em++,fm=Ap.next())fm=Wp(Rp,fm.value,jp),fm!==null&&(bp=fo(fm,bp,em),im===null?Kp=fm:im.sibling=fm,im=fm);return cm&&gg(Rp,em),Kp}for(Zp=cn(Zp);!fm.done;em++,fm=Ap.next())fm=Lp(Zp,Rp,em,fm.value,jp),fm!==null&&(st&&fm.alternate!==null&&Zp.delete(fm.key===null?em:fm.key),bp=fo(fm,bp,em),im===null?Kp=fm:im.sibling=fm,im=fm);return st&&Zp.forEach(function(vS){return rn(Rp,vS)}),cm&&gg(Rp,em),Kp}function Tm(Rp,bp,Ap,jp){if(typeof Ap=="object"&&Ap!==null&&Ap.type===an&&Ap.key===null&&(Ap=Ap.props.children),typeof Ap=="object"&&Ap!==null){switch(Ap.$$typeof){case Mt:e:{for(var Kp=Ap.key;bp!==null;){if(bp.key===Kp){if(Kp=Ap.type,Kp===an){if(bp.tag===7){un(Rp,bp.sibling),jp=to(bp,Ap.props.children),jp.return=Rp,Rp=jp;break e}}else if(bp.elementType===Kp||typeof Kp=="object"&&Kp!==null&&Kp.$$typeof===ho&&A_(Kp)===bp.type){un(Rp,bp.sibling),jp=to(bp,Ap.props),Oy(jp,Ap),jp.return=Rp,Rp=jp;break e}un(Rp,bp);break}else rn(Rp,bp);bp=bp.sibling}Ap.type===an?(jp=Tg(Ap.props.children,Rp.mode,jp,Ap.key),jp.return=Rp,Rp=jp):(jp=G0(Ap.type,Ap.key,Ap.props,null,Rp.mode,jp),Oy(jp,Ap),jp.return=Rp,Rp=jp)}return np(Rp);case nn:e:{for(Kp=Ap.key;bp!==null;){if(bp.key===Kp)if(bp.tag===4&&bp.stateNode.containerInfo===Ap.containerInfo&&bp.stateNode.implementation===Ap.implementation){un(Rp,bp.sibling),jp=to(bp,Ap.children||[]),jp.return=Rp,Rp=jp;break e}else{un(Rp,bp);break}else rn(Rp,bp);bp=bp.sibling}jp=H1(Ap,Rp.mode,jp),jp.return=Rp,Rp=jp}return np(Rp);case ho:return Kp=Ap._init,Ap=Kp(Ap._payload),Tm(Rp,bp,Ap,jp)}if(Hp(Ap))return Yp(Rp,bp,Ap,jp);if(rp(Ap)){if(Kp=rp(Ap),typeof Kp!="function")throw Error(Ye(150));return Ap=Kp.call(Ap),nm(Rp,bp,Ap,jp)}if(typeof Ap.then=="function")return Tm(Rp,bp,T0(Ap),jp);if(Ap.$$typeof===Xr)return Tm(Rp,bp,W0(Rp,Ap),jp);D0(Rp,Ap)}return typeof Ap=="string"&&Ap!==""||typeof Ap=="number"||typeof Ap=="bigint"?(Ap=""+Ap,bp!==null&&bp.tag===6?(un(Rp,bp.sibling),jp=to(bp,Ap),jp.return=Rp,Rp=jp):(un(Rp,bp),jp=U1(Ap,Rp.mode,jp),jp.return=Rp,Rp=jp),np(Rp)):un(Rp,bp)}return function(Rp,bp,Ap,jp){try{ky=0;var Kp=Tm(Rp,bp,Ap,jp);return Gg=null,Kp}catch(Zp){if(Zp===Dy)throw Zp;var im=dv(29,Zp,null,Rp.mode);return im.lanes=jp,im.return=Rp,im}finally{}}}var bg=T_(!0),D_=T_(!1),Xg=Tp(null),N0=Tp(0);function N_(st,rn){st=Uv,$p(N0,st),$p(Xg,rn),Uv=st|rn.baseLanes}function $x(){$p(N0,Uv),$p(Xg,Xg.current)}function Gx(){Uv=N0.current,qp(Xg),qp(N0)}var cv=Tp(null),wv=null;function Vv(st){var rn=st.alternate;$p(Im,Im.current&1),$p(cv,st),wv===null&&(rn===null||Xg.current!==null||rn.memoizedState!==null)&&(wv=st)}function k_(st){if(st.tag===22){if($p(Im,Im.current),$p(cv,st),wv===null){var rn=st.alternate;rn!==null&&rn.memoizedState!==null&&(wv=st)}}else $v()}function $v(){$p(Im,Im.current),$p(cv,cv.current)}function Dv(st){qp(cv),wv===st&&(wv=null),qp(Im)}var Im=Tp(0);function k0(st){for(var rn=st;rn!==null;){if(rn.tag===13){var un=rn.memoizedState;if(un!==null&&(un=un.dehydrated,un===null||un.data==="$?"||un.data==="$!"))return rn}else if(rn.tag===19&&rn.memoizedProps.revealOrder!==void 0){if((rn.flags&128)!==0)return rn}else if(rn.child!==null){rn.child.return=rn,rn=rn.child;continue}if(rn===st)break;for(;rn.sibling===null;){if(rn.return===null||rn.return===st)return null;rn=rn.return}rn.sibling.return=rn.return,rn=rn.sibling}return null}var rR=typeof AbortController<"u"?AbortController:function(){var st=[],rn=this.signal={aborted:!1,addEventListener:function(un,cn){st.push(cn)}};this.abort=function(){rn.aborted=!0,st.forEach(function(un){return un()})}},iR=Ke.unstable_scheduleCallback,aR=Ke.unstable_NormalPriority,Fm={$$typeof:Xr,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Xx(){return{controller:new rR,data:new Map,refCount:0}}function By(st){st.refCount--,st.refCount===0&&iR(aR,function(){st.controller.abort()})}var My=null,Kx=0,Kg=0,Yg=null;function oR(st,rn){if(My===null){var un=My=[];Kx=0,Kg=tw(),Yg={status:"pending",value:void 0,then:function(cn){un.push(cn)}}}return Kx++,rn.then(O_,O_),rn}function O_(){if(--Kx===0&&My!==null){Yg!==null&&(Yg.status="fulfilled");var st=My;My=null,Kg=0,Yg=null;for(var rn=0;rn<st.length;rn++)(0,st[rn])()}}function sR(st,rn){var un=[],cn={status:"pending",value:null,reason:null,then:function(to){un.push(to)}};return st.then(function(){cn.status="fulfilled",cn.value=rn;for(var to=0;to<un.length;to++)(0,un[to])(rn)},function(to){for(cn.status="rejected",cn.reason=to,to=0;to<un.length;to++)(0,un[to])(void 0)}),cn}var B_=ip.S;ip.S=function(st,rn){typeof rn=="object"&&rn!==null&&typeof rn.then=="function"&&oR(st,rn),B_!==null&&B_(st,rn)};var xg=Tp(null);function Yx(){var st=xg.current;return st!==null?st:gm.pooledCache}function O0(st,rn){rn===null?$p(xg,xg.current):$p(xg,rn.pool)}function M_(){var st=Yx();return st===null?null:{parent:Fm._currentValue,pool:st}}var Gv=0,rm=null,pm=null,km=null,B0=!1,Zg=!1,wg=!1,M0=0,Iy=0,Qg=null,uR=0;function Dm(){throw Error(Ye(321))}function Zx(st,rn){if(rn===null)return!1;for(var un=0;un<rn.length&&un<st.length;un++)if(!Jm(st[un],rn[un]))return!1;return!0}function Qx(st,rn,un,cn,to,fo){return Gv=fo,rm=rn,rn.memoizedState=null,rn.updateQueue=null,rn.lanes=0,ip.H=st===null||st.memoizedState===null?_g:Xv,wg=!1,fo=un(cn,to),wg=!1,Zg&&(fo=F_(rn,un,cn,to)),I_(st),fo}function I_(st){ip.H=_v;var rn=pm!==null&&pm.next!==null;if(Gv=0,km=pm=rm=null,B0=!1,Iy=0,Qg=null,rn)throw Error(Ye(300));st===null||Pm||(st=st.dependencies,st!==null&&q0(st)&&(Pm=!0))}function F_(st,rn,un,cn){rm=st;var to=0;do{if(Zg&&(Qg=null),Iy=0,Zg=!1,25<=to)throw Error(Ye(301));if(to+=1,km=pm=null,st.updateQueue!=null){var fo=st.updateQueue;fo.lastEffect=null,fo.events=null,fo.stores=null,fo.memoCache!=null&&(fo.memoCache.index=0)}ip.H=Eg,fo=rn(un,cn)}while(Zg);return fo}function lR(){var st=ip.H,rn=st.useState()[0];return rn=typeof rn.then=="function"?Fy(rn):rn,st=st.useState()[0],(pm!==null?pm.memoizedState:null)!==st&&(rm.flags|=1024),rn}function Jx(){var st=M0!==0;return M0=0,st}function e1(st,rn,un){rn.updateQueue=st.updateQueue,rn.flags&=-2053,st.lanes&=~un}function t1(st){if(B0){for(st=st.memoizedState;st!==null;){var rn=st.queue;rn!==null&&(rn.pending=null),st=st.next}B0=!1}Gv=0,km=pm=rm=null,Zg=!1,Iy=M0=0,Qg=null}function Qm(){var st={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return km===null?rm.memoizedState=km=st:km=km.next=st,km}function Om(){if(pm===null){var st=rm.alternate;st=st!==null?st.memoizedState:null}else st=pm.next;var rn=km===null?rm.memoizedState:km.next;if(rn!==null)km=rn,pm=st;else{if(st===null)throw rm.alternate===null?Error(Ye(467)):Error(Ye(310));pm=st,st={memoizedState:pm.memoizedState,baseState:pm.baseState,baseQueue:pm.baseQueue,queue:pm.queue,next:null},km===null?rm.memoizedState=km=st:km=km.next=st}return km}var I0;I0=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function Fy(st){var rn=Iy;return Iy+=1,Qg===null&&(Qg=[]),st=R_(Qg,st,rn),rn=rm,(km===null?rn.memoizedState:km.next)===null&&(rn=rn.alternate,ip.H=rn===null||rn.memoizedState===null?_g:Xv),st}function F0(st){if(st!==null&&typeof st=="object"){if(typeof st.then=="function")return Fy(st);if(st.$$typeof===Xr)return $m(st)}throw Error(Ye(438,String(st)))}function n1(st){var rn=null,un=rm.updateQueue;if(un!==null&&(rn=un.memoCache),rn==null){var cn=rm.alternate;cn!==null&&(cn=cn.updateQueue,cn!==null&&(cn=cn.memoCache,cn!=null&&(rn={data:cn.data.map(function(to){return to.slice()}),index:0})))}if(rn==null&&(rn={data:[],index:0}),un===null&&(un=I0(),rm.updateQueue=un),un.memoCache=rn,un=rn.data[rn.index],un===void 0)for(un=rn.data[rn.index]=Array(st),cn=0;cn<st;cn++)un[cn]=_d;return rn.index++,un}function Nv(st,rn){return typeof rn=="function"?rn(st):rn}function L0(st){var rn=Om();return r1(rn,pm,st)}function r1(st,rn,un){var cn=st.queue;if(cn===null)throw Error(Ye(311));cn.lastRenderedReducer=un;var to=st.baseQueue,fo=cn.pending;if(fo!==null){if(to!==null){var np=to.next;to.next=fo.next,fo.next=np}rn.baseQueue=to=fo,cn.pending=null}if(fo=st.baseState,to===null)st.memoizedState=fo;else{rn=to.next;var up=np=null,pp=null,_p=rn,Up=!1;do{var Wp=_p.lane&-536870913;if(Wp!==_p.lane?(um&Wp)===Wp:(Gv&Wp)===Wp){var Dp=_p.revertLane;if(Dp===0)pp!==null&&(pp=pp.next={lane:0,revertLane:0,action:_p.action,hasEagerState:_p.hasEagerState,eagerState:_p.eagerState,next:null}),Wp===Kg&&(Up=!0);else if((Gv&Dp)===Dp){_p=_p.next,Dp===Kg&&(Up=!0);continue}else Wp={lane:0,revertLane:_p.revertLane,action:_p.action,hasEagerState:_p.hasEagerState,eagerState:_p.eagerState,next:null},pp===null?(up=pp=Wp,np=fo):pp=pp.next=Wp,rm.lanes|=Dp,rg|=Dp;Wp=_p.action,wg&&un(fo,Wp),fo=_p.hasEagerState?_p.eagerState:un(fo,Wp)}else Dp={lane:Wp,revertLane:_p.revertLane,action:_p.action,hasEagerState:_p.hasEagerState,eagerState:_p.eagerState,next:null},pp===null?(up=pp=Dp,np=fo):pp=pp.next=Dp,rm.lanes|=Wp,rg|=Wp;_p=_p.next}while(_p!==null&&_p!==rn);if(pp===null?np=fo:pp.next=up,!Jm(fo,st.memoizedState)&&(Pm=!0,Up&&(un=Yg,un!==null)))throw un;st.memoizedState=fo,st.baseState=np,st.baseQueue=pp,cn.lastRenderedState=fo}return to===null&&(cn.lanes=0),[st.memoizedState,cn.dispatch]}function i1(st){var rn=Om(),un=rn.queue;if(un===null)throw Error(Ye(311));un.lastRenderedReducer=st;var cn=un.dispatch,to=un.pending,fo=rn.memoizedState;if(to!==null){un.pending=null;var np=to=to.next;do fo=st(fo,np.action),np=np.next;while(np!==to);Jm(fo,rn.memoizedState)||(Pm=!0),rn.memoizedState=fo,rn.baseQueue===null&&(rn.baseState=fo),un.lastRenderedState=fo}return[fo,cn]}function L_(st,rn,un){var cn=rm,to=Om(),fo=cm;if(fo){if(un===void 0)throw Error(Ye(407));un=un()}else un=rn();var np=!Jm((pm||to).memoizedState,un);if(np&&(to.memoizedState=un,Pm=!0),to=to.queue,s1(H_.bind(null,cn,to,st),[st]),to.getSnapshot!==rn||np||km!==null&&km.memoizedState.tag&1){if(cn.flags|=2048,Jg(9,U_.bind(null,cn,to,un,rn),{destroy:void 0},null),gm===null)throw Error(Ye(349));fo||(Gv&60)!==0||P_(cn,rn,un)}return un}function P_(st,rn,un){st.flags|=16384,st={getSnapshot:rn,value:un},rn=rm.updateQueue,rn===null?(rn=I0(),rm.updateQueue=rn,rn.stores=[st]):(un=rn.stores,un===null?rn.stores=[st]:un.push(st))}function U_(st,rn,un,cn){rn.value=un,rn.getSnapshot=cn,z_(rn)&&j_(st)}function H_(st,rn,un){return un(function(){z_(rn)&&j_(st)})}function z_(st){var rn=st.getSnapshot;st=st.value;try{var un=rn();return!Jm(st,un)}catch{return!0}}function j_(st){var rn=Wv(st,2);rn!==null&&Xm(rn,st,2)}function a1(st){var rn=Qm();if(typeof st=="function"){var un=st;if(st=un(),wg){lm(!0);try{un()}finally{lm(!1)}}}return rn.memoizedState=rn.baseState=st,rn.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Nv,lastRenderedState:st},rn}function q_(st,rn,un,cn){return st.baseState=un,r1(st,pm,typeof cn=="function"?cn:Nv)}function cR(st,rn,un,cn,to){if(H0(st))throw Error(Ye(485));if(st=rn.action,st!==null){var fo={payload:to,action:st,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(np){fo.listeners.push(np)}};ip.T!==null?un(!0):fo.isTransition=!1,cn(fo),un=rn.pending,un===null?(fo.next=rn.pending=fo,W_(rn,fo)):(fo.next=un.next,rn.pending=un.next=fo)}}function W_(st,rn){var un=rn.action,cn=rn.payload,to=st.state;if(rn.isTransition){var fo=ip.T,np={};ip.T=np;try{var up=un(to,cn),pp=ip.S;pp!==null&&pp(np,up),V_(st,rn,up)}catch(_p){o1(st,rn,_p)}finally{ip.T=fo}}else try{fo=un(to,cn),V_(st,rn,fo)}catch(_p){o1(st,rn,_p)}}function V_(st,rn,un){un!==null&&typeof un=="object"&&typeof un.then=="function"?un.then(function(cn){$_(st,rn,cn)},function(cn){return o1(st,rn,cn)}):$_(st,rn,un)}function $_(st,rn,un){rn.status="fulfilled",rn.value=un,G_(rn),st.state=un,rn=st.pending,rn!==null&&(un=rn.next,un===rn?st.pending=null:(un=un.next,rn.next=un,W_(st,un)))}function o1(st,rn,un){var cn=st.pending;if(st.pending=null,cn!==null){cn=cn.next;do rn.status="rejected",rn.reason=un,G_(rn),rn=rn.next;while(rn!==cn)}st.action=null}function G_(st){st=st.listeners;for(var rn=0;rn<st.length;rn++)(0,st[rn])()}function X_(st,rn){return rn}function K_(st,rn){if(cm){var un=gm.formState;if(un!==null){e:{var cn=rm;if(cm){if(zm){t:{for(var to=zm,fo=xv;to.nodeType!==8;){if(!fo){to=null;break t}if(to=bv(to.nextSibling),to===null){to=null;break t}}fo=to.data,to=fo==="F!"||fo==="F"?to:null}if(to){zm=bv(to.nextSibling),cn=to.data==="F!";break e}}yg(cn)}cn=!1}cn&&(rn=un[0])}}return un=Qm(),un.memoizedState=un.baseState=rn,cn={pending:null,lanes:0,dispatch:null,lastRenderedReducer:X_,lastRenderedState:rn},un.queue=cn,un=dE.bind(null,rm,cn),cn.dispatch=un,cn=a1(!1),fo=h1.bind(null,rm,!1,cn.queue),cn=Qm(),to={state:rn,dispatch:null,action:st,pending:null},cn.queue=to,un=cR.bind(null,rm,to,fo,un),to.dispatch=un,cn.memoizedState=st,[rn,un,!1]}function Y_(st){var rn=Om();return Z_(rn,pm,st)}function Z_(st,rn,un){rn=r1(st,rn,X_)[0],st=L0(Nv)[0],rn=typeof rn=="object"&&rn!==null&&typeof rn.then=="function"?Fy(rn):rn;var cn=Om(),to=cn.queue,fo=to.dispatch;return un!==cn.memoizedState&&(rm.flags|=2048,Jg(9,fR.bind(null,to,un),{destroy:void 0},null)),[rn,fo,st]}function fR(st,rn){st.action=rn}function Q_(st){var rn=Om(),un=pm;if(un!==null)return Z_(rn,un,st);Om(),rn=rn.memoizedState,un=Om();var cn=un.queue.dispatch;return un.memoizedState=st,[rn,cn,!1]}function Jg(st,rn,un,cn){return st={tag:st,create:rn,inst:un,deps:cn,next:null},rn=rm.updateQueue,rn===null&&(rn=I0(),rm.updateQueue=rn),un=rn.lastEffect,un===null?rn.lastEffect=st.next=st:(cn=un.next,un.next=st,st.next=cn,rn.lastEffect=st),st}function J_(){return Om().memoizedState}function P0(st,rn,un,cn){var to=Qm();rm.flags|=st,to.memoizedState=Jg(1|rn,un,{destroy:void 0},cn===void 0?null:cn)}function U0(st,rn,un,cn){var to=Om();cn=cn===void 0?null:cn;var fo=to.memoizedState.inst;pm!==null&&cn!==null&&Zx(cn,pm.memoizedState.deps)?to.memoizedState=Jg(rn,un,fo,cn):(rm.flags|=st,to.memoizedState=Jg(1|rn,un,fo,cn))}function eE(st,rn){P0(8390656,8,st,rn)}function s1(st,rn){U0(2048,8,st,rn)}function tE(st,rn){return U0(4,2,st,rn)}function nE(st,rn){return U0(4,4,st,rn)}function rE(st,rn){if(typeof rn=="function"){st=st();var un=rn(st);return function(){typeof un=="function"?un():rn(null)}}if(rn!=null)return st=st(),rn.current=st,function(){rn.current=null}}function iE(st,rn,un){un=un!=null?un.concat([st]):null,U0(4,4,rE.bind(null,rn,st),un)}function u1(){}function aE(st,rn){var un=Om();rn=rn===void 0?null:rn;var cn=un.memoizedState;return rn!==null&&Zx(rn,cn[1])?cn[0]:(un.memoizedState=[st,rn],st)}function oE(st,rn){var un=Om();rn=rn===void 0?null:rn;var cn=un.memoizedState;if(rn!==null&&Zx(rn,cn[1]))return cn[0];if(cn=st(),wg){lm(!0);try{st()}finally{lm(!1)}}return un.memoizedState=[cn,rn],cn}function l1(st,rn,un){return un===void 0||(Gv&1073741824)!==0?st.memoizedState=rn:(st.memoizedState=un,st=u2(),rm.lanes|=st,rg|=st,un)}function sE(st,rn,un,cn){return Jm(un,rn)?un:Xg.current!==null?(st=l1(st,un,cn),Jm(st,rn)||(Pm=!0),st):(Gv&42)===0?(Pm=!0,st.memoizedState=un):(st=u2(),rm.lanes|=st,rg|=st,rn)}function uE(st,rn,un,cn,to){var fo=zp.p;zp.p=fo!==0&&8>fo?fo:8;var np=ip.T,up={};ip.T=up,h1(st,!1,rn,un);try{var pp=to(),_p=ip.S;if(_p!==null&&_p(up,pp),pp!==null&&typeof pp=="object"&&typeof pp.then=="function"){var Up=sR(pp,cn);Ly(st,rn,Up,rv(st))}else Ly(st,rn,cn,rv(st))}catch(Wp){Ly(st,rn,{then:function(){},status:"rejected",reason:Wp},rv())}finally{zp.p=fo,ip.T=np}}function hR(){}function c1(st,rn,un,cn){if(st.tag!==5)throw Error(Ye(476));var to=lE(st).queue;uE(st,to,rn,Gp,un===null?hR:function(){return cE(st),un(cn)})}function lE(st){var rn=st.memoizedState;if(rn!==null)return rn;rn={memoizedState:Gp,baseState:Gp,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Nv,lastRenderedState:Gp},next:null};var un={};return rn.next={memoizedState:un,baseState:un,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Nv,lastRenderedState:un},next:null},st.memoizedState=rn,st=st.alternate,st!==null&&(st.memoizedState=rn),rn}function cE(st){var rn=lE(st).next.queue;Ly(st,rn,{},rv())}function f1(){return $m(r0)}function fE(){return Om().memoizedState}function hE(){return Om().memoizedState}function dR(st){for(var rn=st.return;rn!==null;){switch(rn.tag){case 24:case 3:var un=rv();st=Zv(un);var cn=Qv(rn,st,un);cn!==null&&(Xm(cn,rn,un),Hy(cn,rn,un)),rn={cache:Xx()},st.payload=rn;return}rn=rn.return}}function pR(st,rn,un){var cn=rv();un={lane:cn,revertLane:0,action:un,hasEagerState:!1,eagerState:null,next:null},H0(st)?pE(rn,un):(un=zx(st,rn,un,cn),un!==null&&(Xm(un,st,cn),mE(un,rn,cn)))}function dE(st,rn,un){var cn=rv();Ly(st,rn,un,cn)}function Ly(st,rn,un,cn){var to={lane:cn,revertLane:0,action:un,hasEagerState:!1,eagerState:null,next:null};if(H0(st))pE(rn,to);else{var fo=st.alternate;if(st.lanes===0&&(fo===null||fo.lanes===0)&&(fo=rn.lastRenderedReducer,fo!==null))try{var np=rn.lastRenderedState,up=fo(np,un);if(to.hasEagerState=!0,to.eagerState=up,Jm(up,np))return E0(st,rn,to,0),gm===null&&_0(),!1}catch{}finally{}if(un=zx(st,rn,to,cn),un!==null)return Xm(un,st,cn),mE(un,rn,cn),!0}return!1}function h1(st,rn,un,cn){if(cn={lane:2,revertLane:tw(),action:cn,hasEagerState:!1,eagerState:null,next:null},H0(st)){if(rn)throw Error(Ye(479))}else rn=zx(st,un,cn,2),rn!==null&&Xm(rn,st,2)}function H0(st){var rn=st.alternate;return st===rm||rn!==null&&rn===rm}function pE(st,rn){Zg=B0=!0;var un=st.pending;un===null?rn.next=rn:(rn.next=un.next,un.next=rn),st.pending=rn}function mE(st,rn,un){if((un&4194176)!==0){var cn=rn.lanes;cn&=st.pendingLanes,un|=cn,rn.lanes=un,Sw(st,un)}}var _v={readContext:$m,use:F0,useCallback:Dm,useContext:Dm,useEffect:Dm,useImperativeHandle:Dm,useLayoutEffect:Dm,useInsertionEffect:Dm,useMemo:Dm,useReducer:Dm,useRef:Dm,useState:Dm,useDebugValue:Dm,useDeferredValue:Dm,useTransition:Dm,useSyncExternalStore:Dm,useId:Dm};_v.useCacheRefresh=Dm,_v.useMemoCache=Dm,_v.useHostTransitionStatus=Dm,_v.useFormState=Dm,_v.useActionState=Dm,_v.useOptimistic=Dm;var _g={readContext:$m,use:F0,useCallback:function(st,rn){return Qm().memoizedState=[st,rn===void 0?null:rn],st},useContext:$m,useEffect:eE,useImperativeHandle:function(st,rn,un){un=un!=null?un.concat([st]):null,P0(4194308,4,rE.bind(null,rn,st),un)},useLayoutEffect:function(st,rn){return P0(4194308,4,st,rn)},useInsertionEffect:function(st,rn){P0(4,2,st,rn)},useMemo:function(st,rn){var un=Qm();rn=rn===void 0?null:rn;var cn=st();if(wg){lm(!0);try{st()}finally{lm(!1)}}return un.memoizedState=[cn,rn],cn},useReducer:function(st,rn,un){var cn=Qm();if(un!==void 0){var to=un(rn);if(wg){lm(!0);try{un(rn)}finally{lm(!1)}}}else to=rn;return cn.memoizedState=cn.baseState=to,st={pending:null,lanes:0,dispatch:null,lastRenderedReducer:st,lastRenderedState:to},cn.queue=st,st=st.dispatch=pR.bind(null,rm,st),[cn.memoizedState,st]},useRef:function(st){var rn=Qm();return st={current:st},rn.memoizedState=st},useState:function(st){st=a1(st);var rn=st.queue,un=dE.bind(null,rm,rn);return rn.dispatch=un,[st.memoizedState,un]},useDebugValue:u1,useDeferredValue:function(st,rn){var un=Qm();return l1(un,st,rn)},useTransition:function(){var st=a1(!1);return st=uE.bind(null,rm,st.queue,!0,!1),Qm().memoizedState=st,[!1,st]},useSyncExternalStore:function(st,rn,un){var cn=rm,to=Qm();if(cm){if(un===void 0)throw Error(Ye(407));un=un()}else{if(un=rn(),gm===null)throw Error(Ye(349));(um&60)!==0||P_(cn,rn,un)}to.memoizedState=un;var fo={value:un,getSnapshot:rn};return to.queue=fo,eE(H_.bind(null,cn,fo,st),[st]),cn.flags|=2048,Jg(9,U_.bind(null,cn,fo,un,rn),{destroy:void 0},null),un},useId:function(){var st=Qm(),rn=gm.identifierPrefix;if(cm){var un=Tv,cn=Av;un=(cn&~(1<<32-om(cn)-1)).toString(32)+un,rn=":"+rn+"R"+un,un=M0++,0<un&&(rn+="H"+un.toString(32)),rn+=":"}else un=uR++,rn=":"+rn+"r"+un.toString(32)+":";return st.memoizedState=rn},useCacheRefresh:function(){return Qm().memoizedState=dR.bind(null,rm)}};_g.useMemoCache=n1,_g.useHostTransitionStatus=f1,_g.useFormState=K_,_g.useActionState=K_,_g.useOptimistic=function(st){var rn=Qm();rn.memoizedState=rn.baseState=st;var un={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return rn.queue=un,rn=h1.bind(null,rm,!0,un),un.dispatch=rn,[st,rn]};var Xv={readContext:$m,use:F0,useCallback:aE,useContext:$m,useEffect:s1,useImperativeHandle:iE,useInsertionEffect:tE,useLayoutEffect:nE,useMemo:oE,useReducer:L0,useRef:J_,useState:function(){return L0(Nv)},useDebugValue:u1,useDeferredValue:function(st,rn){var un=Om();return sE(un,pm.memoizedState,st,rn)},useTransition:function(){var st=L0(Nv)[0],rn=Om().memoizedState;return[typeof st=="boolean"?st:Fy(st),rn]},useSyncExternalStore:L_,useId:fE};Xv.useCacheRefresh=hE,Xv.useMemoCache=n1,Xv.useHostTransitionStatus=f1,Xv.useFormState=Y_,Xv.useActionState=Y_,Xv.useOptimistic=function(st,rn){var un=Om();return q_(un,pm,st,rn)};var Eg={readContext:$m,use:F0,useCallback:aE,useContext:$m,useEffect:s1,useImperativeHandle:iE,useInsertionEffect:tE,useLayoutEffect:nE,useMemo:oE,useReducer:i1,useRef:J_,useState:function(){return i1(Nv)},useDebugValue:u1,useDeferredValue:function(st,rn){var un=Om();return pm===null?l1(un,st,rn):sE(un,pm.memoizedState,st,rn)},useTransition:function(){var st=i1(Nv)[0],rn=Om().memoizedState;return[typeof st=="boolean"?st:Fy(st),rn]},useSyncExternalStore:L_,useId:fE};Eg.useCacheRefresh=hE,Eg.useMemoCache=n1,Eg.useHostTransitionStatus=f1,Eg.useFormState=Q_,Eg.useActionState=Q_,Eg.useOptimistic=function(st,rn){var un=Om();return pm!==null?q_(un,pm,st,rn):(un.baseState=st,[st,un.queue.dispatch])};function d1(st,rn,un,cn){rn=st.memoizedState,un=un(cn,rn),un=un==null?rn:lp({},rn,un),st.memoizedState=un,st.lanes===0&&(st.updateQueue.baseState=un)}var p1={isMounted:function(st){return(st=st._reactInternals)?Cp(st)===st:!1},enqueueSetState:function(st,rn,un){st=st._reactInternals;var cn=rv(),to=Zv(cn);to.payload=rn,un!=null&&(to.callback=un),rn=Qv(st,to,cn),rn!==null&&(Xm(rn,st,cn),Hy(rn,st,cn))},enqueueReplaceState:function(st,rn,un){st=st._reactInternals;var cn=rv(),to=Zv(cn);to.tag=1,to.payload=rn,un!=null&&(to.callback=un),rn=Qv(st,to,cn),rn!==null&&(Xm(rn,st,cn),Hy(rn,st,cn))},enqueueForceUpdate:function(st,rn){st=st._reactInternals;var un=rv(),cn=Zv(un);cn.tag=2,rn!=null&&(cn.callback=rn),rn=Qv(st,cn,un),rn!==null&&(Xm(rn,st,un),Hy(rn,st,un))}};function vE(st,rn,un,cn,to,fo,np){return st=st.stateNode,typeof st.shouldComponentUpdate=="function"?st.shouldComponentUpdate(cn,fo,np):rn.prototype&&rn.prototype.isPureReactComponent?!Cy(un,cn)||!Cy(to,fo):!0}function gE(st,rn,un,cn){st=rn.state,typeof rn.componentWillReceiveProps=="function"&&rn.componentWillReceiveProps(un,cn),typeof rn.UNSAFE_componentWillReceiveProps=="function"&&rn.UNSAFE_componentWillReceiveProps(un,cn),rn.state!==st&&p1.enqueueReplaceState(rn,rn.state,null)}function Cg(st,rn){var un=rn;if("ref"in rn){un={};for(var cn in rn)cn!=="ref"&&(un[cn]=rn[cn])}if(st=st.defaultProps){un===rn&&(un=lp({},un));for(var to in st)un[to]===void 0&&(un[to]=st[to])}return un}var z0=typeof reportError=="function"?reportError:function(st){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var rn=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof st=="object"&&st!==null&&typeof st.message=="string"?String(st.message):String(st),error:st});if(!window.dispatchEvent(rn))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",st);return}console.error(st)};function yE(st){z0(st)}function bE(st){console.error(st)}function xE(st){z0(st)}function j0(st,rn){try{var un=st.onUncaughtError;un(rn.value,{componentStack:rn.stack})}catch(cn){setTimeout(function(){throw cn})}}function wE(st,rn,un){try{var cn=st.onCaughtError;cn(un.value,{componentStack:un.stack,errorBoundary:rn.tag===1?rn.stateNode:null})}catch(to){setTimeout(function(){throw to})}}function m1(st,rn,un){return un=Zv(un),un.tag=3,un.payload={element:null},un.callback=function(){j0(st,rn)},un}function _E(st){return st=Zv(st),st.tag=3,st}function EE(st,rn,un,cn){var to=un.type.getDerivedStateFromError;if(typeof to=="function"){var fo=cn.value;st.payload=function(){return to(fo)},st.callback=function(){wE(rn,un,cn)}}var np=un.stateNode;np!==null&&typeof np.componentDidCatch=="function"&&(st.callback=function(){wE(rn,un,cn),typeof to!="function"&&(ig===null?ig=new Set([this]):ig.add(this));var up=cn.stack;this.componentDidCatch(cn.value,{componentStack:up!==null?up:""})})}function mR(st,rn,un,cn,to){if(un.flags|=32768,cn!==null&&typeof cn=="object"&&typeof cn.then=="function"){if(rn=un.alternate,rn!==null&&Uy(rn,un,to,!0),un=cv.current,un!==null){switch(un.tag){case 13:return wv===null?Y1():un.alternate===null&&Am===0&&(Am=3),un.flags&=-257,un.flags|=65536,un.lanes=to,cn===Vx?un.flags|=16384:(rn=un.updateQueue,rn===null?un.updateQueue=new Set([cn]):rn.add(cn),Q1(st,cn,to)),!1;case 22:return un.flags|=65536,cn===Vx?un.flags|=16384:(rn=un.updateQueue,rn===null?(rn={transitions:null,markerInstances:null,retryQueue:new Set([cn])},un.updateQueue=rn):(un=rn.retryQueue,un===null?rn.retryQueue=new Set([cn]):un.add(cn)),Q1(st,cn,to)),!1}throw Error(Ye(435,un.tag))}return Q1(st,cn,to),Y1(),!1}if(cm)return rn=cv.current,rn!==null?((rn.flags&65536)===0&&(rn.flags|=256),rn.flags|=65536,rn.lanes=to,cn!==Wx&&(st=Error(Ye(422),{cause:cn}),Ty(sv(st,un)))):(cn!==Wx&&(rn=Error(Ye(423),{cause:cn}),Ty(sv(rn,un))),st=st.current.alternate,st.flags|=65536,to&=-to,st.lanes|=to,cn=sv(cn,un),to=m1(st.stateNode,cn,to),N1(st,to),Am!==4&&(Am=2)),!1;var fo=Error(Ye(520),{cause:cn});if(fo=sv(fo,un),Xy===null?Xy=[fo]:Xy.push(fo),Am!==4&&(Am=2),rn===null)return!0;cn=sv(cn,un),un=rn;do{switch(un.tag){case 3:return un.flags|=65536,st=to&-to,un.lanes|=st,st=m1(un.stateNode,cn,st),N1(un,st),!1;case 1:if(rn=un.type,fo=un.stateNode,(un.flags&128)===0&&(typeof rn.getDerivedStateFromError=="function"||fo!==null&&typeof fo.componentDidCatch=="function"&&(ig===null||!ig.has(fo))))return un.flags|=65536,to&=-to,un.lanes|=to,to=_E(to),EE(to,st,un,cn),N1(un,to),!1}un=un.return}while(un!==null);return!1}var CE=Error(Ye(461)),Pm=!1;function jm(st,rn,un,cn){rn.child=st===null?D_(rn,null,un,cn):bg(rn,st.child,un,cn)}function RE(st,rn,un,cn,to){un=un.render;var fo=rn.ref;if("ref"in cn){var np={};for(var up in cn)up!=="ref"&&(np[up]=cn[up])}else np=cn;return Sg(rn),cn=Qx(st,rn,un,np,fo,to),up=Jx(),st!==null&&!Pm?(e1(st,rn,to),kv(st,rn,to)):(cm&&up&&jx(rn),rn.flags|=1,jm(st,rn,cn,to),rn.child)}function SE(st,rn,un,cn,to){if(st===null){var fo=un.type;return typeof fo=="function"&&!P1(fo)&&fo.defaultProps===void 0&&un.compare===null?(rn.tag=15,rn.type=fo,AE(st,rn,fo,cn,to)):(st=G0(un.type,null,cn,rn,rn.mode,to),st.ref=rn.ref,st.return=rn,rn.child=st)}if(fo=st.child,!C1(st,to)){var np=fo.memoizedProps;if(un=un.compare,un=un!==null?un:Cy,un(np,cn)&&st.ref===rn.ref)return kv(st,rn,to)}return rn.flags|=1,st=ng(fo,cn),st.ref=rn.ref,st.return=rn,rn.child=st}function AE(st,rn,un,cn,to){if(st!==null){var fo=st.memoizedProps;if(Cy(fo,cn)&&st.ref===rn.ref)if(Pm=!1,rn.pendingProps=cn=fo,C1(st,to))(st.flags&131072)!==0&&(Pm=!0);else return rn.lanes=st.lanes,kv(st,rn,to)}return v1(st,rn,un,cn,to)}function TE(st,rn,un){var cn=rn.pendingProps,to=cn.children,fo=(rn.stateNode._pendingVisibility&2)!==0,np=st!==null?st.memoizedState:null;if(Py(st,rn),cn.mode==="hidden"||fo){if((rn.flags&128)!==0){if(cn=np!==null?np.baseLanes|un:un,st!==null){for(to=rn.child=st.child,fo=0;to!==null;)fo=fo|to.lanes|to.childLanes,to=to.sibling;rn.childLanes=fo&~cn}else rn.childLanes=0,rn.child=null;return DE(st,rn,cn,un)}if((un&536870912)!==0)rn.memoizedState={baseLanes:0,cachePool:null},st!==null&&O0(rn,np!==null?np.cachePool:null),np!==null?N_(rn,np):$x(),k_(rn);else return rn.lanes=rn.childLanes=536870912,DE(st,rn,np!==null?np.baseLanes|un:un,un)}else np!==null?(O0(rn,np.cachePool),N_(rn,np),$v(),rn.memoizedState=null):(st!==null&&O0(rn,null),$x(),$v());return jm(st,rn,to,un),rn.child}function DE(st,rn,un,cn){var to=Yx();return to=to===null?null:{parent:Fm._currentValue,pool:to},rn.memoizedState={baseLanes:un,cachePool:to},st!==null&&O0(rn,null),$x(),k_(rn),st!==null&&Uy(st,rn,cn,!0),null}function Py(st,rn){var un=rn.ref;if(un===null)st!==null&&st.ref!==null&&(rn.flags|=2097664);else{if(typeof un!="function"&&typeof un!="object")throw Error(Ye(284));(st===null||st.ref!==un)&&(rn.flags|=2097664)}}function v1(st,rn,un,cn,to){return Sg(rn),un=Qx(st,rn,un,cn,void 0,to),cn=Jx(),st!==null&&!Pm?(e1(st,rn,to),kv(st,rn,to)):(cm&&cn&&jx(rn),rn.flags|=1,jm(st,rn,un,to),rn.child)}function NE(st,rn,un,cn,to,fo){return Sg(rn),rn.updateQueue=null,un=F_(rn,cn,un,to),I_(st),cn=Jx(),st!==null&&!Pm?(e1(st,rn,fo),kv(st,rn,fo)):(cm&&cn&&jx(rn),rn.flags|=1,jm(st,rn,un,fo),rn.child)}function kE(st,rn,un,cn,to){if(Sg(rn),rn.stateNode===null){var fo=Wg,np=un.contextType;typeof np=="object"&&np!==null&&(fo=$m(np)),fo=new un(cn,fo),rn.memoizedState=fo.state!==null&&fo.state!==void 0?fo.state:null,fo.updater=p1,rn.stateNode=fo,fo._reactInternals=rn,fo=rn.stateNode,fo.props=cn,fo.state=rn.memoizedState,fo.refs={},T1(rn),np=un.contextType,fo.context=typeof np=="object"&&np!==null?$m(np):Wg,fo.state=rn.memoizedState,np=un.getDerivedStateFromProps,typeof np=="function"&&(d1(rn,un,np,cn),fo.state=rn.memoizedState),typeof un.getDerivedStateFromProps=="function"||typeof fo.getSnapshotBeforeUpdate=="function"||typeof fo.UNSAFE_componentWillMount!="function"&&typeof fo.componentWillMount!="function"||(np=fo.state,typeof fo.componentWillMount=="function"&&fo.componentWillMount(),typeof fo.UNSAFE_componentWillMount=="function"&&fo.UNSAFE_componentWillMount(),np!==fo.state&&p1.enqueueReplaceState(fo,fo.state,null),jy(rn,cn,fo,to),zy(),fo.state=rn.memoizedState),typeof fo.componentDidMount=="function"&&(rn.flags|=4194308),cn=!0}else if(st===null){fo=rn.stateNode;var up=rn.memoizedProps,pp=Cg(un,up);fo.props=pp;var _p=fo.context,Up=un.contextType;np=Wg,typeof Up=="object"&&Up!==null&&(np=$m(Up));var Wp=un.getDerivedStateFromProps;Up=typeof Wp=="function"||typeof fo.getSnapshotBeforeUpdate=="function",up=rn.pendingProps!==up,Up||typeof fo.UNSAFE_componentWillReceiveProps!="function"&&typeof fo.componentWillReceiveProps!="function"||(up||_p!==np)&&gE(rn,fo,cn,np),Yv=!1;var Dp=rn.memoizedState;fo.state=Dp,jy(rn,cn,fo,to),zy(),_p=rn.memoizedState,up||Dp!==_p||Yv?(typeof Wp=="function"&&(d1(rn,un,Wp,cn),_p=rn.memoizedState),(pp=Yv||vE(rn,un,pp,cn,Dp,_p,np))?(Up||typeof fo.UNSAFE_componentWillMount!="function"&&typeof fo.componentWillMount!="function"||(typeof fo.componentWillMount=="function"&&fo.componentWillMount(),typeof fo.UNSAFE_componentWillMount=="function"&&fo.UNSAFE_componentWillMount()),typeof fo.componentDidMount=="function"&&(rn.flags|=4194308)):(typeof fo.componentDidMount=="function"&&(rn.flags|=4194308),rn.memoizedProps=cn,rn.memoizedState=_p),fo.props=cn,fo.state=_p,fo.context=np,cn=pp):(typeof fo.componentDidMount=="function"&&(rn.flags|=4194308),cn=!1)}else{fo=rn.stateNode,D1(st,rn),np=rn.memoizedProps,Up=Cg(un,np),fo.props=Up,Wp=rn.pendingProps,Dp=fo.context,_p=un.contextType,pp=Wg,typeof _p=="object"&&_p!==null&&(pp=$m(_p)),up=un.getDerivedStateFromProps,(_p=typeof up=="function"||typeof fo.getSnapshotBeforeUpdate=="function")||typeof fo.UNSAFE_componentWillReceiveProps!="function"&&typeof fo.componentWillReceiveProps!="function"||(np!==Wp||Dp!==pp)&&gE(rn,fo,cn,pp),Yv=!1,Dp=rn.memoizedState,fo.state=Dp,jy(rn,cn,fo,to),zy();var Lp=rn.memoizedState;np!==Wp||Dp!==Lp||Yv||st!==null&&st.dependencies!==null&&q0(st.dependencies)?(typeof up=="function"&&(d1(rn,un,up,cn),Lp=rn.memoizedState),(Up=Yv||vE(rn,un,Up,cn,Dp,Lp,pp)||st!==null&&st.dependencies!==null&&q0(st.dependencies))?(_p||typeof fo.UNSAFE_componentWillUpdate!="function"&&typeof fo.componentWillUpdate!="function"||(typeof fo.componentWillUpdate=="function"&&fo.componentWillUpdate(cn,Lp,pp),typeof fo.UNSAFE_componentWillUpdate=="function"&&fo.UNSAFE_componentWillUpdate(cn,Lp,pp)),typeof fo.componentDidUpdate=="function"&&(rn.flags|=4),typeof fo.getSnapshotBeforeUpdate=="function"&&(rn.flags|=1024)):(typeof fo.componentDidUpdate!="function"||np===st.memoizedProps&&Dp===st.memoizedState||(rn.flags|=4),typeof fo.getSnapshotBeforeUpdate!="function"||np===st.memoizedProps&&Dp===st.memoizedState||(rn.flags|=1024),rn.memoizedProps=cn,rn.memoizedState=Lp),fo.props=cn,fo.state=Lp,fo.context=pp,cn=Up):(typeof fo.componentDidUpdate!="function"||np===st.memoizedProps&&Dp===st.memoizedState||(rn.flags|=4),typeof fo.getSnapshotBeforeUpdate!="function"||np===st.memoizedProps&&Dp===st.memoizedState||(rn.flags|=1024),cn=!1)}return fo=cn,Py(st,rn),cn=(rn.flags&128)!==0,fo||cn?(fo=rn.stateNode,un=cn&&typeof un.getDerivedStateFromError!="function"?null:fo.render(),rn.flags|=1,st!==null&&cn?(rn.child=bg(rn,st.child,null,to),rn.child=bg(rn,null,un,to)):jm(st,rn,un,to),rn.memoizedState=fo.state,st=rn.child):st=kv(st,rn,to),st}function OE(st,rn,un,cn){return Ay(),rn.flags|=256,jm(st,rn,un,cn),rn.child}var g1={dehydrated:null,treeContext:null,retryLane:0};function y1(st){return{baseLanes:st,cachePool:M_()}}function b1(st,rn,un){return st=st!==null?st.childLanes&~un:0,rn&&(st|=pv),st}function BE(st,rn,un){var cn=rn.pendingProps,to=!1,fo=(rn.flags&128)!==0,np;if((np=fo)||(np=st!==null&&st.memoizedState===null?!1:(Im.current&2)!==0),np&&(to=!0,rn.flags&=-129),np=(rn.flags&32)!==0,rn.flags&=-33,st===null){if(cm){if(to?Vv(rn):$v(),cm){var up=zm,pp;if(pp=up){e:{for(pp=up,up=xv;pp.nodeType!==8;){if(!up){up=null;break e}if(pp=bv(pp.nextSibling),pp===null){up=null;break e}}up=pp}up!==null?(rn.memoizedState={dehydrated:up,treeContext:vg!==null?{id:Av,overflow:Tv}:null,retryLane:536870912},pp=dv(18,null,null,0),pp.stateNode=up,pp.return=rn,rn.child=pp,Gm=rn,zm=null,pp=!0):pp=!1}pp||yg(rn)}if(up=rn.memoizedState,up!==null&&(up=up.dehydrated,up!==null))return up.data==="$!"?rn.lanes=16:rn.lanes=536870912,null;Dv(rn)}return up=cn.children,cn=cn.fallback,to?($v(),to=rn.mode,up=w1({mode:"hidden",children:up},to),cn=Tg(cn,to,un,null),up.return=rn,cn.return=rn,up.sibling=cn,rn.child=up,to=rn.child,to.memoizedState=y1(un),to.childLanes=b1(st,np,un),rn.memoizedState=g1,cn):(Vv(rn),x1(rn,up))}if(pp=st.memoizedState,pp!==null&&(up=pp.dehydrated,up!==null)){if(fo)rn.flags&256?(Vv(rn),rn.flags&=-257,rn=_1(st,rn,un)):rn.memoizedState!==null?($v(),rn.child=st.child,rn.flags|=128,rn=null):($v(),to=cn.fallback,up=rn.mode,cn=w1({mode:"visible",children:cn.children},up),to=Tg(to,up,un,null),to.flags|=2,cn.return=rn,to.return=rn,cn.sibling=to,rn.child=cn,bg(rn,st.child,null,un),cn=rn.child,cn.memoizedState=y1(un),cn.childLanes=b1(st,np,un),rn.memoizedState=g1,rn=to);else if(Vv(rn),up.data==="$!"){if(np=up.nextSibling&&up.nextSibling.dataset,np)var _p=np.dgst;np=_p,cn=Error(Ye(419)),cn.stack="",cn.digest=np,Ty({value:cn,source:null,stack:null}),rn=_1(st,rn,un)}else if(Pm||Uy(st,rn,un,!1),np=(un&st.childLanes)!==0,Pm||np){if(np=gm,np!==null){if(cn=un&-un,(cn&42)!==0)cn=1;else switch(cn){case 2:cn=1;break;case 8:cn=4;break;case 32:cn=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:cn=64;break;case 268435456:cn=134217728;break;default:cn=0}if(cn=(cn&(np.suspendedLanes|un))!==0?0:cn,cn!==0&&cn!==pp.retryLane)throw pp.retryLane=cn,Wv(st,cn),Xm(np,st,cn),CE}up.data==="$?"||Y1(),rn=_1(st,rn,un)}else up.data==="$?"?(rn.flags|=128,rn.child=st.child,rn=NR.bind(null,st),up._reactRetry=rn,rn=null):(st=pp.treeContext,zm=bv(up.nextSibling),Gm=rn,cm=!0,gv=null,xv=!1,st!==null&&(uv[lv++]=Av,uv[lv++]=Tv,uv[lv++]=vg,Av=st.id,Tv=st.overflow,vg=rn),rn=x1(rn,cn.children),rn.flags|=4096);return rn}return to?($v(),to=cn.fallback,up=rn.mode,pp=st.child,_p=pp.sibling,cn=ng(pp,{mode:"hidden",children:cn.children}),cn.subtreeFlags=pp.subtreeFlags&31457280,_p!==null?to=ng(_p,to):(to=Tg(to,up,un,null),to.flags|=2),to.return=rn,cn.return=rn,cn.sibling=to,rn.child=cn,cn=to,to=rn.child,up=st.child.memoizedState,up===null?up=y1(un):(pp=up.cachePool,pp!==null?(_p=Fm._currentValue,pp=pp.parent!==_p?{parent:_p,pool:_p}:pp):pp=M_(),up={baseLanes:up.baseLanes|un,cachePool:pp}),to.memoizedState=up,to.childLanes=b1(st,np,un),rn.memoizedState=g1,cn):(Vv(rn),un=st.child,st=un.sibling,un=ng(un,{mode:"visible",children:cn.children}),un.return=rn,un.sibling=null,st!==null&&(np=rn.deletions,np===null?(rn.deletions=[st],rn.flags|=16):np.push(st)),rn.child=un,rn.memoizedState=null,un)}function x1(st,rn){return rn=w1({mode:"visible",children:rn},st.mode),rn.return=st,st.child=rn}function w1(st,rn){return a2(st,rn,0,null)}function _1(st,rn,un){return bg(rn,st.child,null,un),st=x1(rn,rn.pendingProps.children),st.flags|=2,rn.memoizedState=null,st}function ME(st,rn,un){st.lanes|=rn;var cn=st.alternate;cn!==null&&(cn.lanes|=rn),S1(st.return,rn,un)}function E1(st,rn,un,cn,to){var fo=st.memoizedState;fo===null?st.memoizedState={isBackwards:rn,rendering:null,renderingStartTime:0,last:cn,tail:un,tailMode:to}:(fo.isBackwards=rn,fo.rendering=null,fo.renderingStartTime=0,fo.last=cn,fo.tail=un,fo.tailMode=to)}function IE(st,rn,un){var cn=rn.pendingProps,to=cn.revealOrder,fo=cn.tail;if(jm(st,rn,cn.children,un),cn=Im.current,(cn&2)!==0)cn=cn&1|2,rn.flags|=128;else{if(st!==null&&(st.flags&128)!==0)e:for(st=rn.child;st!==null;){if(st.tag===13)st.memoizedState!==null&&ME(st,un,rn);else if(st.tag===19)ME(st,un,rn);else if(st.child!==null){st.child.return=st,st=st.child;continue}if(st===rn)break e;for(;st.sibling===null;){if(st.return===null||st.return===rn)break e;st=st.return}st.sibling.return=st.return,st=st.sibling}cn&=1}switch($p(Im,cn),to){case"forwards":for(un=rn.child,to=null;un!==null;)st=un.alternate,st!==null&&k0(st)===null&&(to=un),un=un.sibling;un=to,un===null?(to=rn.child,rn.child=null):(to=un.sibling,un.sibling=null),E1(rn,!1,to,un,fo);break;case"backwards":for(un=null,to=rn.child,rn.child=null;to!==null;){if(st=to.alternate,st!==null&&k0(st)===null){rn.child=to;break}st=to.sibling,to.sibling=un,un=to,to=st}E1(rn,!0,un,null,fo);break;case"together":E1(rn,!1,null,null,void 0);break;default:rn.memoizedState=null}return rn.child}function kv(st,rn,un){if(st!==null&&(rn.dependencies=st.dependencies),rg|=rn.lanes,(un&rn.childLanes)===0)if(st!==null){if(Uy(st,rn,un,!1),(un&rn.childLanes)===0)return null}else return null;if(st!==null&&rn.child!==st.child)throw Error(Ye(153));if(rn.child!==null){for(st=rn.child,un=ng(st,st.pendingProps),rn.child=un,un.return=rn;st.sibling!==null;)st=st.sibling,un=un.sibling=ng(st,st.pendingProps),un.return=rn;un.sibling=null}return rn.child}function C1(st,rn){return(st.lanes&rn)!==0?!0:(st=st.dependencies,!!(st!==null&&q0(st)))}function vR(st,rn,un){switch(rn.tag){case 3:Jp(rn,rn.stateNode.containerInfo),Kv(rn,Fm,st.memoizedState.cache),Ay();break;case 27:case 5:tm(rn);break;case 4:Jp(rn,rn.stateNode.containerInfo);break;case 10:Kv(rn,rn.type,rn.memoizedProps.value);break;case 13:var cn=rn.memoizedState;if(cn!==null)return cn.dehydrated!==null?(Vv(rn),rn.flags|=128,null):(un&rn.child.childLanes)!==0?BE(st,rn,un):(Vv(rn),st=kv(st,rn,un),st!==null?st.sibling:null);Vv(rn);break;case 19:var to=(st.flags&128)!==0;if(cn=(un&rn.childLanes)!==0,cn||(Uy(st,rn,un,!1),cn=(un&rn.childLanes)!==0),to){if(cn)return IE(st,rn,un);rn.flags|=128}if(to=rn.memoizedState,to!==null&&(to.rendering=null,to.tail=null,to.lastEffect=null),$p(Im,Im.current),cn)break;return null;case 22:case 23:return rn.lanes=0,TE(st,rn,un);case 24:Kv(rn,Fm,st.memoizedState.cache)}return kv(st,rn,un)}function FE(st,rn,un){if(st!==null)if(st.memoizedProps!==rn.pendingProps)Pm=!0;else{if(!C1(st,un)&&(rn.flags&128)===0)return Pm=!1,vR(st,rn,un);Pm=(st.flags&131072)!==0}else Pm=!1,cm&&(rn.flags&1048576)!==0&&x_(rn,S0,rn.index);switch(rn.lanes=0,rn.tag){case 16:e:{st=rn.pendingProps;var cn=rn.elementType,to=cn._init;if(cn=to(cn._payload),rn.type=cn,typeof cn=="function")P1(cn)?(st=Cg(cn,st),rn.tag=1,rn=kE(null,rn,cn,st,un)):(rn.tag=0,rn=v1(null,rn,cn,st,un));else{if(cn!=null){if(to=cn.$$typeof,to===Mi){rn.tag=11,rn=RE(null,rn,cn,st,un);break e}else if(to===uo){rn.tag=14,rn=SE(null,rn,cn,st,un);break e}}throw rn=op(cn)||cn,Error(Ye(306,rn,""))}}return rn;case 0:return v1(st,rn,rn.type,rn.pendingProps,un);case 1:return cn=rn.type,to=Cg(cn,rn.pendingProps),kE(st,rn,cn,to,un);case 3:e:{if(Jp(rn,rn.stateNode.containerInfo),st===null)throw Error(Ye(387));var fo=rn.pendingProps;to=rn.memoizedState,cn=to.element,D1(st,rn),jy(rn,fo,null,un);var np=rn.memoizedState;if(fo=np.cache,Kv(rn,Fm,fo),fo!==to.cache&&A1(rn,[Fm],un,!0),zy(),fo=np.element,to.isDehydrated)if(to={element:fo,isDehydrated:!1,cache:np.cache},rn.updateQueue.baseState=to,rn.memoizedState=to,rn.flags&256){rn=OE(st,rn,fo,un);break e}else if(fo!==cn){cn=sv(Error(Ye(424)),rn),Ty(cn),rn=OE(st,rn,fo,un);break e}else for(zm=bv(rn.stateNode.containerInfo.firstChild),Gm=rn,cm=!0,gv=null,xv=!0,un=D_(rn,null,fo,un),rn.child=un;un;)un.flags=un.flags&-3|4096,un=un.sibling;else{if(Ay(),fo===cn){rn=kv(st,rn,un);break e}jm(st,rn,fo,un)}rn=rn.child}return rn;case 26:return Py(st,rn),st===null?(un=U2(rn.type,null,rn.pendingProps,null))?rn.memoizedState=un:cm||(un=rn.type,st=rn.pendingProps,cn=ix(Bp.current).createElement(un),cn[Vm]=rn,cn[Ym]=st,qm(cn,un,st),Lm(cn),rn.stateNode=cn):rn.memoizedState=U2(rn.type,st.memoizedProps,rn.pendingProps,st.memoizedState),null;case 27:return tm(rn),st===null&&cm&&(cn=rn.stateNode=F2(rn.type,rn.pendingProps,Bp.current),Gm=rn,xv=!0,zm=bv(cn.firstChild)),cn=rn.pendingProps.children,st!==null||cm?jm(st,rn,cn,un):rn.child=bg(rn,null,cn,un),Py(st,rn),rn.child;case 5:return st===null&&cm&&((to=cn=zm)&&(cn=$R(cn,rn.type,rn.pendingProps,xv),cn!==null?(rn.stateNode=cn,Gm=rn,zm=bv(cn.firstChild),xv=!1,to=!0):to=!1),to||yg(rn)),tm(rn),to=rn.type,fo=rn.pendingProps,np=st!==null?st.memoizedProps:null,cn=fo.children,cw(to,fo)?cn=null:np!==null&&cw(to,np)&&(rn.flags|=32),rn.memoizedState!==null&&(to=Qx(st,rn,lR,null,null,un),r0._currentValue=to),Py(st,rn),jm(st,rn,cn,un),rn.child;case 6:return st===null&&cm&&((st=un=zm)&&(un=GR(un,rn.pendingProps,xv),un!==null?(rn.stateNode=un,Gm=rn,zm=null,st=!0):st=!1),st||yg(rn)),null;case 13:return BE(st,rn,un);case 4:return Jp(rn,rn.stateNode.containerInfo),cn=rn.pendingProps,st===null?rn.child=bg(rn,null,cn,un):jm(st,rn,cn,un),rn.child;case 11:return RE(st,rn,rn.type,rn.pendingProps,un);case 7:return jm(st,rn,rn.pendingProps,un),rn.child;case 8:return jm(st,rn,rn.pendingProps.children,un),rn.child;case 12:return jm(st,rn,rn.pendingProps.children,un),rn.child;case 10:return cn=rn.pendingProps,Kv(rn,rn.type,cn.value),jm(st,rn,cn.children,un),rn.child;case 9:return to=rn.type._context,cn=rn.pendingProps.children,Sg(rn),to=$m(to),cn=cn(to),rn.flags|=1,jm(st,rn,cn,un),rn.child;case 14:return SE(st,rn,rn.type,rn.pendingProps,un);case 15:return AE(st,rn,rn.type,rn.pendingProps,un);case 19:return IE(st,rn,un);case 22:return TE(st,rn,un);case 24:return Sg(rn),cn=$m(Fm),st===null?(to=Yx(),to===null&&(to=gm,fo=Xx(),to.pooledCache=fo,fo.refCount++,fo!==null&&(to.pooledCacheLanes|=un),to=fo),rn.memoizedState={parent:cn,cache:to},T1(rn),Kv(rn,Fm,to)):((st.lanes&un)!==0&&(D1(st,rn),jy(rn,null,null,un),zy()),to=st.memoizedState,fo=rn.memoizedState,to.parent!==cn?(to={parent:cn,cache:cn},rn.memoizedState=to,rn.lanes===0&&(rn.memoizedState=rn.updateQueue.baseState=to),Kv(rn,Fm,cn)):(cn=fo.cache,Kv(rn,Fm,cn),cn!==to.cache&&A1(rn,[Fm],un,!0))),jm(st,rn,rn.pendingProps.children,un),rn.child;case 29:throw rn.pendingProps}throw Error(Ye(156,rn.tag))}var R1=Tp(null),Rg=null,Ov=null;function Kv(st,rn,un){$p(R1,rn._currentValue),rn._currentValue=un}function Bv(st){st._currentValue=R1.current,qp(R1)}function S1(st,rn,un){for(;st!==null;){var cn=st.alternate;if((st.childLanes&rn)!==rn?(st.childLanes|=rn,cn!==null&&(cn.childLanes|=rn)):cn!==null&&(cn.childLanes&rn)!==rn&&(cn.childLanes|=rn),st===un)break;st=st.return}}function A1(st,rn,un,cn){var to=st.child;for(to!==null&&(to.return=st);to!==null;){var fo=to.dependencies;if(fo!==null){var np=to.child;fo=fo.firstContext;e:for(;fo!==null;){var up=fo;fo=to;for(var pp=0;pp<rn.length;pp++)if(up.context===rn[pp]){fo.lanes|=un,up=fo.alternate,up!==null&&(up.lanes|=un),S1(fo.return,un,st),cn||(np=null);break e}fo=up.next}}else if(to.tag===18){if(np=to.return,np===null)throw Error(Ye(341));np.lanes|=un,fo=np.alternate,fo!==null&&(fo.lanes|=un),S1(np,un,st),np=null}else np=to.child;if(np!==null)np.return=to;else for(np=to;np!==null;){if(np===st){np=null;break}if(to=np.sibling,to!==null){to.return=np.return,np=to;break}np=np.return}to=np}}function Uy(st,rn,un,cn){st=null;for(var to=rn,fo=!1;to!==null;){if(!fo){if((to.flags&524288)!==0)fo=!0;else if((to.flags&262144)!==0)break}if(to.tag===10){var np=to.alternate;if(np===null)throw Error(Ye(387));if(np=np.memoizedProps,np!==null){var up=to.type;Jm(to.pendingProps.value,np.value)||(st!==null?st.push(up):st=[up])}}else if(to===Vp.current){if(np=to.alternate,np===null)throw Error(Ye(387));np.memoizedState.memoizedState!==to.memoizedState.memoizedState&&(st!==null?st.push(r0):st=[r0])}to=to.return}st!==null&&A1(rn,st,un,cn),rn.flags|=262144}function q0(st){for(st=st.firstContext;st!==null;){if(!Jm(st.context._currentValue,st.memoizedValue))return!0;st=st.next}return!1}function Sg(st){Rg=st,Ov=null,st=st.dependencies,st!==null&&(st.firstContext=null)}function $m(st){return LE(Rg,st)}function W0(st,rn){return Rg===null&&Sg(st),LE(st,rn)}function LE(st,rn){var un=rn._currentValue;if(rn={context:rn,memoizedValue:un,next:null},Ov===null){if(st===null)throw Error(Ye(308));Ov=rn,st.dependencies={lanes:0,firstContext:rn},st.flags|=524288}else Ov=Ov.next=rn;return un}var Yv=!1;function T1(st){st.updateQueue={baseState:st.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function D1(st,rn){st=st.updateQueue,rn.updateQueue===st&&(rn.updateQueue={baseState:st.baseState,firstBaseUpdate:st.firstBaseUpdate,lastBaseUpdate:st.lastBaseUpdate,shared:st.shared,callbacks:null})}function Zv(st){return{lane:st,tag:0,payload:null,callback:null,next:null}}function Qv(st,rn,un){var cn=st.updateQueue;if(cn===null)return null;if(cn=cn.shared,(Rm&2)!==0){var to=cn.pending;return to===null?rn.next=rn:(rn.next=to.next,to.next=rn),cn.pending=rn,rn=C0(st),y_(st,null,un),rn}return E0(st,cn,rn,un),C0(st)}function Hy(st,rn,un){if(rn=rn.updateQueue,rn!==null&&(rn=rn.shared,(un&4194176)!==0)){var cn=rn.lanes;cn&=st.pendingLanes,un|=cn,rn.lanes=un,Sw(st,un)}}function N1(st,rn){var un=st.updateQueue,cn=st.alternate;if(cn!==null&&(cn=cn.updateQueue,un===cn)){var to=null,fo=null;if(un=un.firstBaseUpdate,un!==null){do{var np={lane:un.lane,tag:un.tag,payload:un.payload,callback:null,next:null};fo===null?to=fo=np:fo=fo.next=np,un=un.next}while(un!==null);fo===null?to=fo=rn:fo=fo.next=rn}else to=fo=rn;un={baseState:cn.baseState,firstBaseUpdate:to,lastBaseUpdate:fo,shared:cn.shared,callbacks:cn.callbacks},st.updateQueue=un;return}st=un.lastBaseUpdate,st===null?un.firstBaseUpdate=rn:st.next=rn,un.lastBaseUpdate=rn}var k1=!1;function zy(){if(k1){var st=Yg;if(st!==null)throw st}}function jy(st,rn,un,cn){k1=!1;var to=st.updateQueue;Yv=!1;var fo=to.firstBaseUpdate,np=to.lastBaseUpdate,up=to.shared.pending;if(up!==null){to.shared.pending=null;var pp=up,_p=pp.next;pp.next=null,np===null?fo=_p:np.next=_p,np=pp;var Up=st.alternate;Up!==null&&(Up=Up.updateQueue,up=Up.lastBaseUpdate,up!==np&&(up===null?Up.firstBaseUpdate=_p:up.next=_p,Up.lastBaseUpdate=pp))}if(fo!==null){var Wp=to.baseState;np=0,Up=_p=pp=null,up=fo;do{var Dp=up.lane&-536870913,Lp=Dp!==up.lane;if(Lp?(um&Dp)===Dp:(cn&Dp)===Dp){Dp!==0&&Dp===Kg&&(k1=!0),Up!==null&&(Up=Up.next={lane:0,tag:up.tag,payload:up.payload,callback:null,next:null});e:{var Yp=st,nm=up;Dp=rn;var Tm=un;switch(nm.tag){case 1:if(Yp=nm.payload,typeof Yp=="function"){Wp=Yp.call(Tm,Wp,Dp);break e}Wp=Yp;break e;case 3:Yp.flags=Yp.flags&-65537|128;case 0:if(Yp=nm.payload,Dp=typeof Yp=="function"?Yp.call(Tm,Wp,Dp):Yp,Dp==null)break e;Wp=lp({},Wp,Dp);break e;case 2:Yv=!0}}Dp=up.callback,Dp!==null&&(st.flags|=64,Lp&&(st.flags|=8192),Lp=to.callbacks,Lp===null?to.callbacks=[Dp]:Lp.push(Dp))}else Lp={lane:Dp,tag:up.tag,payload:up.payload,callback:up.callback,next:null},Up===null?(_p=Up=Lp,pp=Wp):Up=Up.next=Lp,np|=Dp;if(up=up.next,up===null){if(up=to.shared.pending,up===null)break;Lp=up,up=Lp.next,Lp.next=null,to.lastBaseUpdate=Lp,to.shared.pending=null}}while(!0);Up===null&&(pp=Wp),to.baseState=pp,to.firstBaseUpdate=_p,to.lastBaseUpdate=Up,fo===null&&(to.shared.lanes=0),rg|=np,st.lanes=np,st.memoizedState=Wp}}function PE(st,rn){if(typeof st!="function")throw Error(Ye(191,st));st.call(rn)}function UE(st,rn){var un=st.callbacks;if(un!==null)for(st.callbacks=null,st=0;st<un.length;st++)PE(un[st],rn)}function qy(st,rn){try{var un=rn.updateQueue,cn=un!==null?un.lastEffect:null;if(cn!==null){var to=cn.next;un=to;do{if((un.tag&st)===st){cn=void 0;var fo=un.create,np=un.inst;cn=fo(),np.destroy=cn}un=un.next}while(un!==to)}}catch(up){vm(rn,rn.return,up)}}function Jv(st,rn,un){try{var cn=rn.updateQueue,to=cn!==null?cn.lastEffect:null;if(to!==null){var fo=to.next;cn=fo;do{if((cn.tag&st)===st){var np=cn.inst,up=np.destroy;if(up!==void 0){np.destroy=void 0,to=rn;var pp=un;try{up()}catch(_p){vm(to,pp,_p)}}}cn=cn.next}while(cn!==fo)}}catch(_p){vm(rn,rn.return,_p)}}function HE(st){var rn=st.updateQueue;if(rn!==null){var un=st.stateNode;try{UE(rn,un)}catch(cn){vm(st,st.return,cn)}}}function zE(st,rn,un){un.props=Cg(st.type,st.memoizedProps),un.state=st.memoizedState;try{un.componentWillUnmount()}catch(cn){vm(st,rn,cn)}}function Ag(st,rn){try{var un=st.ref;if(un!==null){var cn=st.stateNode;switch(st.tag){case 26:case 27:case 5:var to=cn;break;default:to=cn}typeof un=="function"?st.refCleanup=un(to):un.current=to}}catch(fo){vm(st,rn,fo)}}function ev(st,rn){var un=st.ref,cn=st.refCleanup;if(un!==null)if(typeof cn=="function")try{cn()}catch(to){vm(st,rn,to)}finally{st.refCleanup=null,st=st.alternate,st!=null&&(st.refCleanup=null)}else if(typeof un=="function")try{un(null)}catch(to){vm(st,rn,to)}else un.current=null}function jE(st){var rn=st.type,un=st.memoizedProps,cn=st.stateNode;try{e:switch(rn){case"button":case"input":case"select":case"textarea":un.autoFocus&&cn.focus();break e;case"img":un.src?cn.src=un.src:un.srcSet&&(cn.srcset=un.srcSet)}}catch(to){vm(st,st.return,to)}}function qE(st,rn,un){try{var cn=st.stateNode;zR(cn,st.type,un,rn),cn[Ym]=rn}catch(to){vm(st,st.return,to)}}function WE(st){return st.tag===5||st.tag===3||st.tag===26||st.tag===27||st.tag===4}function O1(st){e:for(;;){for(;st.sibling===null;){if(st.return===null||WE(st.return))return null;st=st.return}for(st.sibling.return=st.return,st=st.sibling;st.tag!==5&&st.tag!==6&&st.tag!==27&&st.tag!==18;){if(st.flags&2||st.child===null||st.tag===4)continue e;st.child.return=st,st=st.child}if(!(st.flags&2))return st.stateNode}}function B1(st,rn,un){var cn=st.tag;if(cn===5||cn===6)st=st.stateNode,rn?un.nodeType===8?un.parentNode.insertBefore(st,rn):un.insertBefore(st,rn):(un.nodeType===8?(rn=un.parentNode,rn.insertBefore(st,un)):(rn=un,rn.appendChild(st)),un=un._reactRootContainer,un!=null||rn.onclick!==null||(rn.onclick=rx));else if(cn!==4&&cn!==27&&(st=st.child,st!==null))for(B1(st,rn,un),st=st.sibling;st!==null;)B1(st,rn,un),st=st.sibling}function V0(st,rn,un){var cn=st.tag;if(cn===5||cn===6)st=st.stateNode,rn?un.insertBefore(st,rn):un.appendChild(st);else if(cn!==4&&cn!==27&&(st=st.child,st!==null))for(V0(st,rn,un),st=st.sibling;st!==null;)V0(st,rn,un),st=st.sibling}var Mv=!1,Sm=!1,M1=!1,VE=typeof WeakSet=="function"?WeakSet:Set,Um=null,$E=!1;function gR(st,rn){if(st=st.containerInfo,uw=cx,st=l_(st),Fx(st)){if("selectionStart"in st)var un={start:st.selectionStart,end:st.selectionEnd};else e:{un=(un=st.ownerDocument)&&un.defaultView||window;var cn=un.getSelection&&un.getSelection();if(cn&&cn.rangeCount!==0){un=cn.anchorNode;var to=cn.anchorOffset,fo=cn.focusNode;cn=cn.focusOffset;try{un.nodeType,fo.nodeType}catch{un=null;break e}var np=0,up=-1,pp=-1,_p=0,Up=0,Wp=st,Dp=null;t:for(;;){for(var Lp;Wp!==un||to!==0&&Wp.nodeType!==3||(up=np+to),Wp!==fo||cn!==0&&Wp.nodeType!==3||(pp=np+cn),Wp.nodeType===3&&(np+=Wp.nodeValue.length),(Lp=Wp.firstChild)!==null;)Dp=Wp,Wp=Lp;for(;;){if(Wp===st)break t;if(Dp===un&&++_p===to&&(up=np),Dp===fo&&++Up===cn&&(pp=np),(Lp=Wp.nextSibling)!==null)break;Wp=Dp,Dp=Wp.parentNode}Wp=Lp}un=up===-1||pp===-1?null:{start:up,end:pp}}else un=null}un=un||{start:0,end:0}}else un=null;for(lw={focusedElem:st,selectionRange:un},cx=!1,Um=rn;Um!==null;)if(rn=Um,st=rn.child,(rn.subtreeFlags&1028)!==0&&st!==null)st.return=rn,Um=st;else for(;Um!==null;){switch(rn=Um,fo=rn.alternate,st=rn.flags,rn.tag){case 0:break;case 11:case 15:break;case 1:if((st&1024)!==0&&fo!==null){st=void 0,un=rn,to=fo.memoizedProps,fo=fo.memoizedState,cn=un.stateNode;try{var Yp=Cg(un.type,to,un.elementType===un.type);st=cn.getSnapshotBeforeUpdate(Yp,fo),cn.__reactInternalSnapshotBeforeUpdate=st}catch(nm){vm(un,un.return,nm)}}break;case 3:if((st&1024)!==0){if(st=rn.stateNode.containerInfo,un=st.nodeType,un===9)dw(st);else if(un===1)switch(st.nodeName){case"HEAD":case"HTML":case"BODY":dw(st);break;default:st.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((st&1024)!==0)throw Error(Ye(163))}if(st=rn.sibling,st!==null){st.return=rn.return,Um=st;break}Um=rn.return}return Yp=$E,$E=!1,Yp}function GE(st,rn,un){var cn=un.flags;switch(un.tag){case 0:case 11:case 15:Fv(st,un),cn&4&&qy(5,un);break;case 1:if(Fv(st,un),cn&4)if(st=un.stateNode,rn===null)try{st.componentDidMount()}catch(up){vm(un,un.return,up)}else{var to=Cg(un.type,rn.memoizedProps);rn=rn.memoizedState;try{st.componentDidUpdate(to,rn,st.__reactInternalSnapshotBeforeUpdate)}catch(up){vm(un,un.return,up)}}cn&64&&HE(un),cn&512&&Ag(un,un.return);break;case 3:if(Fv(st,un),cn&64&&(cn=un.updateQueue,cn!==null)){if(st=null,un.child!==null)switch(un.child.tag){case 27:case 5:st=un.child.stateNode;break;case 1:st=un.child.stateNode}try{UE(cn,st)}catch(up){vm(un,un.return,up)}}break;case 26:Fv(st,un),cn&512&&Ag(un,un.return);break;case 27:case 5:Fv(st,un),rn===null&&cn&4&&jE(un),cn&512&&Ag(un,un.return);break;case 12:Fv(st,un);break;case 13:Fv(st,un),cn&4&&YE(st,un);break;case 22:if(to=un.memoizedState!==null||Mv,!to){rn=rn!==null&&rn.memoizedState!==null||Sm;var fo=Mv,np=Sm;Mv=to,(Sm=rn)&&!np?eg(st,un,(un.subtreeFlags&8772)!==0):Fv(st,un),Mv=fo,Sm=np}cn&512&&(un.memoizedProps.mode==="manual"?Ag(un,un.return):ev(un,un.return));break;default:Fv(st,un)}}function XE(st){var rn=st.alternate;rn!==null&&(st.alternate=null,XE(rn)),st.child=null,st.deletions=null,st.sibling=null,st.tag===5&&(rn=st.stateNode,rn!==null&&xx(rn)),st.stateNode=null,st.return=null,st.dependencies=null,st.memoizedProps=null,st.memoizedState=null,st.pendingProps=null,st.stateNode=null,st.updateQueue=null}var Bm=null,tv=!1;function Iv(st,rn,un){for(un=un.child;un!==null;)KE(st,rn,un),un=un.sibling}function KE(st,rn,un){if(Qp&&typeof Qp.onCommitFiberUnmount=="function")try{Qp.onCommitFiberUnmount(Pp,un)}catch{}switch(un.tag){case 26:Sm||ev(un,rn),Iv(st,rn,un),un.memoizedState?un.memoizedState.count--:un.stateNode&&(un=un.stateNode,un.parentNode.removeChild(un));break;case 27:Sm||ev(un,rn);var cn=Bm,to=tv;for(Bm=un.stateNode,Iv(st,rn,un),un=un.stateNode,rn=un.attributes;rn.length;)un.removeAttributeNode(rn[0]);xx(un),Bm=cn,tv=to;break;case 5:Sm||ev(un,rn);case 6:to=Bm;var fo=tv;if(Bm=null,Iv(st,rn,un),Bm=to,tv=fo,Bm!==null)if(tv)try{st=Bm,cn=un.stateNode,st.nodeType===8?st.parentNode.removeChild(cn):st.removeChild(cn)}catch(np){vm(un,rn,np)}else try{Bm.removeChild(un.stateNode)}catch(np){vm(un,rn,np)}break;case 18:Bm!==null&&(tv?(rn=Bm,un=un.stateNode,rn.nodeType===8?hw(rn.parentNode,un):rn.nodeType===1&&hw(rn,un),s0(rn)):hw(Bm,un.stateNode));break;case 4:cn=Bm,to=tv,Bm=un.stateNode.containerInfo,tv=!0,Iv(st,rn,un),Bm=cn,tv=to;break;case 0:case 11:case 14:case 15:Sm||Jv(2,un,rn),Sm||Jv(4,un,rn),Iv(st,rn,un);break;case 1:Sm||(ev(un,rn),cn=un.stateNode,typeof cn.componentWillUnmount=="function"&&zE(un,rn,cn)),Iv(st,rn,un);break;case 21:Iv(st,rn,un);break;case 22:Sm||ev(un,rn),Sm=(cn=Sm)||un.memoizedState!==null,Iv(st,rn,un),Sm=cn;break;default:Iv(st,rn,un)}}function YE(st,rn){if(rn.memoizedState===null&&(st=rn.alternate,st!==null&&(st=st.memoizedState,st!==null&&(st=st.dehydrated,st!==null))))try{s0(st)}catch(un){vm(rn,rn.return,un)}}function yR(st){switch(st.tag){case 13:case 19:var rn=st.stateNode;return rn===null&&(rn=st.stateNode=new VE),rn;case 22:return st=st.stateNode,rn=st._retryCache,rn===null&&(rn=st._retryCache=new VE),rn;default:throw Error(Ye(435,st.tag))}}function I1(st,rn){var un=yR(st);rn.forEach(function(cn){var to=kR.bind(null,st,cn);un.has(cn)||(un.add(cn),cn.then(to,to))})}function fv(st,rn){var un=rn.deletions;if(un!==null)for(var cn=0;cn<un.length;cn++){var to=un[cn],fo=st,np=rn,up=np;e:for(;up!==null;){switch(up.tag){case 27:case 5:Bm=up.stateNode,tv=!1;break e;case 3:Bm=up.stateNode.containerInfo,tv=!0;break e;case 4:Bm=up.stateNode.containerInfo,tv=!0;break e}up=up.return}if(Bm===null)throw Error(Ye(160));KE(fo,np,to),Bm=null,tv=!1,fo=to.alternate,fo!==null&&(fo.return=null),to.return=null}if(rn.subtreeFlags&13878)for(rn=rn.child;rn!==null;)ZE(rn,st),rn=rn.sibling}var yv=null;function ZE(st,rn){var un=st.alternate,cn=st.flags;switch(st.tag){case 0:case 11:case 14:case 15:fv(rn,st),hv(st),cn&4&&(Jv(3,st,st.return),qy(3,st),Jv(5,st,st.return));break;case 1:fv(rn,st),hv(st),cn&512&&(Sm||un===null||ev(un,un.return)),cn&64&&Mv&&(st=st.updateQueue,st!==null&&(cn=st.callbacks,cn!==null&&(un=st.shared.hiddenCallbacks,st.shared.hiddenCallbacks=un===null?cn:un.concat(cn))));break;case 26:var to=yv;if(fv(rn,st),hv(st),cn&512&&(Sm||un===null||ev(un,un.return)),cn&4){var fo=un!==null?un.memoizedState:null;if(cn=st.memoizedState,un===null)if(cn===null)if(st.stateNode===null){e:{cn=st.type,un=st.memoizedProps,to=to.ownerDocument||to;t:switch(cn){case"title":fo=to.getElementsByTagName("title")[0],(!fo||fo[my]||fo[Vm]||fo.namespaceURI==="http://www.w3.org/2000/svg"||fo.hasAttribute("itemprop"))&&(fo=to.createElement(cn),to.head.insertBefore(fo,to.querySelector("head > title"))),qm(fo,cn,un),fo[Vm]=st,Lm(fo),cn=fo;break e;case"link":var np=j2("link","href",to).get(cn+(un.href||""));if(np){for(var up=0;up<np.length;up++)if(fo=np[up],fo.getAttribute("href")===(un.href==null?null:un.href)&&fo.getAttribute("rel")===(un.rel==null?null:un.rel)&&fo.getAttribute("title")===(un.title==null?null:un.title)&&fo.getAttribute("crossorigin")===(un.crossOrigin==null?null:un.crossOrigin)){np.splice(up,1);break t}}fo=to.createElement(cn),qm(fo,cn,un),to.head.appendChild(fo);break;case"meta":if(np=j2("meta","content",to).get(cn+(un.content||""))){for(up=0;up<np.length;up++)if(fo=np[up],fo.getAttribute("content")===(un.content==null?null:""+un.content)&&fo.getAttribute("name")===(un.name==null?null:un.name)&&fo.getAttribute("property")===(un.property==null?null:un.property)&&fo.getAttribute("http-equiv")===(un.httpEquiv==null?null:un.httpEquiv)&&fo.getAttribute("charset")===(un.charSet==null?null:un.charSet)){np.splice(up,1);break t}}fo=to.createElement(cn),qm(fo,cn,un),to.head.appendChild(fo);break;default:throw Error(Ye(468,cn))}fo[Vm]=st,Lm(fo),cn=fo}st.stateNode=cn}else q2(to,st.type,st.stateNode);else st.stateNode=z2(to,cn,st.memoizedProps);else fo!==cn?(fo===null?un.stateNode!==null&&(un=un.stateNode,un.parentNode.removeChild(un)):fo.count--,cn===null?q2(to,st.type,st.stateNode):z2(to,cn,st.memoizedProps)):cn===null&&st.stateNode!==null&&qE(st,st.memoizedProps,un.memoizedProps)}break;case 27:if(cn&4&&st.alternate===null){to=st.stateNode,fo=st.memoizedProps;try{for(var pp=to.firstChild;pp;){var _p=pp.nextSibling,Up=pp.nodeName;pp[my]||Up==="HEAD"||Up==="BODY"||Up==="SCRIPT"||Up==="STYLE"||Up==="LINK"&&pp.rel.toLowerCase()==="stylesheet"||to.removeChild(pp),pp=_p}for(var Wp=st.type,Dp=to.attributes;Dp.length;)to.removeAttributeNode(Dp[0]);qm(to,Wp,fo),to[Vm]=st,to[Ym]=fo}catch(Yp){vm(st,st.return,Yp)}}case 5:if(fv(rn,st),hv(st),cn&512&&(Sm||un===null||ev(un,un.return)),st.flags&32){to=st.stateNode;try{Lg(to,"")}catch(Yp){vm(st,st.return,Yp)}}cn&4&&st.stateNode!=null&&(to=st.memoizedProps,qE(st,to,un!==null?un.memoizedProps:to)),cn&1024&&(M1=!0);break;case 6:if(fv(rn,st),hv(st),cn&4){if(st.stateNode===null)throw Error(Ye(162));cn=st.memoizedProps,un=st.stateNode;try{un.nodeValue=cn}catch(Yp){vm(st,st.return,Yp)}}break;case 3:if(sx=null,to=yv,yv=ax(rn.containerInfo),fv(rn,st),yv=to,hv(st),cn&4&&un!==null&&un.memoizedState.isDehydrated)try{s0(rn.containerInfo)}catch(Yp){vm(st,st.return,Yp)}M1&&(M1=!1,QE(st));break;case 4:cn=yv,yv=ax(st.stateNode.containerInfo),fv(rn,st),hv(st),yv=cn;break;case 12:fv(rn,st),hv(st);break;case 13:fv(rn,st),hv(st),st.child.flags&8192&&st.memoizedState!==null!=(un!==null&&un.memoizedState!==null)&&(W1=Em()),cn&4&&(cn=st.updateQueue,cn!==null&&(st.updateQueue=null,I1(st,cn)));break;case 22:if(cn&512&&(Sm||un===null||ev(un,un.return)),pp=st.memoizedState!==null,_p=un!==null&&un.memoizedState!==null,Up=Mv,Wp=Sm,Mv=Up||pp,Sm=Wp||_p,fv(rn,st),Sm=Wp,Mv=Up,hv(st),rn=st.stateNode,rn._current=st,rn._visibility&=-3,rn._visibility|=rn._pendingVisibility&2,cn&8192&&(rn._visibility=pp?rn._visibility&-2:rn._visibility|1,pp&&(rn=Mv||Sm,un===null||_p||rn||ey(st)),st.memoizedProps===null||st.memoizedProps.mode!=="manual"))e:for(un=null,rn=st;;){if(rn.tag===5||rn.tag===26||rn.tag===27){if(un===null){_p=un=rn;try{if(to=_p.stateNode,pp)fo=to.style,typeof fo.setProperty=="function"?fo.setProperty("display","none","important"):fo.display="none";else{np=_p.stateNode,up=_p.memoizedProps.style;var Lp=up!=null&&up.hasOwnProperty("display")?up.display:null;np.style.display=Lp==null||typeof Lp=="boolean"?"":(""+Lp).trim()}}catch(Yp){vm(_p,_p.return,Yp)}}}else if(rn.tag===6){if(un===null){_p=rn;try{_p.stateNode.nodeValue=pp?"":_p.memoizedProps}catch(Yp){vm(_p,_p.return,Yp)}}}else if((rn.tag!==22&&rn.tag!==23||rn.memoizedState===null||rn===st)&&rn.child!==null){rn.child.return=rn,rn=rn.child;continue}if(rn===st)break e;for(;rn.sibling===null;){if(rn.return===null||rn.return===st)break e;un===rn&&(un=null),rn=rn.return}un===rn&&(un=null),rn.sibling.return=rn.return,rn=rn.sibling}cn&4&&(cn=st.updateQueue,cn!==null&&(un=cn.retryQueue,un!==null&&(cn.retryQueue=null,I1(st,un))));break;case 19:fv(rn,st),hv(st),cn&4&&(cn=st.updateQueue,cn!==null&&(st.updateQueue=null,I1(st,cn)));break;case 21:break;default:fv(rn,st),hv(st)}}function hv(st){var rn=st.flags;if(rn&2){try{if(st.tag!==27){e:{for(var un=st.return;un!==null;){if(WE(un)){var cn=un;break e}un=un.return}throw Error(Ye(160))}switch(cn.tag){case 27:var to=cn.stateNode,fo=O1(st);V0(st,fo,to);break;case 5:var np=cn.stateNode;cn.flags&32&&(Lg(np,""),cn.flags&=-33);var up=O1(st);V0(st,up,np);break;case 3:case 4:var pp=cn.stateNode.containerInfo,_p=O1(st);B1(st,_p,pp);break;default:throw Error(Ye(161))}}}catch(Up){vm(st,st.return,Up)}st.flags&=-3}rn&4096&&(st.flags&=-4097)}function QE(st){if(st.subtreeFlags&1024)for(st=st.child;st!==null;){var rn=st;QE(rn),rn.tag===5&&rn.flags&1024&&rn.stateNode.reset(),st=st.sibling}}function Fv(st,rn){if(rn.subtreeFlags&8772)for(rn=rn.child;rn!==null;)GE(st,rn.alternate,rn),rn=rn.sibling}function ey(st){for(st=st.child;st!==null;){var rn=st;switch(rn.tag){case 0:case 11:case 14:case 15:Jv(4,rn,rn.return),ey(rn);break;case 1:ev(rn,rn.return);var un=rn.stateNode;typeof un.componentWillUnmount=="function"&&zE(rn,rn.return,un),ey(rn);break;case 26:case 27:case 5:ev(rn,rn.return),ey(rn);break;case 22:ev(rn,rn.return),rn.memoizedState===null&&ey(rn);break;default:ey(rn)}st=st.sibling}}function eg(st,rn,un){for(un=un&&(rn.subtreeFlags&8772)!==0,rn=rn.child;rn!==null;){var cn=rn.alternate,to=st,fo=rn,np=fo.flags;switch(fo.tag){case 0:case 11:case 15:eg(to,fo,un),qy(4,fo);break;case 1:if(eg(to,fo,un),cn=fo,to=cn.stateNode,typeof to.componentDidMount=="function")try{to.componentDidMount()}catch(_p){vm(cn,cn.return,_p)}if(cn=fo,to=cn.updateQueue,to!==null){var up=cn.stateNode;try{var pp=to.shared.hiddenCallbacks;if(pp!==null)for(to.shared.hiddenCallbacks=null,to=0;to<pp.length;to++)PE(pp[to],up)}catch(_p){vm(cn,cn.return,_p)}}un&&np&64&&HE(fo),Ag(fo,fo.return);break;case 26:case 27:case 5:eg(to,fo,un),un&&cn===null&&np&4&&jE(fo),Ag(fo,fo.return);break;case 12:eg(to,fo,un);break;case 13:eg(to,fo,un),un&&np&4&&YE(to,fo);break;case 22:fo.memoizedState===null&&eg(to,fo,un),Ag(fo,fo.return);break;default:eg(to,fo,un)}rn=rn.sibling}}function F1(st,rn){var un=null;st!==null&&st.memoizedState!==null&&st.memoizedState.cachePool!==null&&(un=st.memoizedState.cachePool.pool),st=null,rn.memoizedState!==null&&rn.memoizedState.cachePool!==null&&(st=rn.memoizedState.cachePool.pool),st!==un&&(st!=null&&st.refCount++,un!=null&&By(un))}function L1(st,rn){st=null,rn.alternate!==null&&(st=rn.alternate.memoizedState.cache),rn=rn.memoizedState.cache,rn!==st&&(rn.refCount++,st!=null&&By(st))}function tg(st,rn,un,cn){if(rn.subtreeFlags&10256)for(rn=rn.child;rn!==null;)JE(st,rn,un,cn),rn=rn.sibling}function JE(st,rn,un,cn){var to=rn.flags;switch(rn.tag){case 0:case 11:case 15:tg(st,rn,un,cn),to&2048&&qy(9,rn);break;case 3:tg(st,rn,un,cn),to&2048&&(st=null,rn.alternate!==null&&(st=rn.alternate.memoizedState.cache),rn=rn.memoizedState.cache,rn!==st&&(rn.refCount++,st!=null&&By(st)));break;case 12:if(to&2048){tg(st,rn,un,cn),st=rn.stateNode;try{var fo=rn.memoizedProps,np=fo.id,up=fo.onPostCommit;typeof up=="function"&&up(np,rn.alternate===null?"mount":"update",st.passiveEffectDuration,-0)}catch(pp){vm(rn,rn.return,pp)}}else tg(st,rn,un,cn);break;case 23:break;case 22:fo=rn.stateNode,rn.memoizedState!==null?fo._visibility&4?tg(st,rn,un,cn):Wy(st,rn):fo._visibility&4?tg(st,rn,un,cn):(fo._visibility|=4,ty(st,rn,un,cn,(rn.subtreeFlags&10256)!==0)),to&2048&&F1(rn.alternate,rn);break;case 24:tg(st,rn,un,cn),to&2048&&L1(rn.alternate,rn);break;default:tg(st,rn,un,cn)}}function ty(st,rn,un,cn,to){for(to=to&&(rn.subtreeFlags&10256)!==0,rn=rn.child;rn!==null;){var fo=st,np=rn,up=un,pp=cn,_p=np.flags;switch(np.tag){case 0:case 11:case 15:ty(fo,np,up,pp,to),qy(8,np);break;case 23:break;case 22:var Up=np.stateNode;np.memoizedState!==null?Up._visibility&4?ty(fo,np,up,pp,to):Wy(fo,np):(Up._visibility|=4,ty(fo,np,up,pp,to)),to&&_p&2048&&F1(np.alternate,np);break;case 24:ty(fo,np,up,pp,to),to&&_p&2048&&L1(np.alternate,np);break;default:ty(fo,np,up,pp,to)}rn=rn.sibling}}function Wy(st,rn){if(rn.subtreeFlags&10256)for(rn=rn.child;rn!==null;){var un=st,cn=rn,to=cn.flags;switch(cn.tag){case 22:Wy(un,cn),to&2048&&F1(cn.alternate,cn);break;case 24:Wy(un,cn),to&2048&&L1(cn.alternate,cn);break;default:Wy(un,cn)}rn=rn.sibling}}var Vy=8192;function ny(st){if(st.subtreeFlags&Vy)for(st=st.child;st!==null;)e2(st),st=st.sibling}function e2(st){switch(st.tag){case 26:ny(st),st.flags&Vy&&st.memoizedState!==null&&oS(yv,st.memoizedState,st.memoizedProps);break;case 5:ny(st);break;case 3:case 4:var rn=yv;yv=ax(st.stateNode.containerInfo),ny(st),yv=rn;break;case 22:st.memoizedState===null&&(rn=st.alternate,rn!==null&&rn.memoizedState!==null?(rn=Vy,Vy=16777216,ny(st),Vy=rn):ny(st));break;default:ny(st)}}function t2(st){var rn=st.alternate;if(rn!==null&&(st=rn.child,st!==null)){rn.child=null;do rn=st.sibling,st.sibling=null,st=rn;while(st!==null)}}function $y(st){var rn=st.deletions;if((st.flags&16)!==0){if(rn!==null)for(var un=0;un<rn.length;un++){var cn=rn[un];Um=cn,r2(cn,st)}t2(st)}if(st.subtreeFlags&10256)for(st=st.child;st!==null;)n2(st),st=st.sibling}function n2(st){switch(st.tag){case 0:case 11:case 15:$y(st),st.flags&2048&&Jv(9,st,st.return);break;case 3:$y(st);break;case 12:$y(st);break;case 22:var rn=st.stateNode;st.memoizedState!==null&&rn._visibility&4&&(st.return===null||st.return.tag!==13)?(rn._visibility&=-5,$0(st)):$y(st);break;default:$y(st)}}function $0(st){var rn=st.deletions;if((st.flags&16)!==0){if(rn!==null)for(var un=0;un<rn.length;un++){var cn=rn[un];Um=cn,r2(cn,st)}t2(st)}for(st=st.child;st!==null;){switch(rn=st,rn.tag){case 0:case 11:case 15:Jv(8,rn,rn.return),$0(rn);break;case 22:un=rn.stateNode,un._visibility&4&&(un._visibility&=-5,$0(rn));break;default:$0(rn)}st=st.sibling}}function r2(st,rn){for(;Um!==null;){var un=Um;switch(un.tag){case 0:case 11:case 15:Jv(8,un,rn);break;case 23:case 22:if(un.memoizedState!==null&&un.memoizedState.cachePool!==null){var cn=un.memoizedState.cachePool.pool;cn!=null&&cn.refCount++}break;case 24:By(un.memoizedState.cache)}if(cn=un.child,cn!==null)cn.return=un,Um=cn;else e:for(un=st;Um!==null;){cn=Um;var to=cn.sibling,fo=cn.return;if(XE(cn),cn===un){Um=null;break e}if(to!==null){to.return=fo,Um=to;break e}Um=fo}}}function bR(st,rn,un,cn){this.tag=st,this.key=un,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=rn,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=cn,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function dv(st,rn,un,cn){return new bR(st,rn,un,cn)}function P1(st){return st=st.prototype,!(!st||!st.isReactComponent)}function ng(st,rn){var un=st.alternate;return un===null?(un=dv(st.tag,rn,st.key,st.mode),un.elementType=st.elementType,un.type=st.type,un.stateNode=st.stateNode,un.alternate=st,st.alternate=un):(un.pendingProps=rn,un.type=st.type,un.flags=0,un.subtreeFlags=0,un.deletions=null),un.flags=st.flags&31457280,un.childLanes=st.childLanes,un.lanes=st.lanes,un.child=st.child,un.memoizedProps=st.memoizedProps,un.memoizedState=st.memoizedState,un.updateQueue=st.updateQueue,rn=st.dependencies,un.dependencies=rn===null?null:{lanes:rn.lanes,firstContext:rn.firstContext},un.sibling=st.sibling,un.index=st.index,un.ref=st.ref,un.refCleanup=st.refCleanup,un}function i2(st,rn){st.flags&=31457282;var un=st.alternate;return un===null?(st.childLanes=0,st.lanes=rn,st.child=null,st.subtreeFlags=0,st.memoizedProps=null,st.memoizedState=null,st.updateQueue=null,st.dependencies=null,st.stateNode=null):(st.childLanes=un.childLanes,st.lanes=un.lanes,st.child=un.child,st.subtreeFlags=0,st.deletions=null,st.memoizedProps=un.memoizedProps,st.memoizedState=un.memoizedState,st.updateQueue=un.updateQueue,st.type=un.type,rn=un.dependencies,st.dependencies=rn===null?null:{lanes:rn.lanes,firstContext:rn.firstContext}),st}function G0(st,rn,un,cn,to,fo){var np=0;if(cn=st,typeof st=="function")P1(st)&&(np=1);else if(typeof st=="string")np=iS(st,un,fp.current)?26:st==="html"||st==="head"||st==="body"?27:5;else e:switch(st){case an:return Tg(un.children,to,fo,rn);case sn:np=8,to|=24;break;case ln:return st=dv(12,un,rn,to|2),st.elementType=ln,st.lanes=fo,st;case co:return st=dv(13,un,rn,to),st.elementType=co,st.lanes=fo,st;case lo:return st=dv(19,un,rn,to),st.elementType=lo,st.lanes=fo,st;case mo:return a2(un,to,fo,rn);default:if(typeof st=="object"&&st!==null)switch(st.$$typeof){case fn:case Xr:np=10;break e;case hn:np=9;break e;case Mi:np=11;break e;case uo:np=14;break e;case ho:np=16,cn=null;break e}np=29,un=Error(Ye(130,st===null?"null":typeof st,"")),cn=null}return rn=dv(np,un,rn,to),rn.elementType=st,rn.type=cn,rn.lanes=fo,rn}function Tg(st,rn,un,cn){return st=dv(7,st,cn,rn),st.lanes=un,st}function a2(st,rn,un,cn){st=dv(22,st,cn,rn),st.elementType=mo,st.lanes=un;var to={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var fo=to._current;if(fo===null)throw Error(Ye(456));if((to._pendingVisibility&2)===0){var np=Wv(fo,2);np!==null&&(to._pendingVisibility|=2,Xm(np,fo,2))}},attach:function(){var fo=to._current;if(fo===null)throw Error(Ye(456));if((to._pendingVisibility&2)!==0){var np=Wv(fo,2);np!==null&&(to._pendingVisibility&=-3,Xm(np,fo,2))}}};return st.stateNode=to,st}function U1(st,rn,un){return st=dv(6,st,null,rn),st.lanes=un,st}function H1(st,rn,un){return rn=dv(4,st.children!==null?st.children:[],st.key,rn),rn.lanes=un,rn.stateNode={containerInfo:st.containerInfo,pendingChildren:null,implementation:st.implementation},rn}function Lv(st){st.flags|=4}function o2(st,rn){if(rn.type!=="stylesheet"||(rn.state.loading&4)!==0)st.flags&=-16777217;else if(st.flags|=16777216,!W2(rn)){if(rn=cv.current,rn!==null&&((um&4194176)===um?wv!==null:(um&62914560)!==um&&(um&536870912)===0||rn!==wv))throw Ny=Vx,E_;st.flags|=8192}}function X0(st,rn){rn!==null&&(st.flags|=4),st.flags&16384&&(rn=st.tag!==22?Cw():536870912,st.lanes|=rn,iy|=rn)}function Gy(st,rn){if(!cm)switch(st.tailMode){case"hidden":rn=st.tail;for(var un=null;rn!==null;)rn.alternate!==null&&(un=rn),rn=rn.sibling;un===null?st.tail=null:un.sibling=null;break;case"collapsed":un=st.tail;for(var cn=null;un!==null;)un.alternate!==null&&(cn=un),un=un.sibling;cn===null?rn||st.tail===null?st.tail=null:st.tail.sibling=null:cn.sibling=null}}function Cm(st){var rn=st.alternate!==null&&st.alternate.child===st.child,un=0,cn=0;if(rn)for(var to=st.child;to!==null;)un|=to.lanes|to.childLanes,cn|=to.subtreeFlags&31457280,cn|=to.flags&31457280,to.return=st,to=to.sibling;else for(to=st.child;to!==null;)un|=to.lanes|to.childLanes,cn|=to.subtreeFlags,cn|=to.flags,to.return=st,to=to.sibling;return st.subtreeFlags|=cn,st.childLanes=un,rn}function xR(st,rn,un){var cn=rn.pendingProps;switch(qx(rn),rn.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Cm(rn),null;case 1:return Cm(rn),null;case 3:return un=rn.stateNode,cn=null,st!==null&&(cn=st.memoizedState.cache),rn.memoizedState.cache!==cn&&(rn.flags|=2048),Bv(Fm),Xp(),un.pendingContext&&(un.context=un.pendingContext,un.pendingContext=null),(st===null||st.child===null)&&(Sy(rn)?Lv(rn):st===null||st.memoizedState.isDehydrated&&(rn.flags&256)===0||(rn.flags|=1024,gv!==null&&(X1(gv),gv=null))),Cm(rn),null;case 26:return un=rn.memoizedState,st===null?(Lv(rn),un!==null?(Cm(rn),o2(rn,un)):(Cm(rn),rn.flags&=-16777217)):un?un!==st.memoizedState?(Lv(rn),Cm(rn),o2(rn,un)):(Cm(rn),rn.flags&=-16777217):(st.memoizedProps!==cn&&Lv(rn),Cm(rn),rn.flags&=-16777217),null;case 27:bm(rn),un=Bp.current;var to=rn.type;if(st!==null&&rn.stateNode!=null)st.memoizedProps!==cn&&Lv(rn);else{if(!cn){if(rn.stateNode===null)throw Error(Ye(166));return Cm(rn),null}st=fp.current,Sy(rn)?w_(rn):(st=F2(to,cn,un),rn.stateNode=st,Lv(rn))}return Cm(rn),null;case 5:if(bm(rn),un=rn.type,st!==null&&rn.stateNode!=null)st.memoizedProps!==cn&&Lv(rn);else{if(!cn){if(rn.stateNode===null)throw Error(Ye(166));return Cm(rn),null}if(st=fp.current,Sy(rn))w_(rn);else{switch(to=ix(Bp.current),st){case 1:st=to.createElementNS("http://www.w3.org/2000/svg",un);break;case 2:st=to.createElementNS("http://www.w3.org/1998/Math/MathML",un);break;default:switch(un){case"svg":st=to.createElementNS("http://www.w3.org/2000/svg",un);break;case"math":st=to.createElementNS("http://www.w3.org/1998/Math/MathML",un);break;case"script":st=to.createElement("div"),st.innerHTML="<script><\/script>",st=st.removeChild(st.firstChild);break;case"select":st=typeof cn.is=="string"?to.createElement("select",{is:cn.is}):to.createElement("select"),cn.multiple?st.multiple=!0:cn.size&&(st.size=cn.size);break;default:st=typeof cn.is=="string"?to.createElement(un,{is:cn.is}):to.createElement(un)}}st[Vm]=rn,st[Ym]=cn;e:for(to=rn.child;to!==null;){if(to.tag===5||to.tag===6)st.appendChild(to.stateNode);else if(to.tag!==4&&to.tag!==27&&to.child!==null){to.child.return=to,to=to.child;continue}if(to===rn)break e;for(;to.sibling===null;){if(to.return===null||to.return===rn)break e;to=to.return}to.sibling.return=to.return,to=to.sibling}rn.stateNode=st;e:switch(qm(st,un,cn),un){case"button":case"input":case"select":case"textarea":st=!!cn.autoFocus;break e;case"img":st=!0;break e;default:st=!1}st&&Lv(rn)}}return Cm(rn),rn.flags&=-16777217,null;case 6:if(st&&rn.stateNode!=null)st.memoizedProps!==cn&&Lv(rn);else{if(typeof cn!="string"&&rn.stateNode===null)throw Error(Ye(166));if(st=Bp.current,Sy(rn)){if(st=rn.stateNode,un=rn.memoizedProps,cn=null,to=Gm,to!==null)switch(to.tag){case 27:case 5:cn=to.memoizedProps}st[Vm]=rn,st=!!(st.nodeValue===un||cn!==null&&cn.suppressHydrationWarning===!0||N2(st.nodeValue,un)),st||yg(rn)}else st=ix(st).createTextNode(cn),st[Vm]=rn,rn.stateNode=st}return Cm(rn),null;case 13:if(cn=rn.memoizedState,st===null||st.memoizedState!==null&&st.memoizedState.dehydrated!==null){if(to=Sy(rn),cn!==null&&cn.dehydrated!==null){if(st===null){if(!to)throw Error(Ye(318));if(to=rn.memoizedState,to=to!==null?to.dehydrated:null,!to)throw Error(Ye(317));to[Vm]=rn}else Ay(),(rn.flags&128)===0&&(rn.memoizedState=null),rn.flags|=4;Cm(rn),to=!1}else gv!==null&&(X1(gv),gv=null),to=!0;if(!to)return rn.flags&256?(Dv(rn),rn):(Dv(rn),null)}if(Dv(rn),(rn.flags&128)!==0)return rn.lanes=un,rn;if(un=cn!==null,st=st!==null&&st.memoizedState!==null,un){cn=rn.child,to=null,cn.alternate!==null&&cn.alternate.memoizedState!==null&&cn.alternate.memoizedState.cachePool!==null&&(to=cn.alternate.memoizedState.cachePool.pool);var fo=null;cn.memoizedState!==null&&cn.memoizedState.cachePool!==null&&(fo=cn.memoizedState.cachePool.pool),fo!==to&&(cn.flags|=2048)}return un!==st&&un&&(rn.child.flags|=8192),X0(rn,rn.updateQueue),Cm(rn),null;case 4:return Xp(),st===null&&aw(rn.stateNode.containerInfo),Cm(rn),null;case 10:return Bv(rn.type),Cm(rn),null;case 19:if(qp(Im),to=rn.memoizedState,to===null)return Cm(rn),null;if(cn=(rn.flags&128)!==0,fo=to.rendering,fo===null)if(cn)Gy(to,!1);else{if(Am!==0||st!==null&&(st.flags&128)!==0)for(st=rn.child;st!==null;){if(fo=k0(st),fo!==null){for(rn.flags|=128,Gy(to,!1),st=fo.updateQueue,rn.updateQueue=st,X0(rn,st),rn.subtreeFlags=0,st=un,un=rn.child;un!==null;)i2(un,st),un=un.sibling;return $p(Im,Im.current&1|2),rn.child}st=st.sibling}to.tail!==null&&Em()>K0&&(rn.flags|=128,cn=!0,Gy(to,!1),rn.lanes=4194304)}else{if(!cn)if(st=k0(fo),st!==null){if(rn.flags|=128,cn=!0,st=st.updateQueue,rn.updateQueue=st,X0(rn,st),Gy(to,!0),to.tail===null&&to.tailMode==="hidden"&&!fo.alternate&&!cm)return Cm(rn),null}else 2*Em()-to.renderingStartTime>K0&&un!==536870912&&(rn.flags|=128,cn=!0,Gy(to,!1),rn.lanes=4194304);to.isBackwards?(fo.sibling=rn.child,rn.child=fo):(st=to.last,st!==null?st.sibling=fo:rn.child=fo,to.last=fo)}return to.tail!==null?(rn=to.tail,to.rendering=rn,to.tail=rn.sibling,to.renderingStartTime=Em(),rn.sibling=null,st=Im.current,$p(Im,cn?st&1|2:st&1),rn):(Cm(rn),null);case 22:case 23:return Dv(rn),Gx(),cn=rn.memoizedState!==null,st!==null?st.memoizedState!==null!==cn&&(rn.flags|=8192):cn&&(rn.flags|=8192),cn?(un&536870912)!==0&&(rn.flags&128)===0&&(Cm(rn),rn.subtreeFlags&6&&(rn.flags|=8192)):Cm(rn),un=rn.updateQueue,un!==null&&X0(rn,un.retryQueue),un=null,st!==null&&st.memoizedState!==null&&st.memoizedState.cachePool!==null&&(un=st.memoizedState.cachePool.pool),cn=null,rn.memoizedState!==null&&rn.memoizedState.cachePool!==null&&(cn=rn.memoizedState.cachePool.pool),cn!==un&&(rn.flags|=2048),st!==null&&qp(xg),null;case 24:return un=null,st!==null&&(un=st.memoizedState.cache),rn.memoizedState.cache!==un&&(rn.flags|=2048),Bv(Fm),Cm(rn),null;case 25:return null}throw Error(Ye(156,rn.tag))}function wR(st,rn){switch(qx(rn),rn.tag){case 1:return st=rn.flags,st&65536?(rn.flags=st&-65537|128,rn):null;case 3:return Bv(Fm),Xp(),st=rn.flags,(st&65536)!==0&&(st&128)===0?(rn.flags=st&-65537|128,rn):null;case 26:case 27:case 5:return bm(rn),null;case 13:if(Dv(rn),st=rn.memoizedState,st!==null&&st.dehydrated!==null){if(rn.alternate===null)throw Error(Ye(340));Ay()}return st=rn.flags,st&65536?(rn.flags=st&-65537|128,rn):null;case 19:return qp(Im),null;case 4:return Xp(),null;case 10:return Bv(rn.type),null;case 22:case 23:return Dv(rn),Gx(),st!==null&&qp(xg),st=rn.flags,st&65536?(rn.flags=st&-65537|128,rn):null;case 24:return Bv(Fm),null;case 25:return null;default:return null}}function s2(st,rn){switch(qx(rn),rn.tag){case 3:Bv(Fm),Xp();break;case 26:case 27:case 5:bm(rn);break;case 4:Xp();break;case 13:Dv(rn);break;case 19:qp(Im);break;case 10:Bv(rn.type);break;case 22:case 23:Dv(rn),Gx(),st!==null&&qp(xg);break;case 24:Bv(Fm)}}var _R={getCacheForType:function(st){var rn=$m(Fm),un=rn.data.get(st);return un===void 0&&(un=st(),rn.data.set(st,un)),un}},ER=typeof WeakMap=="function"?WeakMap:Map,Rm=0,gm=null,am=null,um=0,ym=0,nv=null,Pv=!1,ry=!1,z1=!1,Uv=0,Am=0,rg=0,Dg=0,j1=0,pv=0,iy=0,Xy=null,Ev=null,q1=!1,W1=0,K0=1/0,Y0=null,ig=null,Z0=!1,Ng=null,Ky=0,V1=0,$1=null,Yy=0,G1=null;function rv(){if((Rm&2)!==0&&um!==0)return um&-um;if(ip.T!==null){var st=Kg;return st!==0?st:tw()}return Tw()}function u2(){pv===0&&(pv=(um&536870912)===0||cm?Ew():536870912);var st=cv.current;return st!==null&&(st.flags|=32),pv}function Xm(st,rn,un){(st===gm&&ym===2||st.cancelPendingCommit!==null)&&(ay(st,0),Hv(st,um,pv,!1)),py(st,un),((Rm&2)===0||st!==gm)&&(st===gm&&((Rm&2)===0&&(Dg|=un),Am===4&&Hv(st,um,pv,!1)),Cv(st))}function l2(st,rn,un){if((Rm&6)!==0)throw Error(Ye(327));var cn=!un&&(rn&60)===0&&(rn&st.expiredLanes)===0||dy(st,rn),to=cn?SR(st,rn):Z1(st,rn,!0),fo=cn;do{if(to===0){ry&&!cn&&Hv(st,rn,0,!1);break}else if(to===6)Hv(st,rn,0,!Pv);else{if(un=st.current.alternate,fo&&!CR(un)){to=Z1(st,rn,!1),fo=!1;continue}if(to===2){if(fo=rn,st.errorRecoveryDisabledLanes&fo)var np=0;else np=st.pendingLanes&-536870913,np=np!==0?np:np&536870912?536870912:0;if(np!==0){rn=np;e:{var up=st;to=Xy;var pp=up.current.memoizedState.isDehydrated;if(pp&&(ay(up,np).flags|=256),np=Z1(up,np,!1),np!==2){if(z1&&!pp){up.errorRecoveryDisabledLanes|=fo,Dg|=fo,to=4;break e}fo=Ev,Ev=to,fo!==null&&X1(fo)}to=np}if(fo=!1,to!==2)continue}}if(to===1){ay(st,0),Hv(st,rn,0,!0);break}e:{switch(cn=st,to){case 0:case 1:throw Error(Ye(345));case 4:if((rn&4194176)===rn){Hv(cn,rn,pv,!Pv);break e}break;case 2:Ev=null;break;case 3:case 5:break;default:throw Error(Ye(329))}if(cn.finishedWork=un,cn.finishedLanes=rn,(rn&62914560)===rn&&(fo=W1+300-Em(),10<fo)){if(Hv(cn,rn,pv,!Pv),c0(cn,0)!==0)break e;cn.timeoutHandle=B2(c2.bind(null,cn,un,Ev,Y0,q1,rn,pv,Dg,iy,Pv,2,-0,0),fo);break e}c2(cn,un,Ev,Y0,q1,rn,pv,Dg,iy,Pv,0,-0,0)}}break}while(!0);Cv(st)}function X1(st){Ev===null?Ev=st:Ev.push.apply(Ev,st)}function c2(st,rn,un,cn,to,fo,np,up,pp,_p,Up,Wp,Dp){var Lp=rn.subtreeFlags;if((Lp&8192||(Lp&16785408)===16785408)&&(n0={stylesheets:null,count:0,unsuspend:aS},e2(rn),rn=sS(),rn!==null)){st.cancelPendingCommit=rn(g2.bind(null,st,un,cn,to,np,up,pp,1,Wp,Dp)),Hv(st,fo,np,!_p);return}g2(st,un,cn,to,np,up,pp,Up,Wp,Dp)}function CR(st){for(var rn=st;;){var un=rn.tag;if((un===0||un===11||un===15)&&rn.flags&16384&&(un=rn.updateQueue,un!==null&&(un=un.stores,un!==null)))for(var cn=0;cn<un.length;cn++){var to=un[cn],fo=to.getSnapshot;to=to.value;try{if(!Jm(fo(),to))return!1}catch{return!1}}if(un=rn.child,rn.subtreeFlags&16384&&un!==null)un.return=rn,rn=un;else{if(rn===st)break;for(;rn.sibling===null;){if(rn.return===null||rn.return===st)return!0;rn=rn.return}rn.sibling.return=rn.return,rn=rn.sibling}}return!0}function Hv(st,rn,un,cn){rn&=~j1,rn&=~Dg,st.suspendedLanes|=rn,st.pingedLanes&=~rn,cn&&(st.warmLanes|=rn),cn=st.expirationTimes;for(var to=rn;0<to;){var fo=31-om(to),np=1<<fo;cn[fo]=-1,to&=~np}un!==0&&Rw(st,un,rn)}function Q0(){return(Rm&6)===0?(Zy(0),!1):!0}function K1(){if(am!==null){if(ym===0)var st=am.return;else st=am,Ov=Rg=null,t1(st),Gg=null,ky=0,st=am;for(;st!==null;)s2(st.alternate,st),st=st.return;am=null}}function ay(st,rn){st.finishedWork=null,st.finishedLanes=0;var un=st.timeoutHandle;un!==-1&&(st.timeoutHandle=-1,qR(un)),un=st.cancelPendingCommit,un!==null&&(st.cancelPendingCommit=null,un()),K1(),gm=st,am=un=ng(st.current,null),um=rn,ym=0,nv=null,Pv=!1,ry=dy(st,rn),z1=!1,iy=pv=j1=Dg=rg=Am=0,Ev=Xy=null,q1=!1,(rn&8)!==0&&(rn|=rn&32);var cn=st.entangledLanes;if(cn!==0)for(st=st.entanglements,cn&=rn;0<cn;){var to=31-om(cn),fo=1<<to;rn|=st[to],cn&=~fo}return Uv=rn,_0(),un}function f2(st,rn){rm=null,ip.H=_v,rn===Dy?(rn=S_(),ym=3):rn===E_?(rn=S_(),ym=4):ym=rn===CE?8:rn!==null&&typeof rn=="object"&&typeof rn.then=="function"?6:1,nv=rn,am===null&&(Am=1,j0(st,sv(rn,st.current)))}function h2(){var st=ip.H;return ip.H=_v,st===null?_v:st}function d2(){var st=ip.A;return ip.A=_R,st}function Y1(){Am=4,Pv||(um&4194176)!==um&&cv.current!==null||(ry=!0),(rg&134217727)===0&&(Dg&134217727)===0||gm===null||Hv(gm,um,pv,!1)}function Z1(st,rn,un){var cn=Rm;Rm|=2;var to=h2(),fo=d2();(gm!==st||um!==rn)&&(Y0=null,ay(st,rn)),rn=!1;var np=Am;e:do try{if(ym!==0&&am!==null){var up=am,pp=nv;switch(ym){case 8:K1(),np=6;break e;case 3:case 2:case 6:cv.current===null&&(rn=!0);var _p=ym;if(ym=0,nv=null,oy(st,up,pp,_p),un&&ry){np=0;break e}break;default:_p=ym,ym=0,nv=null,oy(st,up,pp,_p)}}RR(),np=Am;break}catch(Up){f2(st,Up)}while(!0);return rn&&st.shellSuspendCounter++,Ov=Rg=null,Rm=cn,ip.H=to,ip.A=fo,am===null&&(gm=null,um=0,_0()),np}function RR(){for(;am!==null;)p2(am)}function SR(st,rn){var un=Rm;Rm|=2;var cn=h2(),to=d2();gm!==st||um!==rn?(Y0=null,K0=Em()+500,ay(st,rn)):ry=dy(st,rn);e:do try{if(ym!==0&&am!==null){rn=am;var fo=nv;t:switch(ym){case 1:ym=0,nv=null,oy(st,rn,fo,1);break;case 2:if(C_(fo)){ym=0,nv=null,m2(rn);break}rn=function(){ym===2&&gm===st&&(ym=7),Cv(st)},fo.then(rn,rn);break e;case 3:ym=7;break e;case 4:ym=5;break e;case 7:C_(fo)?(ym=0,nv=null,m2(rn)):(ym=0,nv=null,oy(st,rn,fo,7));break;case 5:var np=null;switch(am.tag){case 26:np=am.memoizedState;case 5:case 27:var up=am;if(!np||W2(np)){ym=0,nv=null;var pp=up.sibling;if(pp!==null)am=pp;else{var _p=up.return;_p!==null?(am=_p,J0(_p)):am=null}break t}}ym=0,nv=null,oy(st,rn,fo,5);break;case 6:ym=0,nv=null,oy(st,rn,fo,6);break;case 8:K1(),Am=6;break e;default:throw Error(Ye(462))}}AR();break}catch(Up){f2(st,Up)}while(!0);return Ov=Rg=null,ip.H=cn,ip.A=to,Rm=un,am!==null?0:(gm=null,um=0,_0(),Am)}function AR(){for(;am!==null&&!wm();)p2(am)}function p2(st){var rn=FE(st.alternate,st,Uv);st.memoizedProps=st.pendingProps,rn===null?J0(st):am=rn}function m2(st){var rn=st,un=rn.alternate;switch(rn.tag){case 15:case 0:rn=NE(un,rn,rn.pendingProps,rn.type,void 0,um);break;case 11:rn=NE(un,rn,rn.pendingProps,rn.type.render,rn.ref,um);break;case 5:t1(rn);default:s2(un,rn),rn=am=i2(rn,Uv),rn=FE(un,rn,Uv)}st.memoizedProps=st.pendingProps,rn===null?J0(st):am=rn}function oy(st,rn,un,cn){Ov=Rg=null,t1(rn),Gg=null,ky=0;var to=rn.return;try{if(mR(st,to,rn,un,um)){Am=1,j0(st,sv(un,st.current)),am=null;return}}catch(fo){if(to!==null)throw am=to,fo;Am=1,j0(st,sv(un,st.current)),am=null;return}rn.flags&32768?(cm||cn===1?st=!0:ry||(um&536870912)!==0?st=!1:(Pv=st=!0,(cn===2||cn===3||cn===6)&&(cn=cv.current,cn!==null&&cn.tag===13&&(cn.flags|=16384))),v2(rn,st)):J0(rn)}function J0(st){var rn=st;do{if((rn.flags&32768)!==0){v2(rn,Pv);return}st=rn.return;var un=xR(rn.alternate,rn,Uv);if(un!==null){am=un;return}if(rn=rn.sibling,rn!==null){am=rn;return}am=rn=st}while(rn!==null);Am===0&&(Am=5)}function v2(st,rn){do{var un=wR(st.alternate,st);if(un!==null){un.flags&=32767,am=un;return}if(un=st.return,un!==null&&(un.flags|=32768,un.subtreeFlags=0,un.deletions=null),!rn&&(st=st.sibling,st!==null)){am=st;return}am=st=un}while(st!==null);Am=6,am=null}function g2(st,rn,un,cn,to,fo,np,up,pp,_p){var Up=ip.T,Wp=zp.p;try{zp.p=2,ip.T=null,TR(st,rn,un,cn,Wp,to,fo,np,up,pp,_p)}finally{ip.T=Up,zp.p=Wp}}function TR(st,rn,un,cn,to,fo,np,up){do sy();while(Ng!==null);if((Rm&6)!==0)throw Error(Ye(327));var pp=st.finishedWork;if(cn=st.finishedLanes,pp===null)return null;if(st.finishedWork=null,st.finishedLanes=0,pp===st.current)throw Error(Ye(177));st.callbackNode=null,st.callbackPriority=0,st.cancelPendingCommit=null;var _p=pp.lanes|pp.childLanes;if(_p|=Hx,oC(st,cn,_p,fo,np,up),st===gm&&(am=gm=null,um=0),(pp.subtreeFlags&10256)===0&&(pp.flags&10256)===0||Z0||(Z0=!0,V1=_p,$1=un,OR(Uo,function(){return sy(),null})),un=(pp.flags&15990)!==0,(pp.subtreeFlags&15990)!==0||un?(un=ip.T,ip.T=null,fo=zp.p,zp.p=2,np=Rm,Rm|=4,gR(st,pp),ZE(pp,st),QC(lw,st.containerInfo),cx=!!uw,lw=uw=null,st.current=pp,GE(st,pp.alternate,pp),Mm(),Rm=np,zp.p=fo,ip.T=un):st.current=pp,Z0?(Z0=!1,Ng=st,Ky=cn):y2(st,_p),_p=st.pendingLanes,_p===0&&(ig=null),dm(pp.stateNode),Cv(st),rn!==null)for(to=st.onRecoverableError,pp=0;pp<rn.length;pp++)_p=rn[pp],to(_p.value,{componentStack:_p.stack});return(Ky&3)!==0&&sy(),_p=st.pendingLanes,(cn&4194218)!==0&&(_p&42)!==0?st===G1?Yy++:(Yy=0,G1=st):Yy=0,Zy(0),null}function y2(st,rn){(st.pooledCacheLanes&=rn)===0&&(rn=st.pooledCache,rn!=null&&(st.pooledCache=null,By(rn)))}function sy(){if(Ng!==null){var st=Ng,rn=V1;V1=0;var un=Aw(Ky),cn=ip.T,to=zp.p;try{if(zp.p=32>un?32:un,ip.T=null,Ng===null)var fo=!1;else{un=$1,$1=null;var np=Ng,up=Ky;if(Ng=null,Ky=0,(Rm&6)!==0)throw Error(Ye(331));var pp=Rm;if(Rm|=4,n2(np.current),JE(np,np.current,up,un),Rm=pp,Zy(0,!1),Qp&&typeof Qp.onPostCommitFiberRoot=="function")try{Qp.onPostCommitFiberRoot(Pp,np)}catch{}fo=!0}return fo}finally{zp.p=to,ip.T=cn,y2(st,rn)}}return!1}function b2(st,rn,un){rn=sv(un,rn),rn=m1(st.stateNode,rn,2),st=Qv(st,rn,2),st!==null&&(py(st,2),Cv(st))}function vm(st,rn,un){if(st.tag===3)b2(st,st,un);else for(;rn!==null;){if(rn.tag===3){b2(rn,st,un);break}else if(rn.tag===1){var cn=rn.stateNode;if(typeof rn.type.getDerivedStateFromError=="function"||typeof cn.componentDidCatch=="function"&&(ig===null||!ig.has(cn))){st=sv(un,st),un=_E(2),cn=Qv(rn,un,2),cn!==null&&(EE(un,cn,rn,st),py(cn,2),Cv(cn));break}}rn=rn.return}}function Q1(st,rn,un){var cn=st.pingCache;if(cn===null){cn=st.pingCache=new ER;var to=new Set;cn.set(rn,to)}else to=cn.get(rn),to===void 0&&(to=new Set,cn.set(rn,to));to.has(un)||(z1=!0,to.add(un),st=DR.bind(null,st,rn,un),rn.then(st,st))}function DR(st,rn,un){var cn=st.pingCache;cn!==null&&cn.delete(rn),st.pingedLanes|=st.suspendedLanes&un,st.warmLanes&=~un,gm===st&&(um&un)===un&&(Am===4||Am===3&&(um&62914560)===um&&300>Em()-W1?(Rm&2)===0&&ay(st,0):j1|=un,iy===um&&(iy=0)),Cv(st)}function x2(st,rn){rn===0&&(rn=Cw()),st=Wv(st,rn),st!==null&&(py(st,rn),Cv(st))}function NR(st){var rn=st.memoizedState,un=0;rn!==null&&(un=rn.retryLane),x2(st,un)}function kR(st,rn){var un=0;switch(st.tag){case 13:var cn=st.stateNode,to=st.memoizedState;to!==null&&(un=to.retryLane);break;case 19:cn=st.stateNode;break;case 22:cn=st.stateNode._retryCache;break;default:throw Error(Ye(314))}cn!==null&&cn.delete(rn),x2(st,un)}function OR(st,rn){return Wm(st,rn)}var _b=null,uy=null,J1=!1,ex=!1,ew=!1,kg=0;function Cv(st){st!==uy&&st.next===null&&(uy===null?_b=uy=st:uy=uy.next=st),ex=!0,J1||(J1=!0,MR(BR))}function Zy(st,rn){if(!ew&&ex){ew=!0;do for(var un=!1,cn=_b;cn!==null;){if(st!==0){var to=cn.pendingLanes;if(to===0)var fo=0;else{var np=cn.suspendedLanes,up=cn.pingedLanes;fo=(1<<31-om(42|st)+1)-1,fo&=to&~(np&~up),fo=fo&201326677?fo&201326677|1:fo?fo|2:0}fo!==0&&(un=!0,E2(cn,fo))}else fo=um,fo=c0(cn,cn===gm?fo:0),(fo&3)===0||dy(cn,fo)||(un=!0,E2(cn,fo));cn=cn.next}while(un);ew=!1}}function BR(){ex=J1=!1;var st=0;kg!==0&&(jR()&&(st=kg),kg=0);for(var rn=Em(),un=null,cn=_b;cn!==null;){var to=cn.next,fo=w2(cn,rn);fo===0?(cn.next=null,un===null?_b=to:un.next=to,to===null&&(uy=un)):(un=cn,(st!==0||(fo&3)!==0)&&(ex=!0)),cn=to}Zy(st)}function w2(st,rn){for(var un=st.suspendedLanes,cn=st.pingedLanes,to=st.expirationTimes,fo=st.pendingLanes&-62914561;0<fo;){var np=31-om(fo),up=1<<np,pp=to[np];pp===-1?((up&un)===0||(up&cn)!==0)&&(to[np]=aC(up,rn)):pp<=rn&&(st.expiredLanes|=up),fo&=~up}if(rn=gm,un=um,un=c0(st,st===rn?un:0),cn=st.callbackNode,un===0||st===rn&&ym===2||st.cancelPendingCommit!==null)return cn!==null&&cn!==null&&Nm(cn),st.callbackNode=null,st.callbackPriority=0;if((un&3)===0||dy(st,un)){if(rn=un&-un,rn===st.callbackPriority)return rn;switch(cn!==null&&Nm(cn),Aw(un)){case 2:case 8:un=ap;break;case 32:un=Uo;break;case 268435456:un=dp;break;default:un=Uo}return cn=_2.bind(null,st),un=Wm(un,cn),st.callbackPriority=rn,st.callbackNode=un,rn}return cn!==null&&cn!==null&&Nm(cn),st.callbackPriority=2,st.callbackNode=null,2}function _2(st,rn){var un=st.callbackNode;if(sy()&&st.callbackNode!==un)return null;var cn=um;return cn=c0(st,st===gm?cn:0),cn===0?null:(l2(st,cn,rn),w2(st,Em()),st.callbackNode!=null&&st.callbackNode===un?_2.bind(null,st):null)}function E2(st,rn){if(sy())return null;l2(st,rn,!0)}function MR(st){WR(function(){(Rm&6)!==0?Wm(Km,st):st()})}function tw(){return kg===0&&(kg=Ew()),kg}function C2(st){return st==null||typeof st=="symbol"||typeof st=="boolean"?null:typeof st=="function"?st:m0(""+st)}function R2(st,rn){var un=rn.ownerDocument.createElement("input");return un.name=rn.name,un.value=rn.value,st.id&&un.setAttribute("form",st.id),rn.parentNode.insertBefore(un,rn),st=new FormData(st),un.parentNode.removeChild(un),st}function IR(st,rn,un,cn,to){if(rn==="submit"&&un&&un.stateNode===to){var fo=C2((to[Ym]||null).action),np=cn.submitter;np&&(rn=(rn=np[Ym]||null)?C2(rn.formAction):np.getAttribute("formAction"),rn!==null&&(fo=rn,np=null));var up=new b0("action","action",null,cn,to);st.push({event:up,listeners:[{instance:null,listener:function(){if(cn.defaultPrevented){if(kg!==0){var pp=np?R2(to,np):new FormData(to);c1(un,{pending:!0,data:pp,method:to.method,action:fo},null,pp)}}else typeof fo=="function"&&(up.preventDefault(),pp=np?R2(to,np):new FormData(to),c1(un,{pending:!0,data:pp,method:to.method,action:fo},fo,pp))},currentTarget:to}]})}}for(var nw=0;nw<g_.length;nw++){var rw=g_[nw],FR=rw.toLowerCase(),LR=rw[0].toUpperCase()+rw.slice(1);vv(FR,"on"+LR)}vv(h_,"onAnimationEnd"),vv(d_,"onAnimationIteration"),vv(p_,"onAnimationStart"),vv("dblclick","onDoubleClick"),vv("focusin","onFocus"),vv("focusout","onBlur"),vv(eR,"onTransitionRun"),vv(tR,"onTransitionStart"),vv(nR,"onTransitionCancel"),vv(m_,"onTransitionEnd"),Ig("onMouseEnter",["mouseout","mouseover"]),Ig("onMouseLeave",["mouseout","mouseover"]),Ig("onPointerEnter",["pointerout","pointerover"]),Ig("onPointerLeave",["pointerout","pointerover"]),hg("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),hg("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),hg("onBeforeInput",["compositionend","keypress","textInput","paste"]),hg("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),hg("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),hg("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Qy="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),PR=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Qy));function S2(st,rn){rn=(rn&4)!==0;for(var un=0;un<st.length;un++){var cn=st[un],to=cn.event;cn=cn.listeners;e:{var fo=void 0;if(rn)for(var np=cn.length-1;0<=np;np--){var up=cn[np],pp=up.instance,_p=up.currentTarget;if(up=up.listener,pp!==fo&&to.isPropagationStopped())break e;fo=up,to.currentTarget=_p;try{fo(to)}catch(Up){z0(Up)}to.currentTarget=null,fo=pp}else for(np=0;np<cn.length;np++){if(up=cn[np],pp=up.instance,_p=up.currentTarget,up=up.listener,pp!==fo&&to.isPropagationStopped())break e;fo=up,to.currentTarget=_p;try{fo(to)}catch(Up){z0(Up)}to.currentTarget=null,fo=pp}}}}function sm(st,rn){var un=rn[bx];un===void 0&&(un=rn[bx]=new Set);var cn=st+"__bubble";un.has(cn)||(A2(rn,st,2,!1),un.add(cn))}function iw(st,rn,un){var cn=0;rn&&(cn|=4),A2(un,st,cn,rn)}var tx="_reactListening"+Math.random().toString(36).slice(2);function aw(st){if(!st[tx]){st[tx]=!0,Nw.forEach(function(un){un!=="selectionchange"&&(PR.has(un)||iw(un,!1,st),iw(un,!0,st))});var rn=st.nodeType===9?st:st.ownerDocument;rn===null||rn[tx]||(rn[tx]=!0,iw("selectionchange",!1,rn))}}function A2(st,rn,un,cn){switch(Y2(rn)){case 2:var to=cS;break;case 8:to=fS;break;default:to=yw}un=to.bind(null,rn,un,st),to=void 0,!Ax||rn!=="touchstart"&&rn!=="touchmove"&&rn!=="wheel"||(to=!0),cn?to!==void 0?st.addEventListener(rn,un,{capture:!0,passive:to}):st.addEventListener(rn,un,!0):to!==void 0?st.addEventListener(rn,un,{passive:to}):st.addEventListener(rn,un,!1)}function ow(st,rn,un,cn,to){var fo=cn;if((rn&1)===0&&(rn&2)===0&&cn!==null)e:for(;;){if(cn===null)return;var np=cn.tag;if(np===3||np===4){var up=cn.stateNode.containerInfo;if(up===to||up.nodeType===8&&up.parentNode===to)break;if(np===4)for(np=cn.return;np!==null;){var pp=np.tag;if((pp===3||pp===4)&&(pp=np.stateNode.containerInfo,pp===to||pp.nodeType===8&&pp.parentNode===to))return;np=np.return}for(;up!==null;){if(np=fg(up),np===null)return;if(pp=np.tag,pp===5||pp===6||pp===26||pp===27){cn=fo=np;continue e}up=up.parentNode}}cn=cn.return}jw(function(){var _p=fo,Up=Rx(un),Wp=[];e:{var Dp=v_.get(st);if(Dp!==void 0){var Lp=b0,Yp=st;switch(st){case"keypress":if(g0(un)===0)break e;case"keydown":case"keyup":Lp=kC;break;case"focusin":Yp="focus",Lp=kx;break;case"focusout":Yp="blur",Lp=kx;break;case"beforeblur":case"afterblur":Lp=kx;break;case"click":if(un.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Lp=Vw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Lp=bC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Lp=MC;break;case h_:case d_:case p_:Lp=_C;break;case m_:Lp=FC;break;case"scroll":case"scrollend":Lp=gC;break;case"wheel":Lp=PC;break;case"copy":case"cut":case"paste":Lp=CC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Lp=Gw;break;case"toggle":case"beforetoggle":Lp=HC}var nm=(rn&4)!==0,Tm=!nm&&(st==="scroll"||st==="scrollend"),Rp=nm?Dp!==null?Dp+"Capture":null:Dp;nm=[];for(var bp=_p,Ap;bp!==null;){var jp=bp;if(Ap=jp.stateNode,jp=jp.tag,jp!==5&&jp!==26&&jp!==27||Ap===null||Rp===null||(jp=gy(bp,Rp),jp!=null&&nm.push(Jy(bp,jp,Ap))),Tm)break;bp=bp.return}0<nm.length&&(Dp=new Lp(Dp,Yp,null,un,Up),Wp.push({event:Dp,listeners:nm}))}}if((rn&7)===0){e:{if(Dp=st==="mouseover"||st==="pointerover",Lp=st==="mouseout"||st==="pointerout",Dp&&un!==Cx&&(Yp=un.relatedTarget||un.fromElement)&&(fg(Yp)||Yp[Og]))break e;if((Lp||Dp)&&(Dp=Up.window===Up?Up:(Dp=Up.ownerDocument)?Dp.defaultView||Dp.parentWindow:window,Lp?(Yp=un.relatedTarget||un.toElement,Lp=_p,Yp=Yp?fg(Yp):null,Yp!==null&&(Tm=Cp(Yp),nm=Yp.tag,Yp!==Tm||nm!==5&&nm!==27&&nm!==6)&&(Yp=null)):(Lp=null,Yp=_p),Lp!==Yp)){if(nm=Vw,jp="onMouseLeave",Rp="onMouseEnter",bp="mouse",(st==="pointerout"||st==="pointerover")&&(nm=Gw,jp="onPointerLeave",Rp="onPointerEnter",bp="pointer"),Tm=Lp==null?Dp:vy(Lp),Ap=Yp==null?Dp:vy(Yp),Dp=new nm(jp,bp+"leave",Lp,un,Up),Dp.target=Tm,Dp.relatedTarget=Ap,jp=null,fg(Up)===_p&&(nm=new nm(Rp,bp+"enter",Yp,un,Up),nm.target=Ap,nm.relatedTarget=Tm,jp=nm),Tm=jp,Lp&&Yp)t:{for(nm=Lp,Rp=Yp,bp=0,Ap=nm;Ap;Ap=ly(Ap))bp++;for(Ap=0,jp=Rp;jp;jp=ly(jp))Ap++;for(;0<bp-Ap;)nm=ly(nm),bp--;for(;0<Ap-bp;)Rp=ly(Rp),Ap--;for(;bp--;){if(nm===Rp||Rp!==null&&nm===Rp.alternate)break t;nm=ly(nm),Rp=ly(Rp)}nm=null}else nm=null;Lp!==null&&T2(Wp,Dp,Lp,nm,!1),Yp!==null&&Tm!==null&&T2(Wp,Tm,Yp,nm,!0)}}e:{if(Dp=_p?vy(_p):window,Lp=Dp.nodeName&&Dp.nodeName.toLowerCase(),Lp==="select"||Lp==="input"&&Dp.type==="file")var Kp=t_;else if(Jw(Dp))if(n_)Kp=YC;else{Kp=XC;var im=GC}else Lp=Dp.nodeName,!Lp||Lp.toLowerCase()!=="input"||Dp.type!=="checkbox"&&Dp.type!=="radio"?_p&&Ex(_p.elementType)&&(Kp=t_):Kp=KC;if(Kp&&(Kp=Kp(st,_p))){e_(Wp,Kp,un,Up);break e}im&&im(st,Dp,_p),st==="focusout"&&_p&&Dp.type==="number"&&_p.memoizedProps.value!=null&&_x(Dp,"number",Dp.value)}switch(im=_p?vy(_p):window,st){case"focusin":(Jw(im)||im.contentEditable==="true")&&(zg=im,Lx=_p,Ry=null);break;case"focusout":Ry=Lx=zg=null;break;case"mousedown":Px=!0;break;case"contextmenu":case"mouseup":case"dragend":Px=!1,c_(Wp,un,Up);break;case"selectionchange":if(JC)break;case"keydown":case"keyup":c_(Wp,un,Up)}var Zp;if(Bx)e:{switch(st){case"compositionstart":var em="onCompositionStart";break e;case"compositionend":em="onCompositionEnd";break e;case"compositionupdate":em="onCompositionUpdate";break e}em=void 0}else Hg?Zw(st,un)&&(em="onCompositionEnd"):st==="keydown"&&un.keyCode===229&&(em="onCompositionStart");em&&(Xw&&un.locale!=="ko"&&(Hg||em!=="onCompositionStart"?em==="onCompositionEnd"&&Hg&&(Zp=qw()):(qv=Up,Tx="value"in qv?qv.value:qv.textContent,Hg=!0)),im=nx(_p,em),0<im.length&&(em=new $w(em,st,null,un,Up),Wp.push({event:em,listeners:im}),Zp?em.data=Zp:(Zp=Qw(un),Zp!==null&&(em.data=Zp)))),(Zp=jC?qC(st,un):WC(st,un))&&(em=nx(_p,"onBeforeInput"),0<em.length&&(im=new $w("onBeforeInput","beforeinput",null,un,Up),Wp.push({event:im,listeners:em}),im.data=Zp)),IR(Wp,st,_p,un,Up)}S2(Wp,rn)})}function Jy(st,rn,un){return{instance:st,listener:rn,currentTarget:un}}function nx(st,rn){for(var un=rn+"Capture",cn=[];st!==null;){var to=st,fo=to.stateNode;to=to.tag,to!==5&&to!==26&&to!==27||fo===null||(to=gy(st,un),to!=null&&cn.unshift(Jy(st,to,fo)),to=gy(st,rn),to!=null&&cn.push(Jy(st,to,fo))),st=st.return}return cn}function ly(st){if(st===null)return null;do st=st.return;while(st&&st.tag!==5&&st.tag!==27);return st||null}function T2(st,rn,un,cn,to){for(var fo=rn._reactName,np=[];un!==null&&un!==cn;){var up=un,pp=up.alternate,_p=up.stateNode;if(up=up.tag,pp!==null&&pp===cn)break;up!==5&&up!==26&&up!==27||_p===null||(pp=_p,to?(_p=gy(un,fo),_p!=null&&np.unshift(Jy(un,_p,pp))):to||(_p=gy(un,fo),_p!=null&&np.push(Jy(un,_p,pp)))),un=un.return}np.length!==0&&st.push({event:rn,listeners:np})}var UR=/\r\n?/g,HR=/\u0000|\uFFFD/g;function D2(st){return(typeof st=="string"?st:""+st).replace(UR,`
`).replace(HR,"")}function N2(st,rn){return rn=D2(rn),D2(st)===rn}function rx(){}function mm(st,rn,un,cn,to,fo){switch(un){case"children":typeof cn=="string"?rn==="body"||rn==="textarea"&&cn===""||Lg(st,cn):(typeof cn=="number"||typeof cn=="bigint")&&rn!=="body"&&Lg(st,""+cn);break;case"className":h0(st,"class",cn);break;case"tabIndex":h0(st,"tabindex",cn);break;case"dir":case"role":case"viewBox":case"width":case"height":h0(st,un,cn);break;case"style":Hw(st,cn,fo);break;case"data":if(rn!=="object"){h0(st,"data",cn);break}case"src":case"href":if(cn===""&&(rn!=="a"||un!=="href")){st.removeAttribute(un);break}if(cn==null||typeof cn=="function"||typeof cn=="symbol"||typeof cn=="boolean"){st.removeAttribute(un);break}cn=m0(""+cn),st.setAttribute(un,cn);break;case"action":case"formAction":if(typeof cn=="function"){st.setAttribute(un,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof fo=="function"&&(un==="formAction"?(rn!=="input"&&mm(st,rn,"name",to.name,to,null),mm(st,rn,"formEncType",to.formEncType,to,null),mm(st,rn,"formMethod",to.formMethod,to,null),mm(st,rn,"formTarget",to.formTarget,to,null)):(mm(st,rn,"encType",to.encType,to,null),mm(st,rn,"method",to.method,to,null),mm(st,rn,"target",to.target,to,null)));if(cn==null||typeof cn=="symbol"||typeof cn=="boolean"){st.removeAttribute(un);break}cn=m0(""+cn),st.setAttribute(un,cn);break;case"onClick":cn!=null&&(st.onclick=rx);break;case"onScroll":cn!=null&&sm("scroll",st);break;case"onScrollEnd":cn!=null&&sm("scrollend",st);break;case"dangerouslySetInnerHTML":if(cn!=null){if(typeof cn!="object"||!("__html"in cn))throw Error(Ye(61));if(un=cn.__html,un!=null){if(to.children!=null)throw Error(Ye(60));st.innerHTML=un}}break;case"multiple":st.multiple=cn&&typeof cn!="function"&&typeof cn!="symbol";break;case"muted":st.muted=cn&&typeof cn!="function"&&typeof cn!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(cn==null||typeof cn=="function"||typeof cn=="boolean"||typeof cn=="symbol"){st.removeAttribute("xlink:href");break}un=m0(""+cn),st.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",un);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":cn!=null&&typeof cn!="function"&&typeof cn!="symbol"?st.setAttribute(un,""+cn):st.removeAttribute(un);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":cn&&typeof cn!="function"&&typeof cn!="symbol"?st.setAttribute(un,""):st.removeAttribute(un);break;case"capture":case"download":cn===!0?st.setAttribute(un,""):cn!==!1&&cn!=null&&typeof cn!="function"&&typeof cn!="symbol"?st.setAttribute(un,cn):st.removeAttribute(un);break;case"cols":case"rows":case"size":case"span":cn!=null&&typeof cn!="function"&&typeof cn!="symbol"&&!isNaN(cn)&&1<=cn?st.setAttribute(un,cn):st.removeAttribute(un);break;case"rowSpan":case"start":cn==null||typeof cn=="function"||typeof cn=="symbol"||isNaN(cn)?st.removeAttribute(un):st.setAttribute(un,cn);break;case"popover":sm("beforetoggle",st),sm("toggle",st),f0(st,"popover",cn);break;case"xlinkActuate":Sv(st,"http://www.w3.org/1999/xlink","xlink:actuate",cn);break;case"xlinkArcrole":Sv(st,"http://www.w3.org/1999/xlink","xlink:arcrole",cn);break;case"xlinkRole":Sv(st,"http://www.w3.org/1999/xlink","xlink:role",cn);break;case"xlinkShow":Sv(st,"http://www.w3.org/1999/xlink","xlink:show",cn);break;case"xlinkTitle":Sv(st,"http://www.w3.org/1999/xlink","xlink:title",cn);break;case"xlinkType":Sv(st,"http://www.w3.org/1999/xlink","xlink:type",cn);break;case"xmlBase":Sv(st,"http://www.w3.org/XML/1998/namespace","xml:base",cn);break;case"xmlLang":Sv(st,"http://www.w3.org/XML/1998/namespace","xml:lang",cn);break;case"xmlSpace":Sv(st,"http://www.w3.org/XML/1998/namespace","xml:space",cn);break;case"is":f0(st,"is",cn);break;case"innerText":case"textContent":break;default:(!(2<un.length)||un[0]!=="o"&&un[0]!=="O"||un[1]!=="n"&&un[1]!=="N")&&(un=mC.get(un)||un,f0(st,un,cn))}}function sw(st,rn,un,cn,to,fo){switch(un){case"style":Hw(st,cn,fo);break;case"dangerouslySetInnerHTML":if(cn!=null){if(typeof cn!="object"||!("__html"in cn))throw Error(Ye(61));if(un=cn.__html,un!=null){if(to.children!=null)throw Error(Ye(60));st.innerHTML=un}}break;case"children":typeof cn=="string"?Lg(st,cn):(typeof cn=="number"||typeof cn=="bigint")&&Lg(st,""+cn);break;case"onScroll":cn!=null&&sm("scroll",st);break;case"onScrollEnd":cn!=null&&sm("scrollend",st);break;case"onClick":cn!=null&&(st.onclick=rx);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!kw.hasOwnProperty(un))e:{if(un[0]==="o"&&un[1]==="n"&&(to=un.endsWith("Capture"),rn=un.slice(2,to?un.length-7:void 0),fo=st[Ym]||null,fo=fo!=null?fo[un]:null,typeof fo=="function"&&st.removeEventListener(rn,fo,to),typeof cn=="function")){typeof fo!="function"&&fo!==null&&(un in st?st[un]=null:st.hasAttribute(un)&&st.removeAttribute(un)),st.addEventListener(rn,cn,to);break e}un in st?st[un]=cn:cn===!0?st.setAttribute(un,""):f0(st,un,cn)}}}function qm(st,rn,un){switch(rn){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":sm("error",st),sm("load",st);var cn=!1,to=!1,fo;for(fo in un)if(un.hasOwnProperty(fo)){var np=un[fo];if(np!=null)switch(fo){case"src":cn=!0;break;case"srcSet":to=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(Ye(137,rn));default:mm(st,rn,fo,np,un,null)}}to&&mm(st,rn,"srcSet",un.srcSet,un,null),cn&&mm(st,rn,"src",un.src,un,null);return;case"input":sm("invalid",st);var up=fo=np=to=null,pp=null,_p=null;for(cn in un)if(un.hasOwnProperty(cn)){var Up=un[cn];if(Up!=null)switch(cn){case"name":to=Up;break;case"type":np=Up;break;case"checked":pp=Up;break;case"defaultChecked":_p=Up;break;case"value":fo=Up;break;case"defaultValue":up=Up;break;case"children":case"dangerouslySetInnerHTML":if(Up!=null)throw Error(Ye(137,rn));break;default:mm(st,rn,cn,Up,un,null)}}Fw(st,fo,up,pp,_p,np,to,!1),d0(st);return;case"select":sm("invalid",st),cn=np=fo=null;for(to in un)if(un.hasOwnProperty(to)&&(up=un[to],up!=null))switch(to){case"value":fo=up;break;case"defaultValue":np=up;break;case"multiple":cn=up;default:mm(st,rn,to,up,un,null)}rn=fo,un=np,st.multiple=!!cn,rn!=null?Fg(st,!!cn,rn,!1):un!=null&&Fg(st,!!cn,un,!0);return;case"textarea":sm("invalid",st),fo=to=cn=null;for(np in un)if(un.hasOwnProperty(np)&&(up=un[np],up!=null))switch(np){case"value":cn=up;break;case"defaultValue":to=up;break;case"children":fo=up;break;case"dangerouslySetInnerHTML":if(up!=null)throw Error(Ye(91));break;default:mm(st,rn,np,up,un,null)}Pw(st,cn,to,fo),d0(st);return;case"option":for(pp in un)if(un.hasOwnProperty(pp)&&(cn=un[pp],cn!=null))switch(pp){case"selected":st.selected=cn&&typeof cn!="function"&&typeof cn!="symbol";break;default:mm(st,rn,pp,cn,un,null)}return;case"dialog":sm("cancel",st),sm("close",st);break;case"iframe":case"object":sm("load",st);break;case"video":case"audio":for(cn=0;cn<Qy.length;cn++)sm(Qy[cn],st);break;case"image":sm("error",st),sm("load",st);break;case"details":sm("toggle",st);break;case"embed":case"source":case"link":sm("error",st),sm("load",st);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(_p in un)if(un.hasOwnProperty(_p)&&(cn=un[_p],cn!=null))switch(_p){case"children":case"dangerouslySetInnerHTML":throw Error(Ye(137,rn));default:mm(st,rn,_p,cn,un,null)}return;default:if(Ex(rn)){for(Up in un)un.hasOwnProperty(Up)&&(cn=un[Up],cn!==void 0&&sw(st,rn,Up,cn,un,void 0));return}}for(up in un)un.hasOwnProperty(up)&&(cn=un[up],cn!=null&&mm(st,rn,up,cn,un,null))}function zR(st,rn,un,cn){switch(rn){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var to=null,fo=null,np=null,up=null,pp=null,_p=null,Up=null;for(Lp in un){var Wp=un[Lp];if(un.hasOwnProperty(Lp)&&Wp!=null)switch(Lp){case"checked":break;case"value":break;case"defaultValue":pp=Wp;default:cn.hasOwnProperty(Lp)||mm(st,rn,Lp,null,cn,Wp)}}for(var Dp in cn){var Lp=cn[Dp];if(Wp=un[Dp],cn.hasOwnProperty(Dp)&&(Lp!=null||Wp!=null))switch(Dp){case"type":fo=Lp;break;case"name":to=Lp;break;case"checked":_p=Lp;break;case"defaultChecked":Up=Lp;break;case"value":np=Lp;break;case"defaultValue":up=Lp;break;case"children":case"dangerouslySetInnerHTML":if(Lp!=null)throw Error(Ye(137,rn));break;default:Lp!==Wp&&mm(st,rn,Dp,Lp,cn,Wp)}}wx(st,np,up,pp,_p,Up,fo,to);return;case"select":Lp=np=up=Dp=null;for(fo in un)if(pp=un[fo],un.hasOwnProperty(fo)&&pp!=null)switch(fo){case"value":break;case"multiple":Lp=pp;default:cn.hasOwnProperty(fo)||mm(st,rn,fo,null,cn,pp)}for(to in cn)if(fo=cn[to],pp=un[to],cn.hasOwnProperty(to)&&(fo!=null||pp!=null))switch(to){case"value":Dp=fo;break;case"defaultValue":up=fo;break;case"multiple":np=fo;default:fo!==pp&&mm(st,rn,to,fo,cn,pp)}rn=up,un=np,cn=Lp,Dp!=null?Fg(st,!!un,Dp,!1):!!cn!=!!un&&(rn!=null?Fg(st,!!un,rn,!0):Fg(st,!!un,un?[]:"",!1));return;case"textarea":Lp=Dp=null;for(up in un)if(to=un[up],un.hasOwnProperty(up)&&to!=null&&!cn.hasOwnProperty(up))switch(up){case"value":break;case"children":break;default:mm(st,rn,up,null,cn,to)}for(np in cn)if(to=cn[np],fo=un[np],cn.hasOwnProperty(np)&&(to!=null||fo!=null))switch(np){case"value":Dp=to;break;case"defaultValue":Lp=to;break;case"children":break;case"dangerouslySetInnerHTML":if(to!=null)throw Error(Ye(91));break;default:to!==fo&&mm(st,rn,np,to,cn,fo)}Lw(st,Dp,Lp);return;case"option":for(var Yp in un)if(Dp=un[Yp],un.hasOwnProperty(Yp)&&Dp!=null&&!cn.hasOwnProperty(Yp))switch(Yp){case"selected":st.selected=!1;break;default:mm(st,rn,Yp,null,cn,Dp)}for(pp in cn)if(Dp=cn[pp],Lp=un[pp],cn.hasOwnProperty(pp)&&Dp!==Lp&&(Dp!=null||Lp!=null))switch(pp){case"selected":st.selected=Dp&&typeof Dp!="function"&&typeof Dp!="symbol";break;default:mm(st,rn,pp,Dp,cn,Lp)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var nm in un)Dp=un[nm],un.hasOwnProperty(nm)&&Dp!=null&&!cn.hasOwnProperty(nm)&&mm(st,rn,nm,null,cn,Dp);for(_p in cn)if(Dp=cn[_p],Lp=un[_p],cn.hasOwnProperty(_p)&&Dp!==Lp&&(Dp!=null||Lp!=null))switch(_p){case"children":case"dangerouslySetInnerHTML":if(Dp!=null)throw Error(Ye(137,rn));break;default:mm(st,rn,_p,Dp,cn,Lp)}return;default:if(Ex(rn)){for(var Tm in un)Dp=un[Tm],un.hasOwnProperty(Tm)&&Dp!==void 0&&!cn.hasOwnProperty(Tm)&&sw(st,rn,Tm,void 0,cn,Dp);for(Up in cn)Dp=cn[Up],Lp=un[Up],!cn.hasOwnProperty(Up)||Dp===Lp||Dp===void 0&&Lp===void 0||sw(st,rn,Up,Dp,cn,Lp);return}}for(var Rp in un)Dp=un[Rp],un.hasOwnProperty(Rp)&&Dp!=null&&!cn.hasOwnProperty(Rp)&&mm(st,rn,Rp,null,cn,Dp);for(Wp in cn)Dp=cn[Wp],Lp=un[Wp],!cn.hasOwnProperty(Wp)||Dp===Lp||Dp==null&&Lp==null||mm(st,rn,Wp,Dp,cn,Lp)}var uw=null,lw=null;function ix(st){return st.nodeType===9?st:st.ownerDocument}function k2(st){switch(st){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function O2(st,rn){if(st===0)switch(rn){case"svg":return 1;case"math":return 2;default:return 0}return st===1&&rn==="foreignObject"?0:st}function cw(st,rn){return st==="textarea"||st==="noscript"||typeof rn.children=="string"||typeof rn.children=="number"||typeof rn.children=="bigint"||typeof rn.dangerouslySetInnerHTML=="object"&&rn.dangerouslySetInnerHTML!==null&&rn.dangerouslySetInnerHTML.__html!=null}var fw=null;function jR(){var st=window.event;return st&&st.type==="popstate"?st===fw?!1:(fw=st,!0):(fw=null,!1)}var B2=typeof setTimeout=="function"?setTimeout:void 0,qR=typeof clearTimeout=="function"?clearTimeout:void 0,M2=typeof Promise=="function"?Promise:void 0,WR=typeof queueMicrotask=="function"?queueMicrotask:typeof M2<"u"?function(st){return M2.resolve(null).then(st).catch(VR)}:B2;function VR(st){setTimeout(function(){throw st})}function hw(st,rn){var un=rn,cn=0;do{var to=un.nextSibling;if(st.removeChild(un),to&&to.nodeType===8)if(un=to.data,un==="/$"){if(cn===0){st.removeChild(to),s0(rn);return}cn--}else un!=="$"&&un!=="$?"&&un!=="$!"||cn++;un=to}while(un);s0(rn)}function dw(st){var rn=st.firstChild;for(rn&&rn.nodeType===10&&(rn=rn.nextSibling);rn;){var un=rn;switch(rn=rn.nextSibling,un.nodeName){case"HTML":case"HEAD":case"BODY":dw(un),xx(un);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(un.rel.toLowerCase()==="stylesheet")continue}st.removeChild(un)}}function $R(st,rn,un,cn){for(;st.nodeType===1;){var to=un;if(st.nodeName.toLowerCase()!==rn.toLowerCase()){if(!cn&&(st.nodeName!=="INPUT"||st.type!=="hidden"))break}else if(cn){if(!st[my])switch(rn){case"meta":if(!st.hasAttribute("itemprop"))break;return st;case"link":if(fo=st.getAttribute("rel"),fo==="stylesheet"&&st.hasAttribute("data-precedence"))break;if(fo!==to.rel||st.getAttribute("href")!==(to.href==null?null:to.href)||st.getAttribute("crossorigin")!==(to.crossOrigin==null?null:to.crossOrigin)||st.getAttribute("title")!==(to.title==null?null:to.title))break;return st;case"style":if(st.hasAttribute("data-precedence"))break;return st;case"script":if(fo=st.getAttribute("src"),(fo!==(to.src==null?null:to.src)||st.getAttribute("type")!==(to.type==null?null:to.type)||st.getAttribute("crossorigin")!==(to.crossOrigin==null?null:to.crossOrigin))&&fo&&st.hasAttribute("async")&&!st.hasAttribute("itemprop"))break;return st;default:return st}}else if(rn==="input"&&st.type==="hidden"){var fo=to.name==null?null:""+to.name;if(to.type==="hidden"&&st.getAttribute("name")===fo)return st}else return st;if(st=bv(st.nextSibling),st===null)break}return null}function GR(st,rn,un){if(rn==="")return null;for(;st.nodeType!==3;)if((st.nodeType!==1||st.nodeName!=="INPUT"||st.type!=="hidden")&&!un||(st=bv(st.nextSibling),st===null))return null;return st}function bv(st){for(;st!=null;st=st.nextSibling){var rn=st.nodeType;if(rn===1||rn===3)break;if(rn===8){if(rn=st.data,rn==="$"||rn==="$!"||rn==="$?"||rn==="F!"||rn==="F")break;if(rn==="/$")return null}}return st}function I2(st){st=st.previousSibling;for(var rn=0;st;){if(st.nodeType===8){var un=st.data;if(un==="$"||un==="$!"||un==="$?"){if(rn===0)return st;rn--}else un==="/$"&&rn++}st=st.previousSibling}return null}function F2(st,rn,un){switch(rn=ix(un),st){case"html":if(st=rn.documentElement,!st)throw Error(Ye(452));return st;case"head":if(st=rn.head,!st)throw Error(Ye(453));return st;case"body":if(st=rn.body,!st)throw Error(Ye(454));return st;default:throw Error(Ye(451))}}var mv=new Map,L2=new Set;function ax(st){return typeof st.getRootNode=="function"?st.getRootNode():st.ownerDocument}var zv=zp.d;zp.d={f:XR,r:KR,D:YR,C:ZR,L:QR,m:JR,X:tS,S:eS,M:nS};function XR(){var st=zv.f(),rn=Q0();return st||rn}function KR(st){var rn=Bg(st);rn!==null&&rn.tag===5&&rn.type==="form"?cE(rn):zv.r(st)}var cy=typeof document>"u"?null:document;function P2(st,rn,un){var cn=cy;if(cn&&typeof rn=="string"&&rn){var to=av(rn);to='link[rel="'+st+'"][href="'+to+'"]',typeof un=="string"&&(to+='[crossorigin="'+un+'"]'),L2.has(to)||(L2.add(to),st={rel:st,crossOrigin:un,href:rn},cn.querySelector(to)===null&&(rn=cn.createElement("link"),qm(rn,"link",st),Lm(rn),cn.head.appendChild(rn)))}}function YR(st){zv.D(st),P2("dns-prefetch",st,null)}function ZR(st,rn){zv.C(st,rn),P2("preconnect",st,rn)}function QR(st,rn,un){zv.L(st,rn,un);var cn=cy;if(cn&&st&&rn){var to='link[rel="preload"][as="'+av(rn)+'"]';rn==="image"&&un&&un.imageSrcSet?(to+='[imagesrcset="'+av(un.imageSrcSet)+'"]',typeof un.imageSizes=="string"&&(to+='[imagesizes="'+av(un.imageSizes)+'"]')):to+='[href="'+av(st)+'"]';var fo=to;switch(rn){case"style":fo=fy(st);break;case"script":fo=hy(st)}mv.has(fo)||(st=lp({rel:"preload",href:rn==="image"&&un&&un.imageSrcSet?void 0:st,as:rn},un),mv.set(fo,st),cn.querySelector(to)!==null||rn==="style"&&cn.querySelector(e0(fo))||rn==="script"&&cn.querySelector(t0(fo))||(rn=cn.createElement("link"),qm(rn,"link",st),Lm(rn),cn.head.appendChild(rn)))}}function JR(st,rn){zv.m(st,rn);var un=cy;if(un&&st){var cn=rn&&typeof rn.as=="string"?rn.as:"script",to='link[rel="modulepreload"][as="'+av(cn)+'"][href="'+av(st)+'"]',fo=to;switch(cn){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":fo=hy(st)}if(!mv.has(fo)&&(st=lp({rel:"modulepreload",href:st},rn),mv.set(fo,st),un.querySelector(to)===null)){switch(cn){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(un.querySelector(t0(fo)))return}cn=un.createElement("link"),qm(cn,"link",st),Lm(cn),un.head.appendChild(cn)}}}function eS(st,rn,un){zv.S(st,rn,un);var cn=cy;if(cn&&st){var to=Mg(cn).hoistableStyles,fo=fy(st);rn=rn||"default";var np=to.get(fo);if(!np){var up={loading:0,preload:null};if(np=cn.querySelector(e0(fo)))up.loading=5;else{st=lp({rel:"stylesheet",href:st,"data-precedence":rn},un),(un=mv.get(fo))&&pw(st,un);var pp=np=cn.createElement("link");Lm(pp),qm(pp,"link",st),pp._p=new Promise(function(_p,Up){pp.onload=_p,pp.onerror=Up}),pp.addEventListener("load",function(){up.loading|=1}),pp.addEventListener("error",function(){up.loading|=2}),up.loading|=4,ox(np,rn,cn)}np={type:"stylesheet",instance:np,count:1,state:up},to.set(fo,np)}}}function tS(st,rn){zv.X(st,rn);var un=cy;if(un&&st){var cn=Mg(un).hoistableScripts,to=hy(st),fo=cn.get(to);fo||(fo=un.querySelector(t0(to)),fo||(st=lp({src:st,async:!0},rn),(rn=mv.get(to))&&mw(st,rn),fo=un.createElement("script"),Lm(fo),qm(fo,"link",st),un.head.appendChild(fo)),fo={type:"script",instance:fo,count:1,state:null},cn.set(to,fo))}}function nS(st,rn){zv.M(st,rn);var un=cy;if(un&&st){var cn=Mg(un).hoistableScripts,to=hy(st),fo=cn.get(to);fo||(fo=un.querySelector(t0(to)),fo||(st=lp({src:st,async:!0,type:"module"},rn),(rn=mv.get(to))&&mw(st,rn),fo=un.createElement("script"),Lm(fo),qm(fo,"link",st),un.head.appendChild(fo)),fo={type:"script",instance:fo,count:1,state:null},cn.set(to,fo))}}function U2(st,rn,un,cn){var to=(to=Bp.current)?ax(to):null;if(!to)throw Error(Ye(446));switch(st){case"meta":case"title":return null;case"style":return typeof un.precedence=="string"&&typeof un.href=="string"?(rn=fy(un.href),un=Mg(to).hoistableStyles,cn=un.get(rn),cn||(cn={type:"style",instance:null,count:0,state:null},un.set(rn,cn)),cn):{type:"void",instance:null,count:0,state:null};case"link":if(un.rel==="stylesheet"&&typeof un.href=="string"&&typeof un.precedence=="string"){st=fy(un.href);var fo=Mg(to).hoistableStyles,np=fo.get(st);if(np||(to=to.ownerDocument||to,np={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},fo.set(st,np),(fo=to.querySelector(e0(st)))&&!fo._p&&(np.instance=fo,np.state.loading=5),mv.has(st)||(un={rel:"preload",as:"style",href:un.href,crossOrigin:un.crossOrigin,integrity:un.integrity,media:un.media,hrefLang:un.hrefLang,referrerPolicy:un.referrerPolicy},mv.set(st,un),fo||rS(to,st,un,np.state))),rn&&cn===null)throw Error(Ye(528,""));return np}if(rn&&cn!==null)throw Error(Ye(529,""));return null;case"script":return rn=un.async,un=un.src,typeof un=="string"&&rn&&typeof rn!="function"&&typeof rn!="symbol"?(rn=hy(un),un=Mg(to).hoistableScripts,cn=un.get(rn),cn||(cn={type:"script",instance:null,count:0,state:null},un.set(rn,cn)),cn):{type:"void",instance:null,count:0,state:null};default:throw Error(Ye(444,st))}}function fy(st){return'href="'+av(st)+'"'}function e0(st){return'link[rel="stylesheet"]['+st+"]"}function H2(st){return lp({},st,{"data-precedence":st.precedence,precedence:null})}function rS(st,rn,un,cn){st.querySelector('link[rel="preload"][as="style"]['+rn+"]")?cn.loading=1:(rn=st.createElement("link"),cn.preload=rn,rn.addEventListener("load",function(){return cn.loading|=1}),rn.addEventListener("error",function(){return cn.loading|=2}),qm(rn,"link",un),Lm(rn),st.head.appendChild(rn))}function hy(st){return'[src="'+av(st)+'"]'}function t0(st){return"script[async]"+st}function z2(st,rn,un){if(rn.count++,rn.instance===null)switch(rn.type){case"style":var cn=st.querySelector('style[data-href~="'+av(un.href)+'"]');if(cn)return rn.instance=cn,Lm(cn),cn;var to=lp({},un,{"data-href":un.href,"data-precedence":un.precedence,href:null,precedence:null});return cn=(st.ownerDocument||st).createElement("style"),Lm(cn),qm(cn,"style",to),ox(cn,un.precedence,st),rn.instance=cn;case"stylesheet":to=fy(un.href);var fo=st.querySelector(e0(to));if(fo)return rn.state.loading|=4,rn.instance=fo,Lm(fo),fo;cn=H2(un),(to=mv.get(to))&&pw(cn,to),fo=(st.ownerDocument||st).createElement("link"),Lm(fo);var np=fo;return np._p=new Promise(function(up,pp){np.onload=up,np.onerror=pp}),qm(fo,"link",cn),rn.state.loading|=4,ox(fo,un.precedence,st),rn.instance=fo;case"script":return fo=hy(un.src),(to=st.querySelector(t0(fo)))?(rn.instance=to,Lm(to),to):(cn=un,(to=mv.get(fo))&&(cn=lp({},un),mw(cn,to)),st=st.ownerDocument||st,to=st.createElement("script"),Lm(to),qm(to,"link",cn),st.head.appendChild(to),rn.instance=to);case"void":return null;default:throw Error(Ye(443,rn.type))}else rn.type==="stylesheet"&&(rn.state.loading&4)===0&&(cn=rn.instance,rn.state.loading|=4,ox(cn,un.precedence,st));return rn.instance}function ox(st,rn,un){for(var cn=un.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),to=cn.length?cn[cn.length-1]:null,fo=to,np=0;np<cn.length;np++){var up=cn[np];if(up.dataset.precedence===rn)fo=up;else if(fo!==to)break}fo?fo.parentNode.insertBefore(st,fo.nextSibling):(rn=un.nodeType===9?un.head:un,rn.insertBefore(st,rn.firstChild))}function pw(st,rn){st.crossOrigin==null&&(st.crossOrigin=rn.crossOrigin),st.referrerPolicy==null&&(st.referrerPolicy=rn.referrerPolicy),st.title==null&&(st.title=rn.title)}function mw(st,rn){st.crossOrigin==null&&(st.crossOrigin=rn.crossOrigin),st.referrerPolicy==null&&(st.referrerPolicy=rn.referrerPolicy),st.integrity==null&&(st.integrity=rn.integrity)}var sx=null;function j2(st,rn,un){if(sx===null){var cn=new Map,to=sx=new Map;to.set(un,cn)}else to=sx,cn=to.get(un),cn||(cn=new Map,to.set(un,cn));if(cn.has(st))return cn;for(cn.set(st,null),un=un.getElementsByTagName(st),to=0;to<un.length;to++){var fo=un[to];if(!(fo[my]||fo[Vm]||st==="link"&&fo.getAttribute("rel")==="stylesheet")&&fo.namespaceURI!=="http://www.w3.org/2000/svg"){var np=fo.getAttribute(rn)||"";np=st+np;var up=cn.get(np);up?up.push(fo):cn.set(np,[fo])}}return cn}function q2(st,rn,un){st=st.ownerDocument||st,st.head.insertBefore(un,rn==="title"?st.querySelector("head > title"):null)}function iS(st,rn,un){if(un===1||rn.itemProp!=null)return!1;switch(st){case"meta":case"title":return!0;case"style":if(typeof rn.precedence!="string"||typeof rn.href!="string"||rn.href==="")break;return!0;case"link":if(typeof rn.rel!="string"||typeof rn.href!="string"||rn.href===""||rn.onLoad||rn.onError)break;switch(rn.rel){case"stylesheet":return st=rn.disabled,typeof rn.precedence=="string"&&st==null;default:return!0}case"script":if(rn.async&&typeof rn.async!="function"&&typeof rn.async!="symbol"&&!rn.onLoad&&!rn.onError&&rn.src&&typeof rn.src=="string")return!0}return!1}function W2(st){return!(st.type==="stylesheet"&&(st.state.loading&3)===0)}var n0=null;function aS(){}function oS(st,rn,un){if(n0===null)throw Error(Ye(475));var cn=n0;if(rn.type==="stylesheet"&&(typeof un.media!="string"||matchMedia(un.media).matches!==!1)&&(rn.state.loading&4)===0){if(rn.instance===null){var to=fy(un.href),fo=st.querySelector(e0(to));if(fo){st=fo._p,st!==null&&typeof st=="object"&&typeof st.then=="function"&&(cn.count++,cn=ux.bind(cn),st.then(cn,cn)),rn.state.loading|=4,rn.instance=fo,Lm(fo);return}fo=st.ownerDocument||st,un=H2(un),(to=mv.get(to))&&pw(un,to),fo=fo.createElement("link"),Lm(fo);var np=fo;np._p=new Promise(function(up,pp){np.onload=up,np.onerror=pp}),qm(fo,"link",un),rn.instance=fo}cn.stylesheets===null&&(cn.stylesheets=new Map),cn.stylesheets.set(rn,st),(st=rn.state.preload)&&(rn.state.loading&3)===0&&(cn.count++,rn=ux.bind(cn),st.addEventListener("load",rn),st.addEventListener("error",rn))}}function sS(){if(n0===null)throw Error(Ye(475));var st=n0;return st.stylesheets&&st.count===0&&vw(st,st.stylesheets),0<st.count?function(rn){var un=setTimeout(function(){if(st.stylesheets&&vw(st,st.stylesheets),st.unsuspend){var cn=st.unsuspend;st.unsuspend=null,cn()}},6e4);return st.unsuspend=rn,function(){st.unsuspend=null,clearTimeout(un)}}:null}function ux(){if(this.count--,this.count===0){if(this.stylesheets)vw(this,this.stylesheets);else if(this.unsuspend){var st=this.unsuspend;this.unsuspend=null,st()}}}var lx=null;function vw(st,rn){st.stylesheets=null,st.unsuspend!==null&&(st.count++,lx=new Map,rn.forEach(uS,st),lx=null,ux.call(st))}function uS(st,rn){if(!(rn.state.loading&4)){var un=lx.get(st);if(un)var cn=un.get(null);else{un=new Map,lx.set(st,un);for(var to=st.querySelectorAll("link[data-precedence],style[data-precedence]"),fo=0;fo<to.length;fo++){var np=to[fo];(np.nodeName==="LINK"||np.getAttribute("media")!=="not all")&&(un.set(np.dataset.precedence,np),cn=np)}cn&&un.set(null,cn)}to=rn.instance,np=to.getAttribute("data-precedence"),fo=un.get(np)||cn,fo===cn&&un.set(null,to),un.set(np,to),this.count++,cn=ux.bind(this),to.addEventListener("load",cn),to.addEventListener("error",cn),fo?fo.parentNode.insertBefore(to,fo.nextSibling):(st=st.nodeType===9?st.head:st,st.insertBefore(to,st.firstChild)),rn.state.loading|=4}}var r0={$$typeof:Xr,Provider:null,Consumer:null,_currentValue:Gp,_currentValue2:Gp,_threadCount:0};function lS(st,rn,un,cn,to,fo,np,up){this.tag=1,this.containerInfo=st,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=yx(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yx(0),this.hiddenUpdates=yx(null),this.identifierPrefix=cn,this.onUncaughtError=to,this.onCaughtError=fo,this.onRecoverableError=np,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=up,this.incompleteTransitions=new Map}function V2(st,rn,un,cn,to,fo,np,up,pp,_p,Up,Wp){return st=new lS(st,rn,un,np,up,pp,_p,Wp),rn=1,fo===!0&&(rn|=24),fo=dv(3,null,null,rn),st.current=fo,fo.stateNode=st,rn=Xx(),rn.refCount++,st.pooledCache=rn,rn.refCount++,fo.memoizedState={element:cn,isDehydrated:un,cache:rn},T1(fo),st}function $2(st){return st?(st=Wg,st):Wg}function G2(st,rn,un,cn,to,fo){to=$2(to),cn.context===null?cn.context=to:cn.pendingContext=to,cn=Zv(rn),cn.payload={element:un},fo=fo===void 0?null:fo,fo!==null&&(cn.callback=fo),un=Qv(st,cn,rn),un!==null&&(Xm(un,st,rn),Hy(un,st,rn))}function X2(st,rn){if(st=st.memoizedState,st!==null&&st.dehydrated!==null){var un=st.retryLane;st.retryLane=un!==0&&un<rn?un:rn}}function gw(st,rn){X2(st,rn),(st=st.alternate)&&X2(st,rn)}function K2(st){if(st.tag===13){var rn=Wv(st,67108864);rn!==null&&Xm(rn,st,67108864),gw(st,67108864)}}var cx=!0;function cS(st,rn,un,cn){var to=ip.T;ip.T=null;var fo=zp.p;try{zp.p=2,yw(st,rn,un,cn)}finally{zp.p=fo,ip.T=to}}function fS(st,rn,un,cn){var to=ip.T;ip.T=null;var fo=zp.p;try{zp.p=8,yw(st,rn,un,cn)}finally{zp.p=fo,ip.T=to}}function yw(st,rn,un,cn){if(cx){var to=bw(cn);if(to===null)ow(st,rn,cn,fx,un),Z2(st,cn);else if(dS(to,st,rn,un,cn))cn.stopPropagation();else if(Z2(st,cn),rn&4&&-1<hS.indexOf(st)){for(;to!==null;){var fo=Bg(to);if(fo!==null)switch(fo.tag){case 3:if(fo=fo.stateNode,fo.current.memoizedState.isDehydrated){var np=cg(fo.pendingLanes);if(np!==0){var up=fo;for(up.pendingLanes|=2,up.entangledLanes|=2;np;){var pp=1<<31-om(np);up.entanglements[1]|=pp,np&=~pp}Cv(fo),(Rm&6)===0&&(K0=Em()+500,Zy(0))}}break;case 13:up=Wv(fo,2),up!==null&&Xm(up,fo,2),Q0(),gw(fo,2)}if(fo=bw(cn),fo===null&&ow(st,rn,cn,fx,un),fo===to)break;to=fo}to!==null&&cn.stopPropagation()}else ow(st,rn,cn,null,un)}}function bw(st){return st=Rx(st),xw(st)}var fx=null;function xw(st){if(fx=null,st=fg(st),st!==null){var rn=Cp(st);if(rn===null)st=null;else{var un=rn.tag;if(un===13){if(st=Ip(rn),st!==null)return st;st=null}else if(un===3){if(rn.stateNode.current.memoizedState.isDehydrated)return rn.tag===3?rn.stateNode.containerInfo:null;st=null}else rn!==st&&(st=null)}}return fx=st,null}function Y2(st){switch(st){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(_m()){case Km:return 2;case ap:return 8;case Uo:case tp:return 32;case dp:return 268435456;default:return 32}default:return 32}}var ww=!1,ag=null,og=null,sg=null,i0=new Map,a0=new Map,ug=[],hS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Z2(st,rn){switch(st){case"focusin":case"focusout":ag=null;break;case"dragenter":case"dragleave":og=null;break;case"mouseover":case"mouseout":sg=null;break;case"pointerover":case"pointerout":i0.delete(rn.pointerId);break;case"gotpointercapture":case"lostpointercapture":a0.delete(rn.pointerId)}}function o0(st,rn,un,cn,to,fo){return st===null||st.nativeEvent!==fo?(st={blockedOn:rn,domEventName:un,eventSystemFlags:cn,nativeEvent:fo,targetContainers:[to]},rn!==null&&(rn=Bg(rn),rn!==null&&K2(rn)),st):(st.eventSystemFlags|=cn,rn=st.targetContainers,to!==null&&rn.indexOf(to)===-1&&rn.push(to),st)}function dS(st,rn,un,cn,to){switch(rn){case"focusin":return ag=o0(ag,st,rn,un,cn,to),!0;case"dragenter":return og=o0(og,st,rn,un,cn,to),!0;case"mouseover":return sg=o0(sg,st,rn,un,cn,to),!0;case"pointerover":var fo=to.pointerId;return i0.set(fo,o0(i0.get(fo)||null,st,rn,un,cn,to)),!0;case"gotpointercapture":return fo=to.pointerId,a0.set(fo,o0(a0.get(fo)||null,st,rn,un,cn,to)),!0}return!1}function Q2(st){var rn=fg(st.target);if(rn!==null){var un=Cp(rn);if(un!==null){if(rn=un.tag,rn===13){if(rn=Ip(un),rn!==null){st.blockedOn=rn,sC(st.priority,function(){if(un.tag===13){var cn=rv(),to=Wv(un,cn);to!==null&&Xm(to,un,cn),gw(un,cn)}});return}}else if(rn===3&&un.stateNode.current.memoizedState.isDehydrated){st.blockedOn=un.tag===3?un.stateNode.containerInfo:null;return}}}st.blockedOn=null}function hx(st){if(st.blockedOn!==null)return!1;for(var rn=st.targetContainers;0<rn.length;){var un=bw(st.nativeEvent);if(un===null){un=st.nativeEvent;var cn=new un.constructor(un.type,un);Cx=cn,un.target.dispatchEvent(cn),Cx=null}else return rn=Bg(un),rn!==null&&K2(rn),st.blockedOn=un,!1;rn.shift()}return!0}function J2(st,rn,un){hx(st)&&un.delete(rn)}function pS(){ww=!1,ag!==null&&hx(ag)&&(ag=null),og!==null&&hx(og)&&(og=null),sg!==null&&hx(sg)&&(sg=null),i0.forEach(J2),a0.forEach(J2)}function dx(st,rn){st.blockedOn===rn&&(st.blockedOn=null,ww||(ww=!0,Ke.unstable_scheduleCallback(Ke.unstable_NormalPriority,pS)))}var px=null;function eC(st){px!==st&&(px=st,Ke.unstable_scheduleCallback(Ke.unstable_NormalPriority,function(){px===st&&(px=null);for(var rn=0;rn<st.length;rn+=3){var un=st[rn],cn=st[rn+1],to=st[rn+2];if(typeof cn!="function"){if(xw(cn||un)===null)continue;break}var fo=Bg(un);fo!==null&&(st.splice(rn,3),rn-=3,c1(fo,{pending:!0,data:to,method:un.method,action:cn},cn,to))}}))}function s0(st){function rn(pp){return dx(pp,st)}ag!==null&&dx(ag,st),og!==null&&dx(og,st),sg!==null&&dx(sg,st),i0.forEach(rn),a0.forEach(rn);for(var un=0;un<ug.length;un++){var cn=ug[un];cn.blockedOn===st&&(cn.blockedOn=null)}for(;0<ug.length&&(un=ug[0],un.blockedOn===null);)Q2(un),un.blockedOn===null&&ug.shift();if(un=(st.ownerDocument||st).$$reactFormReplay,un!=null)for(cn=0;cn<un.length;cn+=3){var to=un[cn],fo=un[cn+1],np=to[Ym]||null;if(typeof fo=="function")np||eC(un);else if(np){var up=null;if(fo&&fo.hasAttribute("formAction")){if(to=fo,np=fo[Ym]||null)up=np.formAction;else if(xw(to)!==null)continue}else up=np.action;typeof up=="function"?un[cn+1]=up:(un.splice(cn,3),cn-=3),eC(un)}}}function _w(st){this._internalRoot=st}mx.prototype.render=_w.prototype.render=function(st){var rn=this._internalRoot;if(rn===null)throw Error(Ye(409));var un=rn.current,cn=rv();G2(un,cn,st,rn,null,null)},mx.prototype.unmount=_w.prototype.unmount=function(){var st=this._internalRoot;if(st!==null){this._internalRoot=null;var rn=st.containerInfo;st.tag===0&&sy(),G2(st.current,2,null,st,null,null),Q0(),rn[Og]=null}};function mx(st){this._internalRoot=st}mx.prototype.unstable_scheduleHydration=function(st){if(st){var rn=Tw();st={blockedOn:null,target:st,priority:rn};for(var un=0;un<ug.length&&rn!==0&&rn<ug[un].priority;un++);ug.splice(un,0,st),un===0&&Q2(st)}};var tC=Ge.version;if(tC!=="19.0.0")throw Error(Ye(527,tC,"19.0.0"));zp.findDOMNode=function(st){var rn=st._reactInternals;if(rn===void 0)throw typeof st.render=="function"?Error(Ye(188)):(st=Object.keys(st).join(","),Error(Ye(268,st)));return st=Ep(rn),st=st!==null?Fp(st):null,st=st===null?null:st.stateNode,st};var mS={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:ip,findFiberByHostInstance:fg,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vx=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vx.isDisabled&&vx.supportsFiber)try{Pp=vx.inject(mS),Qp=vx}catch{}}return reactDomClient_production.createRoot=function(st,rn){if(!Qe(st))throw Error(Ye(299));var un=!1,cn="",to=yE,fo=bE,np=xE,up=null;return rn!=null&&(rn.unstable_strictMode===!0&&(un=!0),rn.identifierPrefix!==void 0&&(cn=rn.identifierPrefix),rn.onUncaughtError!==void 0&&(to=rn.onUncaughtError),rn.onCaughtError!==void 0&&(fo=rn.onCaughtError),rn.onRecoverableError!==void 0&&(np=rn.onRecoverableError),rn.unstable_transitionCallbacks!==void 0&&(up=rn.unstable_transitionCallbacks)),rn=V2(st,1,!1,null,null,un,cn,to,fo,np,up,null),st[Og]=rn.current,aw(st.nodeType===8?st.parentNode:st),new _w(rn)},reactDomClient_production.hydrateRoot=function(st,rn,un){if(!Qe(st))throw Error(Ye(299));var cn=!1,to="",fo=yE,np=bE,up=xE,pp=null,_p=null;return un!=null&&(un.unstable_strictMode===!0&&(cn=!0),un.identifierPrefix!==void 0&&(to=un.identifierPrefix),un.onUncaughtError!==void 0&&(fo=un.onUncaughtError),un.onCaughtError!==void 0&&(np=un.onCaughtError),un.onRecoverableError!==void 0&&(up=un.onRecoverableError),un.unstable_transitionCallbacks!==void 0&&(pp=un.unstable_transitionCallbacks),un.formState!==void 0&&(_p=un.formState)),rn=V2(st,1,!0,rn,un??null,cn,to,fo,np,up,pp,_p),rn.context=$2(null),un=rn.current,cn=rv(),to=Zv(cn),to.callback=null,Qv(un,to,cn),rn.current.lanes=cn,py(rn,cn),Cv(rn),st[Og]=rn.current,aw(st),new mx(rn)},reactDomClient_production.version="19.0.0",reactDomClient_production}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client.exports;hasRequiredClient=1;function Ke(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ke)}catch(Ge){console.error(Ge)}}return Ke(),client.exports=requireReactDomClient_production(),client.exports}var clientExports=requireClient();let e$1={data:""},t$1=Ke=>typeof window=="object"?((Ke?Ke.querySelector("#_goober"):window._goober)||Object.assign((Ke||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:Ke||e$1,l$1=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,a$1=/\/\*[^]*?\*\/|  +/g,n$1=/\n+/g,o$1=(Ke,Ge)=>{let $e="",Ye="",Qe="";for(let Je in Ke){let Mt=Ke[Je];Je[0]=="@"?Je[1]=="i"?$e=Je+" "+Mt+";":Ye+=Je[1]=="f"?o$1(Mt,Je):Je+"{"+o$1(Mt,Je[1]=="k"?"":Ge)+"}":typeof Mt=="object"?Ye+=o$1(Mt,Ge?Ge.replace(/([^,])+/g,nn=>Je.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,an=>/&/.test(an)?an.replace(/&/g,nn):nn?nn+" "+an:an)):Je):Mt!=null&&(Je=/^--/.test(Je)?Je:Je.replace(/[A-Z]/g,"-$&").toLowerCase(),Qe+=o$1.p?o$1.p(Je,Mt):Je+":"+Mt+";")}return $e+(Ge&&Qe?Ge+"{"+Qe+"}":Qe)+Ye},c$2={},s$1=Ke=>{if(typeof Ke=="object"){let Ge="";for(let $e in Ke)Ge+=$e+s$1(Ke[$e]);return Ge}return Ke},i$1=(Ke,Ge,$e,Ye,Qe)=>{let Je=s$1(Ke),Mt=c$2[Je]||(c$2[Je]=(an=>{let sn=0,ln=11;for(;sn<an.length;)ln=101*ln+an.charCodeAt(sn++)>>>0;return"go"+ln})(Je));if(!c$2[Mt]){let an=Je!==Ke?Ke:(sn=>{let ln,fn,hn=[{}];for(;ln=l$1.exec(sn.replace(a$1,""));)ln[4]?hn.shift():ln[3]?(fn=ln[3].replace(n$1," ").trim(),hn.unshift(hn[0][fn]=hn[0][fn]||{})):hn[0][ln[1]]=ln[2].replace(n$1," ").trim();return hn[0]})(Ke);c$2[Mt]=o$1(Qe?{["@keyframes "+Mt]:an}:an,$e?"":"."+Mt)}let nn=$e&&c$2.g?c$2.g:null;return $e&&(c$2.g=c$2[Mt]),((an,sn,ln,fn)=>{fn?sn.data=sn.data.replace(fn,an):sn.data.indexOf(an)===-1&&(sn.data=ln?an+sn.data:sn.data+an)})(c$2[Mt],Ge,Ye,nn),Mt},p$1=(Ke,Ge,$e)=>Ke.reduce((Ye,Qe,Je)=>{let Mt=Ge[Je];if(Mt&&Mt.call){let nn=Mt($e),an=nn&&nn.props&&nn.props.className||/^go/.test(nn)&&nn;Mt=an?"."+an:nn&&typeof nn=="object"?nn.props?"":o$1(nn,""):nn===!1?"":nn}return Ye+Qe+(Mt??"")},"");function u$2(Ke){let Ge=this||{},$e=Ke.call?Ke(Ge.p):Ke;return i$1($e.unshift?$e.raw?p$1($e,[].slice.call(arguments,1),Ge.p):$e.reduce((Ye,Qe)=>Object.assign(Ye,Qe&&Qe.call?Qe(Ge.p):Qe),{}):$e,t$1(Ge.target),Ge.g,Ge.o,Ge.k)}let d$1,f$2,g$1;u$2.bind({g:1});let h$1=u$2.bind({k:1});function m(Ke,Ge,$e,Ye){o$1.p=Ge,d$1=Ke,f$2=$e,g$1=Ye}function j$1(Ke,Ge){let $e=this||{};return function(){let Ye=arguments;function Qe(Je,Mt){let nn=Object.assign({},Je),an=nn.className||Qe.className;$e.p=Object.assign({theme:f$2&&f$2()},nn),$e.o=/ *go\d+/.test(an),nn.className=u$2.apply($e,Ye)+(an?" "+an:"");let sn=Ke;return Ke[0]&&(sn=nn.as||Ke,delete nn.as),g$1&&sn[0]&&g$1(nn),d$1(sn,nn)}return Qe}}var W$1=Ke=>typeof Ke=="function",f$1=(Ke,Ge)=>W$1(Ke)?Ke(Ge):Ke,F$1=(()=>{let Ke=0;return()=>(++Ke).toString()})(),A$1=(()=>{let Ke;return()=>{if(Ke===void 0&&typeof window<"u"){let Ge=matchMedia("(prefers-reduced-motion: reduce)");Ke=!Ge||Ge.matches}return Ke}})(),Y$1=20,U$1=(Ke,Ge)=>{switch(Ge.type){case 0:return{...Ke,toasts:[Ge.toast,...Ke.toasts].slice(0,Y$1)};case 1:return{...Ke,toasts:Ke.toasts.map(Je=>Je.id===Ge.toast.id?{...Je,...Ge.toast}:Je)};case 2:let{toast:$e}=Ge;return U$1(Ke,{type:Ke.toasts.find(Je=>Je.id===$e.id)?1:0,toast:$e});case 3:let{toastId:Ye}=Ge;return{...Ke,toasts:Ke.toasts.map(Je=>Je.id===Ye||Ye===void 0?{...Je,dismissed:!0,visible:!1}:Je)};case 4:return Ge.toastId===void 0?{...Ke,toasts:[]}:{...Ke,toasts:Ke.toasts.filter(Je=>Je.id!==Ge.toastId)};case 5:return{...Ke,pausedAt:Ge.time};case 6:let Qe=Ge.time-(Ke.pausedAt||0);return{...Ke,pausedAt:void 0,toasts:Ke.toasts.map(Je=>({...Je,pauseDuration:Je.pauseDuration+Qe}))}}},P$1=[],y={toasts:[],pausedAt:void 0},u$1=Ke=>{y=U$1(y,Ke),P$1.forEach(Ge=>{Ge(y)})},q$1={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},D$1=(Ke={})=>{let[Ge,$e]=reactExports.useState(y),Ye=reactExports.useRef(y);reactExports.useEffect(()=>(Ye.current!==y&&$e(y),P$1.push($e),()=>{let Je=P$1.indexOf($e);Je>-1&&P$1.splice(Je,1)}),[]);let Qe=Ge.toasts.map(Je=>{var Mt,nn,an;return{...Ke,...Ke[Je.type],...Je,removeDelay:Je.removeDelay||((Mt=Ke[Je.type])==null?void 0:Mt.removeDelay)||(Ke==null?void 0:Ke.removeDelay),duration:Je.duration||((nn=Ke[Je.type])==null?void 0:nn.duration)||(Ke==null?void 0:Ke.duration)||q$1[Je.type],style:{...Ke.style,...(an=Ke[Je.type])==null?void 0:an.style,...Je.style}}});return{...Ge,toasts:Qe}},J$1=(Ke,Ge="blank",$e)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:Ge,ariaProps:{role:"status","aria-live":"polite"},message:Ke,pauseDuration:0,...$e,id:($e==null?void 0:$e.id)||F$1()}),x$1=Ke=>(Ge,$e)=>{let Ye=J$1(Ge,Ke,$e);return u$1({type:2,toast:Ye}),Ye.id},c$1=(Ke,Ge)=>x$1("blank")(Ke,Ge);c$1.error=x$1("error");c$1.success=x$1("success");c$1.loading=x$1("loading");c$1.custom=x$1("custom");c$1.dismiss=Ke=>{u$1({type:3,toastId:Ke})};c$1.remove=Ke=>u$1({type:4,toastId:Ke});c$1.promise=(Ke,Ge,$e)=>{let Ye=c$1.loading(Ge.loading,{...$e,...$e==null?void 0:$e.loading});return typeof Ke=="function"&&(Ke=Ke()),Ke.then(Qe=>{let Je=Ge.success?f$1(Ge.success,Qe):void 0;return Je?c$1.success(Je,{id:Ye,...$e,...$e==null?void 0:$e.success}):c$1.dismiss(Ye),Qe}).catch(Qe=>{let Je=Ge.error?f$1(Ge.error,Qe):void 0;Je?c$1.error(Je,{id:Ye,...$e,...$e==null?void 0:$e.error}):c$1.dismiss(Ye)}),Ke};var K$1=(Ke,Ge)=>{u$1({type:1,toast:{id:Ke,height:Ge}})},X$1=()=>{u$1({type:5,time:Date.now()})},b$1=new Map,Z$1=1e3,ee$1=(Ke,Ge=Z$1)=>{if(b$1.has(Ke))return;let $e=setTimeout(()=>{b$1.delete(Ke),u$1({type:4,toastId:Ke})},Ge);b$1.set(Ke,$e)},O$1=Ke=>{let{toasts:Ge,pausedAt:$e}=D$1(Ke);reactExports.useEffect(()=>{if($e)return;let Je=Date.now(),Mt=Ge.map(nn=>{if(nn.duration===1/0)return;let an=(nn.duration||0)+nn.pauseDuration-(Je-nn.createdAt);if(an<0){nn.visible&&c$1.dismiss(nn.id);return}return setTimeout(()=>c$1.dismiss(nn.id),an)});return()=>{Mt.forEach(nn=>nn&&clearTimeout(nn))}},[Ge,$e]);let Ye=reactExports.useCallback(()=>{$e&&u$1({type:6,time:Date.now()})},[$e]),Qe=reactExports.useCallback((Je,Mt)=>{let{reverseOrder:nn=!1,gutter:an=8,defaultPosition:sn}=Mt||{},ln=Ge.filter(Xr=>(Xr.position||sn)===(Je.position||sn)&&Xr.height),fn=ln.findIndex(Xr=>Xr.id===Je.id),hn=ln.filter((Xr,Mi)=>Mi<fn&&Xr.visible).length;return ln.filter(Xr=>Xr.visible).slice(...nn?[hn+1]:[0,hn]).reduce((Xr,Mi)=>Xr+(Mi.height||0)+an,0)},[Ge]);return reactExports.useEffect(()=>{Ge.forEach(Je=>{if(Je.dismissed)ee$1(Je.id,Je.removeDelay);else{let Mt=b$1.get(Je.id);Mt&&(clearTimeout(Mt),b$1.delete(Je.id))}})},[Ge]),{toasts:Ge,handlers:{updateHeight:K$1,startPause:X$1,endPause:Ye,calculateOffset:Qe}}},oe$1=h$1`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,re$2=h$1`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,se$1=h$1`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,k$1=j$1("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${Ke=>Ke.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${oe$1} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${re$2} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${Ke=>Ke.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${se$1} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,ne$1=h$1`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,V$1=j$1("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${Ke=>Ke.secondary||"#e0e0e0"};
  border-right-color: ${Ke=>Ke.primary||"#616161"};
  animation: ${ne$1} 1s linear infinite;
`,pe$1=h$1`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,de$1=h$1`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,_$1=j$1("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${Ke=>Ke.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${pe$1} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${de$1} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${Ke=>Ke.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,ue$1=j$1("div")`
  position: absolute;
`,le$1=j$1("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,fe$1=h$1`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Te$1=j$1("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${fe$1} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,M$1=({toast:Ke})=>{let{icon:Ge,type:$e,iconTheme:Ye}=Ke;return Ge!==void 0?typeof Ge=="string"?reactExports.createElement(Te$1,null,Ge):Ge:$e==="blank"?null:reactExports.createElement(le$1,null,reactExports.createElement(V$1,{...Ye}),$e!=="loading"&&reactExports.createElement(ue$1,null,$e==="error"?reactExports.createElement(k$1,{...Ye}):reactExports.createElement(_$1,{...Ye})))},ye$1=Ke=>`
0% {transform: translate3d(0,${Ke*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,ge$1=Ke=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${Ke*-150}%,-1px) scale(.6); opacity:0;}
`,he$1="0%{opacity:0;} 100%{opacity:1;}",xe$1="0%{opacity:1;} 100%{opacity:0;}",be$1=j$1("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,Se$1=j$1("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Ae$1=(Ke,Ge)=>{let $e=Ke.includes("top")?1:-1,[Ye,Qe]=A$1()?[he$1,xe$1]:[ye$1($e),ge$1($e)];return{animation:Ge?`${h$1(Ye)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${h$1(Qe)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},C$1=reactExports.memo(({toast:Ke,position:Ge,style:$e,children:Ye})=>{let Qe=Ke.height?Ae$1(Ke.position||Ge||"top-center",Ke.visible):{opacity:0},Je=reactExports.createElement(M$1,{toast:Ke}),Mt=reactExports.createElement(Se$1,{...Ke.ariaProps},f$1(Ke.message,Ke));return reactExports.createElement(be$1,{className:Ke.className,style:{...Qe,...$e,...Ke.style}},typeof Ye=="function"?Ye({icon:Je,message:Mt}):reactExports.createElement(reactExports.Fragment,null,Je,Mt))});m(reactExports.createElement);var ve$1=({id:Ke,className:Ge,style:$e,onHeightUpdate:Ye,children:Qe})=>{let Je=reactExports.useCallback(Mt=>{if(Mt){let nn=()=>{let an=Mt.getBoundingClientRect().height;Ye(Ke,an)};nn(),new MutationObserver(nn).observe(Mt,{subtree:!0,childList:!0,characterData:!0})}},[Ke,Ye]);return reactExports.createElement("div",{ref:Je,className:Ge,style:$e},Qe)},Ee$1=(Ke,Ge)=>{let $e=Ke.includes("top"),Ye=$e?{top:0}:{bottom:0},Qe=Ke.includes("center")?{justifyContent:"center"}:Ke.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:A$1()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${Ge*($e?1:-1)}px)`,...Ye,...Qe}},De$1=u$2`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,R$1=16,Oe$1=({reverseOrder:Ke,position:Ge="top-center",toastOptions:$e,gutter:Ye,children:Qe,containerStyle:Je,containerClassName:Mt})=>{let{toasts:nn,handlers:an}=O$1($e);return reactExports.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:R$1,left:R$1,right:R$1,bottom:R$1,pointerEvents:"none",...Je},className:Mt,onMouseEnter:an.startPause,onMouseLeave:an.endPause},nn.map(sn=>{let ln=sn.position||Ge,fn=an.calculateOffset(sn,{reverseOrder:Ke,gutter:Ye,defaultPosition:Ge}),hn=Ee$1(ln,fn);return reactExports.createElement(ve$1,{id:sn.id,key:sn.id,onHeightUpdate:an.updateHeight,className:sn.visible?De$1:"",style:hn},sn.type==="custom"?f$1(sn.message,sn):Qe?Qe(sn):reactExports.createElement(C$1,{toast:sn,position:ln}))}))},DefaultContext={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},IconContext=React.createContext&&React.createContext(DefaultContext),_excluded=["attr","size","title"];function _objectWithoutProperties(Ke,Ge){if(Ke==null)return{};var $e=_objectWithoutPropertiesLoose(Ke,Ge),Ye,Qe;if(Object.getOwnPropertySymbols){var Je=Object.getOwnPropertySymbols(Ke);for(Qe=0;Qe<Je.length;Qe++)Ye=Je[Qe],!(Ge.indexOf(Ye)>=0)&&Object.prototype.propertyIsEnumerable.call(Ke,Ye)&&($e[Ye]=Ke[Ye])}return $e}function _objectWithoutPropertiesLoose(Ke,Ge){if(Ke==null)return{};var $e={};for(var Ye in Ke)if(Object.prototype.hasOwnProperty.call(Ke,Ye)){if(Ge.indexOf(Ye)>=0)continue;$e[Ye]=Ke[Ye]}return $e}function _extends(){return _extends=Object.assign?Object.assign.bind():function(Ke){for(var Ge=1;Ge<arguments.length;Ge++){var $e=arguments[Ge];for(var Ye in $e)Object.prototype.hasOwnProperty.call($e,Ye)&&(Ke[Ye]=$e[Ye])}return Ke},_extends.apply(this,arguments)}function ownKeys(Ke,Ge){var $e=Object.keys(Ke);if(Object.getOwnPropertySymbols){var Ye=Object.getOwnPropertySymbols(Ke);Ge&&(Ye=Ye.filter(function(Qe){return Object.getOwnPropertyDescriptor(Ke,Qe).enumerable})),$e.push.apply($e,Ye)}return $e}function _objectSpread(Ke){for(var Ge=1;Ge<arguments.length;Ge++){var $e=arguments[Ge]!=null?arguments[Ge]:{};Ge%2?ownKeys(Object($e),!0).forEach(function(Ye){_defineProperty(Ke,Ye,$e[Ye])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Ke,Object.getOwnPropertyDescriptors($e)):ownKeys(Object($e)).forEach(function(Ye){Object.defineProperty(Ke,Ye,Object.getOwnPropertyDescriptor($e,Ye))})}return Ke}function _defineProperty(Ke,Ge,$e){return Ge=_toPropertyKey(Ge),Ge in Ke?Object.defineProperty(Ke,Ge,{value:$e,enumerable:!0,configurable:!0,writable:!0}):Ke[Ge]=$e,Ke}function _toPropertyKey(Ke){var Ge=_toPrimitive(Ke,"string");return typeof Ge=="symbol"?Ge:Ge+""}function _toPrimitive(Ke,Ge){if(typeof Ke!="object"||!Ke)return Ke;var $e=Ke[Symbol.toPrimitive];if($e!==void 0){var Ye=$e.call(Ke,Ge);if(typeof Ye!="object")return Ye;throw new TypeError("@@toPrimitive must return a primitive value.")}return(Ge==="string"?String:Number)(Ke)}function Tree2Element(Ke){return Ke&&Ke.map((Ge,$e)=>React.createElement(Ge.tag,_objectSpread({key:$e},Ge.attr),Tree2Element(Ge.child)))}function GenIcon(Ke){return Ge=>React.createElement(IconBase,_extends({attr:_objectSpread({},Ke.attr)},Ge),Tree2Element(Ke.child))}function IconBase(Ke){var Ge=$e=>{var{attr:Ye,size:Qe,title:Je}=Ke,Mt=_objectWithoutProperties(Ke,_excluded),nn=Qe||$e.size||"1em",an;return $e.className&&(an=$e.className),Ke.className&&(an=(an?an+" ":"")+Ke.className),React.createElement("svg",_extends({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},$e.attr,Ye,Mt,{className:an,style:_objectSpread(_objectSpread({color:Ke.color||$e.color},$e.style),Ke.style),height:nn,width:nn,xmlns:"http://www.w3.org/2000/svg"}),Je&&React.createElement("title",null,Je),Ke.children)};return IconContext!==void 0?React.createElement(IconContext.Consumer,null,$e=>Ge($e)):Ge(DefaultContext)}function FaCopy(Ke){return GenIcon({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"},child:[]}]})(Ke)}function FaEnvelope(Ke){return GenIcon({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"},child:[]}]})(Ke)}function FaLock(Ke){return GenIcon({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M400 224h-24v-72C376 68.2 307.8 0 224 0S72 68.2 72 152v72H48c-26.5 0-48 21.5-48 48v192c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V272c0-26.5-21.5-48-48-48zm-104 0H152v-72c0-39.7 32.3-72 72-72s72 32.3 72 72v72z"},child:[]}]})(Ke)}function FaPhoneSlash(Ke){return GenIcon({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M268.2 381.4l-49.6-60.6c-6.8-8.3-18.2-11.1-28-6.9l-112 48c-10.7 4.6-16.5 16.1-13.9 27.5l24 104c2.5 10.8 12.1 18.6 23.4 18.6 100.7 0 193.7-32.4 269.7-86.9l-80-61.8c-10.9 6.5-22.1 12.7-33.6 18.1zm365.6 76.7L475.1 335.5C537.9 256.4 576 156.9 576 48c0-11.2-7.7-20.9-18.6-23.4l-104-24c-11.3-2.6-22.9 3.3-27.5 13.9l-48 112c-4.2 9.8-1.4 21.3 6.9 28l60.6 49.6c-12.2 26.1-27.9 50.3-46 72.8L45.5 3.4C38.5-2 28.5-.8 23 6.2L3.4 31.4c-5.4 7-4.2 17 2.8 22.4l588.4 454.7c7 5.4 17 4.2 22.5-2.8l19.6-25.3c5.4-6.8 4.1-16.9-2.9-22.3z"},child:[]}]})(Ke)}function FaPhone(Ke){return GenIcon({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M493.4 24.6l-104-24c-11.3-2.6-22.9 3.3-27.5 13.9l-48 112c-4.2 9.8-1.4 21.3 6.9 28l60.6 49.6c-36 76.7-98.9 140.5-177.2 177.2l-49.6-60.6c-6.8-8.3-18.2-11.1-28-6.9l-112 48C3.9 366.5-2 378.1.6 389.4l24 104C27.1 504.2 36.7 512 48 512c256.1 0 464-207.5 464-464 0-11.2-7.7-20.9-18.6-23.4z"},child:[]}]})(Ke)}var dist={},hasRequiredDist;function requireDist(){if(hasRequiredDist)return dist;hasRequiredDist=1,Object.defineProperty(dist,"__esModule",{value:!0}),dist.parse=Mt,dist.serialize=sn;const Ke=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,Ge=/^[\u0021-\u003A\u003C-\u007E]*$/,$e=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,Ye=/^[\u0020-\u003A\u003D-\u007E]*$/,Qe=Object.prototype.toString,Je=(()=>{const hn=function(){};return hn.prototype=Object.create(null),hn})();function Mt(hn,Xr){const Mi=new Je,co=hn.length;if(co<2)return Mi;const lo=(Xr==null?void 0:Xr.decode)||ln;let uo=0;do{const ho=hn.indexOf("=",uo);if(ho===-1)break;const mo=hn.indexOf(";",uo),_d=mo===-1?co:mo;if(ho>_d){uo=hn.lastIndexOf(";",ho-1)+1;continue}const ep=nn(hn,uo,ho),rp=an(hn,ho,ep),sp=hn.slice(ep,rp);if(Mi[sp]===void 0){let op=nn(hn,ho+1,_d),ip=an(hn,_d,op);const lp=lo(hn.slice(op,ip));Mi[sp]=lp}uo=_d+1}while(uo<co);return Mi}function nn(hn,Xr,Mi){do{const co=hn.charCodeAt(Xr);if(co!==32&&co!==9)return Xr}while(++Xr<Mi);return Mi}function an(hn,Xr,Mi){for(;Xr>Mi;){const co=hn.charCodeAt(--Xr);if(co!==32&&co!==9)return Xr+1}return Mi}function sn(hn,Xr,Mi){const co=(Mi==null?void 0:Mi.encode)||encodeURIComponent;if(!Ke.test(hn))throw new TypeError(`argument name is invalid: ${hn}`);const lo=co(Xr);if(!Ge.test(lo))throw new TypeError(`argument val is invalid: ${Xr}`);let uo=hn+"="+lo;if(!Mi)return uo;if(Mi.maxAge!==void 0){if(!Number.isInteger(Mi.maxAge))throw new TypeError(`option maxAge is invalid: ${Mi.maxAge}`);uo+="; Max-Age="+Mi.maxAge}if(Mi.domain){if(!$e.test(Mi.domain))throw new TypeError(`option domain is invalid: ${Mi.domain}`);uo+="; Domain="+Mi.domain}if(Mi.path){if(!Ye.test(Mi.path))throw new TypeError(`option path is invalid: ${Mi.path}`);uo+="; Path="+Mi.path}if(Mi.expires){if(!fn(Mi.expires)||!Number.isFinite(Mi.expires.valueOf()))throw new TypeError(`option expires is invalid: ${Mi.expires}`);uo+="; Expires="+Mi.expires.toUTCString()}if(Mi.httpOnly&&(uo+="; HttpOnly"),Mi.secure&&(uo+="; Secure"),Mi.partitioned&&(uo+="; Partitioned"),Mi.priority)switch(typeof Mi.priority=="string"?Mi.priority.toLowerCase():void 0){case"low":uo+="; Priority=Low";break;case"medium":uo+="; Priority=Medium";break;case"high":uo+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${Mi.priority}`)}if(Mi.sameSite)switch(typeof Mi.sameSite=="string"?Mi.sameSite.toLowerCase():Mi.sameSite){case!0:case"strict":uo+="; SameSite=Strict";break;case"lax":uo+="; SameSite=Lax";break;case"none":uo+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${Mi.sameSite}`)}return uo}function ln(hn){if(hn.indexOf("%")===-1)return hn;try{return decodeURIComponent(hn)}catch{return hn}}function fn(hn){return Qe.call(hn)==="[object Date]"}return dist}requireDist();/**
 * react-router v7.3.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var PopStateEventType="popstate";function createBrowserHistory(Ke={}){function Ge(Ye,Qe){let{pathname:Je,search:Mt,hash:nn}=Ye.location;return createLocation("",{pathname:Je,search:Mt,hash:nn},Qe.state&&Qe.state.usr||null,Qe.state&&Qe.state.key||"default")}function $e(Ye,Qe){return typeof Qe=="string"?Qe:createPath(Qe)}return getUrlBasedHistory(Ge,$e,null,Ke)}function invariant(Ke,Ge){if(Ke===!1||Ke===null||typeof Ke>"u")throw new Error(Ge)}function warning(Ke,Ge){if(!Ke){typeof console<"u"&&console.warn(Ge);try{throw new Error(Ge)}catch{}}}function createKey(){return Math.random().toString(36).substring(2,10)}function getHistoryState(Ke,Ge){return{usr:Ke.state,key:Ke.key,idx:Ge}}function createLocation(Ke,Ge,$e=null,Ye){return{pathname:typeof Ke=="string"?Ke:Ke.pathname,search:"",hash:"",...typeof Ge=="string"?parsePath(Ge):Ge,state:$e,key:Ge&&Ge.key||Ye||createKey()}}function createPath({pathname:Ke="/",search:Ge="",hash:$e=""}){return Ge&&Ge!=="?"&&(Ke+=Ge.charAt(0)==="?"?Ge:"?"+Ge),$e&&$e!=="#"&&(Ke+=$e.charAt(0)==="#"?$e:"#"+$e),Ke}function parsePath(Ke){let Ge={};if(Ke){let $e=Ke.indexOf("#");$e>=0&&(Ge.hash=Ke.substring($e),Ke=Ke.substring(0,$e));let Ye=Ke.indexOf("?");Ye>=0&&(Ge.search=Ke.substring(Ye),Ke=Ke.substring(0,Ye)),Ke&&(Ge.pathname=Ke)}return Ge}function getUrlBasedHistory(Ke,Ge,$e,Ye={}){let{window:Qe=document.defaultView,v5Compat:Je=!1}=Ye,Mt=Qe.history,nn="POP",an=null,sn=ln();sn==null&&(sn=0,Mt.replaceState({...Mt.state,idx:sn},""));function ln(){return(Mt.state||{idx:null}).idx}function fn(){nn="POP";let lo=ln(),uo=lo==null?null:lo-sn;sn=lo,an&&an({action:nn,location:co.location,delta:uo})}function hn(lo,uo){nn="PUSH";let ho=createLocation(co.location,lo,uo);sn=ln()+1;let mo=getHistoryState(ho,sn),_d=co.createHref(ho);try{Mt.pushState(mo,"",_d)}catch(ep){if(ep instanceof DOMException&&ep.name==="DataCloneError")throw ep;Qe.location.assign(_d)}Je&&an&&an({action:nn,location:co.location,delta:1})}function Xr(lo,uo){nn="REPLACE";let ho=createLocation(co.location,lo,uo);sn=ln();let mo=getHistoryState(ho,sn),_d=co.createHref(ho);Mt.replaceState(mo,"",_d),Je&&an&&an({action:nn,location:co.location,delta:0})}function Mi(lo){let uo=Qe.location.origin!=="null"?Qe.location.origin:Qe.location.href,ho=typeof lo=="string"?lo:createPath(lo);return ho=ho.replace(/ $/,"%20"),invariant(uo,`No window.location.(origin|href) available to create URL for href: ${ho}`),new URL(ho,uo)}let co={get action(){return nn},get location(){return Ke(Qe,Mt)},listen(lo){if(an)throw new Error("A history only accepts one active listener");return Qe.addEventListener(PopStateEventType,fn),an=lo,()=>{Qe.removeEventListener(PopStateEventType,fn),an=null}},createHref(lo){return Ge(Qe,lo)},createURL:Mi,encodeLocation(lo){let uo=Mi(lo);return{pathname:uo.pathname,search:uo.search,hash:uo.hash}},push:hn,replace:Xr,go(lo){return Mt.go(lo)}};return co}function matchRoutes(Ke,Ge,$e="/"){return matchRoutesImpl(Ke,Ge,$e,!1)}function matchRoutesImpl(Ke,Ge,$e,Ye){let Qe=typeof Ge=="string"?parsePath(Ge):Ge,Je=stripBasename(Qe.pathname||"/",$e);if(Je==null)return null;let Mt=flattenRoutes(Ke);rankRouteBranches(Mt);let nn=null;for(let an=0;nn==null&&an<Mt.length;++an){let sn=decodePath(Je);nn=matchRouteBranch(Mt[an],sn,Ye)}return nn}function flattenRoutes(Ke,Ge=[],$e=[],Ye=""){let Qe=(Je,Mt,nn)=>{let an={relativePath:nn===void 0?Je.path||"":nn,caseSensitive:Je.caseSensitive===!0,childrenIndex:Mt,route:Je};an.relativePath.startsWith("/")&&(invariant(an.relativePath.startsWith(Ye),`Absolute route path "${an.relativePath}" nested under path "${Ye}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),an.relativePath=an.relativePath.slice(Ye.length));let sn=joinPaths([Ye,an.relativePath]),ln=$e.concat(an);Je.children&&Je.children.length>0&&(invariant(Je.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${sn}".`),flattenRoutes(Je.children,Ge,ln,sn)),!(Je.path==null&&!Je.index)&&Ge.push({path:sn,score:computeScore(sn,Je.index),routesMeta:ln})};return Ke.forEach((Je,Mt)=>{var nn;if(Je.path===""||!((nn=Je.path)!=null&&nn.includes("?")))Qe(Je,Mt);else for(let an of explodeOptionalSegments(Je.path))Qe(Je,Mt,an)}),Ge}function explodeOptionalSegments(Ke){let Ge=Ke.split("/");if(Ge.length===0)return[];let[$e,...Ye]=Ge,Qe=$e.endsWith("?"),Je=$e.replace(/\?$/,"");if(Ye.length===0)return Qe?[Je,""]:[Je];let Mt=explodeOptionalSegments(Ye.join("/")),nn=[];return nn.push(...Mt.map(an=>an===""?Je:[Je,an].join("/"))),Qe&&nn.push(...Mt),nn.map(an=>Ke.startsWith("/")&&an===""?"/":an)}function rankRouteBranches(Ke){Ke.sort((Ge,$e)=>Ge.score!==$e.score?$e.score-Ge.score:compareIndexes(Ge.routesMeta.map(Ye=>Ye.childrenIndex),$e.routesMeta.map(Ye=>Ye.childrenIndex)))}var paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=Ke=>Ke==="*";function computeScore(Ke,Ge){let $e=Ke.split("/"),Ye=$e.length;return $e.some(isSplat)&&(Ye+=splatPenalty),Ge&&(Ye+=indexRouteValue),$e.filter(Qe=>!isSplat(Qe)).reduce((Qe,Je)=>Qe+(paramRe.test(Je)?dynamicSegmentValue:Je===""?emptySegmentValue:staticSegmentValue),Ye)}function compareIndexes(Ke,Ge){return Ke.length===Ge.length&&Ke.slice(0,-1).every((Ye,Qe)=>Ye===Ge[Qe])?Ke[Ke.length-1]-Ge[Ge.length-1]:0}function matchRouteBranch(Ke,Ge,$e=!1){let{routesMeta:Ye}=Ke,Qe={},Je="/",Mt=[];for(let nn=0;nn<Ye.length;++nn){let an=Ye[nn],sn=nn===Ye.length-1,ln=Je==="/"?Ge:Ge.slice(Je.length)||"/",fn=matchPath({path:an.relativePath,caseSensitive:an.caseSensitive,end:sn},ln),hn=an.route;if(!fn&&sn&&$e&&!Ye[Ye.length-1].route.index&&(fn=matchPath({path:an.relativePath,caseSensitive:an.caseSensitive,end:!1},ln)),!fn)return null;Object.assign(Qe,fn.params),Mt.push({params:Qe,pathname:joinPaths([Je,fn.pathname]),pathnameBase:normalizePathname(joinPaths([Je,fn.pathnameBase])),route:hn}),fn.pathnameBase!=="/"&&(Je=joinPaths([Je,fn.pathnameBase]))}return Mt}function matchPath(Ke,Ge){typeof Ke=="string"&&(Ke={path:Ke,caseSensitive:!1,end:!0});let[$e,Ye]=compilePath(Ke.path,Ke.caseSensitive,Ke.end),Qe=Ge.match($e);if(!Qe)return null;let Je=Qe[0],Mt=Je.replace(/(.)\/+$/,"$1"),nn=Qe.slice(1);return{params:Ye.reduce((sn,{paramName:ln,isOptional:fn},hn)=>{if(ln==="*"){let Mi=nn[hn]||"";Mt=Je.slice(0,Je.length-Mi.length).replace(/(.)\/+$/,"$1")}const Xr=nn[hn];return fn&&!Xr?sn[ln]=void 0:sn[ln]=(Xr||"").replace(/%2F/g,"/"),sn},{}),pathname:Je,pathnameBase:Mt,pattern:Ke}}function compilePath(Ke,Ge=!1,$e=!0){warning(Ke==="*"||!Ke.endsWith("*")||Ke.endsWith("/*"),`Route path "${Ke}" will be treated as if it were "${Ke.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${Ke.replace(/\*$/,"/*")}".`);let Ye=[],Qe="^"+Ke.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(Mt,nn,an)=>(Ye.push({paramName:nn,isOptional:an!=null}),an?"/?([^\\/]+)?":"/([^\\/]+)"));return Ke.endsWith("*")?(Ye.push({paramName:"*"}),Qe+=Ke==="*"||Ke==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):$e?Qe+="\\/*$":Ke!==""&&Ke!=="/"&&(Qe+="(?:(?=\\/|$))"),[new RegExp(Qe,Ge?void 0:"i"),Ye]}function decodePath(Ke){try{return Ke.split("/").map(Ge=>decodeURIComponent(Ge).replace(/\//g,"%2F")).join("/")}catch(Ge){return warning(!1,`The URL path "${Ke}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${Ge}).`),Ke}}function stripBasename(Ke,Ge){if(Ge==="/")return Ke;if(!Ke.toLowerCase().startsWith(Ge.toLowerCase()))return null;let $e=Ge.endsWith("/")?Ge.length-1:Ge.length,Ye=Ke.charAt($e);return Ye&&Ye!=="/"?null:Ke.slice($e)||"/"}function resolvePath(Ke,Ge="/"){let{pathname:$e,search:Ye="",hash:Qe=""}=typeof Ke=="string"?parsePath(Ke):Ke;return{pathname:$e?$e.startsWith("/")?$e:resolvePathname($e,Ge):Ge,search:normalizeSearch(Ye),hash:normalizeHash(Qe)}}function resolvePathname(Ke,Ge){let $e=Ge.replace(/\/+$/,"").split("/");return Ke.split("/").forEach(Qe=>{Qe===".."?$e.length>1&&$e.pop():Qe!=="."&&$e.push(Qe)}),$e.length>1?$e.join("/"):"/"}function getInvalidPathError(Ke,Ge,$e,Ye){return`Cannot include a '${Ke}' character in a manually specified \`to.${Ge}\` field [${JSON.stringify(Ye)}].  Please separate it out to the \`to.${$e}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function getPathContributingMatches(Ke){return Ke.filter((Ge,$e)=>$e===0||Ge.route.path&&Ge.route.path.length>0)}function getResolveToMatches(Ke){let Ge=getPathContributingMatches(Ke);return Ge.map(($e,Ye)=>Ye===Ge.length-1?$e.pathname:$e.pathnameBase)}function resolveTo(Ke,Ge,$e,Ye=!1){let Qe;typeof Ke=="string"?Qe=parsePath(Ke):(Qe={...Ke},invariant(!Qe.pathname||!Qe.pathname.includes("?"),getInvalidPathError("?","pathname","search",Qe)),invariant(!Qe.pathname||!Qe.pathname.includes("#"),getInvalidPathError("#","pathname","hash",Qe)),invariant(!Qe.search||!Qe.search.includes("#"),getInvalidPathError("#","search","hash",Qe)));let Je=Ke===""||Qe.pathname==="",Mt=Je?"/":Qe.pathname,nn;if(Mt==null)nn=$e;else{let fn=Ge.length-1;if(!Ye&&Mt.startsWith("..")){let hn=Mt.split("/");for(;hn[0]==="..";)hn.shift(),fn-=1;Qe.pathname=hn.join("/")}nn=fn>=0?Ge[fn]:"/"}let an=resolvePath(Qe,nn),sn=Mt&&Mt!=="/"&&Mt.endsWith("/"),ln=(Je||Mt===".")&&$e.endsWith("/");return!an.pathname.endsWith("/")&&(sn||ln)&&(an.pathname+="/"),an}var joinPaths=Ke=>Ke.join("/").replace(/\/\/+/g,"/"),normalizePathname=Ke=>Ke.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=Ke=>!Ke||Ke==="?"?"":Ke.startsWith("?")?Ke:"?"+Ke,normalizeHash=Ke=>!Ke||Ke==="#"?"":Ke.startsWith("#")?Ke:"#"+Ke;function isRouteErrorResponse(Ke){return Ke!=null&&typeof Ke.status=="number"&&typeof Ke.statusText=="string"&&typeof Ke.internal=="boolean"&&"data"in Ke}var validMutationMethodsArr=["POST","PUT","PATCH","DELETE"];new Set(validMutationMethodsArr);var validRequestMethodsArr=["GET",...validMutationMethodsArr];new Set(validRequestMethodsArr);var DataRouterContext=reactExports.createContext(null);DataRouterContext.displayName="DataRouter";var DataRouterStateContext=reactExports.createContext(null);DataRouterStateContext.displayName="DataRouterState";var ViewTransitionContext=reactExports.createContext({isTransitioning:!1});ViewTransitionContext.displayName="ViewTransition";var FetchersContext=reactExports.createContext(new Map);FetchersContext.displayName="Fetchers";var AwaitContext=reactExports.createContext(null);AwaitContext.displayName="Await";var NavigationContext=reactExports.createContext(null);NavigationContext.displayName="Navigation";var LocationContext=reactExports.createContext(null);LocationContext.displayName="Location";var RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1});RouteContext.displayName="Route";var RouteErrorContext=reactExports.createContext(null);RouteErrorContext.displayName="RouteError";function useHref(Ke,{relative:Ge}={}){invariant(useInRouterContext(),"useHref() may be used only in the context of a <Router> component.");let{basename:$e,navigator:Ye}=reactExports.useContext(NavigationContext),{hash:Qe,pathname:Je,search:Mt}=useResolvedPath(Ke,{relative:Ge}),nn=Je;return $e!=="/"&&(nn=Je==="/"?$e:joinPaths([$e,Je])),Ye.createHref({pathname:nn,search:Mt,hash:Qe})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return invariant(useInRouterContext(),"useLocation() may be used only in the context of a <Router> component."),reactExports.useContext(LocationContext).location}var navigateEffectWarning="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function useIsomorphicLayoutEffect(Ke){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(Ke)}function useNavigate(){let{isDataRoute:Ke}=reactExports.useContext(RouteContext);return Ke?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){invariant(useInRouterContext(),"useNavigate() may be used only in the context of a <Router> component.");let Ke=reactExports.useContext(DataRouterContext),{basename:Ge,navigator:$e}=reactExports.useContext(NavigationContext),{matches:Ye}=reactExports.useContext(RouteContext),{pathname:Qe}=useLocation(),Je=JSON.stringify(getResolveToMatches(Ye)),Mt=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{Mt.current=!0}),reactExports.useCallback((an,sn={})=>{if(warning(Mt.current,navigateEffectWarning),!Mt.current)return;if(typeof an=="number"){$e.go(an);return}let ln=resolveTo(an,JSON.parse(Je),Qe,sn.relative==="path");Ke==null&&Ge!=="/"&&(ln.pathname=ln.pathname==="/"?Ge:joinPaths([Ge,ln.pathname])),(sn.replace?$e.replace:$e.push)(ln,sn.state,sn)},[Ge,$e,Je,Qe,Ke])}reactExports.createContext(null);function useParams(){let{matches:Ke}=reactExports.useContext(RouteContext),Ge=Ke[Ke.length-1];return Ge?Ge.params:{}}function useResolvedPath(Ke,{relative:Ge}={}){let{matches:$e}=reactExports.useContext(RouteContext),{pathname:Ye}=useLocation(),Qe=JSON.stringify(getResolveToMatches($e));return reactExports.useMemo(()=>resolveTo(Ke,JSON.parse(Qe),Ye,Ge==="path"),[Ke,Qe,Ye,Ge])}function useRoutes(Ke,Ge){return useRoutesImpl(Ke,Ge)}function useRoutesImpl(Ke,Ge,$e,Ye){var ho;invariant(useInRouterContext(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:Qe,static:Je}=reactExports.useContext(NavigationContext),{matches:Mt}=reactExports.useContext(RouteContext),nn=Mt[Mt.length-1],an=nn?nn.params:{},sn=nn?nn.pathname:"/",ln=nn?nn.pathnameBase:"/",fn=nn&&nn.route;{let mo=fn&&fn.path||"";warningOnce(sn,!fn||mo.endsWith("*")||mo.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${sn}" (under <Route path="${mo}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${mo}"> to <Route path="${mo==="/"?"*":`${mo}/*`}">.`)}let hn=useLocation(),Xr;if(Ge){let mo=typeof Ge=="string"?parsePath(Ge):Ge;invariant(ln==="/"||((ho=mo.pathname)==null?void 0:ho.startsWith(ln)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${ln}" but pathname "${mo.pathname}" was given in the \`location\` prop.`),Xr=mo}else Xr=hn;let Mi=Xr.pathname||"/",co=Mi;if(ln!=="/"){let mo=ln.replace(/^\//,"").split("/");co="/"+Mi.replace(/^\//,"").split("/").slice(mo.length).join("/")}let lo=!Je&&$e&&$e.matches&&$e.matches.length>0?$e.matches:matchRoutes(Ke,{pathname:co});warning(fn||lo!=null,`No routes matched location "${Xr.pathname}${Xr.search}${Xr.hash}" `),warning(lo==null||lo[lo.length-1].route.element!==void 0||lo[lo.length-1].route.Component!==void 0||lo[lo.length-1].route.lazy!==void 0,`Matched leaf route at location "${Xr.pathname}${Xr.search}${Xr.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let uo=_renderMatches(lo&&lo.map(mo=>Object.assign({},mo,{params:Object.assign({},an,mo.params),pathname:joinPaths([ln,Qe.encodeLocation?Qe.encodeLocation(mo.pathname).pathname:mo.pathname]),pathnameBase:mo.pathnameBase==="/"?ln:joinPaths([ln,Qe.encodeLocation?Qe.encodeLocation(mo.pathnameBase).pathname:mo.pathnameBase])})),Mt,$e,Ye);return Ge&&uo?reactExports.createElement(LocationContext.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...Xr},navigationType:"POP"}},uo):uo}function DefaultErrorComponent(){let Ke=useRouteError(),Ge=isRouteErrorResponse(Ke)?`${Ke.status} ${Ke.statusText}`:Ke instanceof Error?Ke.message:JSON.stringify(Ke),$e=Ke instanceof Error?Ke.stack:null,Ye="rgba(200,200,200, 0.5)",Qe={padding:"0.5rem",backgroundColor:Ye},Je={padding:"2px 4px",backgroundColor:Ye},Mt=null;return console.error("Error handled by React Router default ErrorBoundary:",Ke),Mt=reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("p",null," Hey developer "),reactExports.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",reactExports.createElement("code",{style:Je},"ErrorBoundary")," or"," ",reactExports.createElement("code",{style:Je},"errorElement")," prop on your route.")),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},Ge),$e?reactExports.createElement("pre",{style:Qe},$e):null,Mt)}var defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null),RenderErrorBoundary=class extends reactExports.Component{constructor(Ke){super(Ke),this.state={location:Ke.location,revalidation:Ke.revalidation,error:Ke.error}}static getDerivedStateFromError(Ke){return{error:Ke}}static getDerivedStateFromProps(Ke,Ge){return Ge.location!==Ke.location||Ge.revalidation!=="idle"&&Ke.revalidation==="idle"?{error:Ke.error,location:Ke.location,revalidation:Ke.revalidation}:{error:Ke.error!==void 0?Ke.error:Ge.error,location:Ge.location,revalidation:Ke.revalidation||Ge.revalidation}}componentDidCatch(Ke,Ge){console.error("React Router caught the following error during render",Ke,Ge)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function RenderedRoute({routeContext:Ke,match:Ge,children:$e}){let Ye=reactExports.useContext(DataRouterContext);return Ye&&Ye.static&&Ye.staticContext&&(Ge.route.errorElement||Ge.route.ErrorBoundary)&&(Ye.staticContext._deepestRenderedBoundaryId=Ge.route.id),reactExports.createElement(RouteContext.Provider,{value:Ke},$e)}function _renderMatches(Ke,Ge=[],$e=null,Ye=null){if(Ke==null){if(!$e)return null;if($e.errors)Ke=$e.matches;else if(Ge.length===0&&!$e.initialized&&$e.matches.length>0)Ke=$e.matches;else return null}let Qe=Ke,Je=$e==null?void 0:$e.errors;if(Je!=null){let an=Qe.findIndex(sn=>sn.route.id&&(Je==null?void 0:Je[sn.route.id])!==void 0);invariant(an>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(Je).join(",")}`),Qe=Qe.slice(0,Math.min(Qe.length,an+1))}let Mt=!1,nn=-1;if($e)for(let an=0;an<Qe.length;an++){let sn=Qe[an];if((sn.route.HydrateFallback||sn.route.hydrateFallbackElement)&&(nn=an),sn.route.id){let{loaderData:ln,errors:fn}=$e,hn=sn.route.loader&&!ln.hasOwnProperty(sn.route.id)&&(!fn||fn[sn.route.id]===void 0);if(sn.route.lazy||hn){Mt=!0,nn>=0?Qe=Qe.slice(0,nn+1):Qe=[Qe[0]];break}}}return Qe.reduceRight((an,sn,ln)=>{let fn,hn=!1,Xr=null,Mi=null;$e&&(fn=Je&&sn.route.id?Je[sn.route.id]:void 0,Xr=sn.route.errorElement||defaultErrorElement,Mt&&(nn<0&&ln===0?(warningOnce("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),hn=!0,Mi=null):nn===ln&&(hn=!0,Mi=sn.route.hydrateFallbackElement||null)));let co=Ge.concat(Qe.slice(0,ln+1)),lo=()=>{let uo;return fn?uo=Xr:hn?uo=Mi:sn.route.Component?uo=reactExports.createElement(sn.route.Component,null):sn.route.element?uo=sn.route.element:uo=an,reactExports.createElement(RenderedRoute,{match:sn,routeContext:{outlet:an,matches:co,isDataRoute:$e!=null},children:uo})};return $e&&(sn.route.ErrorBoundary||sn.route.errorElement||ln===0)?reactExports.createElement(RenderErrorBoundary,{location:$e.location,revalidation:$e.revalidation,component:Xr,error:fn,children:lo(),routeContext:{outlet:null,matches:co,isDataRoute:!0}}):lo()},null)}function getDataRouterConsoleError(Ke){return`${Ke} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext(Ke){let Ge=reactExports.useContext(DataRouterContext);return invariant(Ge,getDataRouterConsoleError(Ke)),Ge}function useDataRouterState(Ke){let Ge=reactExports.useContext(DataRouterStateContext);return invariant(Ge,getDataRouterConsoleError(Ke)),Ge}function useRouteContext(Ke){let Ge=reactExports.useContext(RouteContext);return invariant(Ge,getDataRouterConsoleError(Ke)),Ge}function useCurrentRouteId(Ke){let Ge=useRouteContext(Ke),$e=Ge.matches[Ge.matches.length-1];return invariant($e.route.id,`${Ke} can only be used on routes that contain a unique "id"`),$e.route.id}function useRouteId(){return useCurrentRouteId("useRouteId")}function useRouteError(){var Ye;let Ke=reactExports.useContext(RouteErrorContext),Ge=useDataRouterState("useRouteError"),$e=useCurrentRouteId("useRouteError");return Ke!==void 0?Ke:(Ye=Ge.errors)==null?void 0:Ye[$e]}function useNavigateStable(){let{router:Ke}=useDataRouterContext("useNavigate"),Ge=useCurrentRouteId("useNavigate"),$e=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{$e.current=!0}),reactExports.useCallback(async(Qe,Je={})=>{warning($e.current,navigateEffectWarning),$e.current&&(typeof Qe=="number"?Ke.navigate(Qe):await Ke.navigate(Qe,{fromRouteId:Ge,...Je}))},[Ke,Ge])}var alreadyWarned={};function warningOnce(Ke,Ge,$e){!Ge&&!alreadyWarned[Ke]&&(alreadyWarned[Ke]=!0,warning(!1,$e))}reactExports.memo(DataRoutes);function DataRoutes({routes:Ke,future:Ge,state:$e}){return useRoutesImpl(Ke,void 0,$e,Ge)}function Route(Ke){invariant(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Router({basename:Ke="/",children:Ge=null,location:$e,navigationType:Ye="POP",navigator:Qe,static:Je=!1}){invariant(!useInRouterContext(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let Mt=Ke.replace(/^\/*/,"/"),nn=reactExports.useMemo(()=>({basename:Mt,navigator:Qe,static:Je,future:{}}),[Mt,Qe,Je]);typeof $e=="string"&&($e=parsePath($e));let{pathname:an="/",search:sn="",hash:ln="",state:fn=null,key:hn="default"}=$e,Xr=reactExports.useMemo(()=>{let Mi=stripBasename(an,Mt);return Mi==null?null:{location:{pathname:Mi,search:sn,hash:ln,state:fn,key:hn},navigationType:Ye}},[Mt,an,sn,ln,fn,hn,Ye]);return warning(Xr!=null,`<Router basename="${Mt}"> is not able to match the URL "${an}${sn}${ln}" because it does not start with the basename, so the <Router> won't render anything.`),Xr==null?null:reactExports.createElement(NavigationContext.Provider,{value:nn},reactExports.createElement(LocationContext.Provider,{children:Ge,value:Xr}))}function Routes({children:Ke,location:Ge}){return useRoutes(createRoutesFromChildren(Ke),Ge)}function createRoutesFromChildren(Ke,Ge=[]){let $e=[];return reactExports.Children.forEach(Ke,(Ye,Qe)=>{if(!reactExports.isValidElement(Ye))return;let Je=[...Ge,Qe];if(Ye.type===reactExports.Fragment){$e.push.apply($e,createRoutesFromChildren(Ye.props.children,Je));return}invariant(Ye.type===Route,`[${typeof Ye.type=="string"?Ye.type:Ye.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),invariant(!Ye.props.index||!Ye.props.children,"An index route cannot have child routes.");let Mt={id:Ye.props.id||Je.join("-"),caseSensitive:Ye.props.caseSensitive,element:Ye.props.element,Component:Ye.props.Component,index:Ye.props.index,path:Ye.props.path,loader:Ye.props.loader,action:Ye.props.action,hydrateFallbackElement:Ye.props.hydrateFallbackElement,HydrateFallback:Ye.props.HydrateFallback,errorElement:Ye.props.errorElement,ErrorBoundary:Ye.props.ErrorBoundary,hasErrorBoundary:Ye.props.hasErrorBoundary===!0||Ye.props.ErrorBoundary!=null||Ye.props.errorElement!=null,shouldRevalidate:Ye.props.shouldRevalidate,handle:Ye.props.handle,lazy:Ye.props.lazy};Ye.props.children&&(Mt.children=createRoutesFromChildren(Ye.props.children,Je)),$e.push(Mt)}),$e}var defaultMethod="get",defaultEncType="application/x-www-form-urlencoded";function isHtmlElement(Ke){return Ke!=null&&typeof Ke.tagName=="string"}function isButtonElement(Ke){return isHtmlElement(Ke)&&Ke.tagName.toLowerCase()==="button"}function isFormElement(Ke){return isHtmlElement(Ke)&&Ke.tagName.toLowerCase()==="form"}function isInputElement(Ke){return isHtmlElement(Ke)&&Ke.tagName.toLowerCase()==="input"}function isModifiedEvent(Ke){return!!(Ke.metaKey||Ke.altKey||Ke.ctrlKey||Ke.shiftKey)}function shouldProcessLinkClick(Ke,Ge){return Ke.button===0&&(!Ge||Ge==="_self")&&!isModifiedEvent(Ke)}var _formDataSupportsSubmitter=null;function isFormDataSubmitterSupported(){if(_formDataSupportsSubmitter===null)try{new FormData(document.createElement("form"),0),_formDataSupportsSubmitter=!1}catch{_formDataSupportsSubmitter=!0}return _formDataSupportsSubmitter}var supportedFormEncTypes=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function getFormEncType(Ke){return Ke!=null&&!supportedFormEncTypes.has(Ke)?(warning(!1,`"${Ke}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${defaultEncType}"`),null):Ke}function getFormSubmissionInfo(Ke,Ge){let $e,Ye,Qe,Je,Mt;if(isFormElement(Ke)){let nn=Ke.getAttribute("action");Ye=nn?stripBasename(nn,Ge):null,$e=Ke.getAttribute("method")||defaultMethod,Qe=getFormEncType(Ke.getAttribute("enctype"))||defaultEncType,Je=new FormData(Ke)}else if(isButtonElement(Ke)||isInputElement(Ke)&&(Ke.type==="submit"||Ke.type==="image")){let nn=Ke.form;if(nn==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let an=Ke.getAttribute("formaction")||nn.getAttribute("action");if(Ye=an?stripBasename(an,Ge):null,$e=Ke.getAttribute("formmethod")||nn.getAttribute("method")||defaultMethod,Qe=getFormEncType(Ke.getAttribute("formenctype"))||getFormEncType(nn.getAttribute("enctype"))||defaultEncType,Je=new FormData(nn,Ke),!isFormDataSubmitterSupported()){let{name:sn,type:ln,value:fn}=Ke;if(ln==="image"){let hn=sn?`${sn}.`:"";Je.append(`${hn}x`,"0"),Je.append(`${hn}y`,"0")}else sn&&Je.append(sn,fn)}}else{if(isHtmlElement(Ke))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');$e=defaultMethod,Ye=null,Qe=defaultEncType,Mt=Ke}return Je&&Qe==="text/plain"&&(Mt=Je,Je=void 0),{action:Ye,method:$e.toLowerCase(),encType:Qe,formData:Je,body:Mt}}function invariant2(Ke,Ge){if(Ke===!1||Ke===null||typeof Ke>"u")throw new Error(Ge)}async function loadRouteModule(Ke,Ge){if(Ke.id in Ge)return Ge[Ke.id];try{let $e=await import(Ke.module);return Ge[Ke.id]=$e,$e}catch($e){return console.error(`Error loading route module \`${Ke.module}\`, reloading page...`),console.error($e),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function isHtmlLinkDescriptor(Ke){return Ke==null?!1:Ke.href==null?Ke.rel==="preload"&&typeof Ke.imageSrcSet=="string"&&typeof Ke.imageSizes=="string":typeof Ke.rel=="string"&&typeof Ke.href=="string"}async function getKeyedPrefetchLinks(Ke,Ge,$e){let Ye=await Promise.all(Ke.map(async Qe=>{let Je=Ge.routes[Qe.route.id];if(Je){let Mt=await loadRouteModule(Je,$e);return Mt.links?Mt.links():[]}return[]}));return dedupeLinkDescriptors(Ye.flat(1).filter(isHtmlLinkDescriptor).filter(Qe=>Qe.rel==="stylesheet"||Qe.rel==="preload").map(Qe=>Qe.rel==="stylesheet"?{...Qe,rel:"prefetch",as:"style"}:{...Qe,rel:"prefetch"}))}function getNewMatchesForLinks(Ke,Ge,$e,Ye,Qe,Je){let Mt=(an,sn)=>$e[sn]?an.route.id!==$e[sn].route.id:!0,nn=(an,sn)=>{var ln;return $e[sn].pathname!==an.pathname||((ln=$e[sn].route.path)==null?void 0:ln.endsWith("*"))&&$e[sn].params["*"]!==an.params["*"]};return Je==="assets"?Ge.filter((an,sn)=>Mt(an,sn)||nn(an,sn)):Je==="data"?Ge.filter((an,sn)=>{var fn;let ln=Ye.routes[an.route.id];if(!ln||!ln.hasLoader)return!1;if(Mt(an,sn)||nn(an,sn))return!0;if(an.route.shouldRevalidate){let hn=an.route.shouldRevalidate({currentUrl:new URL(Qe.pathname+Qe.search+Qe.hash,window.origin),currentParams:((fn=$e[0])==null?void 0:fn.params)||{},nextUrl:new URL(Ke,window.origin),nextParams:an.params,defaultShouldRevalidate:!0});if(typeof hn=="boolean")return hn}return!0}):[]}function getModuleLinkHrefs(Ke,Ge,{includeHydrateFallback:$e}={}){return dedupeHrefs(Ke.map(Ye=>{let Qe=Ge.routes[Ye.route.id];if(!Qe)return[];let Je=[Qe.module];return Qe.clientActionModule&&(Je=Je.concat(Qe.clientActionModule)),Qe.clientLoaderModule&&(Je=Je.concat(Qe.clientLoaderModule)),$e&&Qe.hydrateFallbackModule&&(Je=Je.concat(Qe.hydrateFallbackModule)),Qe.imports&&(Je=Je.concat(Qe.imports)),Je}).flat(1))}function dedupeHrefs(Ke){return[...new Set(Ke)]}function sortKeys(Ke){let Ge={},$e=Object.keys(Ke).sort();for(let Ye of $e)Ge[Ye]=Ke[Ye];return Ge}function dedupeLinkDescriptors(Ke,Ge){let $e=new Set;return new Set(Ge),Ke.reduce((Ye,Qe)=>{let Je=JSON.stringify(sortKeys(Qe));return $e.has(Je)||($e.add(Je),Ye.push({key:Je,link:Qe})),Ye},[])}function singleFetchUrl(Ke,Ge){let $e=typeof Ke=="string"?new URL(Ke,typeof window>"u"?"server://singlefetch/":window.location.origin):Ke;return $e.pathname==="/"?$e.pathname="_root.data":Ge&&stripBasename($e.pathname,Ge)==="/"?$e.pathname=`${Ge.replace(/\/$/,"")}/_root.data`:$e.pathname=`${$e.pathname.replace(/\/$/,"")}.data`,$e}function useDataRouterContext2(){let Ke=reactExports.useContext(DataRouterContext);return invariant2(Ke,"You must render this element inside a <DataRouterContext.Provider> element"),Ke}function useDataRouterStateContext(){let Ke=reactExports.useContext(DataRouterStateContext);return invariant2(Ke,"You must render this element inside a <DataRouterStateContext.Provider> element"),Ke}var FrameworkContext=reactExports.createContext(void 0);FrameworkContext.displayName="FrameworkContext";function useFrameworkContext(){let Ke=reactExports.useContext(FrameworkContext);return invariant2(Ke,"You must render this element inside a <HydratedRouter> element"),Ke}function usePrefetchBehavior(Ke,Ge){let $e=reactExports.useContext(FrameworkContext),[Ye,Qe]=reactExports.useState(!1),[Je,Mt]=reactExports.useState(!1),{onFocus:nn,onBlur:an,onMouseEnter:sn,onMouseLeave:ln,onTouchStart:fn}=Ge,hn=reactExports.useRef(null);reactExports.useEffect(()=>{if(Ke==="render"&&Mt(!0),Ke==="viewport"){let co=uo=>{uo.forEach(ho=>{Mt(ho.isIntersecting)})},lo=new IntersectionObserver(co,{threshold:.5});return hn.current&&lo.observe(hn.current),()=>{lo.disconnect()}}},[Ke]),reactExports.useEffect(()=>{if(Ye){let co=setTimeout(()=>{Mt(!0)},100);return()=>{clearTimeout(co)}}},[Ye]);let Xr=()=>{Qe(!0)},Mi=()=>{Qe(!1),Mt(!1)};return $e?Ke!=="intent"?[Je,hn,{}]:[Je,hn,{onFocus:composeEventHandlers(nn,Xr),onBlur:composeEventHandlers(an,Mi),onMouseEnter:composeEventHandlers(sn,Xr),onMouseLeave:composeEventHandlers(ln,Mi),onTouchStart:composeEventHandlers(fn,Xr)}]:[!1,hn,{}]}function composeEventHandlers(Ke,Ge){return $e=>{Ke&&Ke($e),$e.defaultPrevented||Ge($e)}}function PrefetchPageLinks({page:Ke,...Ge}){let{router:$e}=useDataRouterContext2(),Ye=reactExports.useMemo(()=>matchRoutes($e.routes,Ke,$e.basename),[$e.routes,Ke,$e.basename]);return Ye?reactExports.createElement(PrefetchPageLinksImpl,{page:Ke,matches:Ye,...Ge}):null}function useKeyedPrefetchLinks(Ke){let{manifest:Ge,routeModules:$e}=useFrameworkContext(),[Ye,Qe]=reactExports.useState([]);return reactExports.useEffect(()=>{let Je=!1;return getKeyedPrefetchLinks(Ke,Ge,$e).then(Mt=>{Je||Qe(Mt)}),()=>{Je=!0}},[Ke,Ge,$e]),Ye}function PrefetchPageLinksImpl({page:Ke,matches:Ge,...$e}){let Ye=useLocation(),{manifest:Qe,routeModules:Je}=useFrameworkContext(),{basename:Mt}=useDataRouterContext2(),{loaderData:nn,matches:an}=useDataRouterStateContext(),sn=reactExports.useMemo(()=>getNewMatchesForLinks(Ke,Ge,an,Qe,Ye,"data"),[Ke,Ge,an,Qe,Ye]),ln=reactExports.useMemo(()=>getNewMatchesForLinks(Ke,Ge,an,Qe,Ye,"assets"),[Ke,Ge,an,Qe,Ye]),fn=reactExports.useMemo(()=>{if(Ke===Ye.pathname+Ye.search+Ye.hash)return[];let Mi=new Set,co=!1;if(Ge.forEach(uo=>{var mo;let ho=Qe.routes[uo.route.id];!ho||!ho.hasLoader||(!sn.some(_d=>_d.route.id===uo.route.id)&&uo.route.id in nn&&((mo=Je[uo.route.id])!=null&&mo.shouldRevalidate)||ho.hasClientLoader?co=!0:Mi.add(uo.route.id))}),Mi.size===0)return[];let lo=singleFetchUrl(Ke,Mt);return co&&Mi.size>0&&lo.searchParams.set("_routes",Ge.filter(uo=>Mi.has(uo.route.id)).map(uo=>uo.route.id).join(",")),[lo.pathname+lo.search]},[Mt,nn,Ye,Qe,sn,Ge,Ke,Je]),hn=reactExports.useMemo(()=>getModuleLinkHrefs(ln,Qe),[ln,Qe]),Xr=useKeyedPrefetchLinks(ln);return reactExports.createElement(reactExports.Fragment,null,fn.map(Mi=>reactExports.createElement("link",{key:Mi,rel:"prefetch",as:"fetch",href:Mi,...$e})),hn.map(Mi=>reactExports.createElement("link",{key:Mi,rel:"modulepreload",href:Mi,...$e})),Xr.map(({key:Mi,link:co})=>reactExports.createElement("link",{key:Mi,...co})))}function mergeRefs(...Ke){return Ge=>{Ke.forEach($e=>{typeof $e=="function"?$e(Ge):$e!=null&&($e.current=Ge)})}}var isBrowser$1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{isBrowser$1&&(window.__reactRouterVersion="7.3.0")}catch{}function BrowserRouter({basename:Ke,children:Ge,window:$e}){let Ye=reactExports.useRef();Ye.current==null&&(Ye.current=createBrowserHistory({window:$e,v5Compat:!0}));let Qe=Ye.current,[Je,Mt]=reactExports.useState({action:Qe.action,location:Qe.location}),nn=reactExports.useCallback(an=>{reactExports.startTransition(()=>Mt(an))},[Mt]);return reactExports.useLayoutEffect(()=>Qe.listen(nn),[Qe,nn]),reactExports.createElement(Router,{basename:Ke,children:Ge,location:Je.location,navigationType:Je.action,navigator:Qe})}var ABSOLUTE_URL_REGEX2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link=reactExports.forwardRef(function({onClick:Ge,discover:$e="render",prefetch:Ye="none",relative:Qe,reloadDocument:Je,replace:Mt,state:nn,target:an,to:sn,preventScrollReset:ln,viewTransition:fn,...hn},Xr){let{basename:Mi}=reactExports.useContext(NavigationContext),co=typeof sn=="string"&&ABSOLUTE_URL_REGEX2.test(sn),lo,uo=!1;if(typeof sn=="string"&&co&&(lo=sn,isBrowser$1))try{let ip=new URL(window.location.href),lp=sn.startsWith("//")?new URL(ip.protocol+sn):new URL(sn),vp=stripBasename(lp.pathname,Mi);lp.origin===ip.origin&&vp!=null?sn=vp+lp.search+lp.hash:uo=!0}catch{warning(!1,`<Link to="${sn}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let ho=useHref(sn,{relative:Qe}),[mo,_d,ep]=usePrefetchBehavior(Ye,hn),rp=useLinkClickHandler(sn,{replace:Mt,state:nn,target:an,preventScrollReset:ln,relative:Qe,viewTransition:fn});function sp(ip){Ge&&Ge(ip),ip.defaultPrevented||rp(ip)}let op=reactExports.createElement("a",{...hn,...ep,href:lo||ho,onClick:uo||Je?Ge:sp,ref:mergeRefs(Xr,_d),target:an,"data-discover":!co&&$e==="render"?"true":void 0});return mo&&!co?reactExports.createElement(reactExports.Fragment,null,op,reactExports.createElement(PrefetchPageLinks,{page:ho})):op});Link.displayName="Link";var NavLink=reactExports.forwardRef(function({"aria-current":Ge="page",caseSensitive:$e=!1,className:Ye="",end:Qe=!1,style:Je,to:Mt,viewTransition:nn,children:an,...sn},ln){let fn=useResolvedPath(Mt,{relative:sn.relative}),hn=useLocation(),Xr=reactExports.useContext(DataRouterStateContext),{navigator:Mi,basename:co}=reactExports.useContext(NavigationContext),lo=Xr!=null&&useViewTransitionState(fn)&&nn===!0,uo=Mi.encodeLocation?Mi.encodeLocation(fn).pathname:fn.pathname,ho=hn.pathname,mo=Xr&&Xr.navigation&&Xr.navigation.location?Xr.navigation.location.pathname:null;$e||(ho=ho.toLowerCase(),mo=mo?mo.toLowerCase():null,uo=uo.toLowerCase()),mo&&co&&(mo=stripBasename(mo,co)||mo);const _d=uo!=="/"&&uo.endsWith("/")?uo.length-1:uo.length;let ep=ho===uo||!Qe&&ho.startsWith(uo)&&ho.charAt(_d)==="/",rp=mo!=null&&(mo===uo||!Qe&&mo.startsWith(uo)&&mo.charAt(uo.length)==="/"),sp={isActive:ep,isPending:rp,isTransitioning:lo},op=ep?Ge:void 0,ip;typeof Ye=="function"?ip=Ye(sp):ip=[Ye,ep?"active":null,rp?"pending":null,lo?"transitioning":null].filter(Boolean).join(" ");let lp=typeof Je=="function"?Je(sp):Je;return reactExports.createElement(Link,{...sn,"aria-current":op,className:ip,ref:ln,style:lp,to:Mt,viewTransition:nn},typeof an=="function"?an(sp):an)});NavLink.displayName="NavLink";var Form=reactExports.forwardRef(({discover:Ke="render",fetcherKey:Ge,navigate:$e,reloadDocument:Ye,replace:Qe,state:Je,method:Mt=defaultMethod,action:nn,onSubmit:an,relative:sn,preventScrollReset:ln,viewTransition:fn,...hn},Xr)=>{let Mi=useSubmit(),co=useFormAction(nn,{relative:sn}),lo=Mt.toLowerCase()==="get"?"get":"post",uo=typeof nn=="string"&&ABSOLUTE_URL_REGEX2.test(nn),ho=mo=>{if(an&&an(mo),mo.defaultPrevented)return;mo.preventDefault();let _d=mo.nativeEvent.submitter,ep=(_d==null?void 0:_d.getAttribute("formmethod"))||Mt;Mi(_d||mo.currentTarget,{fetcherKey:Ge,method:ep,navigate:$e,replace:Qe,state:Je,relative:sn,preventScrollReset:ln,viewTransition:fn})};return reactExports.createElement("form",{ref:Xr,method:lo,action:co,onSubmit:Ye?an:ho,...hn,"data-discover":!uo&&Ke==="render"?"true":void 0})});Form.displayName="Form";function getDataRouterConsoleError2(Ke){return`${Ke} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext3(Ke){let Ge=reactExports.useContext(DataRouterContext);return invariant(Ge,getDataRouterConsoleError2(Ke)),Ge}function useLinkClickHandler(Ke,{target:Ge,replace:$e,state:Ye,preventScrollReset:Qe,relative:Je,viewTransition:Mt}={}){let nn=useNavigate(),an=useLocation(),sn=useResolvedPath(Ke,{relative:Je});return reactExports.useCallback(ln=>{if(shouldProcessLinkClick(ln,Ge)){ln.preventDefault();let fn=$e!==void 0?$e:createPath(an)===createPath(sn);nn(Ke,{replace:fn,state:Ye,preventScrollReset:Qe,relative:Je,viewTransition:Mt})}},[an,nn,sn,$e,Ye,Ge,Ke,Qe,Je,Mt])}var fetcherId=0,getUniqueFetcherId=()=>`__${String(++fetcherId)}__`;function useSubmit(){let{router:Ke}=useDataRouterContext3("useSubmit"),{basename:Ge}=reactExports.useContext(NavigationContext),$e=useRouteId();return reactExports.useCallback(async(Ye,Qe={})=>{let{action:Je,method:Mt,encType:nn,formData:an,body:sn}=getFormSubmissionInfo(Ye,Ge);if(Qe.navigate===!1){let ln=Qe.fetcherKey||getUniqueFetcherId();await Ke.fetch(ln,$e,Qe.action||Je,{preventScrollReset:Qe.preventScrollReset,formData:an,body:sn,formMethod:Qe.method||Mt,formEncType:Qe.encType||nn,flushSync:Qe.flushSync})}else await Ke.navigate(Qe.action||Je,{preventScrollReset:Qe.preventScrollReset,formData:an,body:sn,formMethod:Qe.method||Mt,formEncType:Qe.encType||nn,replace:Qe.replace,state:Qe.state,fromRouteId:$e,flushSync:Qe.flushSync,viewTransition:Qe.viewTransition})},[Ke,Ge,$e])}function useFormAction(Ke,{relative:Ge}={}){let{basename:$e}=reactExports.useContext(NavigationContext),Ye=reactExports.useContext(RouteContext);invariant(Ye,"useFormAction must be used inside a RouteContext");let[Qe]=Ye.matches.slice(-1),Je={...useResolvedPath(Ke||".",{relative:Ge})},Mt=useLocation();if(Ke==null){Je.search=Mt.search;let nn=new URLSearchParams(Je.search),an=nn.getAll("index");if(an.some(ln=>ln==="")){nn.delete("index"),an.filter(fn=>fn).forEach(fn=>nn.append("index",fn));let ln=nn.toString();Je.search=ln?`?${ln}`:""}}return(!Ke||Ke===".")&&Qe.route.index&&(Je.search=Je.search?Je.search.replace(/^\?/,"?index&"):"?index"),$e!=="/"&&(Je.pathname=Je.pathname==="/"?$e:joinPaths([$e,Je.pathname])),createPath(Je)}function useViewTransitionState(Ke,Ge={}){let $e=reactExports.useContext(ViewTransitionContext);invariant($e!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:Ye}=useDataRouterContext3("useViewTransitionState"),Qe=useResolvedPath(Ke,{relative:Ge.relative});if(!$e.isTransitioning)return!1;let Je=stripBasename($e.currentLocation.pathname,Ye)||$e.currentLocation.pathname,Mt=stripBasename($e.nextLocation.pathname,Ye)||$e.nextLocation.pathname;return matchPath(Qe.pathname,Mt)!=null||matchPath(Qe.pathname,Je)!=null}new TextEncoder;function bind(Ke,Ge){return function(){return Ke.apply(Ge,arguments)}}const{toString:toString$1}=Object.prototype,{getPrototypeOf}=Object,kindOf=(Ke=>Ge=>{const $e=toString$1.call(Ge);return Ke[$e]||(Ke[$e]=$e.slice(8,-1).toLowerCase())})(Object.create(null)),kindOfTest=Ke=>(Ke=Ke.toLowerCase(),Ge=>kindOf(Ge)===Ke),typeOfTest=Ke=>Ge=>typeof Ge===Ke,{isArray}=Array,isUndefined=typeOfTest("undefined");function isBuffer(Ke){return Ke!==null&&!isUndefined(Ke)&&Ke.constructor!==null&&!isUndefined(Ke.constructor)&&isFunction(Ke.constructor.isBuffer)&&Ke.constructor.isBuffer(Ke)}const isArrayBuffer=kindOfTest("ArrayBuffer");function isArrayBufferView(Ke){let Ge;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?Ge=ArrayBuffer.isView(Ke):Ge=Ke&&Ke.buffer&&isArrayBuffer(Ke.buffer),Ge}const isString=typeOfTest("string"),isFunction=typeOfTest("function"),isNumber$1=typeOfTest("number"),isObject$1=Ke=>Ke!==null&&typeof Ke=="object",isBoolean=Ke=>Ke===!0||Ke===!1,isPlainObject=Ke=>{if(kindOf(Ke)!=="object")return!1;const Ge=getPrototypeOf(Ke);return(Ge===null||Ge===Object.prototype||Object.getPrototypeOf(Ge)===null)&&!(Symbol.toStringTag in Ke)&&!(Symbol.iterator in Ke)},isDate=kindOfTest("Date"),isFile=kindOfTest("File"),isBlob=kindOfTest("Blob"),isFileList=kindOfTest("FileList"),isStream=Ke=>isObject$1(Ke)&&isFunction(Ke.pipe),isFormData=Ke=>{let Ge;return Ke&&(typeof FormData=="function"&&Ke instanceof FormData||isFunction(Ke.append)&&((Ge=kindOf(Ke))==="formdata"||Ge==="object"&&isFunction(Ke.toString)&&Ke.toString()==="[object FormData]"))},isURLSearchParams=kindOfTest("URLSearchParams"),[isReadableStream,isRequest,isResponse,isHeaders]=["ReadableStream","Request","Response","Headers"].map(kindOfTest),trim=Ke=>Ke.trim?Ke.trim():Ke.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function forEach(Ke,Ge,{allOwnKeys:$e=!1}={}){if(Ke===null||typeof Ke>"u")return;let Ye,Qe;if(typeof Ke!="object"&&(Ke=[Ke]),isArray(Ke))for(Ye=0,Qe=Ke.length;Ye<Qe;Ye++)Ge.call(null,Ke[Ye],Ye,Ke);else{const Je=$e?Object.getOwnPropertyNames(Ke):Object.keys(Ke),Mt=Je.length;let nn;for(Ye=0;Ye<Mt;Ye++)nn=Je[Ye],Ge.call(null,Ke[nn],nn,Ke)}}function findKey(Ke,Ge){Ge=Ge.toLowerCase();const $e=Object.keys(Ke);let Ye=$e.length,Qe;for(;Ye-- >0;)if(Qe=$e[Ye],Ge===Qe.toLowerCase())return Qe;return null}const _global=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,isContextDefined=Ke=>!isUndefined(Ke)&&Ke!==_global;function merge(){const{caseless:Ke}=isContextDefined(this)&&this||{},Ge={},$e=(Ye,Qe)=>{const Je=Ke&&findKey(Ge,Qe)||Qe;isPlainObject(Ge[Je])&&isPlainObject(Ye)?Ge[Je]=merge(Ge[Je],Ye):isPlainObject(Ye)?Ge[Je]=merge({},Ye):isArray(Ye)?Ge[Je]=Ye.slice():Ge[Je]=Ye};for(let Ye=0,Qe=arguments.length;Ye<Qe;Ye++)arguments[Ye]&&forEach(arguments[Ye],$e);return Ge}const extend=(Ke,Ge,$e,{allOwnKeys:Ye}={})=>(forEach(Ge,(Qe,Je)=>{$e&&isFunction(Qe)?Ke[Je]=bind(Qe,$e):Ke[Je]=Qe},{allOwnKeys:Ye}),Ke),stripBOM=Ke=>(Ke.charCodeAt(0)===65279&&(Ke=Ke.slice(1)),Ke),inherits=(Ke,Ge,$e,Ye)=>{Ke.prototype=Object.create(Ge.prototype,Ye),Ke.prototype.constructor=Ke,Object.defineProperty(Ke,"super",{value:Ge.prototype}),$e&&Object.assign(Ke.prototype,$e)},toFlatObject=(Ke,Ge,$e,Ye)=>{let Qe,Je,Mt;const nn={};if(Ge=Ge||{},Ke==null)return Ge;do{for(Qe=Object.getOwnPropertyNames(Ke),Je=Qe.length;Je-- >0;)Mt=Qe[Je],(!Ye||Ye(Mt,Ke,Ge))&&!nn[Mt]&&(Ge[Mt]=Ke[Mt],nn[Mt]=!0);Ke=$e!==!1&&getPrototypeOf(Ke)}while(Ke&&(!$e||$e(Ke,Ge))&&Ke!==Object.prototype);return Ge},endsWith=(Ke,Ge,$e)=>{Ke=String(Ke),($e===void 0||$e>Ke.length)&&($e=Ke.length),$e-=Ge.length;const Ye=Ke.indexOf(Ge,$e);return Ye!==-1&&Ye===$e},toArray$1=Ke=>{if(!Ke)return null;if(isArray(Ke))return Ke;let Ge=Ke.length;if(!isNumber$1(Ge))return null;const $e=new Array(Ge);for(;Ge-- >0;)$e[Ge]=Ke[Ge];return $e},isTypedArray=(Ke=>Ge=>Ke&&Ge instanceof Ke)(typeof Uint8Array<"u"&&getPrototypeOf(Uint8Array)),forEachEntry=(Ke,Ge)=>{const Ye=(Ke&&Ke[Symbol.iterator]).call(Ke);let Qe;for(;(Qe=Ye.next())&&!Qe.done;){const Je=Qe.value;Ge.call(Ke,Je[0],Je[1])}},matchAll=(Ke,Ge)=>{let $e;const Ye=[];for(;($e=Ke.exec(Ge))!==null;)Ye.push($e);return Ye},isHTMLForm=kindOfTest("HTMLFormElement"),toCamelCase=Ke=>Ke.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function($e,Ye,Qe){return Ye.toUpperCase()+Qe}),hasOwnProperty=(({hasOwnProperty:Ke})=>(Ge,$e)=>Ke.call(Ge,$e))(Object.prototype),isRegExp=kindOfTest("RegExp"),reduceDescriptors=(Ke,Ge)=>{const $e=Object.getOwnPropertyDescriptors(Ke),Ye={};forEach($e,(Qe,Je)=>{let Mt;(Mt=Ge(Qe,Je,Ke))!==!1&&(Ye[Je]=Mt||Qe)}),Object.defineProperties(Ke,Ye)},freezeMethods=Ke=>{reduceDescriptors(Ke,(Ge,$e)=>{if(isFunction(Ke)&&["arguments","caller","callee"].indexOf($e)!==-1)return!1;const Ye=Ke[$e];if(isFunction(Ye)){if(Ge.enumerable=!1,"writable"in Ge){Ge.writable=!1;return}Ge.set||(Ge.set=()=>{throw Error("Can not rewrite read-only method '"+$e+"'")})}})},toObjectSet=(Ke,Ge)=>{const $e={},Ye=Qe=>{Qe.forEach(Je=>{$e[Je]=!0})};return isArray(Ke)?Ye(Ke):Ye(String(Ke).split(Ge)),$e},noop=()=>{},toFiniteNumber=(Ke,Ge)=>Ke!=null&&Number.isFinite(Ke=+Ke)?Ke:Ge;function isSpecCompliantForm(Ke){return!!(Ke&&isFunction(Ke.append)&&Ke[Symbol.toStringTag]==="FormData"&&Ke[Symbol.iterator])}const toJSONObject=Ke=>{const Ge=new Array(10),$e=(Ye,Qe)=>{if(isObject$1(Ye)){if(Ge.indexOf(Ye)>=0)return;if(!("toJSON"in Ye)){Ge[Qe]=Ye;const Je=isArray(Ye)?[]:{};return forEach(Ye,(Mt,nn)=>{const an=$e(Mt,Qe+1);!isUndefined(an)&&(Je[nn]=an)}),Ge[Qe]=void 0,Je}}return Ye};return $e(Ke,0)},isAsyncFn=kindOfTest("AsyncFunction"),isThenable=Ke=>Ke&&(isObject$1(Ke)||isFunction(Ke))&&isFunction(Ke.then)&&isFunction(Ke.catch),_setImmediate=((Ke,Ge)=>Ke?setImmediate:Ge?(($e,Ye)=>(_global.addEventListener("message",({source:Qe,data:Je})=>{Qe===_global&&Je===$e&&Ye.length&&Ye.shift()()},!1),Qe=>{Ye.push(Qe),_global.postMessage($e,"*")}))(`axios@${Math.random()}`,[]):$e=>setTimeout($e))(typeof setImmediate=="function",isFunction(_global.postMessage)),asap=typeof queueMicrotask<"u"?queueMicrotask.bind(_global):typeof process<"u"&&process.nextTick||_setImmediate,utils$1={isArray,isArrayBuffer,isBuffer,isFormData,isArrayBufferView,isString,isNumber:isNumber$1,isBoolean,isObject:isObject$1,isPlainObject,isReadableStream,isRequest,isResponse,isHeaders,isUndefined,isDate,isFile,isBlob,isRegExp,isFunction,isStream,isURLSearchParams,isTypedArray,isFileList,forEach,merge,extend,trim,stripBOM,inherits,toFlatObject,kindOf,kindOfTest,endsWith,toArray:toArray$1,forEachEntry,matchAll,isHTMLForm,hasOwnProperty,hasOwnProp:hasOwnProperty,reduceDescriptors,freezeMethods,toObjectSet,toCamelCase,noop,toFiniteNumber,findKey,global:_global,isContextDefined,isSpecCompliantForm,toJSONObject,isAsyncFn,isThenable,setImmediate:_setImmediate,asap};function AxiosError$1(Ke,Ge,$e,Ye,Qe){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=Ke,this.name="AxiosError",Ge&&(this.code=Ge),$e&&(this.config=$e),Ye&&(this.request=Ye),Qe&&(this.response=Qe,this.status=Qe.status?Qe.status:null)}utils$1.inherits(AxiosError$1,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:utils$1.toJSONObject(this.config),code:this.code,status:this.status}}});const prototype$1=AxiosError$1.prototype,descriptors={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(Ke=>{descriptors[Ke]={value:Ke}});Object.defineProperties(AxiosError$1,descriptors);Object.defineProperty(prototype$1,"isAxiosError",{value:!0});AxiosError$1.from=(Ke,Ge,$e,Ye,Qe,Je)=>{const Mt=Object.create(prototype$1);return utils$1.toFlatObject(Ke,Mt,function(an){return an!==Error.prototype},nn=>nn!=="isAxiosError"),AxiosError$1.call(Mt,Ke.message,Ge,$e,Ye,Qe),Mt.cause=Ke,Mt.name=Ke.name,Je&&Object.assign(Mt,Je),Mt};const httpAdapter=null;function isVisitable(Ke){return utils$1.isPlainObject(Ke)||utils$1.isArray(Ke)}function removeBrackets(Ke){return utils$1.endsWith(Ke,"[]")?Ke.slice(0,-2):Ke}function renderKey(Ke,Ge,$e){return Ke?Ke.concat(Ge).map(function(Qe,Je){return Qe=removeBrackets(Qe),!$e&&Je?"["+Qe+"]":Qe}).join($e?".":""):Ge}function isFlatArray(Ke){return utils$1.isArray(Ke)&&!Ke.some(isVisitable)}const predicates=utils$1.toFlatObject(utils$1,{},null,function(Ge){return/^is[A-Z]/.test(Ge)});function toFormData$1(Ke,Ge,$e){if(!utils$1.isObject(Ke))throw new TypeError("target must be an object");Ge=Ge||new FormData,$e=utils$1.toFlatObject($e,{metaTokens:!0,dots:!1,indexes:!1},!1,function(co,lo){return!utils$1.isUndefined(lo[co])});const Ye=$e.metaTokens,Qe=$e.visitor||ln,Je=$e.dots,Mt=$e.indexes,an=($e.Blob||typeof Blob<"u"&&Blob)&&utils$1.isSpecCompliantForm(Ge);if(!utils$1.isFunction(Qe))throw new TypeError("visitor must be a function");function sn(Mi){if(Mi===null)return"";if(utils$1.isDate(Mi))return Mi.toISOString();if(!an&&utils$1.isBlob(Mi))throw new AxiosError$1("Blob is not supported. Use a Buffer instead.");return utils$1.isArrayBuffer(Mi)||utils$1.isTypedArray(Mi)?an&&typeof Blob=="function"?new Blob([Mi]):Buffer.from(Mi):Mi}function ln(Mi,co,lo){let uo=Mi;if(Mi&&!lo&&typeof Mi=="object"){if(utils$1.endsWith(co,"{}"))co=Ye?co:co.slice(0,-2),Mi=JSON.stringify(Mi);else if(utils$1.isArray(Mi)&&isFlatArray(Mi)||(utils$1.isFileList(Mi)||utils$1.endsWith(co,"[]"))&&(uo=utils$1.toArray(Mi)))return co=removeBrackets(co),uo.forEach(function(mo,_d){!(utils$1.isUndefined(mo)||mo===null)&&Ge.append(Mt===!0?renderKey([co],_d,Je):Mt===null?co:co+"[]",sn(mo))}),!1}return isVisitable(Mi)?!0:(Ge.append(renderKey(lo,co,Je),sn(Mi)),!1)}const fn=[],hn=Object.assign(predicates,{defaultVisitor:ln,convertValue:sn,isVisitable});function Xr(Mi,co){if(!utils$1.isUndefined(Mi)){if(fn.indexOf(Mi)!==-1)throw Error("Circular reference detected in "+co.join("."));fn.push(Mi),utils$1.forEach(Mi,function(uo,ho){(!(utils$1.isUndefined(uo)||uo===null)&&Qe.call(Ge,uo,utils$1.isString(ho)?ho.trim():ho,co,hn))===!0&&Xr(uo,co?co.concat(ho):[ho])}),fn.pop()}}if(!utils$1.isObject(Ke))throw new TypeError("data must be an object");return Xr(Ke),Ge}function encode$2(Ke){const Ge={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(Ke).replace(/[!'()~]|%20|%00/g,function(Ye){return Ge[Ye]})}function AxiosURLSearchParams(Ke,Ge){this._pairs=[],Ke&&toFormData$1(Ke,this,Ge)}const prototype=AxiosURLSearchParams.prototype;prototype.append=function(Ge,$e){this._pairs.push([Ge,$e])};prototype.toString=function(Ge){const $e=Ge?function(Ye){return Ge.call(this,Ye,encode$2)}:encode$2;return this._pairs.map(function(Qe){return $e(Qe[0])+"="+$e(Qe[1])},"").join("&")};function encode$1(Ke){return encodeURIComponent(Ke).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function buildURL(Ke,Ge,$e){if(!Ge)return Ke;const Ye=$e&&$e.encode||encode$1;utils$1.isFunction($e)&&($e={serialize:$e});const Qe=$e&&$e.serialize;let Je;if(Qe?Je=Qe(Ge,$e):Je=utils$1.isURLSearchParams(Ge)?Ge.toString():new AxiosURLSearchParams(Ge,$e).toString(Ye),Je){const Mt=Ke.indexOf("#");Mt!==-1&&(Ke=Ke.slice(0,Mt)),Ke+=(Ke.indexOf("?")===-1?"?":"&")+Je}return Ke}class InterceptorManager{constructor(){this.handlers=[]}use(Ge,$e,Ye){return this.handlers.push({fulfilled:Ge,rejected:$e,synchronous:Ye?Ye.synchronous:!1,runWhen:Ye?Ye.runWhen:null}),this.handlers.length-1}eject(Ge){this.handlers[Ge]&&(this.handlers[Ge]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(Ge){utils$1.forEach(this.handlers,function(Ye){Ye!==null&&Ge(Ye)})}}const transitionalDefaults={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},URLSearchParams$1=typeof URLSearchParams<"u"?URLSearchParams:AxiosURLSearchParams,FormData$1=typeof FormData<"u"?FormData:null,Blob$1=typeof Blob<"u"?Blob:null,platform$1={isBrowser:!0,classes:{URLSearchParams:URLSearchParams$1,FormData:FormData$1,Blob:Blob$1},protocols:["http","https","file","blob","url","data"]},hasBrowserEnv=typeof window<"u"&&typeof document<"u",_navigator=typeof navigator=="object"&&navigator||void 0,hasStandardBrowserEnv=hasBrowserEnv&&(!_navigator||["ReactNative","NativeScript","NS"].indexOf(_navigator.product)<0),hasStandardBrowserWebWorkerEnv=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",origin=hasBrowserEnv&&window.location.href||"http://localhost",utils=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv,hasStandardBrowserEnv,hasStandardBrowserWebWorkerEnv,navigator:_navigator,origin},Symbol.toStringTag,{value:"Module"})),platform={...utils,...platform$1};function toURLEncodedForm(Ke,Ge){return toFormData$1(Ke,new platform.classes.URLSearchParams,Object.assign({visitor:function($e,Ye,Qe,Je){return platform.isNode&&utils$1.isBuffer($e)?(this.append(Ye,$e.toString("base64")),!1):Je.defaultVisitor.apply(this,arguments)}},Ge))}function parsePropPath(Ke){return utils$1.matchAll(/\w+|\[(\w*)]/g,Ke).map(Ge=>Ge[0]==="[]"?"":Ge[1]||Ge[0])}function arrayToObject(Ke){const Ge={},$e=Object.keys(Ke);let Ye;const Qe=$e.length;let Je;for(Ye=0;Ye<Qe;Ye++)Je=$e[Ye],Ge[Je]=Ke[Je];return Ge}function formDataToJSON(Ke){function Ge($e,Ye,Qe,Je){let Mt=$e[Je++];if(Mt==="__proto__")return!0;const nn=Number.isFinite(+Mt),an=Je>=$e.length;return Mt=!Mt&&utils$1.isArray(Qe)?Qe.length:Mt,an?(utils$1.hasOwnProp(Qe,Mt)?Qe[Mt]=[Qe[Mt],Ye]:Qe[Mt]=Ye,!nn):((!Qe[Mt]||!utils$1.isObject(Qe[Mt]))&&(Qe[Mt]=[]),Ge($e,Ye,Qe[Mt],Je)&&utils$1.isArray(Qe[Mt])&&(Qe[Mt]=arrayToObject(Qe[Mt])),!nn)}if(utils$1.isFormData(Ke)&&utils$1.isFunction(Ke.entries)){const $e={};return utils$1.forEachEntry(Ke,(Ye,Qe)=>{Ge(parsePropPath(Ye),Qe,$e,0)}),$e}return null}function stringifySafely(Ke,Ge,$e){if(utils$1.isString(Ke))try{return(Ge||JSON.parse)(Ke),utils$1.trim(Ke)}catch(Ye){if(Ye.name!=="SyntaxError")throw Ye}return($e||JSON.stringify)(Ke)}const defaults={transitional:transitionalDefaults,adapter:["xhr","http","fetch"],transformRequest:[function(Ge,$e){const Ye=$e.getContentType()||"",Qe=Ye.indexOf("application/json")>-1,Je=utils$1.isObject(Ge);if(Je&&utils$1.isHTMLForm(Ge)&&(Ge=new FormData(Ge)),utils$1.isFormData(Ge))return Qe?JSON.stringify(formDataToJSON(Ge)):Ge;if(utils$1.isArrayBuffer(Ge)||utils$1.isBuffer(Ge)||utils$1.isStream(Ge)||utils$1.isFile(Ge)||utils$1.isBlob(Ge)||utils$1.isReadableStream(Ge))return Ge;if(utils$1.isArrayBufferView(Ge))return Ge.buffer;if(utils$1.isURLSearchParams(Ge))return $e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),Ge.toString();let nn;if(Je){if(Ye.indexOf("application/x-www-form-urlencoded")>-1)return toURLEncodedForm(Ge,this.formSerializer).toString();if((nn=utils$1.isFileList(Ge))||Ye.indexOf("multipart/form-data")>-1){const an=this.env&&this.env.FormData;return toFormData$1(nn?{"files[]":Ge}:Ge,an&&new an,this.formSerializer)}}return Je||Qe?($e.setContentType("application/json",!1),stringifySafely(Ge)):Ge}],transformResponse:[function(Ge){const $e=this.transitional||defaults.transitional,Ye=$e&&$e.forcedJSONParsing,Qe=this.responseType==="json";if(utils$1.isResponse(Ge)||utils$1.isReadableStream(Ge))return Ge;if(Ge&&utils$1.isString(Ge)&&(Ye&&!this.responseType||Qe)){const Mt=!($e&&$e.silentJSONParsing)&&Qe;try{return JSON.parse(Ge)}catch(nn){if(Mt)throw nn.name==="SyntaxError"?AxiosError$1.from(nn,AxiosError$1.ERR_BAD_RESPONSE,this,null,this.response):nn}}return Ge}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:platform.classes.FormData,Blob:platform.classes.Blob},validateStatus:function(Ge){return Ge>=200&&Ge<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};utils$1.forEach(["delete","get","head","post","put","patch"],Ke=>{defaults.headers[Ke]={}});const ignoreDuplicateOf=utils$1.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),parseHeaders=Ke=>{const Ge={};let $e,Ye,Qe;return Ke&&Ke.split(`
`).forEach(function(Mt){Qe=Mt.indexOf(":"),$e=Mt.substring(0,Qe).trim().toLowerCase(),Ye=Mt.substring(Qe+1).trim(),!(!$e||Ge[$e]&&ignoreDuplicateOf[$e])&&($e==="set-cookie"?Ge[$e]?Ge[$e].push(Ye):Ge[$e]=[Ye]:Ge[$e]=Ge[$e]?Ge[$e]+", "+Ye:Ye)}),Ge},$internals=Symbol("internals");function normalizeHeader(Ke){return Ke&&String(Ke).trim().toLowerCase()}function normalizeValue(Ke){return Ke===!1||Ke==null?Ke:utils$1.isArray(Ke)?Ke.map(normalizeValue):String(Ke)}function parseTokens(Ke){const Ge=Object.create(null),$e=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let Ye;for(;Ye=$e.exec(Ke);)Ge[Ye[1]]=Ye[2];return Ge}const isValidHeaderName=Ke=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(Ke.trim());function matchHeaderValue(Ke,Ge,$e,Ye,Qe){if(utils$1.isFunction(Ye))return Ye.call(this,Ge,$e);if(Qe&&(Ge=$e),!!utils$1.isString(Ge)){if(utils$1.isString(Ye))return Ge.indexOf(Ye)!==-1;if(utils$1.isRegExp(Ye))return Ye.test(Ge)}}function formatHeader(Ke){return Ke.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(Ge,$e,Ye)=>$e.toUpperCase()+Ye)}function buildAccessors(Ke,Ge){const $e=utils$1.toCamelCase(" "+Ge);["get","set","has"].forEach(Ye=>{Object.defineProperty(Ke,Ye+$e,{value:function(Qe,Je,Mt){return this[Ye].call(this,Ge,Qe,Je,Mt)},configurable:!0})})}let AxiosHeaders$1=class{constructor(Ge){Ge&&this.set(Ge)}set(Ge,$e,Ye){const Qe=this;function Je(nn,an,sn){const ln=normalizeHeader(an);if(!ln)throw new Error("header name must be a non-empty string");const fn=utils$1.findKey(Qe,ln);(!fn||Qe[fn]===void 0||sn===!0||sn===void 0&&Qe[fn]!==!1)&&(Qe[fn||an]=normalizeValue(nn))}const Mt=(nn,an)=>utils$1.forEach(nn,(sn,ln)=>Je(sn,ln,an));if(utils$1.isPlainObject(Ge)||Ge instanceof this.constructor)Mt(Ge,$e);else if(utils$1.isString(Ge)&&(Ge=Ge.trim())&&!isValidHeaderName(Ge))Mt(parseHeaders(Ge),$e);else if(utils$1.isHeaders(Ge))for(const[nn,an]of Ge.entries())Je(an,nn,Ye);else Ge!=null&&Je($e,Ge,Ye);return this}get(Ge,$e){if(Ge=normalizeHeader(Ge),Ge){const Ye=utils$1.findKey(this,Ge);if(Ye){const Qe=this[Ye];if(!$e)return Qe;if($e===!0)return parseTokens(Qe);if(utils$1.isFunction($e))return $e.call(this,Qe,Ye);if(utils$1.isRegExp($e))return $e.exec(Qe);throw new TypeError("parser must be boolean|regexp|function")}}}has(Ge,$e){if(Ge=normalizeHeader(Ge),Ge){const Ye=utils$1.findKey(this,Ge);return!!(Ye&&this[Ye]!==void 0&&(!$e||matchHeaderValue(this,this[Ye],Ye,$e)))}return!1}delete(Ge,$e){const Ye=this;let Qe=!1;function Je(Mt){if(Mt=normalizeHeader(Mt),Mt){const nn=utils$1.findKey(Ye,Mt);nn&&(!$e||matchHeaderValue(Ye,Ye[nn],nn,$e))&&(delete Ye[nn],Qe=!0)}}return utils$1.isArray(Ge)?Ge.forEach(Je):Je(Ge),Qe}clear(Ge){const $e=Object.keys(this);let Ye=$e.length,Qe=!1;for(;Ye--;){const Je=$e[Ye];(!Ge||matchHeaderValue(this,this[Je],Je,Ge,!0))&&(delete this[Je],Qe=!0)}return Qe}normalize(Ge){const $e=this,Ye={};return utils$1.forEach(this,(Qe,Je)=>{const Mt=utils$1.findKey(Ye,Je);if(Mt){$e[Mt]=normalizeValue(Qe),delete $e[Je];return}const nn=Ge?formatHeader(Je):String(Je).trim();nn!==Je&&delete $e[Je],$e[nn]=normalizeValue(Qe),Ye[nn]=!0}),this}concat(...Ge){return this.constructor.concat(this,...Ge)}toJSON(Ge){const $e=Object.create(null);return utils$1.forEach(this,(Ye,Qe)=>{Ye!=null&&Ye!==!1&&($e[Qe]=Ge&&utils$1.isArray(Ye)?Ye.join(", "):Ye)}),$e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([Ge,$e])=>Ge+": "+$e).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(Ge){return Ge instanceof this?Ge:new this(Ge)}static concat(Ge,...$e){const Ye=new this(Ge);return $e.forEach(Qe=>Ye.set(Qe)),Ye}static accessor(Ge){const Ye=(this[$internals]=this[$internals]={accessors:{}}).accessors,Qe=this.prototype;function Je(Mt){const nn=normalizeHeader(Mt);Ye[nn]||(buildAccessors(Qe,Mt),Ye[nn]=!0)}return utils$1.isArray(Ge)?Ge.forEach(Je):Je(Ge),this}};AxiosHeaders$1.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);utils$1.reduceDescriptors(AxiosHeaders$1.prototype,({value:Ke},Ge)=>{let $e=Ge[0].toUpperCase()+Ge.slice(1);return{get:()=>Ke,set(Ye){this[$e]=Ye}}});utils$1.freezeMethods(AxiosHeaders$1);function transformData(Ke,Ge){const $e=this||defaults,Ye=Ge||$e,Qe=AxiosHeaders$1.from(Ye.headers);let Je=Ye.data;return utils$1.forEach(Ke,function(nn){Je=nn.call($e,Je,Qe.normalize(),Ge?Ge.status:void 0)}),Qe.normalize(),Je}function isCancel$1(Ke){return!!(Ke&&Ke.__CANCEL__)}function CanceledError$1(Ke,Ge,$e){AxiosError$1.call(this,Ke??"canceled",AxiosError$1.ERR_CANCELED,Ge,$e),this.name="CanceledError"}utils$1.inherits(CanceledError$1,AxiosError$1,{__CANCEL__:!0});function settle(Ke,Ge,$e){const Ye=$e.config.validateStatus;!$e.status||!Ye||Ye($e.status)?Ke($e):Ge(new AxiosError$1("Request failed with status code "+$e.status,[AxiosError$1.ERR_BAD_REQUEST,AxiosError$1.ERR_BAD_RESPONSE][Math.floor($e.status/100)-4],$e.config,$e.request,$e))}function parseProtocol(Ke){const Ge=/^([-+\w]{1,25})(:?\/\/|:)/.exec(Ke);return Ge&&Ge[1]||""}function speedometer(Ke,Ge){Ke=Ke||10;const $e=new Array(Ke),Ye=new Array(Ke);let Qe=0,Je=0,Mt;return Ge=Ge!==void 0?Ge:1e3,function(an){const sn=Date.now(),ln=Ye[Je];Mt||(Mt=sn),$e[Qe]=an,Ye[Qe]=sn;let fn=Je,hn=0;for(;fn!==Qe;)hn+=$e[fn++],fn=fn%Ke;if(Qe=(Qe+1)%Ke,Qe===Je&&(Je=(Je+1)%Ke),sn-Mt<Ge)return;const Xr=ln&&sn-ln;return Xr?Math.round(hn*1e3/Xr):void 0}}function throttle(Ke,Ge){let $e=0,Ye=1e3/Ge,Qe,Je;const Mt=(sn,ln=Date.now())=>{$e=ln,Qe=null,Je&&(clearTimeout(Je),Je=null),Ke.apply(null,sn)};return[(...sn)=>{const ln=Date.now(),fn=ln-$e;fn>=Ye?Mt(sn,ln):(Qe=sn,Je||(Je=setTimeout(()=>{Je=null,Mt(Qe)},Ye-fn)))},()=>Qe&&Mt(Qe)]}const progressEventReducer=(Ke,Ge,$e=3)=>{let Ye=0;const Qe=speedometer(50,250);return throttle(Je=>{const Mt=Je.loaded,nn=Je.lengthComputable?Je.total:void 0,an=Mt-Ye,sn=Qe(an),ln=Mt<=nn;Ye=Mt;const fn={loaded:Mt,total:nn,progress:nn?Mt/nn:void 0,bytes:an,rate:sn||void 0,estimated:sn&&nn&&ln?(nn-Mt)/sn:void 0,event:Je,lengthComputable:nn!=null,[Ge?"download":"upload"]:!0};Ke(fn)},$e)},progressEventDecorator=(Ke,Ge)=>{const $e=Ke!=null;return[Ye=>Ge[0]({lengthComputable:$e,total:Ke,loaded:Ye}),Ge[1]]},asyncDecorator=Ke=>(...Ge)=>utils$1.asap(()=>Ke(...Ge)),isURLSameOrigin=platform.hasStandardBrowserEnv?((Ke,Ge)=>$e=>($e=new URL($e,platform.origin),Ke.protocol===$e.protocol&&Ke.host===$e.host&&(Ge||Ke.port===$e.port)))(new URL(platform.origin),platform.navigator&&/(msie|trident)/i.test(platform.navigator.userAgent)):()=>!0,cookies=platform.hasStandardBrowserEnv?{write(Ke,Ge,$e,Ye,Qe,Je){const Mt=[Ke+"="+encodeURIComponent(Ge)];utils$1.isNumber($e)&&Mt.push("expires="+new Date($e).toGMTString()),utils$1.isString(Ye)&&Mt.push("path="+Ye),utils$1.isString(Qe)&&Mt.push("domain="+Qe),Je===!0&&Mt.push("secure"),document.cookie=Mt.join("; ")},read(Ke){const Ge=document.cookie.match(new RegExp("(^|;\\s*)("+Ke+")=([^;]*)"));return Ge?decodeURIComponent(Ge[3]):null},remove(Ke){this.write(Ke,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function isAbsoluteURL(Ke){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(Ke)}function combineURLs(Ke,Ge){return Ge?Ke.replace(/\/?\/$/,"")+"/"+Ge.replace(/^\/+/,""):Ke}function buildFullPath(Ke,Ge,$e){let Ye=!isAbsoluteURL(Ge);return Ke&&(Ye||$e==!1)?combineURLs(Ke,Ge):Ge}const headersToObject=Ke=>Ke instanceof AxiosHeaders$1?{...Ke}:Ke;function mergeConfig$1(Ke,Ge){Ge=Ge||{};const $e={};function Ye(sn,ln,fn,hn){return utils$1.isPlainObject(sn)&&utils$1.isPlainObject(ln)?utils$1.merge.call({caseless:hn},sn,ln):utils$1.isPlainObject(ln)?utils$1.merge({},ln):utils$1.isArray(ln)?ln.slice():ln}function Qe(sn,ln,fn,hn){if(utils$1.isUndefined(ln)){if(!utils$1.isUndefined(sn))return Ye(void 0,sn,fn,hn)}else return Ye(sn,ln,fn,hn)}function Je(sn,ln){if(!utils$1.isUndefined(ln))return Ye(void 0,ln)}function Mt(sn,ln){if(utils$1.isUndefined(ln)){if(!utils$1.isUndefined(sn))return Ye(void 0,sn)}else return Ye(void 0,ln)}function nn(sn,ln,fn){if(fn in Ge)return Ye(sn,ln);if(fn in Ke)return Ye(void 0,sn)}const an={url:Je,method:Je,data:Je,baseURL:Mt,transformRequest:Mt,transformResponse:Mt,paramsSerializer:Mt,timeout:Mt,timeoutMessage:Mt,withCredentials:Mt,withXSRFToken:Mt,adapter:Mt,responseType:Mt,xsrfCookieName:Mt,xsrfHeaderName:Mt,onUploadProgress:Mt,onDownloadProgress:Mt,decompress:Mt,maxContentLength:Mt,maxBodyLength:Mt,beforeRedirect:Mt,transport:Mt,httpAgent:Mt,httpsAgent:Mt,cancelToken:Mt,socketPath:Mt,responseEncoding:Mt,validateStatus:nn,headers:(sn,ln,fn)=>Qe(headersToObject(sn),headersToObject(ln),fn,!0)};return utils$1.forEach(Object.keys(Object.assign({},Ke,Ge)),function(ln){const fn=an[ln]||Qe,hn=fn(Ke[ln],Ge[ln],ln);utils$1.isUndefined(hn)&&fn!==nn||($e[ln]=hn)}),$e}const resolveConfig=Ke=>{const Ge=mergeConfig$1({},Ke);let{data:$e,withXSRFToken:Ye,xsrfHeaderName:Qe,xsrfCookieName:Je,headers:Mt,auth:nn}=Ge;Ge.headers=Mt=AxiosHeaders$1.from(Mt),Ge.url=buildURL(buildFullPath(Ge.baseURL,Ge.url,Ge.allowAbsoluteUrls),Ke.params,Ke.paramsSerializer),nn&&Mt.set("Authorization","Basic "+btoa((nn.username||"")+":"+(nn.password?unescape(encodeURIComponent(nn.password)):"")));let an;if(utils$1.isFormData($e)){if(platform.hasStandardBrowserEnv||platform.hasStandardBrowserWebWorkerEnv)Mt.setContentType(void 0);else if((an=Mt.getContentType())!==!1){const[sn,...ln]=an?an.split(";").map(fn=>fn.trim()).filter(Boolean):[];Mt.setContentType([sn||"multipart/form-data",...ln].join("; "))}}if(platform.hasStandardBrowserEnv&&(Ye&&utils$1.isFunction(Ye)&&(Ye=Ye(Ge)),Ye||Ye!==!1&&isURLSameOrigin(Ge.url))){const sn=Qe&&Je&&cookies.read(Je);sn&&Mt.set(Qe,sn)}return Ge},isXHRAdapterSupported=typeof XMLHttpRequest<"u",xhrAdapter=isXHRAdapterSupported&&function(Ke){return new Promise(function($e,Ye){const Qe=resolveConfig(Ke);let Je=Qe.data;const Mt=AxiosHeaders$1.from(Qe.headers).normalize();let{responseType:nn,onUploadProgress:an,onDownloadProgress:sn}=Qe,ln,fn,hn,Xr,Mi;function co(){Xr&&Xr(),Mi&&Mi(),Qe.cancelToken&&Qe.cancelToken.unsubscribe(ln),Qe.signal&&Qe.signal.removeEventListener("abort",ln)}let lo=new XMLHttpRequest;lo.open(Qe.method.toUpperCase(),Qe.url,!0),lo.timeout=Qe.timeout;function uo(){if(!lo)return;const mo=AxiosHeaders$1.from("getAllResponseHeaders"in lo&&lo.getAllResponseHeaders()),ep={data:!nn||nn==="text"||nn==="json"?lo.responseText:lo.response,status:lo.status,statusText:lo.statusText,headers:mo,config:Ke,request:lo};settle(function(sp){$e(sp),co()},function(sp){Ye(sp),co()},ep),lo=null}"onloadend"in lo?lo.onloadend=uo:lo.onreadystatechange=function(){!lo||lo.readyState!==4||lo.status===0&&!(lo.responseURL&&lo.responseURL.indexOf("file:")===0)||setTimeout(uo)},lo.onabort=function(){lo&&(Ye(new AxiosError$1("Request aborted",AxiosError$1.ECONNABORTED,Ke,lo)),lo=null)},lo.onerror=function(){Ye(new AxiosError$1("Network Error",AxiosError$1.ERR_NETWORK,Ke,lo)),lo=null},lo.ontimeout=function(){let _d=Qe.timeout?"timeout of "+Qe.timeout+"ms exceeded":"timeout exceeded";const ep=Qe.transitional||transitionalDefaults;Qe.timeoutErrorMessage&&(_d=Qe.timeoutErrorMessage),Ye(new AxiosError$1(_d,ep.clarifyTimeoutError?AxiosError$1.ETIMEDOUT:AxiosError$1.ECONNABORTED,Ke,lo)),lo=null},Je===void 0&&Mt.setContentType(null),"setRequestHeader"in lo&&utils$1.forEach(Mt.toJSON(),function(_d,ep){lo.setRequestHeader(ep,_d)}),utils$1.isUndefined(Qe.withCredentials)||(lo.withCredentials=!!Qe.withCredentials),nn&&nn!=="json"&&(lo.responseType=Qe.responseType),sn&&([hn,Mi]=progressEventReducer(sn,!0),lo.addEventListener("progress",hn)),an&&lo.upload&&([fn,Xr]=progressEventReducer(an),lo.upload.addEventListener("progress",fn),lo.upload.addEventListener("loadend",Xr)),(Qe.cancelToken||Qe.signal)&&(ln=mo=>{lo&&(Ye(!mo||mo.type?new CanceledError$1(null,Ke,lo):mo),lo.abort(),lo=null)},Qe.cancelToken&&Qe.cancelToken.subscribe(ln),Qe.signal&&(Qe.signal.aborted?ln():Qe.signal.addEventListener("abort",ln)));const ho=parseProtocol(Qe.url);if(ho&&platform.protocols.indexOf(ho)===-1){Ye(new AxiosError$1("Unsupported protocol "+ho+":",AxiosError$1.ERR_BAD_REQUEST,Ke));return}lo.send(Je||null)})},composeSignals=(Ke,Ge)=>{const{length:$e}=Ke=Ke?Ke.filter(Boolean):[];if(Ge||$e){let Ye=new AbortController,Qe;const Je=function(sn){if(!Qe){Qe=!0,nn();const ln=sn instanceof Error?sn:this.reason;Ye.abort(ln instanceof AxiosError$1?ln:new CanceledError$1(ln instanceof Error?ln.message:ln))}};let Mt=Ge&&setTimeout(()=>{Mt=null,Je(new AxiosError$1(`timeout ${Ge} of ms exceeded`,AxiosError$1.ETIMEDOUT))},Ge);const nn=()=>{Ke&&(Mt&&clearTimeout(Mt),Mt=null,Ke.forEach(sn=>{sn.unsubscribe?sn.unsubscribe(Je):sn.removeEventListener("abort",Je)}),Ke=null)};Ke.forEach(sn=>sn.addEventListener("abort",Je));const{signal:an}=Ye;return an.unsubscribe=()=>utils$1.asap(nn),an}},streamChunk=function*(Ke,Ge){let $e=Ke.byteLength;if($e<Ge){yield Ke;return}let Ye=0,Qe;for(;Ye<$e;)Qe=Ye+Ge,yield Ke.slice(Ye,Qe),Ye=Qe},readBytes=async function*(Ke,Ge){for await(const $e of readStream(Ke))yield*streamChunk($e,Ge)},readStream=async function*(Ke){if(Ke[Symbol.asyncIterator]){yield*Ke;return}const Ge=Ke.getReader();try{for(;;){const{done:$e,value:Ye}=await Ge.read();if($e)break;yield Ye}}finally{await Ge.cancel()}},trackStream=(Ke,Ge,$e,Ye)=>{const Qe=readBytes(Ke,Ge);let Je=0,Mt,nn=an=>{Mt||(Mt=!0,Ye&&Ye(an))};return new ReadableStream({async pull(an){try{const{done:sn,value:ln}=await Qe.next();if(sn){nn(),an.close();return}let fn=ln.byteLength;if($e){let hn=Je+=fn;$e(hn)}an.enqueue(new Uint8Array(ln))}catch(sn){throw nn(sn),sn}},cancel(an){return nn(an),Qe.return()}},{highWaterMark:2})},isFetchSupported=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",isReadableStreamSupported=isFetchSupported&&typeof ReadableStream=="function",encodeText=isFetchSupported&&(typeof TextEncoder=="function"?(Ke=>Ge=>Ke.encode(Ge))(new TextEncoder):async Ke=>new Uint8Array(await new Response(Ke).arrayBuffer())),test=(Ke,...Ge)=>{try{return!!Ke(...Ge)}catch{return!1}},supportsRequestStream=isReadableStreamSupported&&test(()=>{let Ke=!1;const Ge=new Request(platform.origin,{body:new ReadableStream,method:"POST",get duplex(){return Ke=!0,"half"}}).headers.has("Content-Type");return Ke&&!Ge}),DEFAULT_CHUNK_SIZE=64*1024,supportsResponseStream=isReadableStreamSupported&&test(()=>utils$1.isReadableStream(new Response("").body)),resolvers={stream:supportsResponseStream&&(Ke=>Ke.body)};isFetchSupported&&(Ke=>{["text","arrayBuffer","blob","formData","stream"].forEach(Ge=>{!resolvers[Ge]&&(resolvers[Ge]=utils$1.isFunction(Ke[Ge])?$e=>$e[Ge]():($e,Ye)=>{throw new AxiosError$1(`Response type '${Ge}' is not supported`,AxiosError$1.ERR_NOT_SUPPORT,Ye)})})})(new Response);const getBodyLength=async Ke=>{if(Ke==null)return 0;if(utils$1.isBlob(Ke))return Ke.size;if(utils$1.isSpecCompliantForm(Ke))return(await new Request(platform.origin,{method:"POST",body:Ke}).arrayBuffer()).byteLength;if(utils$1.isArrayBufferView(Ke)||utils$1.isArrayBuffer(Ke))return Ke.byteLength;if(utils$1.isURLSearchParams(Ke)&&(Ke=Ke+""),utils$1.isString(Ke))return(await encodeText(Ke)).byteLength},resolveBodyLength=async(Ke,Ge)=>{const $e=utils$1.toFiniteNumber(Ke.getContentLength());return $e??getBodyLength(Ge)},fetchAdapter=isFetchSupported&&(async Ke=>{let{url:Ge,method:$e,data:Ye,signal:Qe,cancelToken:Je,timeout:Mt,onDownloadProgress:nn,onUploadProgress:an,responseType:sn,headers:ln,withCredentials:fn="same-origin",fetchOptions:hn}=resolveConfig(Ke);sn=sn?(sn+"").toLowerCase():"text";let Xr=composeSignals([Qe,Je&&Je.toAbortSignal()],Mt),Mi;const co=Xr&&Xr.unsubscribe&&(()=>{Xr.unsubscribe()});let lo;try{if(an&&supportsRequestStream&&$e!=="get"&&$e!=="head"&&(lo=await resolveBodyLength(ln,Ye))!==0){let ep=new Request(Ge,{method:"POST",body:Ye,duplex:"half"}),rp;if(utils$1.isFormData(Ye)&&(rp=ep.headers.get("content-type"))&&ln.setContentType(rp),ep.body){const[sp,op]=progressEventDecorator(lo,progressEventReducer(asyncDecorator(an)));Ye=trackStream(ep.body,DEFAULT_CHUNK_SIZE,sp,op)}}utils$1.isString(fn)||(fn=fn?"include":"omit");const uo="credentials"in Request.prototype;Mi=new Request(Ge,{...hn,signal:Xr,method:$e.toUpperCase(),headers:ln.normalize().toJSON(),body:Ye,duplex:"half",credentials:uo?fn:void 0});let ho=await fetch(Mi);const mo=supportsResponseStream&&(sn==="stream"||sn==="response");if(supportsResponseStream&&(nn||mo&&co)){const ep={};["status","statusText","headers"].forEach(ip=>{ep[ip]=ho[ip]});const rp=utils$1.toFiniteNumber(ho.headers.get("content-length")),[sp,op]=nn&&progressEventDecorator(rp,progressEventReducer(asyncDecorator(nn),!0))||[];ho=new Response(trackStream(ho.body,DEFAULT_CHUNK_SIZE,sp,()=>{op&&op(),co&&co()}),ep)}sn=sn||"text";let _d=await resolvers[utils$1.findKey(resolvers,sn)||"text"](ho,Ke);return!mo&&co&&co(),await new Promise((ep,rp)=>{settle(ep,rp,{data:_d,headers:AxiosHeaders$1.from(ho.headers),status:ho.status,statusText:ho.statusText,config:Ke,request:Mi})})}catch(uo){throw co&&co(),uo&&uo.name==="TypeError"&&/fetch/i.test(uo.message)?Object.assign(new AxiosError$1("Network Error",AxiosError$1.ERR_NETWORK,Ke,Mi),{cause:uo.cause||uo}):AxiosError$1.from(uo,uo&&uo.code,Ke,Mi)}}),knownAdapters={http:httpAdapter,xhr:xhrAdapter,fetch:fetchAdapter};utils$1.forEach(knownAdapters,(Ke,Ge)=>{if(Ke){try{Object.defineProperty(Ke,"name",{value:Ge})}catch{}Object.defineProperty(Ke,"adapterName",{value:Ge})}});const renderReason=Ke=>`- ${Ke}`,isResolvedHandle=Ke=>utils$1.isFunction(Ke)||Ke===null||Ke===!1,adapters={getAdapter:Ke=>{Ke=utils$1.isArray(Ke)?Ke:[Ke];const{length:Ge}=Ke;let $e,Ye;const Qe={};for(let Je=0;Je<Ge;Je++){$e=Ke[Je];let Mt;if(Ye=$e,!isResolvedHandle($e)&&(Ye=knownAdapters[(Mt=String($e)).toLowerCase()],Ye===void 0))throw new AxiosError$1(`Unknown adapter '${Mt}'`);if(Ye)break;Qe[Mt||"#"+Je]=Ye}if(!Ye){const Je=Object.entries(Qe).map(([nn,an])=>`adapter ${nn} `+(an===!1?"is not supported by the environment":"is not available in the build"));let Mt=Ge?Je.length>1?`since :
`+Je.map(renderReason).join(`
`):" "+renderReason(Je[0]):"as no adapter specified";throw new AxiosError$1("There is no suitable adapter to dispatch the request "+Mt,"ERR_NOT_SUPPORT")}return Ye},adapters:knownAdapters};function throwIfCancellationRequested(Ke){if(Ke.cancelToken&&Ke.cancelToken.throwIfRequested(),Ke.signal&&Ke.signal.aborted)throw new CanceledError$1(null,Ke)}function dispatchRequest(Ke){return throwIfCancellationRequested(Ke),Ke.headers=AxiosHeaders$1.from(Ke.headers),Ke.data=transformData.call(Ke,Ke.transformRequest),["post","put","patch"].indexOf(Ke.method)!==-1&&Ke.headers.setContentType("application/x-www-form-urlencoded",!1),adapters.getAdapter(Ke.adapter||defaults.adapter)(Ke).then(function(Ye){return throwIfCancellationRequested(Ke),Ye.data=transformData.call(Ke,Ke.transformResponse,Ye),Ye.headers=AxiosHeaders$1.from(Ye.headers),Ye},function(Ye){return isCancel$1(Ye)||(throwIfCancellationRequested(Ke),Ye&&Ye.response&&(Ye.response.data=transformData.call(Ke,Ke.transformResponse,Ye.response),Ye.response.headers=AxiosHeaders$1.from(Ye.response.headers))),Promise.reject(Ye)})}const VERSION$1="1.8.4",validators$1={};["object","boolean","number","function","string","symbol"].forEach((Ke,Ge)=>{validators$1[Ke]=function(Ye){return typeof Ye===Ke||"a"+(Ge<1?"n ":" ")+Ke}});const deprecatedWarnings={};validators$1.transitional=function(Ge,$e,Ye){function Qe(Je,Mt){return"[Axios v"+VERSION$1+"] Transitional option '"+Je+"'"+Mt+(Ye?". "+Ye:"")}return(Je,Mt,nn)=>{if(Ge===!1)throw new AxiosError$1(Qe(Mt," has been removed"+($e?" in "+$e:"")),AxiosError$1.ERR_DEPRECATED);return $e&&!deprecatedWarnings[Mt]&&(deprecatedWarnings[Mt]=!0,console.warn(Qe(Mt," has been deprecated since v"+$e+" and will be removed in the near future"))),Ge?Ge(Je,Mt,nn):!0}};validators$1.spelling=function(Ge){return($e,Ye)=>(console.warn(`${Ye} is likely a misspelling of ${Ge}`),!0)};function assertOptions(Ke,Ge,$e){if(typeof Ke!="object")throw new AxiosError$1("options must be an object",AxiosError$1.ERR_BAD_OPTION_VALUE);const Ye=Object.keys(Ke);let Qe=Ye.length;for(;Qe-- >0;){const Je=Ye[Qe],Mt=Ge[Je];if(Mt){const nn=Ke[Je],an=nn===void 0||Mt(nn,Je,Ke);if(an!==!0)throw new AxiosError$1("option "+Je+" must be "+an,AxiosError$1.ERR_BAD_OPTION_VALUE);continue}if($e!==!0)throw new AxiosError$1("Unknown option "+Je,AxiosError$1.ERR_BAD_OPTION)}}const validator={assertOptions,validators:validators$1},validators=validator.validators;let Axios$1=class{constructor(Ge){this.defaults=Ge,this.interceptors={request:new InterceptorManager,response:new InterceptorManager}}async request(Ge,$e){try{return await this._request(Ge,$e)}catch(Ye){if(Ye instanceof Error){let Qe={};Error.captureStackTrace?Error.captureStackTrace(Qe):Qe=new Error;const Je=Qe.stack?Qe.stack.replace(/^.+\n/,""):"";try{Ye.stack?Je&&!String(Ye.stack).endsWith(Je.replace(/^.+\n.+\n/,""))&&(Ye.stack+=`
`+Je):Ye.stack=Je}catch{}}throw Ye}}_request(Ge,$e){typeof Ge=="string"?($e=$e||{},$e.url=Ge):$e=Ge||{},$e=mergeConfig$1(this.defaults,$e);const{transitional:Ye,paramsSerializer:Qe,headers:Je}=$e;Ye!==void 0&&validator.assertOptions(Ye,{silentJSONParsing:validators.transitional(validators.boolean),forcedJSONParsing:validators.transitional(validators.boolean),clarifyTimeoutError:validators.transitional(validators.boolean)},!1),Qe!=null&&(utils$1.isFunction(Qe)?$e.paramsSerializer={serialize:Qe}:validator.assertOptions(Qe,{encode:validators.function,serialize:validators.function},!0)),$e.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?$e.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:$e.allowAbsoluteUrls=!0),validator.assertOptions($e,{baseUrl:validators.spelling("baseURL"),withXsrfToken:validators.spelling("withXSRFToken")},!0),$e.method=($e.method||this.defaults.method||"get").toLowerCase();let Mt=Je&&utils$1.merge(Je.common,Je[$e.method]);Je&&utils$1.forEach(["delete","get","head","post","put","patch","common"],Mi=>{delete Je[Mi]}),$e.headers=AxiosHeaders$1.concat(Mt,Je);const nn=[];let an=!0;this.interceptors.request.forEach(function(co){typeof co.runWhen=="function"&&co.runWhen($e)===!1||(an=an&&co.synchronous,nn.unshift(co.fulfilled,co.rejected))});const sn=[];this.interceptors.response.forEach(function(co){sn.push(co.fulfilled,co.rejected)});let ln,fn=0,hn;if(!an){const Mi=[dispatchRequest.bind(this),void 0];for(Mi.unshift.apply(Mi,nn),Mi.push.apply(Mi,sn),hn=Mi.length,ln=Promise.resolve($e);fn<hn;)ln=ln.then(Mi[fn++],Mi[fn++]);return ln}hn=nn.length;let Xr=$e;for(fn=0;fn<hn;){const Mi=nn[fn++],co=nn[fn++];try{Xr=Mi(Xr)}catch(lo){co.call(this,lo);break}}try{ln=dispatchRequest.call(this,Xr)}catch(Mi){return Promise.reject(Mi)}for(fn=0,hn=sn.length;fn<hn;)ln=ln.then(sn[fn++],sn[fn++]);return ln}getUri(Ge){Ge=mergeConfig$1(this.defaults,Ge);const $e=buildFullPath(Ge.baseURL,Ge.url,Ge.allowAbsoluteUrls);return buildURL($e,Ge.params,Ge.paramsSerializer)}};utils$1.forEach(["delete","get","head","options"],function(Ge){Axios$1.prototype[Ge]=function($e,Ye){return this.request(mergeConfig$1(Ye||{},{method:Ge,url:$e,data:(Ye||{}).data}))}});utils$1.forEach(["post","put","patch"],function(Ge){function $e(Ye){return function(Je,Mt,nn){return this.request(mergeConfig$1(nn||{},{method:Ge,headers:Ye?{"Content-Type":"multipart/form-data"}:{},url:Je,data:Mt}))}}Axios$1.prototype[Ge]=$e(),Axios$1.prototype[Ge+"Form"]=$e(!0)});let CancelToken$1=class nC{constructor(Ge){if(typeof Ge!="function")throw new TypeError("executor must be a function.");let $e;this.promise=new Promise(function(Je){$e=Je});const Ye=this;this.promise.then(Qe=>{if(!Ye._listeners)return;let Je=Ye._listeners.length;for(;Je-- >0;)Ye._listeners[Je](Qe);Ye._listeners=null}),this.promise.then=Qe=>{let Je;const Mt=new Promise(nn=>{Ye.subscribe(nn),Je=nn}).then(Qe);return Mt.cancel=function(){Ye.unsubscribe(Je)},Mt},Ge(function(Je,Mt,nn){Ye.reason||(Ye.reason=new CanceledError$1(Je,Mt,nn),$e(Ye.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(Ge){if(this.reason){Ge(this.reason);return}this._listeners?this._listeners.push(Ge):this._listeners=[Ge]}unsubscribe(Ge){if(!this._listeners)return;const $e=this._listeners.indexOf(Ge);$e!==-1&&this._listeners.splice($e,1)}toAbortSignal(){const Ge=new AbortController,$e=Ye=>{Ge.abort(Ye)};return this.subscribe($e),Ge.signal.unsubscribe=()=>this.unsubscribe($e),Ge.signal}static source(){let Ge;return{token:new nC(function(Qe){Ge=Qe}),cancel:Ge}}};function spread$1(Ke){return function($e){return Ke.apply(null,$e)}}function isAxiosError$1(Ke){return utils$1.isObject(Ke)&&Ke.isAxiosError===!0}const HttpStatusCode$1={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(HttpStatusCode$1).forEach(([Ke,Ge])=>{HttpStatusCode$1[Ge]=Ke});function createInstance(Ke){const Ge=new Axios$1(Ke),$e=bind(Axios$1.prototype.request,Ge);return utils$1.extend($e,Axios$1.prototype,Ge,{allOwnKeys:!0}),utils$1.extend($e,Ge,null,{allOwnKeys:!0}),$e.create=function(Qe){return createInstance(mergeConfig$1(Ke,Qe))},$e}const axios=createInstance(defaults);axios.Axios=Axios$1;axios.CanceledError=CanceledError$1;axios.CancelToken=CancelToken$1;axios.isCancel=isCancel$1;axios.VERSION=VERSION$1;axios.toFormData=toFormData$1;axios.AxiosError=AxiosError$1;axios.Cancel=axios.CanceledError;axios.all=function(Ge){return Promise.all(Ge)};axios.spread=spread$1;axios.isAxiosError=isAxiosError$1;axios.mergeConfig=mergeConfig$1;axios.AxiosHeaders=AxiosHeaders$1;axios.formToJSON=Ke=>formDataToJSON(utils$1.isHTMLForm(Ke)?new FormData(Ke):Ke);axios.getAdapter=adapters.getAdapter;axios.HttpStatusCode=HttpStatusCode$1;axios.default=axios;const{Axios,AxiosError,CanceledError,isCancel,CancelToken,VERSION,all,Cancel,isAxiosError,spread,toFormData,AxiosHeaders,HttpStatusCode,formToJSON,getAdapter,mergeConfig}=axios,AuthContext=reactExports.createContext(),AuthProvider=({children:Ke})=>{const[Ge,$e]=reactExports.useState(()=>{const Ye=localStorage.getItem("auth");return Ye?JSON.parse(Ye):{user:null,token:""}});return reactExports.useEffect(()=>{localStorage.setItem("auth",JSON.stringify(Ge))},[Ge]),jsxRuntimeExports.jsx(AuthContext.Provider,{value:[Ge,$e],children:Ke})},useAuth=()=>reactExports.useContext(AuthContext),Login=()=>{const[Ke,Ge]=reactExports.useState({email:"",password:""}),[$e,Ye]=useAuth(),Qe=useNavigate();axios.defaults.withCredentials=!0;const Je=nn=>{Ge(an=>({...an,[nn.target.name]:nn.target.value}))},Mt=async nn=>{nn.preventDefault();const{email:an,password:sn}=Ke;try{const ln=await axios.post("https://video-call-backend-y8v1.onrender.com/api/v1/auth/login",{email:an,password:sn});ln&&ln.data.success?(c$1.success(ln.data.message),Ye({...$e,user:ln.data.user,token:ln.data.token}),localStorage.setItem("auth",JSON.stringify(ln.data)),Qe("/")):c$1.error(ln.data.message||"Login failed")}catch(ln){console.log(ln),c$1.error("Something went wrong")}};return jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen  bg-gradient-to-r from-purple-100 to-indigo-300  text-indigo-800 px-4",children:[jsxRuntimeExports.jsxs("div",{className:"text-center mb-20",children:[jsxRuntimeExports.jsx("h1",{className:"text-4xl  font-bold text-#E0BBE4",children:"EmoCall"}),jsxRuntimeExports.jsx("h2",{className:"text-lg  text-indigo-800 mt-2 ml-2",children:"Say Hello from Anywhere!"})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col lg:flex-row items-center justify-center w-full lg:w-[60%] gap-10 lg:gap-16",children:[jsxRuntimeExports.jsx("div",{className:"hidden lg:flex w-full lg:w-[55%]  justify-center",children:jsxRuntimeExports.jsx("img",{src:"/vidcall.jpg.jpg",alt:"Login",className:"w-full lg:w-[450px] lg:h-[350px] rounded-lg shadow-md"})}),jsxRuntimeExports.jsxs("div",{className:"w-[450px] p-8 border text-gray-900 border-gray-300 rounded-lg shadow-lg",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl text-gray-900 font-semibold text-center mb-6",children:"Login"}),jsxRuntimeExports.jsxs("form",{onSubmit:Mt,className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{htmlFor:"email",className:"block text-gray-900 font-medium",children:"Enter your Registered Email"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center border border-gray-300 rounded-md px-3 py-2",children:[jsxRuntimeExports.jsx(FaEnvelope,{className:"text-gray-500 mr-2"}),jsxRuntimeExports.jsx("input",{type:"email",name:"email",id:"email",placeholder:"Enter your email here",value:Ke.email,onChange:Je,className:"w-full outline-none text-gray-900 bg-transparent",required:!0})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{htmlFor:"password",className:"block font-medium",children:"Password"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center border border-gray-300 rounded-md px-3 py-2",children:[jsxRuntimeExports.jsx(FaLock,{className:"text-gray-900 mr-2"}),jsxRuntimeExports.jsx("input",{type:"password",name:"password",id:"password",placeholder:"Enter Password",value:Ke.password,onChange:Je,className:"w-full outline-none text-white bg-transparent",required:!0})]})]}),jsxRuntimeExports.jsx("button",{type:"submit",className:"w-full bg-fuchsia-600 hover:bg-fuchsia-700 text-white  cursor-pointer py-2 rounded-md font-semibold",children:"Login"})]}),jsxRuntimeExports.jsxs("div",{className:"text-center mt-4 text-sm text-gray-900",children:["Don't Have an account?"," ",jsxRuntimeExports.jsx(Link,{to:"/register",className:"text-gray-900 hover:underline cursor-pointer",children:"Register Here"})]})]})]})]})},Register=()=>{const[Ke,Ge]=reactExports.useState({name:"",email:"",password:"",phone:""}),$e=useNavigate();axios.defaults.withCredentials=!0;const Ye=Je=>{const{name:Mt,value:nn}=Je.target;Ge({...Ke,[Mt]:nn})},Qe=async Je=>{Je.preventDefault();try{const{name:Mt,email:nn,password:an,phone:sn}=Ke,ln=await axios.post("https://video-call-backend-y8v1.onrender.com/api/v1/auth/register",{name:Mt,email:nn,password:an,phone:sn});ln.data.success?(c$1.success(ln.data.message),$e("/login")):c$1.error(ln.data.message)}catch(Mt){console.log(Mt),c$1.error("Something went wrong")}};return jsxRuntimeExports.jsxs("div",{className:`flex flex-col items-center justify-center min-h-screen bg-gradient-to-r from-purple-100 to-indigo-300\r
\r
\r
\r
 text-indigo-800 px-4 py-10`,children:[jsxRuntimeExports.jsxs("div",{className:"text-center mb-10",children:[jsxRuntimeExports.jsx("h1",{className:"text-4xl font-bold text-indigo-900",children:"EmoCall"}),jsxRuntimeExports.jsx("h2",{className:"text-lg  text-indigo-800 mt-2",children:"Say Hello from Anywhere!"})]}),jsxRuntimeExports.jsx("div",{className:"flex flex-col lg:flex-row w-full lg:w-[65%] items-center justify-center gap-10 lg:gap-20",children:jsxRuntimeExports.jsxs("div",{className:"w-full lg:w-[55%]  border border-white p-8 rounded-lg shadow-lg",children:[jsxRuntimeExports.jsx("h3",{className:"text-2xl font-semibold text-gray-900 mb-4 text-center",children:"Register"}),jsxRuntimeExports.jsxs("form",{onSubmit:Qe,className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{htmlFor:"name",className:"block text-gray-900",children:"Full Name"}),jsxRuntimeExports.jsx("input",{type:"text",name:"name",id:"name",placeholder:"Enter your Name Here",className:"w-full px-4 py-2 mt-1 text-gray-900 border rounded-md ",onChange:Ye,value:Ke.name})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{htmlFor:"email",className:"block text-gray-900",children:"Enter your email"}),jsxRuntimeExports.jsx("input",{type:"email",name:"email",id:"email",placeholder:"Enter your email Here",className:"w-full px-4 py-2 mt-1 border rounded-md text-gray-900",onChange:Ye,value:Ke.email})]}),jsxRuntimeExports.jsxs("div",{className:"flex space-x-4",children:[jsxRuntimeExports.jsxs("div",{className:"w-1/2",children:[jsxRuntimeExports.jsx("label",{htmlFor:"password",className:"block text-gray-900",children:"Password"}),jsxRuntimeExports.jsx("input",{type:"password",name:"password",id:"password",placeholder:"Enter password",className:"w-full px-4 py-2 mt-1 border rounded-md text-gray-900",onChange:Ye,value:Ke.password})]}),jsxRuntimeExports.jsxs("div",{className:"w-1/2",children:[jsxRuntimeExports.jsx("label",{htmlFor:"phone",className:"block text-gray-900",children:"Number"}),jsxRuntimeExports.jsx("input",{type:"number",name:"phone",id:"phone",placeholder:"Enter mobile num.",className:"w-full px-4 py-2 mt-1 border rounded-md text-gray-900",onChange:Ye,value:Ke.phone})]})]}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("button",{type:"submit",className:"w-full bg-fuchsia-600 hover:bg-fuchsia-700 text-white cursor-pointer py-2 rounded-md font-semibold",children:"Register"})})]}),jsxRuntimeExports.jsxs("div",{className:"mt-4 text-gray-900 text-sm text-center",children:["Already have an account?",jsxRuntimeExports.jsx(Link,{to:"/register",className:"text-gray-900 hover:underline cursor-pointer",children:"Login"})]})]})})]})},PACKET_TYPES=Object.create(null);PACKET_TYPES.open="0";PACKET_TYPES.close="1";PACKET_TYPES.ping="2";PACKET_TYPES.pong="3";PACKET_TYPES.message="4";PACKET_TYPES.upgrade="5";PACKET_TYPES.noop="6";const PACKET_TYPES_REVERSE=Object.create(null);Object.keys(PACKET_TYPES).forEach(Ke=>{PACKET_TYPES_REVERSE[PACKET_TYPES[Ke]]=Ke});const ERROR_PACKET={type:"error",data:"parser error"},withNativeBlob$1=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",withNativeArrayBuffer$2=typeof ArrayBuffer=="function",isView$1=Ke=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(Ke):Ke&&Ke.buffer instanceof ArrayBuffer,encodePacket=({type:Ke,data:Ge},$e,Ye)=>withNativeBlob$1&&Ge instanceof Blob?$e?Ye(Ge):encodeBlobAsBase64(Ge,Ye):withNativeArrayBuffer$2&&(Ge instanceof ArrayBuffer||isView$1(Ge))?$e?Ye(Ge):encodeBlobAsBase64(new Blob([Ge]),Ye):Ye(PACKET_TYPES[Ke]+(Ge||"")),encodeBlobAsBase64=(Ke,Ge)=>{const $e=new FileReader;return $e.onload=function(){const Ye=$e.result.split(",")[1];Ge("b"+(Ye||""))},$e.readAsDataURL(Ke)};function toArray(Ke){return Ke instanceof Uint8Array?Ke:Ke instanceof ArrayBuffer?new Uint8Array(Ke):new Uint8Array(Ke.buffer,Ke.byteOffset,Ke.byteLength)}let TEXT_ENCODER;function encodePacketToBinary(Ke,Ge){if(withNativeBlob$1&&Ke.data instanceof Blob)return Ke.data.arrayBuffer().then(toArray).then(Ge);if(withNativeArrayBuffer$2&&(Ke.data instanceof ArrayBuffer||isView$1(Ke.data)))return Ge(toArray(Ke.data));encodePacket(Ke,!1,$e=>{TEXT_ENCODER||(TEXT_ENCODER=new TextEncoder),Ge(TEXT_ENCODER.encode($e))})}const chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup$1=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let Ke=0;Ke<chars.length;Ke++)lookup$1[chars.charCodeAt(Ke)]=Ke;const decode$1=Ke=>{let Ge=Ke.length*.75,$e=Ke.length,Ye,Qe=0,Je,Mt,nn,an;Ke[Ke.length-1]==="="&&(Ge--,Ke[Ke.length-2]==="="&&Ge--);const sn=new ArrayBuffer(Ge),ln=new Uint8Array(sn);for(Ye=0;Ye<$e;Ye+=4)Je=lookup$1[Ke.charCodeAt(Ye)],Mt=lookup$1[Ke.charCodeAt(Ye+1)],nn=lookup$1[Ke.charCodeAt(Ye+2)],an=lookup$1[Ke.charCodeAt(Ye+3)],ln[Qe++]=Je<<2|Mt>>4,ln[Qe++]=(Mt&15)<<4|nn>>2,ln[Qe++]=(nn&3)<<6|an&63;return sn},withNativeArrayBuffer$1=typeof ArrayBuffer=="function",decodePacket=(Ke,Ge)=>{if(typeof Ke!="string")return{type:"message",data:mapBinary(Ke,Ge)};const $e=Ke.charAt(0);return $e==="b"?{type:"message",data:decodeBase64Packet(Ke.substring(1),Ge)}:PACKET_TYPES_REVERSE[$e]?Ke.length>1?{type:PACKET_TYPES_REVERSE[$e],data:Ke.substring(1)}:{type:PACKET_TYPES_REVERSE[$e]}:ERROR_PACKET},decodeBase64Packet=(Ke,Ge)=>{if(withNativeArrayBuffer$1){const $e=decode$1(Ke);return mapBinary($e,Ge)}else return{base64:!0,data:Ke}},mapBinary=(Ke,Ge)=>{switch(Ge){case"blob":return Ke instanceof Blob?Ke:new Blob([Ke]);case"arraybuffer":default:return Ke instanceof ArrayBuffer?Ke:Ke.buffer}},SEPARATOR="",encodePayload=(Ke,Ge)=>{const $e=Ke.length,Ye=new Array($e);let Qe=0;Ke.forEach((Je,Mt)=>{encodePacket(Je,!1,nn=>{Ye[Mt]=nn,++Qe===$e&&Ge(Ye.join(SEPARATOR))})})},decodePayload=(Ke,Ge)=>{const $e=Ke.split(SEPARATOR),Ye=[];for(let Qe=0;Qe<$e.length;Qe++){const Je=decodePacket($e[Qe],Ge);if(Ye.push(Je),Je.type==="error")break}return Ye};function createPacketEncoderStream(){return new TransformStream({transform(Ke,Ge){encodePacketToBinary(Ke,$e=>{const Ye=$e.length;let Qe;if(Ye<126)Qe=new Uint8Array(1),new DataView(Qe.buffer).setUint8(0,Ye);else if(Ye<65536){Qe=new Uint8Array(3);const Je=new DataView(Qe.buffer);Je.setUint8(0,126),Je.setUint16(1,Ye)}else{Qe=new Uint8Array(9);const Je=new DataView(Qe.buffer);Je.setUint8(0,127),Je.setBigUint64(1,BigInt(Ye))}Ke.data&&typeof Ke.data!="string"&&(Qe[0]|=128),Ge.enqueue(Qe),Ge.enqueue($e)})}})}let TEXT_DECODER;function totalLength(Ke){return Ke.reduce((Ge,$e)=>Ge+$e.length,0)}function concatChunks(Ke,Ge){if(Ke[0].length===Ge)return Ke.shift();const $e=new Uint8Array(Ge);let Ye=0;for(let Qe=0;Qe<Ge;Qe++)$e[Qe]=Ke[0][Ye++],Ye===Ke[0].length&&(Ke.shift(),Ye=0);return Ke.length&&Ye<Ke[0].length&&(Ke[0]=Ke[0].slice(Ye)),$e}function createPacketDecoderStream(Ke,Ge){TEXT_DECODER||(TEXT_DECODER=new TextDecoder);const $e=[];let Ye=0,Qe=-1,Je=!1;return new TransformStream({transform(Mt,nn){for($e.push(Mt);;){if(Ye===0){if(totalLength($e)<1)break;const an=concatChunks($e,1);Je=(an[0]&128)===128,Qe=an[0]&127,Qe<126?Ye=3:Qe===126?Ye=1:Ye=2}else if(Ye===1){if(totalLength($e)<2)break;const an=concatChunks($e,2);Qe=new DataView(an.buffer,an.byteOffset,an.length).getUint16(0),Ye=3}else if(Ye===2){if(totalLength($e)<8)break;const an=concatChunks($e,8),sn=new DataView(an.buffer,an.byteOffset,an.length),ln=sn.getUint32(0);if(ln>Math.pow(2,21)-1){nn.enqueue(ERROR_PACKET);break}Qe=ln*Math.pow(2,32)+sn.getUint32(4),Ye=3}else{if(totalLength($e)<Qe)break;const an=concatChunks($e,Qe);nn.enqueue(decodePacket(Je?an:TEXT_DECODER.decode(an),Ge)),Ye=0}if(Qe===0||Qe>Ke){nn.enqueue(ERROR_PACKET);break}}}})}const protocol$1=4;function Emitter(Ke){if(Ke)return mixin(Ke)}function mixin(Ke){for(var Ge in Emitter.prototype)Ke[Ge]=Emitter.prototype[Ge];return Ke}Emitter.prototype.on=Emitter.prototype.addEventListener=function(Ke,Ge){return this._callbacks=this._callbacks||{},(this._callbacks["$"+Ke]=this._callbacks["$"+Ke]||[]).push(Ge),this};Emitter.prototype.once=function(Ke,Ge){function $e(){this.off(Ke,$e),Ge.apply(this,arguments)}return $e.fn=Ge,this.on(Ke,$e),this};Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(Ke,Ge){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var $e=this._callbacks["$"+Ke];if(!$e)return this;if(arguments.length==1)return delete this._callbacks["$"+Ke],this;for(var Ye,Qe=0;Qe<$e.length;Qe++)if(Ye=$e[Qe],Ye===Ge||Ye.fn===Ge){$e.splice(Qe,1);break}return $e.length===0&&delete this._callbacks["$"+Ke],this};Emitter.prototype.emit=function(Ke){this._callbacks=this._callbacks||{};for(var Ge=new Array(arguments.length-1),$e=this._callbacks["$"+Ke],Ye=1;Ye<arguments.length;Ye++)Ge[Ye-1]=arguments[Ye];if($e){$e=$e.slice(0);for(var Ye=0,Qe=$e.length;Ye<Qe;++Ye)$e[Ye].apply(this,Ge)}return this};Emitter.prototype.emitReserved=Emitter.prototype.emit;Emitter.prototype.listeners=function(Ke){return this._callbacks=this._callbacks||{},this._callbacks["$"+Ke]||[]};Emitter.prototype.hasListeners=function(Ke){return!!this.listeners(Ke).length};const nextTick=typeof Promise=="function"&&typeof Promise.resolve=="function"?Ge=>Promise.resolve().then(Ge):(Ge,$e)=>$e(Ge,0),globalThisShim=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),defaultBinaryType="arraybuffer";function createCookieJar(){}function pick(Ke,...Ge){return Ge.reduce(($e,Ye)=>(Ke.hasOwnProperty(Ye)&&($e[Ye]=Ke[Ye]),$e),{})}const NATIVE_SET_TIMEOUT=globalThisShim.setTimeout,NATIVE_CLEAR_TIMEOUT=globalThisShim.clearTimeout;function installTimerFunctions(Ke,Ge){Ge.useNativeTimers?(Ke.setTimeoutFn=NATIVE_SET_TIMEOUT.bind(globalThisShim),Ke.clearTimeoutFn=NATIVE_CLEAR_TIMEOUT.bind(globalThisShim)):(Ke.setTimeoutFn=globalThisShim.setTimeout.bind(globalThisShim),Ke.clearTimeoutFn=globalThisShim.clearTimeout.bind(globalThisShim))}const BASE64_OVERHEAD=1.33;function byteLength(Ke){return typeof Ke=="string"?utf8Length(Ke):Math.ceil((Ke.byteLength||Ke.size)*BASE64_OVERHEAD)}function utf8Length(Ke){let Ge=0,$e=0;for(let Ye=0,Qe=Ke.length;Ye<Qe;Ye++)Ge=Ke.charCodeAt(Ye),Ge<128?$e+=1:Ge<2048?$e+=2:Ge<55296||Ge>=57344?$e+=3:(Ye++,$e+=4);return $e}function randomString(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function encode(Ke){let Ge="";for(let $e in Ke)Ke.hasOwnProperty($e)&&(Ge.length&&(Ge+="&"),Ge+=encodeURIComponent($e)+"="+encodeURIComponent(Ke[$e]));return Ge}function decode(Ke){let Ge={},$e=Ke.split("&");for(let Ye=0,Qe=$e.length;Ye<Qe;Ye++){let Je=$e[Ye].split("=");Ge[decodeURIComponent(Je[0])]=decodeURIComponent(Je[1])}return Ge}class TransportError extends Error{constructor(Ge,$e,Ye){super(Ge),this.description=$e,this.context=Ye,this.type="TransportError"}}class Transport extends Emitter{constructor(Ge){super(),this.writable=!1,installTimerFunctions(this,Ge),this.opts=Ge,this.query=Ge.query,this.socket=Ge.socket,this.supportsBinary=!Ge.forceBase64}onError(Ge,$e,Ye){return super.emitReserved("error",new TransportError(Ge,$e,Ye)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(Ge){this.readyState==="open"&&this.write(Ge)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(Ge){const $e=decodePacket(Ge,this.socket.binaryType);this.onPacket($e)}onPacket(Ge){super.emitReserved("packet",Ge)}onClose(Ge){this.readyState="closed",super.emitReserved("close",Ge)}pause(Ge){}createUri(Ge,$e={}){return Ge+"://"+this._hostname()+this._port()+this.opts.path+this._query($e)}_hostname(){const Ge=this.opts.hostname;return Ge.indexOf(":")===-1?Ge:"["+Ge+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(Ge){const $e=encode(Ge);return $e.length?"?"+$e:""}}class Polling extends Transport{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(Ge){this.readyState="pausing";const $e=()=>{this.readyState="paused",Ge()};if(this._polling||!this.writable){let Ye=0;this._polling&&(Ye++,this.once("pollComplete",function(){--Ye||$e()})),this.writable||(Ye++,this.once("drain",function(){--Ye||$e()}))}else $e()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(Ge){const $e=Ye=>{if(this.readyState==="opening"&&Ye.type==="open"&&this.onOpen(),Ye.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(Ye)};decodePayload(Ge,this.socket.binaryType).forEach($e),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const Ge=()=>{this.write([{type:"close"}])};this.readyState==="open"?Ge():this.once("open",Ge)}write(Ge){this.writable=!1,encodePayload(Ge,$e=>{this.doWrite($e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const Ge=this.opts.secure?"https":"http",$e=this.query||{};return this.opts.timestampRequests!==!1&&($e[this.opts.timestampParam]=randomString()),!this.supportsBinary&&!$e.sid&&($e.b64=1),this.createUri(Ge,$e)}}let value=!1;try{value=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const hasCORS=value;function empty(){}class BaseXHR extends Polling{constructor(Ge){if(super(Ge),typeof location<"u"){const $e=location.protocol==="https:";let Ye=location.port;Ye||(Ye=$e?"443":"80"),this.xd=typeof location<"u"&&Ge.hostname!==location.hostname||Ye!==Ge.port}}doWrite(Ge,$e){const Ye=this.request({method:"POST",data:Ge});Ye.on("success",$e),Ye.on("error",(Qe,Je)=>{this.onError("xhr post error",Qe,Je)})}doPoll(){const Ge=this.request();Ge.on("data",this.onData.bind(this)),Ge.on("error",($e,Ye)=>{this.onError("xhr poll error",$e,Ye)}),this.pollXhr=Ge}}let Request$1=class gx extends Emitter{constructor(Ge,$e,Ye){super(),this.createRequest=Ge,installTimerFunctions(this,Ye),this._opts=Ye,this._method=Ye.method||"GET",this._uri=$e,this._data=Ye.data!==void 0?Ye.data:null,this._create()}_create(){var Ge;const $e=pick(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");$e.xdomain=!!this._opts.xd;const Ye=this._xhr=this.createRequest($e);try{Ye.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){Ye.setDisableHeaderCheck&&Ye.setDisableHeaderCheck(!0);for(let Qe in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(Qe)&&Ye.setRequestHeader(Qe,this._opts.extraHeaders[Qe])}}catch{}if(this._method==="POST")try{Ye.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{Ye.setRequestHeader("Accept","*/*")}catch{}(Ge=this._opts.cookieJar)===null||Ge===void 0||Ge.addCookies(Ye),"withCredentials"in Ye&&(Ye.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(Ye.timeout=this._opts.requestTimeout),Ye.onreadystatechange=()=>{var Qe;Ye.readyState===3&&((Qe=this._opts.cookieJar)===null||Qe===void 0||Qe.parseCookies(Ye.getResponseHeader("set-cookie"))),Ye.readyState===4&&(Ye.status===200||Ye.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof Ye.status=="number"?Ye.status:0)},0))},Ye.send(this._data)}catch(Qe){this.setTimeoutFn(()=>{this._onError(Qe)},0);return}typeof document<"u"&&(this._index=gx.requestsCount++,gx.requests[this._index]=this)}_onError(Ge){this.emitReserved("error",Ge,this._xhr),this._cleanup(!0)}_cleanup(Ge){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=empty,Ge)try{this._xhr.abort()}catch{}typeof document<"u"&&delete gx.requests[this._index],this._xhr=null}}_onLoad(){const Ge=this._xhr.responseText;Ge!==null&&(this.emitReserved("data",Ge),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};Request$1.requestsCount=0;Request$1.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",unloadHandler);else if(typeof addEventListener=="function"){const Ke="onpagehide"in globalThisShim?"pagehide":"unload";addEventListener(Ke,unloadHandler,!1)}}function unloadHandler(){for(let Ke in Request$1.requests)Request$1.requests.hasOwnProperty(Ke)&&Request$1.requests[Ke].abort()}const hasXHR2=function(){const Ke=newRequest({xdomain:!1});return Ke&&Ke.responseType!==null}();class XHR extends BaseXHR{constructor(Ge){super(Ge);const $e=Ge&&Ge.forceBase64;this.supportsBinary=hasXHR2&&!$e}request(Ge={}){return Object.assign(Ge,{xd:this.xd},this.opts),new Request$1(newRequest,this.uri(),Ge)}}function newRequest(Ke){const Ge=Ke.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!Ge||hasCORS))return new XMLHttpRequest}catch{}if(!Ge)try{return new globalThisShim[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const isReactNative=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class BaseWS extends Transport{get name(){return"websocket"}doOpen(){const Ge=this.uri(),$e=this.opts.protocols,Ye=isReactNative?{}:pick(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(Ye.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(Ge,$e,Ye)}catch(Qe){return this.emitReserved("error",Qe)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=Ge=>this.onClose({description:"websocket connection closed",context:Ge}),this.ws.onmessage=Ge=>this.onData(Ge.data),this.ws.onerror=Ge=>this.onError("websocket error",Ge)}write(Ge){this.writable=!1;for(let $e=0;$e<Ge.length;$e++){const Ye=Ge[$e],Qe=$e===Ge.length-1;encodePacket(Ye,this.supportsBinary,Je=>{try{this.doWrite(Ye,Je)}catch{}Qe&&nextTick(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const Ge=this.opts.secure?"wss":"ws",$e=this.query||{};return this.opts.timestampRequests&&($e[this.opts.timestampParam]=randomString()),this.supportsBinary||($e.b64=1),this.createUri(Ge,$e)}}const WebSocketCtor=globalThisShim.WebSocket||globalThisShim.MozWebSocket;class WS extends BaseWS{createSocket(Ge,$e,Ye){return isReactNative?new WebSocketCtor(Ge,$e,Ye):$e?new WebSocketCtor(Ge,$e):new WebSocketCtor(Ge)}doWrite(Ge,$e){this.ws.send($e)}}class WT extends Transport{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(Ge){return this.emitReserved("error",Ge)}this._transport.closed.then(()=>{this.onClose()}).catch(Ge=>{this.onError("webtransport error",Ge)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(Ge=>{const $e=createPacketDecoderStream(Number.MAX_SAFE_INTEGER,this.socket.binaryType),Ye=Ge.readable.pipeThrough($e).getReader(),Qe=createPacketEncoderStream();Qe.readable.pipeTo(Ge.writable),this._writer=Qe.writable.getWriter();const Je=()=>{Ye.read().then(({done:nn,value:an})=>{nn||(this.onPacket(an),Je())}).catch(nn=>{})};Je();const Mt={type:"open"};this.query.sid&&(Mt.data=`{"sid":"${this.query.sid}"}`),this._writer.write(Mt).then(()=>this.onOpen())})})}write(Ge){this.writable=!1;for(let $e=0;$e<Ge.length;$e++){const Ye=Ge[$e],Qe=$e===Ge.length-1;this._writer.write(Ye).then(()=>{Qe&&nextTick(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var Ge;(Ge=this._transport)===null||Ge===void 0||Ge.close()}}const transports={websocket:WS,webtransport:WT,polling:XHR},re$1=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,parts=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function parse(Ke){if(Ke.length>8e3)throw"URI too long";const Ge=Ke,$e=Ke.indexOf("["),Ye=Ke.indexOf("]");$e!=-1&&Ye!=-1&&(Ke=Ke.substring(0,$e)+Ke.substring($e,Ye).replace(/:/g,";")+Ke.substring(Ye,Ke.length));let Qe=re$1.exec(Ke||""),Je={},Mt=14;for(;Mt--;)Je[parts[Mt]]=Qe[Mt]||"";return $e!=-1&&Ye!=-1&&(Je.source=Ge,Je.host=Je.host.substring(1,Je.host.length-1).replace(/;/g,":"),Je.authority=Je.authority.replace("[","").replace("]","").replace(/;/g,":"),Je.ipv6uri=!0),Je.pathNames=pathNames(Je,Je.path),Je.queryKey=queryKey(Je,Je.query),Je}function pathNames(Ke,Ge){const $e=/\/{2,9}/g,Ye=Ge.replace($e,"/").split("/");return(Ge.slice(0,1)=="/"||Ge.length===0)&&Ye.splice(0,1),Ge.slice(-1)=="/"&&Ye.splice(Ye.length-1,1),Ye}function queryKey(Ke,Ge){const $e={};return Ge.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(Ye,Qe,Je){Qe&&($e[Qe]=Je)}),$e}const withEventListeners=typeof addEventListener=="function"&&typeof removeEventListener=="function",OFFLINE_EVENT_LISTENERS=[];withEventListeners&&addEventListener("offline",()=>{OFFLINE_EVENT_LISTENERS.forEach(Ke=>Ke())},!1);class SocketWithoutUpgrade extends Emitter{constructor(Ge,$e){if(super(),this.binaryType=defaultBinaryType,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,Ge&&typeof Ge=="object"&&($e=Ge,Ge=null),Ge){const Ye=parse(Ge);$e.hostname=Ye.host,$e.secure=Ye.protocol==="https"||Ye.protocol==="wss",$e.port=Ye.port,Ye.query&&($e.query=Ye.query)}else $e.host&&($e.hostname=parse($e.host).host);installTimerFunctions(this,$e),this.secure=$e.secure!=null?$e.secure:typeof location<"u"&&location.protocol==="https:",$e.hostname&&!$e.port&&($e.port=this.secure?"443":"80"),this.hostname=$e.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=$e.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},$e.transports.forEach(Ye=>{const Qe=Ye.prototype.name;this.transports.push(Qe),this._transportsByName[Qe]=Ye}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},$e),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=decode(this.opts.query)),withEventListeners&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},OFFLINE_EVENT_LISTENERS.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(Ge){const $e=Object.assign({},this.opts.query);$e.EIO=protocol$1,$e.transport=Ge,this.id&&($e.sid=this.id);const Ye=Object.assign({},this.opts,{query:$e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[Ge]);return new this._transportsByName[Ge](Ye)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const Ge=this.opts.rememberUpgrade&&SocketWithoutUpgrade.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const $e=this.createTransport(Ge);$e.open(),this.setTransport($e)}setTransport(Ge){this.transport&&this.transport.removeAllListeners(),this.transport=Ge,Ge.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",$e=>this._onClose("transport close",$e))}onOpen(){this.readyState="open",SocketWithoutUpgrade.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(Ge){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",Ge),this.emitReserved("heartbeat"),Ge.type){case"open":this.onHandshake(JSON.parse(Ge.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const $e=new Error("server error");$e.code=Ge.data,this._onError($e);break;case"message":this.emitReserved("data",Ge.data),this.emitReserved("message",Ge.data);break}}onHandshake(Ge){this.emitReserved("handshake",Ge),this.id=Ge.sid,this.transport.query.sid=Ge.sid,this._pingInterval=Ge.pingInterval,this._pingTimeout=Ge.pingTimeout,this._maxPayload=Ge.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const Ge=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+Ge,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},Ge),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const Ge=this._getWritablePackets();this.transport.send(Ge),this._prevBufferLen=Ge.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let $e=1;for(let Ye=0;Ye<this.writeBuffer.length;Ye++){const Qe=this.writeBuffer[Ye].data;if(Qe&&($e+=byteLength(Qe)),Ye>0&&$e>this._maxPayload)return this.writeBuffer.slice(0,Ye);$e+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const Ge=Date.now()>this._pingTimeoutTime;return Ge&&(this._pingTimeoutTime=0,nextTick(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),Ge}write(Ge,$e,Ye){return this._sendPacket("message",Ge,$e,Ye),this}send(Ge,$e,Ye){return this._sendPacket("message",Ge,$e,Ye),this}_sendPacket(Ge,$e,Ye,Qe){if(typeof $e=="function"&&(Qe=$e,$e=void 0),typeof Ye=="function"&&(Qe=Ye,Ye=null),this.readyState==="closing"||this.readyState==="closed")return;Ye=Ye||{},Ye.compress=Ye.compress!==!1;const Je={type:Ge,data:$e,options:Ye};this.emitReserved("packetCreate",Je),this.writeBuffer.push(Je),Qe&&this.once("flush",Qe),this.flush()}close(){const Ge=()=>{this._onClose("forced close"),this.transport.close()},$e=()=>{this.off("upgrade",$e),this.off("upgradeError",$e),Ge()},Ye=()=>{this.once("upgrade",$e),this.once("upgradeError",$e)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?Ye():Ge()}):this.upgrading?Ye():Ge()),this}_onError(Ge){if(SocketWithoutUpgrade.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",Ge),this._onClose("transport error",Ge)}_onClose(Ge,$e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),withEventListeners&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const Ye=OFFLINE_EVENT_LISTENERS.indexOf(this._offlineEventListener);Ye!==-1&&OFFLINE_EVENT_LISTENERS.splice(Ye,1)}this.readyState="closed",this.id=null,this.emitReserved("close",Ge,$e),this.writeBuffer=[],this._prevBufferLen=0}}}SocketWithoutUpgrade.protocol=protocol$1;class SocketWithUpgrade extends SocketWithoutUpgrade{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let Ge=0;Ge<this._upgrades.length;Ge++)this._probe(this._upgrades[Ge])}_probe(Ge){let $e=this.createTransport(Ge),Ye=!1;SocketWithoutUpgrade.priorWebsocketSuccess=!1;const Qe=()=>{Ye||($e.send([{type:"ping",data:"probe"}]),$e.once("packet",fn=>{if(!Ye)if(fn.type==="pong"&&fn.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",$e),!$e)return;SocketWithoutUpgrade.priorWebsocketSuccess=$e.name==="websocket",this.transport.pause(()=>{Ye||this.readyState!=="closed"&&(ln(),this.setTransport($e),$e.send([{type:"upgrade"}]),this.emitReserved("upgrade",$e),$e=null,this.upgrading=!1,this.flush())})}else{const hn=new Error("probe error");hn.transport=$e.name,this.emitReserved("upgradeError",hn)}}))};function Je(){Ye||(Ye=!0,ln(),$e.close(),$e=null)}const Mt=fn=>{const hn=new Error("probe error: "+fn);hn.transport=$e.name,Je(),this.emitReserved("upgradeError",hn)};function nn(){Mt("transport closed")}function an(){Mt("socket closed")}function sn(fn){$e&&fn.name!==$e.name&&Je()}const ln=()=>{$e.removeListener("open",Qe),$e.removeListener("error",Mt),$e.removeListener("close",nn),this.off("close",an),this.off("upgrading",sn)};$e.once("open",Qe),$e.once("error",Mt),$e.once("close",nn),this.once("close",an),this.once("upgrading",sn),this._upgrades.indexOf("webtransport")!==-1&&Ge!=="webtransport"?this.setTimeoutFn(()=>{Ye||$e.open()},200):$e.open()}onHandshake(Ge){this._upgrades=this._filterUpgrades(Ge.upgrades),super.onHandshake(Ge)}_filterUpgrades(Ge){const $e=[];for(let Ye=0;Ye<Ge.length;Ye++)~this.transports.indexOf(Ge[Ye])&&$e.push(Ge[Ye]);return $e}}let Socket$1=class extends SocketWithUpgrade{constructor(Ge,$e={}){const Ye=typeof Ge=="object"?Ge:$e;(!Ye.transports||Ye.transports&&typeof Ye.transports[0]=="string")&&(Ye.transports=(Ye.transports||["polling","websocket","webtransport"]).map(Qe=>transports[Qe]).filter(Qe=>!!Qe)),super(Ge,Ye)}};function url(Ke,Ge="",$e){let Ye=Ke;$e=$e||typeof location<"u"&&location,Ke==null&&(Ke=$e.protocol+"//"+$e.host),typeof Ke=="string"&&(Ke.charAt(0)==="/"&&(Ke.charAt(1)==="/"?Ke=$e.protocol+Ke:Ke=$e.host+Ke),/^(https?|wss?):\/\//.test(Ke)||(typeof $e<"u"?Ke=$e.protocol+"//"+Ke:Ke="https://"+Ke),Ye=parse(Ke)),Ye.port||(/^(http|ws)$/.test(Ye.protocol)?Ye.port="80":/^(http|ws)s$/.test(Ye.protocol)&&(Ye.port="443")),Ye.path=Ye.path||"/";const Je=Ye.host.indexOf(":")!==-1?"["+Ye.host+"]":Ye.host;return Ye.id=Ye.protocol+"://"+Je+":"+Ye.port+Ge,Ye.href=Ye.protocol+"://"+Je+($e&&$e.port===Ye.port?"":":"+Ye.port),Ye}const withNativeArrayBuffer=typeof ArrayBuffer=="function",isView=Ke=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(Ke):Ke.buffer instanceof ArrayBuffer,toString=Object.prototype.toString,withNativeBlob=typeof Blob=="function"||typeof Blob<"u"&&toString.call(Blob)==="[object BlobConstructor]",withNativeFile=typeof File=="function"||typeof File<"u"&&toString.call(File)==="[object FileConstructor]";function isBinary(Ke){return withNativeArrayBuffer&&(Ke instanceof ArrayBuffer||isView(Ke))||withNativeBlob&&Ke instanceof Blob||withNativeFile&&Ke instanceof File}function hasBinary(Ke,Ge){if(!Ke||typeof Ke!="object")return!1;if(Array.isArray(Ke)){for(let $e=0,Ye=Ke.length;$e<Ye;$e++)if(hasBinary(Ke[$e]))return!0;return!1}if(isBinary(Ke))return!0;if(Ke.toJSON&&typeof Ke.toJSON=="function"&&arguments.length===1)return hasBinary(Ke.toJSON(),!0);for(const $e in Ke)if(Object.prototype.hasOwnProperty.call(Ke,$e)&&hasBinary(Ke[$e]))return!0;return!1}function deconstructPacket(Ke){const Ge=[],$e=Ke.data,Ye=Ke;return Ye.data=_deconstructPacket($e,Ge),Ye.attachments=Ge.length,{packet:Ye,buffers:Ge}}function _deconstructPacket(Ke,Ge){if(!Ke)return Ke;if(isBinary(Ke)){const $e={_placeholder:!0,num:Ge.length};return Ge.push(Ke),$e}else if(Array.isArray(Ke)){const $e=new Array(Ke.length);for(let Ye=0;Ye<Ke.length;Ye++)$e[Ye]=_deconstructPacket(Ke[Ye],Ge);return $e}else if(typeof Ke=="object"&&!(Ke instanceof Date)){const $e={};for(const Ye in Ke)Object.prototype.hasOwnProperty.call(Ke,Ye)&&($e[Ye]=_deconstructPacket(Ke[Ye],Ge));return $e}return Ke}function reconstructPacket(Ke,Ge){return Ke.data=_reconstructPacket(Ke.data,Ge),delete Ke.attachments,Ke}function _reconstructPacket(Ke,Ge){if(!Ke)return Ke;if(Ke&&Ke._placeholder===!0){if(typeof Ke.num=="number"&&Ke.num>=0&&Ke.num<Ge.length)return Ge[Ke.num];throw new Error("illegal attachments")}else if(Array.isArray(Ke))for(let $e=0;$e<Ke.length;$e++)Ke[$e]=_reconstructPacket(Ke[$e],Ge);else if(typeof Ke=="object")for(const $e in Ke)Object.prototype.hasOwnProperty.call(Ke,$e)&&(Ke[$e]=_reconstructPacket(Ke[$e],Ge));return Ke}const RESERVED_EVENTS$1=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],protocol=5;var PacketType;(function(Ke){Ke[Ke.CONNECT=0]="CONNECT",Ke[Ke.DISCONNECT=1]="DISCONNECT",Ke[Ke.EVENT=2]="EVENT",Ke[Ke.ACK=3]="ACK",Ke[Ke.CONNECT_ERROR=4]="CONNECT_ERROR",Ke[Ke.BINARY_EVENT=5]="BINARY_EVENT",Ke[Ke.BINARY_ACK=6]="BINARY_ACK"})(PacketType||(PacketType={}));class Encoder{constructor(Ge){this.replacer=Ge}encode(Ge){return(Ge.type===PacketType.EVENT||Ge.type===PacketType.ACK)&&hasBinary(Ge)?this.encodeAsBinary({type:Ge.type===PacketType.EVENT?PacketType.BINARY_EVENT:PacketType.BINARY_ACK,nsp:Ge.nsp,data:Ge.data,id:Ge.id}):[this.encodeAsString(Ge)]}encodeAsString(Ge){let $e=""+Ge.type;return(Ge.type===PacketType.BINARY_EVENT||Ge.type===PacketType.BINARY_ACK)&&($e+=Ge.attachments+"-"),Ge.nsp&&Ge.nsp!=="/"&&($e+=Ge.nsp+","),Ge.id!=null&&($e+=Ge.id),Ge.data!=null&&($e+=JSON.stringify(Ge.data,this.replacer)),$e}encodeAsBinary(Ge){const $e=deconstructPacket(Ge),Ye=this.encodeAsString($e.packet),Qe=$e.buffers;return Qe.unshift(Ye),Qe}}function isObject(Ke){return Object.prototype.toString.call(Ke)==="[object Object]"}class Decoder extends Emitter{constructor(Ge){super(),this.reviver=Ge}add(Ge){let $e;if(typeof Ge=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");$e=this.decodeString(Ge);const Ye=$e.type===PacketType.BINARY_EVENT;Ye||$e.type===PacketType.BINARY_ACK?($e.type=Ye?PacketType.EVENT:PacketType.ACK,this.reconstructor=new BinaryReconstructor($e),$e.attachments===0&&super.emitReserved("decoded",$e)):super.emitReserved("decoded",$e)}else if(isBinary(Ge)||Ge.base64)if(this.reconstructor)$e=this.reconstructor.takeBinaryData(Ge),$e&&(this.reconstructor=null,super.emitReserved("decoded",$e));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+Ge)}decodeString(Ge){let $e=0;const Ye={type:Number(Ge.charAt(0))};if(PacketType[Ye.type]===void 0)throw new Error("unknown packet type "+Ye.type);if(Ye.type===PacketType.BINARY_EVENT||Ye.type===PacketType.BINARY_ACK){const Je=$e+1;for(;Ge.charAt(++$e)!=="-"&&$e!=Ge.length;);const Mt=Ge.substring(Je,$e);if(Mt!=Number(Mt)||Ge.charAt($e)!=="-")throw new Error("Illegal attachments");Ye.attachments=Number(Mt)}if(Ge.charAt($e+1)==="/"){const Je=$e+1;for(;++$e&&!(Ge.charAt($e)===","||$e===Ge.length););Ye.nsp=Ge.substring(Je,$e)}else Ye.nsp="/";const Qe=Ge.charAt($e+1);if(Qe!==""&&Number(Qe)==Qe){const Je=$e+1;for(;++$e;){const Mt=Ge.charAt($e);if(Mt==null||Number(Mt)!=Mt){--$e;break}if($e===Ge.length)break}Ye.id=Number(Ge.substring(Je,$e+1))}if(Ge.charAt(++$e)){const Je=this.tryParse(Ge.substr($e));if(Decoder.isPayloadValid(Ye.type,Je))Ye.data=Je;else throw new Error("invalid payload")}return Ye}tryParse(Ge){try{return JSON.parse(Ge,this.reviver)}catch{return!1}}static isPayloadValid(Ge,$e){switch(Ge){case PacketType.CONNECT:return isObject($e);case PacketType.DISCONNECT:return $e===void 0;case PacketType.CONNECT_ERROR:return typeof $e=="string"||isObject($e);case PacketType.EVENT:case PacketType.BINARY_EVENT:return Array.isArray($e)&&(typeof $e[0]=="number"||typeof $e[0]=="string"&&RESERVED_EVENTS$1.indexOf($e[0])===-1);case PacketType.ACK:case PacketType.BINARY_ACK:return Array.isArray($e)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class BinaryReconstructor{constructor(Ge){this.packet=Ge,this.buffers=[],this.reconPack=Ge}takeBinaryData(Ge){if(this.buffers.push(Ge),this.buffers.length===this.reconPack.attachments){const $e=reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),$e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const parser=Object.freeze(Object.defineProperty({__proto__:null,Decoder,Encoder,get PacketType(){return PacketType},protocol},Symbol.toStringTag,{value:"Module"}));function on(Ke,Ge,$e){return Ke.on(Ge,$e),function(){Ke.off(Ge,$e)}}const RESERVED_EVENTS=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Socket extends Emitter{constructor(Ge,$e,Ye){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=Ge,this.nsp=$e,Ye&&Ye.auth&&(this.auth=Ye.auth),this._opts=Object.assign({},Ye),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const Ge=this.io;this.subs=[on(Ge,"open",this.onopen.bind(this)),on(Ge,"packet",this.onpacket.bind(this)),on(Ge,"error",this.onerror.bind(this)),on(Ge,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...Ge){return Ge.unshift("message"),this.emit.apply(this,Ge),this}emit(Ge,...$e){var Ye,Qe,Je;if(RESERVED_EVENTS.hasOwnProperty(Ge))throw new Error('"'+Ge.toString()+'" is a reserved event name');if($e.unshift(Ge),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue($e),this;const Mt={type:PacketType.EVENT,data:$e};if(Mt.options={},Mt.options.compress=this.flags.compress!==!1,typeof $e[$e.length-1]=="function"){const ln=this.ids++,fn=$e.pop();this._registerAckCallback(ln,fn),Mt.id=ln}const nn=(Qe=(Ye=this.io.engine)===null||Ye===void 0?void 0:Ye.transport)===null||Qe===void 0?void 0:Qe.writable,an=this.connected&&!(!((Je=this.io.engine)===null||Je===void 0)&&Je._hasPingExpired());return this.flags.volatile&&!nn||(an?(this.notifyOutgoingListeners(Mt),this.packet(Mt)):this.sendBuffer.push(Mt)),this.flags={},this}_registerAckCallback(Ge,$e){var Ye;const Qe=(Ye=this.flags.timeout)!==null&&Ye!==void 0?Ye:this._opts.ackTimeout;if(Qe===void 0){this.acks[Ge]=$e;return}const Je=this.io.setTimeoutFn(()=>{delete this.acks[Ge];for(let nn=0;nn<this.sendBuffer.length;nn++)this.sendBuffer[nn].id===Ge&&this.sendBuffer.splice(nn,1);$e.call(this,new Error("operation has timed out"))},Qe),Mt=(...nn)=>{this.io.clearTimeoutFn(Je),$e.apply(this,nn)};Mt.withError=!0,this.acks[Ge]=Mt}emitWithAck(Ge,...$e){return new Promise((Ye,Qe)=>{const Je=(Mt,nn)=>Mt?Qe(Mt):Ye(nn);Je.withError=!0,$e.push(Je),this.emit(Ge,...$e)})}_addToQueue(Ge){let $e;typeof Ge[Ge.length-1]=="function"&&($e=Ge.pop());const Ye={id:this._queueSeq++,tryCount:0,pending:!1,args:Ge,flags:Object.assign({fromQueue:!0},this.flags)};Ge.push((Qe,...Je)=>Ye!==this._queue[0]?void 0:(Qe!==null?Ye.tryCount>this._opts.retries&&(this._queue.shift(),$e&&$e(Qe)):(this._queue.shift(),$e&&$e(null,...Je)),Ye.pending=!1,this._drainQueue())),this._queue.push(Ye),this._drainQueue()}_drainQueue(Ge=!1){if(!this.connected||this._queue.length===0)return;const $e=this._queue[0];$e.pending&&!Ge||($e.pending=!0,$e.tryCount++,this.flags=$e.flags,this.emit.apply(this,$e.args))}packet(Ge){Ge.nsp=this.nsp,this.io._packet(Ge)}onopen(){typeof this.auth=="function"?this.auth(Ge=>{this._sendConnectPacket(Ge)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(Ge){this.packet({type:PacketType.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},Ge):Ge})}onerror(Ge){this.connected||this.emitReserved("connect_error",Ge)}onclose(Ge,$e){this.connected=!1,delete this.id,this.emitReserved("disconnect",Ge,$e),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(Ge=>{if(!this.sendBuffer.some(Ye=>String(Ye.id)===Ge)){const Ye=this.acks[Ge];delete this.acks[Ge],Ye.withError&&Ye.call(this,new Error("socket has been disconnected"))}})}onpacket(Ge){if(Ge.nsp===this.nsp)switch(Ge.type){case PacketType.CONNECT:Ge.data&&Ge.data.sid?this.onconnect(Ge.data.sid,Ge.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case PacketType.EVENT:case PacketType.BINARY_EVENT:this.onevent(Ge);break;case PacketType.ACK:case PacketType.BINARY_ACK:this.onack(Ge);break;case PacketType.DISCONNECT:this.ondisconnect();break;case PacketType.CONNECT_ERROR:this.destroy();const Ye=new Error(Ge.data.message);Ye.data=Ge.data.data,this.emitReserved("connect_error",Ye);break}}onevent(Ge){const $e=Ge.data||[];Ge.id!=null&&$e.push(this.ack(Ge.id)),this.connected?this.emitEvent($e):this.receiveBuffer.push(Object.freeze($e))}emitEvent(Ge){if(this._anyListeners&&this._anyListeners.length){const $e=this._anyListeners.slice();for(const Ye of $e)Ye.apply(this,Ge)}super.emit.apply(this,Ge),this._pid&&Ge.length&&typeof Ge[Ge.length-1]=="string"&&(this._lastOffset=Ge[Ge.length-1])}ack(Ge){const $e=this;let Ye=!1;return function(...Qe){Ye||(Ye=!0,$e.packet({type:PacketType.ACK,id:Ge,data:Qe}))}}onack(Ge){const $e=this.acks[Ge.id];typeof $e=="function"&&(delete this.acks[Ge.id],$e.withError&&Ge.data.unshift(null),$e.apply(this,Ge.data))}onconnect(Ge,$e){this.id=Ge,this.recovered=$e&&this._pid===$e,this._pid=$e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(Ge=>this.emitEvent(Ge)),this.receiveBuffer=[],this.sendBuffer.forEach(Ge=>{this.notifyOutgoingListeners(Ge),this.packet(Ge)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(Ge=>Ge()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:PacketType.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(Ge){return this.flags.compress=Ge,this}get volatile(){return this.flags.volatile=!0,this}timeout(Ge){return this.flags.timeout=Ge,this}onAny(Ge){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(Ge),this}prependAny(Ge){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(Ge),this}offAny(Ge){if(!this._anyListeners)return this;if(Ge){const $e=this._anyListeners;for(let Ye=0;Ye<$e.length;Ye++)if(Ge===$e[Ye])return $e.splice(Ye,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(Ge){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(Ge),this}prependAnyOutgoing(Ge){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(Ge),this}offAnyOutgoing(Ge){if(!this._anyOutgoingListeners)return this;if(Ge){const $e=this._anyOutgoingListeners;for(let Ye=0;Ye<$e.length;Ye++)if(Ge===$e[Ye])return $e.splice(Ye,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(Ge){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const $e=this._anyOutgoingListeners.slice();for(const Ye of $e)Ye.apply(this,Ge.data)}}}function Backoff(Ke){Ke=Ke||{},this.ms=Ke.min||100,this.max=Ke.max||1e4,this.factor=Ke.factor||2,this.jitter=Ke.jitter>0&&Ke.jitter<=1?Ke.jitter:0,this.attempts=0}Backoff.prototype.duration=function(){var Ke=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var Ge=Math.random(),$e=Math.floor(Ge*this.jitter*Ke);Ke=(Math.floor(Ge*10)&1)==0?Ke-$e:Ke+$e}return Math.min(Ke,this.max)|0};Backoff.prototype.reset=function(){this.attempts=0};Backoff.prototype.setMin=function(Ke){this.ms=Ke};Backoff.prototype.setMax=function(Ke){this.max=Ke};Backoff.prototype.setJitter=function(Ke){this.jitter=Ke};class Manager extends Emitter{constructor(Ge,$e){var Ye;super(),this.nsps={},this.subs=[],Ge&&typeof Ge=="object"&&($e=Ge,Ge=void 0),$e=$e||{},$e.path=$e.path||"/socket.io",this.opts=$e,installTimerFunctions(this,$e),this.reconnection($e.reconnection!==!1),this.reconnectionAttempts($e.reconnectionAttempts||1/0),this.reconnectionDelay($e.reconnectionDelay||1e3),this.reconnectionDelayMax($e.reconnectionDelayMax||5e3),this.randomizationFactor((Ye=$e.randomizationFactor)!==null&&Ye!==void 0?Ye:.5),this.backoff=new Backoff({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout($e.timeout==null?2e4:$e.timeout),this._readyState="closed",this.uri=Ge;const Qe=$e.parser||parser;this.encoder=new Qe.Encoder,this.decoder=new Qe.Decoder,this._autoConnect=$e.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(Ge){return arguments.length?(this._reconnection=!!Ge,Ge||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(Ge){return Ge===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=Ge,this)}reconnectionDelay(Ge){var $e;return Ge===void 0?this._reconnectionDelay:(this._reconnectionDelay=Ge,($e=this.backoff)===null||$e===void 0||$e.setMin(Ge),this)}randomizationFactor(Ge){var $e;return Ge===void 0?this._randomizationFactor:(this._randomizationFactor=Ge,($e=this.backoff)===null||$e===void 0||$e.setJitter(Ge),this)}reconnectionDelayMax(Ge){var $e;return Ge===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=Ge,($e=this.backoff)===null||$e===void 0||$e.setMax(Ge),this)}timeout(Ge){return arguments.length?(this._timeout=Ge,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(Ge){if(~this._readyState.indexOf("open"))return this;this.engine=new Socket$1(this.uri,this.opts);const $e=this.engine,Ye=this;this._readyState="opening",this.skipReconnect=!1;const Qe=on($e,"open",function(){Ye.onopen(),Ge&&Ge()}),Je=nn=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",nn),Ge?Ge(nn):this.maybeReconnectOnOpen()},Mt=on($e,"error",Je);if(this._timeout!==!1){const nn=this._timeout,an=this.setTimeoutFn(()=>{Qe(),Je(new Error("timeout")),$e.close()},nn);this.opts.autoUnref&&an.unref(),this.subs.push(()=>{this.clearTimeoutFn(an)})}return this.subs.push(Qe),this.subs.push(Mt),this}connect(Ge){return this.open(Ge)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const Ge=this.engine;this.subs.push(on(Ge,"ping",this.onping.bind(this)),on(Ge,"data",this.ondata.bind(this)),on(Ge,"error",this.onerror.bind(this)),on(Ge,"close",this.onclose.bind(this)),on(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(Ge){try{this.decoder.add(Ge)}catch($e){this.onclose("parse error",$e)}}ondecoded(Ge){nextTick(()=>{this.emitReserved("packet",Ge)},this.setTimeoutFn)}onerror(Ge){this.emitReserved("error",Ge)}socket(Ge,$e){let Ye=this.nsps[Ge];return Ye?this._autoConnect&&!Ye.active&&Ye.connect():(Ye=new Socket(this,Ge,$e),this.nsps[Ge]=Ye),Ye}_destroy(Ge){const $e=Object.keys(this.nsps);for(const Ye of $e)if(this.nsps[Ye].active)return;this._close()}_packet(Ge){const $e=this.encoder.encode(Ge);for(let Ye=0;Ye<$e.length;Ye++)this.engine.write($e[Ye],Ge.options)}cleanup(){this.subs.forEach(Ge=>Ge()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(Ge,$e){var Ye;this.cleanup(),(Ye=this.engine)===null||Ye===void 0||Ye.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",Ge,$e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const Ge=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const $e=this.backoff.duration();this._reconnecting=!0;const Ye=this.setTimeoutFn(()=>{Ge.skipReconnect||(this.emitReserved("reconnect_attempt",Ge.backoff.attempts),!Ge.skipReconnect&&Ge.open(Qe=>{Qe?(Ge._reconnecting=!1,Ge.reconnect(),this.emitReserved("reconnect_error",Qe)):Ge.onreconnect()}))},$e);this.opts.autoUnref&&Ye.unref(),this.subs.push(()=>{this.clearTimeoutFn(Ye)})}}onreconnect(){const Ge=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",Ge)}}const cache={};function lookup(Ke,Ge){typeof Ke=="object"&&(Ge=Ke,Ke=void 0),Ge=Ge||{};const $e=url(Ke,Ge.path||"/socket.io"),Ye=$e.source,Qe=$e.id,Je=$e.path,Mt=cache[Qe]&&Je in cache[Qe].nsps,nn=Ge.forceNew||Ge["force new connection"]||Ge.multiplex===!1||Mt;let an;return nn?an=new Manager(Ye,Ge):(cache[Qe]||(cache[Qe]=new Manager(Ye,Ge)),an=cache[Qe]),$e.query&&!Ge.query&&(Ge.query=$e.queryKey),an.socket($e.path,Ge)}Object.assign(lookup,{Manager,Socket,io:lookup,connect:lookup});var browser$2={exports:{}},ms$1,hasRequiredMs;function requireMs(){if(hasRequiredMs)return ms$1;hasRequiredMs=1;var Ke=1e3,Ge=Ke*60,$e=Ge*60,Ye=$e*24,Qe=Ye*7,Je=Ye*365.25;ms$1=function(ln,fn){fn=fn||{};var hn=typeof ln;if(hn==="string"&&ln.length>0)return Mt(ln);if(hn==="number"&&isFinite(ln))return fn.long?an(ln):nn(ln);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(ln))};function Mt(ln){if(ln=String(ln),!(ln.length>100)){var fn=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(ln);if(fn){var hn=parseFloat(fn[1]),Xr=(fn[2]||"ms").toLowerCase();switch(Xr){case"years":case"year":case"yrs":case"yr":case"y":return hn*Je;case"weeks":case"week":case"w":return hn*Qe;case"days":case"day":case"d":return hn*Ye;case"hours":case"hour":case"hrs":case"hr":case"h":return hn*$e;case"minutes":case"minute":case"mins":case"min":case"m":return hn*Ge;case"seconds":case"second":case"secs":case"sec":case"s":return hn*Ke;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return hn;default:return}}}}function nn(ln){var fn=Math.abs(ln);return fn>=Ye?Math.round(ln/Ye)+"d":fn>=$e?Math.round(ln/$e)+"h":fn>=Ge?Math.round(ln/Ge)+"m":fn>=Ke?Math.round(ln/Ke)+"s":ln+"ms"}function an(ln){var fn=Math.abs(ln);return fn>=Ye?sn(ln,fn,Ye,"day"):fn>=$e?sn(ln,fn,$e,"hour"):fn>=Ge?sn(ln,fn,Ge,"minute"):fn>=Ke?sn(ln,fn,Ke,"second"):ln+" ms"}function sn(ln,fn,hn,Xr){var Mi=fn>=hn*1.5;return Math.round(ln/hn)+" "+Xr+(Mi?"s":"")}return ms$1}var common,hasRequiredCommon;function requireCommon(){if(hasRequiredCommon)return common;hasRequiredCommon=1;function Ke(Ge){Ye.debug=Ye,Ye.default=Ye,Ye.coerce=sn,Ye.disable=nn,Ye.enable=Je,Ye.enabled=an,Ye.humanize=requireMs(),Ye.destroy=ln,Object.keys(Ge).forEach(fn=>{Ye[fn]=Ge[fn]}),Ye.names=[],Ye.skips=[],Ye.formatters={};function $e(fn){let hn=0;for(let Xr=0;Xr<fn.length;Xr++)hn=(hn<<5)-hn+fn.charCodeAt(Xr),hn|=0;return Ye.colors[Math.abs(hn)%Ye.colors.length]}Ye.selectColor=$e;function Ye(fn){let hn,Xr=null,Mi,co;function lo(...uo){if(!lo.enabled)return;const ho=lo,mo=Number(new Date),_d=mo-(hn||mo);ho.diff=_d,ho.prev=hn,ho.curr=mo,hn=mo,uo[0]=Ye.coerce(uo[0]),typeof uo[0]!="string"&&uo.unshift("%O");let ep=0;uo[0]=uo[0].replace(/%([a-zA-Z%])/g,(sp,op)=>{if(sp==="%%")return"%";ep++;const ip=Ye.formatters[op];if(typeof ip=="function"){const lp=uo[ep];sp=ip.call(ho,lp),uo.splice(ep,1),ep--}return sp}),Ye.formatArgs.call(ho,uo),(ho.log||Ye.log).apply(ho,uo)}return lo.namespace=fn,lo.useColors=Ye.useColors(),lo.color=Ye.selectColor(fn),lo.extend=Qe,lo.destroy=Ye.destroy,Object.defineProperty(lo,"enabled",{enumerable:!0,configurable:!1,get:()=>Xr!==null?Xr:(Mi!==Ye.namespaces&&(Mi=Ye.namespaces,co=Ye.enabled(fn)),co),set:uo=>{Xr=uo}}),typeof Ye.init=="function"&&Ye.init(lo),lo}function Qe(fn,hn){const Xr=Ye(this.namespace+(typeof hn>"u"?":":hn)+fn);return Xr.log=this.log,Xr}function Je(fn){Ye.save(fn),Ye.namespaces=fn,Ye.names=[],Ye.skips=[];const hn=(typeof fn=="string"?fn:"").trim().replace(" ",",").split(",").filter(Boolean);for(const Xr of hn)Xr[0]==="-"?Ye.skips.push(Xr.slice(1)):Ye.names.push(Xr)}function Mt(fn,hn){let Xr=0,Mi=0,co=-1,lo=0;for(;Xr<fn.length;)if(Mi<hn.length&&(hn[Mi]===fn[Xr]||hn[Mi]==="*"))hn[Mi]==="*"?(co=Mi,lo=Xr,Mi++):(Xr++,Mi++);else if(co!==-1)Mi=co+1,lo++,Xr=lo;else return!1;for(;Mi<hn.length&&hn[Mi]==="*";)Mi++;return Mi===hn.length}function nn(){const fn=[...Ye.names,...Ye.skips.map(hn=>"-"+hn)].join(",");return Ye.enable(""),fn}function an(fn){for(const hn of Ye.skips)if(Mt(fn,hn))return!1;for(const hn of Ye.names)if(Mt(fn,hn))return!0;return!1}function sn(fn){return fn instanceof Error?fn.stack||fn.message:fn}function ln(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return Ye.enable(Ye.load()),Ye}return common=Ke,common}var hasRequiredBrowser$2;function requireBrowser$2(){return hasRequiredBrowser$2||(hasRequiredBrowser$2=1,function(Ke,Ge){var $e={};Ge.formatArgs=Qe,Ge.save=Je,Ge.load=Mt,Ge.useColors=Ye,Ge.storage=nn(),Ge.destroy=(()=>{let sn=!1;return()=>{sn||(sn=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),Ge.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function Ye(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let sn;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(sn=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(sn[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function Qe(sn){if(sn[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+sn[0]+(this.useColors?"%c ":" ")+"+"+Ke.exports.humanize(this.diff),!this.useColors)return;const ln="color: "+this.color;sn.splice(1,0,ln,"color: inherit");let fn=0,hn=0;sn[0].replace(/%[a-zA-Z%]/g,Xr=>{Xr!=="%%"&&(fn++,Xr==="%c"&&(hn=fn))}),sn.splice(hn,0,ln)}Ge.log=console.debug||console.log||(()=>{});function Je(sn){try{sn?Ge.storage.setItem("debug",sn):Ge.storage.removeItem("debug")}catch{}}function Mt(){let sn;try{sn=Ge.storage.getItem("debug")}catch{}return!sn&&typeof process<"u"&&"env"in process&&(sn=$e.DEBUG),sn}function nn(){try{return localStorage}catch{}}Ke.exports=requireCommon()(Ge);const{formatters:an}=Ke.exports;an.j=function(sn){try{return JSON.stringify(sn)}catch(ln){return"[UnexpectedJSONParseError]: "+ln.message}}}(browser$2,browser$2.exports)),browser$2.exports}var getBrowserRtc,hasRequiredGetBrowserRtc;function requireGetBrowserRtc(){return hasRequiredGetBrowserRtc||(hasRequiredGetBrowserRtc=1,getBrowserRtc=function(){if(typeof globalThis>"u")return null;var Ge={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return Ge.RTCPeerConnection?Ge:null}),getBrowserRtc}var browser$1={exports:{}},safeBuffer={exports:{}},buffer={},base64Js={},hasRequiredBase64Js;function requireBase64Js(){if(hasRequiredBase64Js)return base64Js;hasRequiredBase64Js=1,base64Js.byteLength=nn,base64Js.toByteArray=sn,base64Js.fromByteArray=hn;for(var Ke=[],Ge=[],$e=typeof Uint8Array<"u"?Uint8Array:Array,Ye="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Qe=0,Je=Ye.length;Qe<Je;++Qe)Ke[Qe]=Ye[Qe],Ge[Ye.charCodeAt(Qe)]=Qe;Ge[45]=62,Ge[95]=63;function Mt(Xr){var Mi=Xr.length;if(Mi%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var co=Xr.indexOf("=");co===-1&&(co=Mi);var lo=co===Mi?0:4-co%4;return[co,lo]}function nn(Xr){var Mi=Mt(Xr),co=Mi[0],lo=Mi[1];return(co+lo)*3/4-lo}function an(Xr,Mi,co){return(Mi+co)*3/4-co}function sn(Xr){var Mi,co=Mt(Xr),lo=co[0],uo=co[1],ho=new $e(an(Xr,lo,uo)),mo=0,_d=uo>0?lo-4:lo,ep;for(ep=0;ep<_d;ep+=4)Mi=Ge[Xr.charCodeAt(ep)]<<18|Ge[Xr.charCodeAt(ep+1)]<<12|Ge[Xr.charCodeAt(ep+2)]<<6|Ge[Xr.charCodeAt(ep+3)],ho[mo++]=Mi>>16&255,ho[mo++]=Mi>>8&255,ho[mo++]=Mi&255;return uo===2&&(Mi=Ge[Xr.charCodeAt(ep)]<<2|Ge[Xr.charCodeAt(ep+1)]>>4,ho[mo++]=Mi&255),uo===1&&(Mi=Ge[Xr.charCodeAt(ep)]<<10|Ge[Xr.charCodeAt(ep+1)]<<4|Ge[Xr.charCodeAt(ep+2)]>>2,ho[mo++]=Mi>>8&255,ho[mo++]=Mi&255),ho}function ln(Xr){return Ke[Xr>>18&63]+Ke[Xr>>12&63]+Ke[Xr>>6&63]+Ke[Xr&63]}function fn(Xr,Mi,co){for(var lo,uo=[],ho=Mi;ho<co;ho+=3)lo=(Xr[ho]<<16&16711680)+(Xr[ho+1]<<8&65280)+(Xr[ho+2]&255),uo.push(ln(lo));return uo.join("")}function hn(Xr){for(var Mi,co=Xr.length,lo=co%3,uo=[],ho=16383,mo=0,_d=co-lo;mo<_d;mo+=ho)uo.push(fn(Xr,mo,mo+ho>_d?_d:mo+ho));return lo===1?(Mi=Xr[co-1],uo.push(Ke[Mi>>2]+Ke[Mi<<4&63]+"==")):lo===2&&(Mi=(Xr[co-2]<<8)+Xr[co-1],uo.push(Ke[Mi>>10]+Ke[Mi>>4&63]+Ke[Mi<<2&63]+"=")),uo.join("")}return base64Js}var ieee754={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var hasRequiredIeee754;function requireIeee754(){return hasRequiredIeee754||(hasRequiredIeee754=1,ieee754.read=function(Ke,Ge,$e,Ye,Qe){var Je,Mt,nn=Qe*8-Ye-1,an=(1<<nn)-1,sn=an>>1,ln=-7,fn=$e?Qe-1:0,hn=$e?-1:1,Xr=Ke[Ge+fn];for(fn+=hn,Je=Xr&(1<<-ln)-1,Xr>>=-ln,ln+=nn;ln>0;Je=Je*256+Ke[Ge+fn],fn+=hn,ln-=8);for(Mt=Je&(1<<-ln)-1,Je>>=-ln,ln+=Ye;ln>0;Mt=Mt*256+Ke[Ge+fn],fn+=hn,ln-=8);if(Je===0)Je=1-sn;else{if(Je===an)return Mt?NaN:(Xr?-1:1)*(1/0);Mt=Mt+Math.pow(2,Ye),Je=Je-sn}return(Xr?-1:1)*Mt*Math.pow(2,Je-Ye)},ieee754.write=function(Ke,Ge,$e,Ye,Qe,Je){var Mt,nn,an,sn=Je*8-Qe-1,ln=(1<<sn)-1,fn=ln>>1,hn=Qe===23?Math.pow(2,-24)-Math.pow(2,-77):0,Xr=Ye?0:Je-1,Mi=Ye?1:-1,co=Ge<0||Ge===0&&1/Ge<0?1:0;for(Ge=Math.abs(Ge),isNaN(Ge)||Ge===1/0?(nn=isNaN(Ge)?1:0,Mt=ln):(Mt=Math.floor(Math.log(Ge)/Math.LN2),Ge*(an=Math.pow(2,-Mt))<1&&(Mt--,an*=2),Mt+fn>=1?Ge+=hn/an:Ge+=hn*Math.pow(2,1-fn),Ge*an>=2&&(Mt++,an/=2),Mt+fn>=ln?(nn=0,Mt=ln):Mt+fn>=1?(nn=(Ge*an-1)*Math.pow(2,Qe),Mt=Mt+fn):(nn=Ge*Math.pow(2,fn-1)*Math.pow(2,Qe),Mt=0));Qe>=8;Ke[$e+Xr]=nn&255,Xr+=Mi,nn/=256,Qe-=8);for(Mt=Mt<<Qe|nn,sn+=Qe;sn>0;Ke[$e+Xr]=Mt&255,Xr+=Mi,Mt/=256,sn-=8);Ke[$e+Xr-Mi]|=co*128}),ieee754}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var hasRequiredBuffer;function requireBuffer(){return hasRequiredBuffer||(hasRequiredBuffer=1,function(Ke){const Ge=requireBase64Js(),$e=requireIeee754(),Ye=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;Ke.Buffer=nn,Ke.SlowBuffer=ho,Ke.INSPECT_MAX_BYTES=50;const Qe=2147483647;Ke.kMaxLength=Qe,nn.TYPED_ARRAY_SUPPORT=Je(),!nn.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function Je(){try{const ap=new Uint8Array(1),Uo={foo:function(){return 42}};return Object.setPrototypeOf(Uo,Uint8Array.prototype),Object.setPrototypeOf(ap,Uo),ap.foo()===42}catch{return!1}}Object.defineProperty(nn.prototype,"parent",{enumerable:!0,get:function(){if(nn.isBuffer(this))return this.buffer}}),Object.defineProperty(nn.prototype,"offset",{enumerable:!0,get:function(){if(nn.isBuffer(this))return this.byteOffset}});function Mt(ap){if(ap>Qe)throw new RangeError('The value "'+ap+'" is invalid for option "size"');const Uo=new Uint8Array(ap);return Object.setPrototypeOf(Uo,nn.prototype),Uo}function nn(ap,Uo,tp){if(typeof ap=="number"){if(typeof Uo=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return fn(ap)}return an(ap,Uo,tp)}nn.poolSize=8192;function an(ap,Uo,tp){if(typeof ap=="string")return hn(ap,Uo);if(ArrayBuffer.isView(ap))return Mi(ap);if(ap==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof ap);if(wm(ap,ArrayBuffer)||ap&&wm(ap.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(wm(ap,SharedArrayBuffer)||ap&&wm(ap.buffer,SharedArrayBuffer)))return co(ap,Uo,tp);if(typeof ap=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const dp=ap.valueOf&&ap.valueOf();if(dp!=null&&dp!==ap)return nn.from(dp,Uo,tp);const xp=lo(ap);if(xp)return xp;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof ap[Symbol.toPrimitive]=="function")return nn.from(ap[Symbol.toPrimitive]("string"),Uo,tp);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof ap)}nn.from=function(ap,Uo,tp){return an(ap,Uo,tp)},Object.setPrototypeOf(nn.prototype,Uint8Array.prototype),Object.setPrototypeOf(nn,Uint8Array);function sn(ap){if(typeof ap!="number")throw new TypeError('"size" argument must be of type number');if(ap<0)throw new RangeError('The value "'+ap+'" is invalid for option "size"')}function ln(ap,Uo,tp){return sn(ap),ap<=0?Mt(ap):Uo!==void 0?typeof tp=="string"?Mt(ap).fill(Uo,tp):Mt(ap).fill(Uo):Mt(ap)}nn.alloc=function(ap,Uo,tp){return ln(ap,Uo,tp)};function fn(ap){return sn(ap),Mt(ap<0?0:uo(ap)|0)}nn.allocUnsafe=function(ap){return fn(ap)},nn.allocUnsafeSlow=function(ap){return fn(ap)};function hn(ap,Uo){if((typeof Uo!="string"||Uo==="")&&(Uo="utf8"),!nn.isEncoding(Uo))throw new TypeError("Unknown encoding: "+Uo);const tp=mo(ap,Uo)|0;let dp=Mt(tp);const xp=dp.write(ap,Uo);return xp!==tp&&(dp=dp.slice(0,xp)),dp}function Xr(ap){const Uo=ap.length<0?0:uo(ap.length)|0,tp=Mt(Uo);for(let dp=0;dp<Uo;dp+=1)tp[dp]=ap[dp]&255;return tp}function Mi(ap){if(wm(ap,Uint8Array)){const Uo=new Uint8Array(ap);return co(Uo.buffer,Uo.byteOffset,Uo.byteLength)}return Xr(ap)}function co(ap,Uo,tp){if(Uo<0||ap.byteLength<Uo)throw new RangeError('"offset" is outside of buffer bounds');if(ap.byteLength<Uo+(tp||0))throw new RangeError('"length" is outside of buffer bounds');let dp;return Uo===void 0&&tp===void 0?dp=new Uint8Array(ap):tp===void 0?dp=new Uint8Array(ap,Uo):dp=new Uint8Array(ap,Uo,tp),Object.setPrototypeOf(dp,nn.prototype),dp}function lo(ap){if(nn.isBuffer(ap)){const Uo=uo(ap.length)|0,tp=Mt(Uo);return tp.length===0||ap.copy(tp,0,0,Uo),tp}if(ap.length!==void 0)return typeof ap.length!="number"||Mm(ap.length)?Mt(0):Xr(ap);if(ap.type==="Buffer"&&Array.isArray(ap.data))return Xr(ap.data)}function uo(ap){if(ap>=Qe)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Qe.toString(16)+" bytes");return ap|0}function ho(ap){return+ap!=ap&&(ap=0),nn.alloc(+ap)}nn.isBuffer=function(Uo){return Uo!=null&&Uo._isBuffer===!0&&Uo!==nn.prototype},nn.compare=function(Uo,tp){if(wm(Uo,Uint8Array)&&(Uo=nn.from(Uo,Uo.offset,Uo.byteLength)),wm(tp,Uint8Array)&&(tp=nn.from(tp,tp.offset,tp.byteLength)),!nn.isBuffer(Uo)||!nn.isBuffer(tp))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(Uo===tp)return 0;let dp=Uo.length,xp=tp.length;for(let kp=0,Pp=Math.min(dp,xp);kp<Pp;++kp)if(Uo[kp]!==tp[kp]){dp=Uo[kp],xp=tp[kp];break}return dp<xp?-1:xp<dp?1:0},nn.isEncoding=function(Uo){switch(String(Uo).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},nn.concat=function(Uo,tp){if(!Array.isArray(Uo))throw new TypeError('"list" argument must be an Array of Buffers');if(Uo.length===0)return nn.alloc(0);let dp;if(tp===void 0)for(tp=0,dp=0;dp<Uo.length;++dp)tp+=Uo[dp].length;const xp=nn.allocUnsafe(tp);let kp=0;for(dp=0;dp<Uo.length;++dp){let Pp=Uo[dp];if(wm(Pp,Uint8Array))kp+Pp.length>xp.length?(nn.isBuffer(Pp)||(Pp=nn.from(Pp)),Pp.copy(xp,kp)):Uint8Array.prototype.set.call(xp,Pp,kp);else if(nn.isBuffer(Pp))Pp.copy(xp,kp);else throw new TypeError('"list" argument must be an Array of Buffers');kp+=Pp.length}return xp};function mo(ap,Uo){if(nn.isBuffer(ap))return ap.length;if(ArrayBuffer.isView(ap)||wm(ap,ArrayBuffer))return ap.byteLength;if(typeof ap!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof ap);const tp=ap.length,dp=arguments.length>2&&arguments[2]===!0;if(!dp&&tp===0)return 0;let xp=!1;for(;;)switch(Uo){case"ascii":case"latin1":case"binary":return tp;case"utf8":case"utf-8":return tm(ap).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return tp*2;case"hex":return tp>>>1;case"base64":return Wm(ap).length;default:if(xp)return dp?-1:tm(ap).length;Uo=(""+Uo).toLowerCase(),xp=!0}}nn.byteLength=mo;function _d(ap,Uo,tp){let dp=!1;if((Uo===void 0||Uo<0)&&(Uo=0),Uo>this.length||((tp===void 0||tp>this.length)&&(tp=this.length),tp<=0)||(tp>>>=0,Uo>>>=0,tp<=Uo))return"";for(ap||(ap="utf8");;)switch(ap){case"hex":return Ip(this,Uo,tp);case"utf8":case"utf-8":return Mp(this,Uo,tp);case"ascii":return Sp(this,Uo,tp);case"latin1":case"binary":return Cp(this,Uo,tp);case"base64":return Op(this,Uo,tp);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return cp(this,Uo,tp);default:if(dp)throw new TypeError("Unknown encoding: "+ap);ap=(ap+"").toLowerCase(),dp=!0}}nn.prototype._isBuffer=!0;function ep(ap,Uo,tp){const dp=ap[Uo];ap[Uo]=ap[tp],ap[tp]=dp}nn.prototype.swap16=function(){const Uo=this.length;if(Uo%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let tp=0;tp<Uo;tp+=2)ep(this,tp,tp+1);return this},nn.prototype.swap32=function(){const Uo=this.length;if(Uo%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let tp=0;tp<Uo;tp+=4)ep(this,tp,tp+3),ep(this,tp+1,tp+2);return this},nn.prototype.swap64=function(){const Uo=this.length;if(Uo%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let tp=0;tp<Uo;tp+=8)ep(this,tp,tp+7),ep(this,tp+1,tp+6),ep(this,tp+2,tp+5),ep(this,tp+3,tp+4);return this},nn.prototype.toString=function(){const Uo=this.length;return Uo===0?"":arguments.length===0?Mp(this,0,Uo):_d.apply(this,arguments)},nn.prototype.toLocaleString=nn.prototype.toString,nn.prototype.equals=function(Uo){if(!nn.isBuffer(Uo))throw new TypeError("Argument must be a Buffer");return this===Uo?!0:nn.compare(this,Uo)===0},nn.prototype.inspect=function(){let Uo="";const tp=Ke.INSPECT_MAX_BYTES;return Uo=this.toString("hex",0,tp).replace(/(.{2})/g,"$1 ").trim(),this.length>tp&&(Uo+=" ... "),"<Buffer "+Uo+">"},Ye&&(nn.prototype[Ye]=nn.prototype.inspect),nn.prototype.compare=function(Uo,tp,dp,xp,kp){if(wm(Uo,Uint8Array)&&(Uo=nn.from(Uo,Uo.offset,Uo.byteLength)),!nn.isBuffer(Uo))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof Uo);if(tp===void 0&&(tp=0),dp===void 0&&(dp=Uo?Uo.length:0),xp===void 0&&(xp=0),kp===void 0&&(kp=this.length),tp<0||dp>Uo.length||xp<0||kp>this.length)throw new RangeError("out of range index");if(xp>=kp&&tp>=dp)return 0;if(xp>=kp)return-1;if(tp>=dp)return 1;if(tp>>>=0,dp>>>=0,xp>>>=0,kp>>>=0,this===Uo)return 0;let Pp=kp-xp,Qp=dp-tp;const dm=Math.min(Pp,Qp),lm=this.slice(xp,kp),om=Uo.slice(tp,dp);for(let hm=0;hm<dm;++hm)if(lm[hm]!==om[hm]){Pp=lm[hm],Qp=om[hm];break}return Pp<Qp?-1:Qp<Pp?1:0};function rp(ap,Uo,tp,dp,xp){if(ap.length===0)return-1;if(typeof tp=="string"?(dp=tp,tp=0):tp>2147483647?tp=2147483647:tp<-2147483648&&(tp=-2147483648),tp=+tp,Mm(tp)&&(tp=xp?0:ap.length-1),tp<0&&(tp=ap.length+tp),tp>=ap.length){if(xp)return-1;tp=ap.length-1}else if(tp<0)if(xp)tp=0;else return-1;if(typeof Uo=="string"&&(Uo=nn.from(Uo,dp)),nn.isBuffer(Uo))return Uo.length===0?-1:sp(ap,Uo,tp,dp,xp);if(typeof Uo=="number")return Uo=Uo&255,typeof Uint8Array.prototype.indexOf=="function"?xp?Uint8Array.prototype.indexOf.call(ap,Uo,tp):Uint8Array.prototype.lastIndexOf.call(ap,Uo,tp):sp(ap,[Uo],tp,dp,xp);throw new TypeError("val must be string, number or Buffer")}function sp(ap,Uo,tp,dp,xp){let kp=1,Pp=ap.length,Qp=Uo.length;if(dp!==void 0&&(dp=String(dp).toLowerCase(),dp==="ucs2"||dp==="ucs-2"||dp==="utf16le"||dp==="utf-16le")){if(ap.length<2||Uo.length<2)return-1;kp=2,Pp/=2,Qp/=2,tp/=2}function dm(om,hm){return kp===1?om[hm]:om.readUInt16BE(hm*kp)}let lm;if(xp){let om=-1;for(lm=tp;lm<Pp;lm++)if(dm(ap,lm)===dm(Uo,om===-1?0:lm-om)){if(om===-1&&(om=lm),lm-om+1===Qp)return om*kp}else om!==-1&&(lm-=lm-om),om=-1}else for(tp+Qp>Pp&&(tp=Pp-Qp),lm=tp;lm>=0;lm--){let om=!0;for(let hm=0;hm<Qp;hm++)if(dm(ap,lm+hm)!==dm(Uo,hm)){om=!1;break}if(om)return lm}return-1}nn.prototype.includes=function(Uo,tp,dp){return this.indexOf(Uo,tp,dp)!==-1},nn.prototype.indexOf=function(Uo,tp,dp){return rp(this,Uo,tp,dp,!0)},nn.prototype.lastIndexOf=function(Uo,tp,dp){return rp(this,Uo,tp,dp,!1)};function op(ap,Uo,tp,dp){tp=Number(tp)||0;const xp=ap.length-tp;dp?(dp=Number(dp),dp>xp&&(dp=xp)):dp=xp;const kp=Uo.length;dp>kp/2&&(dp=kp/2);let Pp;for(Pp=0;Pp<dp;++Pp){const Qp=parseInt(Uo.substr(Pp*2,2),16);if(Mm(Qp))return Pp;ap[tp+Pp]=Qp}return Pp}function ip(ap,Uo,tp,dp){return Nm(tm(Uo,ap.length-tp),ap,tp,dp)}function lp(ap,Uo,tp,dp){return Nm(bm(Uo),ap,tp,dp)}function vp(ap,Uo,tp,dp){return Nm(Wm(Uo),ap,tp,dp)}function gp(ap,Uo,tp,dp){return Nm(xm(Uo,ap.length-tp),ap,tp,dp)}nn.prototype.write=function(Uo,tp,dp,xp){if(tp===void 0)xp="utf8",dp=this.length,tp=0;else if(dp===void 0&&typeof tp=="string")xp=tp,dp=this.length,tp=0;else if(isFinite(tp))tp=tp>>>0,isFinite(dp)?(dp=dp>>>0,xp===void 0&&(xp="utf8")):(xp=dp,dp=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const kp=this.length-tp;if((dp===void 0||dp>kp)&&(dp=kp),Uo.length>0&&(dp<0||tp<0)||tp>this.length)throw new RangeError("Attempt to write outside buffer bounds");xp||(xp="utf8");let Pp=!1;for(;;)switch(xp){case"hex":return op(this,Uo,tp,dp);case"utf8":case"utf-8":return ip(this,Uo,tp,dp);case"ascii":case"latin1":case"binary":return lp(this,Uo,tp,dp);case"base64":return vp(this,Uo,tp,dp);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return gp(this,Uo,tp,dp);default:if(Pp)throw new TypeError("Unknown encoding: "+xp);xp=(""+xp).toLowerCase(),Pp=!0}},nn.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Op(ap,Uo,tp){return Uo===0&&tp===ap.length?Ge.fromByteArray(ap):Ge.fromByteArray(ap.slice(Uo,tp))}function Mp(ap,Uo,tp){tp=Math.min(ap.length,tp);const dp=[];let xp=Uo;for(;xp<tp;){const kp=ap[xp];let Pp=null,Qp=kp>239?4:kp>223?3:kp>191?2:1;if(xp+Qp<=tp){let dm,lm,om,hm;switch(Qp){case 1:kp<128&&(Pp=kp);break;case 2:dm=ap[xp+1],(dm&192)===128&&(hm=(kp&31)<<6|dm&63,hm>127&&(Pp=hm));break;case 3:dm=ap[xp+1],lm=ap[xp+2],(dm&192)===128&&(lm&192)===128&&(hm=(kp&15)<<12|(dm&63)<<6|lm&63,hm>2047&&(hm<55296||hm>57343)&&(Pp=hm));break;case 4:dm=ap[xp+1],lm=ap[xp+2],om=ap[xp+3],(dm&192)===128&&(lm&192)===128&&(om&192)===128&&(hm=(kp&15)<<18|(dm&63)<<12|(lm&63)<<6|om&63,hm>65535&&hm<1114112&&(Pp=hm))}}Pp===null?(Pp=65533,Qp=1):Pp>65535&&(Pp-=65536,dp.push(Pp>>>10&1023|55296),Pp=56320|Pp&1023),dp.push(Pp),xp+=Qp}return wp(dp)}const Np=4096;function wp(ap){const Uo=ap.length;if(Uo<=Np)return String.fromCharCode.apply(String,ap);let tp="",dp=0;for(;dp<Uo;)tp+=String.fromCharCode.apply(String,ap.slice(dp,dp+=Np));return tp}function Sp(ap,Uo,tp){let dp="";tp=Math.min(ap.length,tp);for(let xp=Uo;xp<tp;++xp)dp+=String.fromCharCode(ap[xp]&127);return dp}function Cp(ap,Uo,tp){let dp="";tp=Math.min(ap.length,tp);for(let xp=Uo;xp<tp;++xp)dp+=String.fromCharCode(ap[xp]);return dp}function Ip(ap,Uo,tp){const dp=ap.length;(!Uo||Uo<0)&&(Uo=0),(!tp||tp<0||tp>dp)&&(tp=dp);let xp="";for(let kp=Uo;kp<tp;++kp)xp+=Em[ap[kp]];return xp}function cp(ap,Uo,tp){const dp=ap.slice(Uo,tp);let xp="";for(let kp=0;kp<dp.length-1;kp+=2)xp+=String.fromCharCode(dp[kp]+dp[kp+1]*256);return xp}nn.prototype.slice=function(Uo,tp){const dp=this.length;Uo=~~Uo,tp=tp===void 0?dp:~~tp,Uo<0?(Uo+=dp,Uo<0&&(Uo=0)):Uo>dp&&(Uo=dp),tp<0?(tp+=dp,tp<0&&(tp=0)):tp>dp&&(tp=dp),tp<Uo&&(tp=Uo);const xp=this.subarray(Uo,tp);return Object.setPrototypeOf(xp,nn.prototype),xp};function Ep(ap,Uo,tp){if(ap%1!==0||ap<0)throw new RangeError("offset is not uint");if(ap+Uo>tp)throw new RangeError("Trying to access beyond buffer length")}nn.prototype.readUintLE=nn.prototype.readUIntLE=function(Uo,tp,dp){Uo=Uo>>>0,tp=tp>>>0,dp||Ep(Uo,tp,this.length);let xp=this[Uo],kp=1,Pp=0;for(;++Pp<tp&&(kp*=256);)xp+=this[Uo+Pp]*kp;return xp},nn.prototype.readUintBE=nn.prototype.readUIntBE=function(Uo,tp,dp){Uo=Uo>>>0,tp=tp>>>0,dp||Ep(Uo,tp,this.length);let xp=this[Uo+--tp],kp=1;for(;tp>0&&(kp*=256);)xp+=this[Uo+--tp]*kp;return xp},nn.prototype.readUint8=nn.prototype.readUInt8=function(Uo,tp){return Uo=Uo>>>0,tp||Ep(Uo,1,this.length),this[Uo]},nn.prototype.readUint16LE=nn.prototype.readUInt16LE=function(Uo,tp){return Uo=Uo>>>0,tp||Ep(Uo,2,this.length),this[Uo]|this[Uo+1]<<8},nn.prototype.readUint16BE=nn.prototype.readUInt16BE=function(Uo,tp){return Uo=Uo>>>0,tp||Ep(Uo,2,this.length),this[Uo]<<8|this[Uo+1]},nn.prototype.readUint32LE=nn.prototype.readUInt32LE=function(Uo,tp){return Uo=Uo>>>0,tp||Ep(Uo,4,this.length),(this[Uo]|this[Uo+1]<<8|this[Uo+2]<<16)+this[Uo+3]*16777216},nn.prototype.readUint32BE=nn.prototype.readUInt32BE=function(Uo,tp){return Uo=Uo>>>0,tp||Ep(Uo,4,this.length),this[Uo]*16777216+(this[Uo+1]<<16|this[Uo+2]<<8|this[Uo+3])},nn.prototype.readBigUInt64LE=_m(function(Uo){Uo=Uo>>>0,Bp(Uo,"offset");const tp=this[Uo],dp=this[Uo+7];(tp===void 0||dp===void 0)&&Vp(Uo,this.length-8);const xp=tp+this[++Uo]*2**8+this[++Uo]*2**16+this[++Uo]*2**24,kp=this[++Uo]+this[++Uo]*2**8+this[++Uo]*2**16+dp*2**24;return BigInt(xp)+(BigInt(kp)<<BigInt(32))}),nn.prototype.readBigUInt64BE=_m(function(Uo){Uo=Uo>>>0,Bp(Uo,"offset");const tp=this[Uo],dp=this[Uo+7];(tp===void 0||dp===void 0)&&Vp(Uo,this.length-8);const xp=tp*2**24+this[++Uo]*2**16+this[++Uo]*2**8+this[++Uo],kp=this[++Uo]*2**24+this[++Uo]*2**16+this[++Uo]*2**8+dp;return(BigInt(xp)<<BigInt(32))+BigInt(kp)}),nn.prototype.readIntLE=function(Uo,tp,dp){Uo=Uo>>>0,tp=tp>>>0,dp||Ep(Uo,tp,this.length);let xp=this[Uo],kp=1,Pp=0;for(;++Pp<tp&&(kp*=256);)xp+=this[Uo+Pp]*kp;return kp*=128,xp>=kp&&(xp-=Math.pow(2,8*tp)),xp},nn.prototype.readIntBE=function(Uo,tp,dp){Uo=Uo>>>0,tp=tp>>>0,dp||Ep(Uo,tp,this.length);let xp=tp,kp=1,Pp=this[Uo+--xp];for(;xp>0&&(kp*=256);)Pp+=this[Uo+--xp]*kp;return kp*=128,Pp>=kp&&(Pp-=Math.pow(2,8*tp)),Pp},nn.prototype.readInt8=function(Uo,tp){return Uo=Uo>>>0,tp||Ep(Uo,1,this.length),this[Uo]&128?(255-this[Uo]+1)*-1:this[Uo]},nn.prototype.readInt16LE=function(Uo,tp){Uo=Uo>>>0,tp||Ep(Uo,2,this.length);const dp=this[Uo]|this[Uo+1]<<8;return dp&32768?dp|4294901760:dp},nn.prototype.readInt16BE=function(Uo,tp){Uo=Uo>>>0,tp||Ep(Uo,2,this.length);const dp=this[Uo+1]|this[Uo]<<8;return dp&32768?dp|4294901760:dp},nn.prototype.readInt32LE=function(Uo,tp){return Uo=Uo>>>0,tp||Ep(Uo,4,this.length),this[Uo]|this[Uo+1]<<8|this[Uo+2]<<16|this[Uo+3]<<24},nn.prototype.readInt32BE=function(Uo,tp){return Uo=Uo>>>0,tp||Ep(Uo,4,this.length),this[Uo]<<24|this[Uo+1]<<16|this[Uo+2]<<8|this[Uo+3]},nn.prototype.readBigInt64LE=_m(function(Uo){Uo=Uo>>>0,Bp(Uo,"offset");const tp=this[Uo],dp=this[Uo+7];(tp===void 0||dp===void 0)&&Vp(Uo,this.length-8);const xp=this[Uo+4]+this[Uo+5]*2**8+this[Uo+6]*2**16+(dp<<24);return(BigInt(xp)<<BigInt(32))+BigInt(tp+this[++Uo]*2**8+this[++Uo]*2**16+this[++Uo]*2**24)}),nn.prototype.readBigInt64BE=_m(function(Uo){Uo=Uo>>>0,Bp(Uo,"offset");const tp=this[Uo],dp=this[Uo+7];(tp===void 0||dp===void 0)&&Vp(Uo,this.length-8);const xp=(tp<<24)+this[++Uo]*2**16+this[++Uo]*2**8+this[++Uo];return(BigInt(xp)<<BigInt(32))+BigInt(this[++Uo]*2**24+this[++Uo]*2**16+this[++Uo]*2**8+dp)}),nn.prototype.readFloatLE=function(Uo,tp){return Uo=Uo>>>0,tp||Ep(Uo,4,this.length),$e.read(this,Uo,!0,23,4)},nn.prototype.readFloatBE=function(Uo,tp){return Uo=Uo>>>0,tp||Ep(Uo,4,this.length),$e.read(this,Uo,!1,23,4)},nn.prototype.readDoubleLE=function(Uo,tp){return Uo=Uo>>>0,tp||Ep(Uo,8,this.length),$e.read(this,Uo,!0,52,8)},nn.prototype.readDoubleBE=function(Uo,tp){return Uo=Uo>>>0,tp||Ep(Uo,8,this.length),$e.read(this,Uo,!1,52,8)};function Fp(ap,Uo,tp,dp,xp,kp){if(!nn.isBuffer(ap))throw new TypeError('"buffer" argument must be a Buffer instance');if(Uo>xp||Uo<kp)throw new RangeError('"value" argument is out of bounds');if(tp+dp>ap.length)throw new RangeError("Index out of range")}nn.prototype.writeUintLE=nn.prototype.writeUIntLE=function(Uo,tp,dp,xp){if(Uo=+Uo,tp=tp>>>0,dp=dp>>>0,!xp){const Qp=Math.pow(2,8*dp)-1;Fp(this,Uo,tp,dp,Qp,0)}let kp=1,Pp=0;for(this[tp]=Uo&255;++Pp<dp&&(kp*=256);)this[tp+Pp]=Uo/kp&255;return tp+dp},nn.prototype.writeUintBE=nn.prototype.writeUIntBE=function(Uo,tp,dp,xp){if(Uo=+Uo,tp=tp>>>0,dp=dp>>>0,!xp){const Qp=Math.pow(2,8*dp)-1;Fp(this,Uo,tp,dp,Qp,0)}let kp=dp-1,Pp=1;for(this[tp+kp]=Uo&255;--kp>=0&&(Pp*=256);)this[tp+kp]=Uo/Pp&255;return tp+dp},nn.prototype.writeUint8=nn.prototype.writeUInt8=function(Uo,tp,dp){return Uo=+Uo,tp=tp>>>0,dp||Fp(this,Uo,tp,1,255,0),this[tp]=Uo&255,tp+1},nn.prototype.writeUint16LE=nn.prototype.writeUInt16LE=function(Uo,tp,dp){return Uo=+Uo,tp=tp>>>0,dp||Fp(this,Uo,tp,2,65535,0),this[tp]=Uo&255,this[tp+1]=Uo>>>8,tp+2},nn.prototype.writeUint16BE=nn.prototype.writeUInt16BE=function(Uo,tp,dp){return Uo=+Uo,tp=tp>>>0,dp||Fp(this,Uo,tp,2,65535,0),this[tp]=Uo>>>8,this[tp+1]=Uo&255,tp+2},nn.prototype.writeUint32LE=nn.prototype.writeUInt32LE=function(Uo,tp,dp){return Uo=+Uo,tp=tp>>>0,dp||Fp(this,Uo,tp,4,4294967295,0),this[tp+3]=Uo>>>24,this[tp+2]=Uo>>>16,this[tp+1]=Uo>>>8,this[tp]=Uo&255,tp+4},nn.prototype.writeUint32BE=nn.prototype.writeUInt32BE=function(Uo,tp,dp){return Uo=+Uo,tp=tp>>>0,dp||Fp(this,Uo,tp,4,4294967295,0),this[tp]=Uo>>>24,this[tp+1]=Uo>>>16,this[tp+2]=Uo>>>8,this[tp+3]=Uo&255,tp+4};function Hp(ap,Uo,tp,dp,xp){hp(Uo,dp,xp,ap,tp,7);let kp=Number(Uo&BigInt(4294967295));ap[tp++]=kp,kp=kp>>8,ap[tp++]=kp,kp=kp>>8,ap[tp++]=kp,kp=kp>>8,ap[tp++]=kp;let Pp=Number(Uo>>BigInt(32)&BigInt(4294967295));return ap[tp++]=Pp,Pp=Pp>>8,ap[tp++]=Pp,Pp=Pp>>8,ap[tp++]=Pp,Pp=Pp>>8,ap[tp++]=Pp,tp}function zp(ap,Uo,tp,dp,xp){hp(Uo,dp,xp,ap,tp,7);let kp=Number(Uo&BigInt(4294967295));ap[tp+7]=kp,kp=kp>>8,ap[tp+6]=kp,kp=kp>>8,ap[tp+5]=kp,kp=kp>>8,ap[tp+4]=kp;let Pp=Number(Uo>>BigInt(32)&BigInt(4294967295));return ap[tp+3]=Pp,Pp=Pp>>8,ap[tp+2]=Pp,Pp=Pp>>8,ap[tp+1]=Pp,Pp=Pp>>8,ap[tp]=Pp,tp+8}nn.prototype.writeBigUInt64LE=_m(function(Uo,tp=0){return Hp(this,Uo,tp,BigInt(0),BigInt("0xffffffffffffffff"))}),nn.prototype.writeBigUInt64BE=_m(function(Uo,tp=0){return zp(this,Uo,tp,BigInt(0),BigInt("0xffffffffffffffff"))}),nn.prototype.writeIntLE=function(Uo,tp,dp,xp){if(Uo=+Uo,tp=tp>>>0,!xp){const dm=Math.pow(2,8*dp-1);Fp(this,Uo,tp,dp,dm-1,-dm)}let kp=0,Pp=1,Qp=0;for(this[tp]=Uo&255;++kp<dp&&(Pp*=256);)Uo<0&&Qp===0&&this[tp+kp-1]!==0&&(Qp=1),this[tp+kp]=(Uo/Pp>>0)-Qp&255;return tp+dp},nn.prototype.writeIntBE=function(Uo,tp,dp,xp){if(Uo=+Uo,tp=tp>>>0,!xp){const dm=Math.pow(2,8*dp-1);Fp(this,Uo,tp,dp,dm-1,-dm)}let kp=dp-1,Pp=1,Qp=0;for(this[tp+kp]=Uo&255;--kp>=0&&(Pp*=256);)Uo<0&&Qp===0&&this[tp+kp+1]!==0&&(Qp=1),this[tp+kp]=(Uo/Pp>>0)-Qp&255;return tp+dp},nn.prototype.writeInt8=function(Uo,tp,dp){return Uo=+Uo,tp=tp>>>0,dp||Fp(this,Uo,tp,1,127,-128),Uo<0&&(Uo=255+Uo+1),this[tp]=Uo&255,tp+1},nn.prototype.writeInt16LE=function(Uo,tp,dp){return Uo=+Uo,tp=tp>>>0,dp||Fp(this,Uo,tp,2,32767,-32768),this[tp]=Uo&255,this[tp+1]=Uo>>>8,tp+2},nn.prototype.writeInt16BE=function(Uo,tp,dp){return Uo=+Uo,tp=tp>>>0,dp||Fp(this,Uo,tp,2,32767,-32768),this[tp]=Uo>>>8,this[tp+1]=Uo&255,tp+2},nn.prototype.writeInt32LE=function(Uo,tp,dp){return Uo=+Uo,tp=tp>>>0,dp||Fp(this,Uo,tp,4,2147483647,-2147483648),this[tp]=Uo&255,this[tp+1]=Uo>>>8,this[tp+2]=Uo>>>16,this[tp+3]=Uo>>>24,tp+4},nn.prototype.writeInt32BE=function(Uo,tp,dp){return Uo=+Uo,tp=tp>>>0,dp||Fp(this,Uo,tp,4,2147483647,-2147483648),Uo<0&&(Uo=4294967295+Uo+1),this[tp]=Uo>>>24,this[tp+1]=Uo>>>16,this[tp+2]=Uo>>>8,this[tp+3]=Uo&255,tp+4},nn.prototype.writeBigInt64LE=_m(function(Uo,tp=0){return Hp(this,Uo,tp,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),nn.prototype.writeBigInt64BE=_m(function(Uo,tp=0){return zp(this,Uo,tp,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Gp(ap,Uo,tp,dp,xp,kp){if(tp+dp>ap.length)throw new RangeError("Index out of range");if(tp<0)throw new RangeError("Index out of range")}function mp(ap,Uo,tp,dp,xp){return Uo=+Uo,tp=tp>>>0,xp||Gp(ap,Uo,tp,4),$e.write(ap,Uo,tp,dp,23,4),tp+4}nn.prototype.writeFloatLE=function(Uo,tp,dp){return mp(this,Uo,tp,!0,dp)},nn.prototype.writeFloatBE=function(Uo,tp,dp){return mp(this,Uo,tp,!1,dp)};function yp(ap,Uo,tp,dp,xp){return Uo=+Uo,tp=tp>>>0,xp||Gp(ap,Uo,tp,8),$e.write(ap,Uo,tp,dp,52,8),tp+8}nn.prototype.writeDoubleLE=function(Uo,tp,dp){return yp(this,Uo,tp,!0,dp)},nn.prototype.writeDoubleBE=function(Uo,tp,dp){return yp(this,Uo,tp,!1,dp)},nn.prototype.copy=function(Uo,tp,dp,xp){if(!nn.isBuffer(Uo))throw new TypeError("argument should be a Buffer");if(dp||(dp=0),!xp&&xp!==0&&(xp=this.length),tp>=Uo.length&&(tp=Uo.length),tp||(tp=0),xp>0&&xp<dp&&(xp=dp),xp===dp||Uo.length===0||this.length===0)return 0;if(tp<0)throw new RangeError("targetStart out of bounds");if(dp<0||dp>=this.length)throw new RangeError("Index out of range");if(xp<0)throw new RangeError("sourceEnd out of bounds");xp>this.length&&(xp=this.length),Uo.length-tp<xp-dp&&(xp=Uo.length-tp+dp);const kp=xp-dp;return this===Uo&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(tp,dp,xp):Uint8Array.prototype.set.call(Uo,this.subarray(dp,xp),tp),kp},nn.prototype.fill=function(Uo,tp,dp,xp){if(typeof Uo=="string"){if(typeof tp=="string"?(xp=tp,tp=0,dp=this.length):typeof dp=="string"&&(xp=dp,dp=this.length),xp!==void 0&&typeof xp!="string")throw new TypeError("encoding must be a string");if(typeof xp=="string"&&!nn.isEncoding(xp))throw new TypeError("Unknown encoding: "+xp);if(Uo.length===1){const Pp=Uo.charCodeAt(0);(xp==="utf8"&&Pp<128||xp==="latin1")&&(Uo=Pp)}}else typeof Uo=="number"?Uo=Uo&255:typeof Uo=="boolean"&&(Uo=Number(Uo));if(tp<0||this.length<tp||this.length<dp)throw new RangeError("Out of range index");if(dp<=tp)return this;tp=tp>>>0,dp=dp===void 0?this.length:dp>>>0,Uo||(Uo=0);let kp;if(typeof Uo=="number")for(kp=tp;kp<dp;++kp)this[kp]=Uo;else{const Pp=nn.isBuffer(Uo)?Uo:nn.from(Uo,xp),Qp=Pp.length;if(Qp===0)throw new TypeError('The value "'+Uo+'" is invalid for argument "value"');for(kp=0;kp<dp-tp;++kp)this[kp+tp]=Pp[kp%Qp]}return this};const Tp={};function qp(ap,Uo,tp){Tp[ap]=class extends tp{constructor(){super(),Object.defineProperty(this,"message",{value:Uo.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${ap}]`,this.stack,delete this.name}get code(){return ap}set code(xp){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:xp,writable:!0})}toString(){return`${this.name} [${ap}]: ${this.message}`}}}qp("ERR_BUFFER_OUT_OF_BOUNDS",function(ap){return ap?`${ap} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),qp("ERR_INVALID_ARG_TYPE",function(ap,Uo){return`The "${ap}" argument must be of type number. Received type ${typeof Uo}`},TypeError),qp("ERR_OUT_OF_RANGE",function(ap,Uo,tp){let dp=`The value of "${ap}" is out of range.`,xp=tp;return Number.isInteger(tp)&&Math.abs(tp)>2**32?xp=$p(String(tp)):typeof tp=="bigint"&&(xp=String(tp),(tp>BigInt(2)**BigInt(32)||tp<-(BigInt(2)**BigInt(32)))&&(xp=$p(xp)),xp+="n"),dp+=` It must be ${Uo}. Received ${xp}`,dp},RangeError);function $p(ap){let Uo="",tp=ap.length;const dp=ap[0]==="-"?1:0;for(;tp>=dp+4;tp-=3)Uo=`_${ap.slice(tp-3,tp)}${Uo}`;return`${ap.slice(0,tp)}${Uo}`}function fp(ap,Uo,tp){Bp(Uo,"offset"),(ap[Uo]===void 0||ap[Uo+tp]===void 0)&&Vp(Uo,ap.length-(tp+1))}function hp(ap,Uo,tp,dp,xp,kp){if(ap>tp||ap<Uo){const Pp=typeof Uo=="bigint"?"n":"";let Qp;throw Uo===0||Uo===BigInt(0)?Qp=`>= 0${Pp} and < 2${Pp} ** ${(kp+1)*8}${Pp}`:Qp=`>= -(2${Pp} ** ${(kp+1)*8-1}${Pp}) and < 2 ** ${(kp+1)*8-1}${Pp}`,new Tp.ERR_OUT_OF_RANGE("value",Qp,ap)}fp(dp,xp,kp)}function Bp(ap,Uo){if(typeof ap!="number")throw new Tp.ERR_INVALID_ARG_TYPE(Uo,"number",ap)}function Vp(ap,Uo,tp){throw Math.floor(ap)!==ap?(Bp(ap,tp),new Tp.ERR_OUT_OF_RANGE("offset","an integer",ap)):Uo<0?new Tp.ERR_BUFFER_OUT_OF_BOUNDS:new Tp.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${Uo}`,ap)}const Jp=/[^+/0-9A-Za-z-_]/g;function Xp(ap){if(ap=ap.split("=")[0],ap=ap.trim().replace(Jp,""),ap.length<2)return"";for(;ap.length%4!==0;)ap=ap+"=";return ap}function tm(ap,Uo){Uo=Uo||1/0;let tp;const dp=ap.length;let xp=null;const kp=[];for(let Pp=0;Pp<dp;++Pp){if(tp=ap.charCodeAt(Pp),tp>55295&&tp<57344){if(!xp){if(tp>56319){(Uo-=3)>-1&&kp.push(239,191,189);continue}else if(Pp+1===dp){(Uo-=3)>-1&&kp.push(239,191,189);continue}xp=tp;continue}if(tp<56320){(Uo-=3)>-1&&kp.push(239,191,189),xp=tp;continue}tp=(xp-55296<<10|tp-56320)+65536}else xp&&(Uo-=3)>-1&&kp.push(239,191,189);if(xp=null,tp<128){if((Uo-=1)<0)break;kp.push(tp)}else if(tp<2048){if((Uo-=2)<0)break;kp.push(tp>>6|192,tp&63|128)}else if(tp<65536){if((Uo-=3)<0)break;kp.push(tp>>12|224,tp>>6&63|128,tp&63|128)}else if(tp<1114112){if((Uo-=4)<0)break;kp.push(tp>>18|240,tp>>12&63|128,tp>>6&63|128,tp&63|128)}else throw new Error("Invalid code point")}return kp}function bm(ap){const Uo=[];for(let tp=0;tp<ap.length;++tp)Uo.push(ap.charCodeAt(tp)&255);return Uo}function xm(ap,Uo){let tp,dp,xp;const kp=[];for(let Pp=0;Pp<ap.length&&!((Uo-=2)<0);++Pp)tp=ap.charCodeAt(Pp),dp=tp>>8,xp=tp%256,kp.push(xp),kp.push(dp);return kp}function Wm(ap){return Ge.toByteArray(Xp(ap))}function Nm(ap,Uo,tp,dp){let xp;for(xp=0;xp<dp&&!(xp+tp>=Uo.length||xp>=ap.length);++xp)Uo[xp+tp]=ap[xp];return xp}function wm(ap,Uo){return ap instanceof Uo||ap!=null&&ap.constructor!=null&&ap.constructor.name!=null&&ap.constructor.name===Uo.name}function Mm(ap){return ap!==ap}const Em=function(){const ap="0123456789abcdef",Uo=new Array(256);for(let tp=0;tp<16;++tp){const dp=tp*16;for(let xp=0;xp<16;++xp)Uo[dp+xp]=ap[tp]+ap[xp]}return Uo}();function _m(ap){return typeof BigInt>"u"?Km:ap}function Km(){throw new Error("BigInt not supported")}}(buffer)),buffer}/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var hasRequiredSafeBuffer;function requireSafeBuffer(){return hasRequiredSafeBuffer||(hasRequiredSafeBuffer=1,function(Ke,Ge){var $e=requireBuffer(),Ye=$e.Buffer;function Qe(Mt,nn){for(var an in Mt)nn[an]=Mt[an]}Ye.from&&Ye.alloc&&Ye.allocUnsafe&&Ye.allocUnsafeSlow?Ke.exports=$e:(Qe($e,Ge),Ge.Buffer=Je);function Je(Mt,nn,an){return Ye(Mt,nn,an)}Je.prototype=Object.create(Ye.prototype),Qe(Ye,Je),Je.from=function(Mt,nn,an){if(typeof Mt=="number")throw new TypeError("Argument must not be a number");return Ye(Mt,nn,an)},Je.alloc=function(Mt,nn,an){if(typeof Mt!="number")throw new TypeError("Argument must be a number");var sn=Ye(Mt);return nn!==void 0?typeof an=="string"?sn.fill(nn,an):sn.fill(nn):sn.fill(0),sn},Je.allocUnsafe=function(Mt){if(typeof Mt!="number")throw new TypeError("Argument must be a number");return Ye(Mt)},Je.allocUnsafeSlow=function(Mt){if(typeof Mt!="number")throw new TypeError("Argument must be a number");return $e.SlowBuffer(Mt)}}(safeBuffer,safeBuffer.exports)),safeBuffer.exports}var hasRequiredBrowser$1;function requireBrowser$1(){if(hasRequiredBrowser$1)return browser$1.exports;hasRequiredBrowser$1=1;var Ke=65536,Ge=4294967295;function $e(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}var Ye=requireSafeBuffer().Buffer,Qe=commonjsGlobal.crypto||commonjsGlobal.msCrypto;Qe&&Qe.getRandomValues?browser$1.exports=Je:browser$1.exports=$e;function Je(Mt,nn){if(Mt>Ge)throw new RangeError("requested too many random bytes");var an=Ye.allocUnsafe(Mt);if(Mt>0)if(Mt>Ke)for(var sn=0;sn<Mt;sn+=Ke)Qe.getRandomValues(an.slice(sn,sn+Ke));else Qe.getRandomValues(an);return typeof nn=="function"?process.nextTick(function(){nn(null,an)}):an}return browser$1.exports}var readableBrowser={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$3=getAugmentedNamespace(__viteBrowserExternal$1);var streamBrowser,hasRequiredStreamBrowser;function requireStreamBrowser(){return hasRequiredStreamBrowser||(hasRequiredStreamBrowser=1,streamBrowser=require$$3.EventEmitter),streamBrowser}var buffer_list,hasRequiredBuffer_list;function requireBuffer_list(){if(hasRequiredBuffer_list)return buffer_list;hasRequiredBuffer_list=1;function Ke(Mi,co){var lo=Object.keys(Mi);if(Object.getOwnPropertySymbols){var uo=Object.getOwnPropertySymbols(Mi);co&&(uo=uo.filter(function(ho){return Object.getOwnPropertyDescriptor(Mi,ho).enumerable})),lo.push.apply(lo,uo)}return lo}function Ge(Mi){for(var co=1;co<arguments.length;co++){var lo=arguments[co]!=null?arguments[co]:{};co%2?Ke(Object(lo),!0).forEach(function(uo){$e(Mi,uo,lo[uo])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Mi,Object.getOwnPropertyDescriptors(lo)):Ke(Object(lo)).forEach(function(uo){Object.defineProperty(Mi,uo,Object.getOwnPropertyDescriptor(lo,uo))})}return Mi}function $e(Mi,co,lo){return co=Mt(co),co in Mi?Object.defineProperty(Mi,co,{value:lo,enumerable:!0,configurable:!0,writable:!0}):Mi[co]=lo,Mi}function Ye(Mi,co){if(!(Mi instanceof co))throw new TypeError("Cannot call a class as a function")}function Qe(Mi,co){for(var lo=0;lo<co.length;lo++){var uo=co[lo];uo.enumerable=uo.enumerable||!1,uo.configurable=!0,"value"in uo&&(uo.writable=!0),Object.defineProperty(Mi,Mt(uo.key),uo)}}function Je(Mi,co,lo){return co&&Qe(Mi.prototype,co),Object.defineProperty(Mi,"prototype",{writable:!1}),Mi}function Mt(Mi){var co=nn(Mi,"string");return typeof co=="symbol"?co:String(co)}function nn(Mi,co){if(typeof Mi!="object"||Mi===null)return Mi;var lo=Mi[Symbol.toPrimitive];if(lo!==void 0){var uo=lo.call(Mi,co);if(typeof uo!="object")return uo;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(Mi)}var an=requireBuffer(),sn=an.Buffer,ln=require$$3,fn=ln.inspect,hn=fn&&fn.custom||"inspect";function Xr(Mi,co,lo){sn.prototype.copy.call(Mi,co,lo)}return buffer_list=function(){function Mi(){Ye(this,Mi),this.head=null,this.tail=null,this.length=0}return Je(Mi,[{key:"push",value:function(lo){var uo={data:lo,next:null};this.length>0?this.tail.next=uo:this.head=uo,this.tail=uo,++this.length}},{key:"unshift",value:function(lo){var uo={data:lo,next:this.head};this.length===0&&(this.tail=uo),this.head=uo,++this.length}},{key:"shift",value:function(){if(this.length!==0){var lo=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,lo}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(lo){if(this.length===0)return"";for(var uo=this.head,ho=""+uo.data;uo=uo.next;)ho+=lo+uo.data;return ho}},{key:"concat",value:function(lo){if(this.length===0)return sn.alloc(0);for(var uo=sn.allocUnsafe(lo>>>0),ho=this.head,mo=0;ho;)Xr(ho.data,uo,mo),mo+=ho.data.length,ho=ho.next;return uo}},{key:"consume",value:function(lo,uo){var ho;return lo<this.head.data.length?(ho=this.head.data.slice(0,lo),this.head.data=this.head.data.slice(lo)):lo===this.head.data.length?ho=this.shift():ho=uo?this._getString(lo):this._getBuffer(lo),ho}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(lo){var uo=this.head,ho=1,mo=uo.data;for(lo-=mo.length;uo=uo.next;){var _d=uo.data,ep=lo>_d.length?_d.length:lo;if(ep===_d.length?mo+=_d:mo+=_d.slice(0,lo),lo-=ep,lo===0){ep===_d.length?(++ho,uo.next?this.head=uo.next:this.head=this.tail=null):(this.head=uo,uo.data=_d.slice(ep));break}++ho}return this.length-=ho,mo}},{key:"_getBuffer",value:function(lo){var uo=sn.allocUnsafe(lo),ho=this.head,mo=1;for(ho.data.copy(uo),lo-=ho.data.length;ho=ho.next;){var _d=ho.data,ep=lo>_d.length?_d.length:lo;if(_d.copy(uo,uo.length-lo,0,ep),lo-=ep,lo===0){ep===_d.length?(++mo,ho.next?this.head=ho.next:this.head=this.tail=null):(this.head=ho,ho.data=_d.slice(ep));break}++mo}return this.length-=mo,uo}},{key:hn,value:function(lo,uo){return fn(this,Ge(Ge({},uo),{},{depth:0,customInspect:!1}))}}]),Mi}(),buffer_list}var destroy_1,hasRequiredDestroy;function requireDestroy(){if(hasRequiredDestroy)return destroy_1;hasRequiredDestroy=1;function Ke(Mt,nn){var an=this,sn=this._readableState&&this._readableState.destroyed,ln=this._writableState&&this._writableState.destroyed;return sn||ln?(nn?nn(Mt):Mt&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(Qe,this,Mt)):process.nextTick(Qe,this,Mt)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(Mt||null,function(fn){!nn&&fn?an._writableState?an._writableState.errorEmitted?process.nextTick($e,an):(an._writableState.errorEmitted=!0,process.nextTick(Ge,an,fn)):process.nextTick(Ge,an,fn):nn?(process.nextTick($e,an),nn(fn)):process.nextTick($e,an)}),this)}function Ge(Mt,nn){Qe(Mt,nn),$e(Mt)}function $e(Mt){Mt._writableState&&!Mt._writableState.emitClose||Mt._readableState&&!Mt._readableState.emitClose||Mt.emit("close")}function Ye(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function Qe(Mt,nn){Mt.emit("error",nn)}function Je(Mt,nn){var an=Mt._readableState,sn=Mt._writableState;an&&an.autoDestroy||sn&&sn.autoDestroy?Mt.destroy(nn):Mt.emit("error",nn)}return destroy_1={destroy:Ke,undestroy:Ye,errorOrDestroy:Je},destroy_1}var errorsBrowser={},hasRequiredErrorsBrowser;function requireErrorsBrowser(){if(hasRequiredErrorsBrowser)return errorsBrowser;hasRequiredErrorsBrowser=1;function Ke(nn,an){nn.prototype=Object.create(an.prototype),nn.prototype.constructor=nn,nn.__proto__=an}var Ge={};function $e(nn,an,sn){sn||(sn=Error);function ln(hn,Xr,Mi){return typeof an=="string"?an:an(hn,Xr,Mi)}var fn=function(hn){Ke(Xr,hn);function Xr(Mi,co,lo){return hn.call(this,ln(Mi,co,lo))||this}return Xr}(sn);fn.prototype.name=sn.name,fn.prototype.code=nn,Ge[nn]=fn}function Ye(nn,an){if(Array.isArray(nn)){var sn=nn.length;return nn=nn.map(function(ln){return String(ln)}),sn>2?"one of ".concat(an," ").concat(nn.slice(0,sn-1).join(", "),", or ")+nn[sn-1]:sn===2?"one of ".concat(an," ").concat(nn[0]," or ").concat(nn[1]):"of ".concat(an," ").concat(nn[0])}else return"of ".concat(an," ").concat(String(nn))}function Qe(nn,an,sn){return nn.substr(0,an.length)===an}function Je(nn,an,sn){return(sn===void 0||sn>nn.length)&&(sn=nn.length),nn.substring(sn-an.length,sn)===an}function Mt(nn,an,sn){return typeof sn!="number"&&(sn=0),sn+an.length>nn.length?!1:nn.indexOf(an,sn)!==-1}return $e("ERR_INVALID_OPT_VALUE",function(nn,an){return'The value "'+an+'" is invalid for option "'+nn+'"'},TypeError),$e("ERR_INVALID_ARG_TYPE",function(nn,an,sn){var ln;typeof an=="string"&&Qe(an,"not ")?(ln="must not be",an=an.replace(/^not /,"")):ln="must be";var fn;if(Je(nn," argument"))fn="The ".concat(nn," ").concat(ln," ").concat(Ye(an,"type"));else{var hn=Mt(nn,".")?"property":"argument";fn='The "'.concat(nn,'" ').concat(hn," ").concat(ln," ").concat(Ye(an,"type"))}return fn+=". Received type ".concat(typeof sn),fn},TypeError),$e("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),$e("ERR_METHOD_NOT_IMPLEMENTED",function(nn){return"The "+nn+" method is not implemented"}),$e("ERR_STREAM_PREMATURE_CLOSE","Premature close"),$e("ERR_STREAM_DESTROYED",function(nn){return"Cannot call "+nn+" after a stream was destroyed"}),$e("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),$e("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),$e("ERR_STREAM_WRITE_AFTER_END","write after end"),$e("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),$e("ERR_UNKNOWN_ENCODING",function(nn){return"Unknown encoding: "+nn},TypeError),$e("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),errorsBrowser.codes=Ge,errorsBrowser}var state,hasRequiredState;function requireState(){if(hasRequiredState)return state;hasRequiredState=1;var Ke=requireErrorsBrowser().codes.ERR_INVALID_OPT_VALUE;function Ge(Ye,Qe,Je){return Ye.highWaterMark!=null?Ye.highWaterMark:Qe?Ye[Je]:null}function $e(Ye,Qe,Je,Mt){var nn=Ge(Qe,Mt,Je);if(nn!=null){if(!(isFinite(nn)&&Math.floor(nn)===nn)||nn<0){var an=Mt?Je:"highWaterMark";throw new Ke(an,nn)}return Math.floor(nn)}return Ye.objectMode?16:16*1024}return state={getHighWaterMark:$e},state}var inherits_browser={exports:{}},hasRequiredInherits_browser;function requireInherits_browser(){return hasRequiredInherits_browser||(hasRequiredInherits_browser=1,typeof Object.create=="function"?inherits_browser.exports=function(Ge,$e){$e&&(Ge.super_=$e,Ge.prototype=Object.create($e.prototype,{constructor:{value:Ge,enumerable:!1,writable:!0,configurable:!0}}))}:inherits_browser.exports=function(Ge,$e){if($e){Ge.super_=$e;var Ye=function(){};Ye.prototype=$e.prototype,Ge.prototype=new Ye,Ge.prototype.constructor=Ge}}),inherits_browser.exports}var browser,hasRequiredBrowser;function requireBrowser(){if(hasRequiredBrowser)return browser;hasRequiredBrowser=1,browser=Ke;function Ke($e,Ye){if(Ge("noDeprecation"))return $e;var Qe=!1;function Je(){if(!Qe){if(Ge("throwDeprecation"))throw new Error(Ye);Ge("traceDeprecation")?console.trace(Ye):console.warn(Ye),Qe=!0}return $e.apply(this,arguments)}return Je}function Ge($e){try{if(!commonjsGlobal.localStorage)return!1}catch{return!1}var Ye=commonjsGlobal.localStorage[$e];return Ye==null?!1:String(Ye).toLowerCase()==="true"}return browser}var _stream_writable,hasRequired_stream_writable;function require_stream_writable(){if(hasRequired_stream_writable)return _stream_writable;hasRequired_stream_writable=1,_stream_writable=op;function Ke(mp){var yp=this;this.next=null,this.entry=null,this.finish=function(){Gp(yp,mp)}}var Ge;op.WritableState=rp;var $e={deprecate:requireBrowser()},Ye=requireStreamBrowser(),Qe=requireBuffer().Buffer,Je=(typeof commonjsGlobal<"u"?commonjsGlobal:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function Mt(mp){return Qe.from(mp)}function nn(mp){return Qe.isBuffer(mp)||mp instanceof Je}var an=requireDestroy(),sn=requireState(),ln=sn.getHighWaterMark,fn=requireErrorsBrowser().codes,hn=fn.ERR_INVALID_ARG_TYPE,Xr=fn.ERR_METHOD_NOT_IMPLEMENTED,Mi=fn.ERR_MULTIPLE_CALLBACK,co=fn.ERR_STREAM_CANNOT_PIPE,lo=fn.ERR_STREAM_DESTROYED,uo=fn.ERR_STREAM_NULL_VALUES,ho=fn.ERR_STREAM_WRITE_AFTER_END,mo=fn.ERR_UNKNOWN_ENCODING,_d=an.errorOrDestroy;requireInherits_browser()(op,Ye);function ep(){}function rp(mp,yp,Tp){Ge=Ge||require_stream_duplex(),mp=mp||{},typeof Tp!="boolean"&&(Tp=yp instanceof Ge),this.objectMode=!!mp.objectMode,Tp&&(this.objectMode=this.objectMode||!!mp.writableObjectMode),this.highWaterMark=ln(this,mp,"writableHighWaterMark",Tp),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var qp=mp.decodeStrings===!1;this.decodeStrings=!qp,this.defaultEncoding=mp.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function($p){wp(yp,$p)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=mp.emitClose!==!1,this.autoDestroy=!!mp.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new Ke(this)}rp.prototype.getBuffer=function(){for(var yp=this.bufferedRequest,Tp=[];yp;)Tp.push(yp),yp=yp.next;return Tp},function(){try{Object.defineProperty(rp.prototype,"buffer",{get:$e.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var sp;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(sp=Function.prototype[Symbol.hasInstance],Object.defineProperty(op,Symbol.hasInstance,{value:function(yp){return sp.call(this,yp)?!0:this!==op?!1:yp&&yp._writableState instanceof rp}})):sp=function(yp){return yp instanceof this};function op(mp){Ge=Ge||require_stream_duplex();var yp=this instanceof Ge;if(!yp&&!sp.call(op,this))return new op(mp);this._writableState=new rp(mp,this,yp),this.writable=!0,mp&&(typeof mp.write=="function"&&(this._write=mp.write),typeof mp.writev=="function"&&(this._writev=mp.writev),typeof mp.destroy=="function"&&(this._destroy=mp.destroy),typeof mp.final=="function"&&(this._final=mp.final)),Ye.call(this)}op.prototype.pipe=function(){_d(this,new co)};function ip(mp,yp){var Tp=new ho;_d(mp,Tp),process.nextTick(yp,Tp)}function lp(mp,yp,Tp,qp){var $p;return Tp===null?$p=new uo:typeof Tp!="string"&&!yp.objectMode&&($p=new hn("chunk",["string","Buffer"],Tp)),$p?(_d(mp,$p),process.nextTick(qp,$p),!1):!0}op.prototype.write=function(mp,yp,Tp){var qp=this._writableState,$p=!1,fp=!qp.objectMode&&nn(mp);return fp&&!Qe.isBuffer(mp)&&(mp=Mt(mp)),typeof yp=="function"&&(Tp=yp,yp=null),fp?yp="buffer":yp||(yp=qp.defaultEncoding),typeof Tp!="function"&&(Tp=ep),qp.ending?ip(this,Tp):(fp||lp(this,qp,mp,Tp))&&(qp.pendingcb++,$p=gp(this,qp,fp,mp,yp,Tp)),$p},op.prototype.cork=function(){this._writableState.corked++},op.prototype.uncork=function(){var mp=this._writableState;mp.corked&&(mp.corked--,!mp.writing&&!mp.corked&&!mp.bufferProcessing&&mp.bufferedRequest&&Ip(this,mp))},op.prototype.setDefaultEncoding=function(yp){if(typeof yp=="string"&&(yp=yp.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((yp+"").toLowerCase())>-1))throw new mo(yp);return this._writableState.defaultEncoding=yp,this},Object.defineProperty(op.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function vp(mp,yp,Tp){return!mp.objectMode&&mp.decodeStrings!==!1&&typeof yp=="string"&&(yp=Qe.from(yp,Tp)),yp}Object.defineProperty(op.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function gp(mp,yp,Tp,qp,$p,fp){if(!Tp){var hp=vp(yp,qp,$p);qp!==hp&&(Tp=!0,$p="buffer",qp=hp)}var Bp=yp.objectMode?1:qp.length;yp.length+=Bp;var Vp=yp.length<yp.highWaterMark;if(Vp||(yp.needDrain=!0),yp.writing||yp.corked){var Jp=yp.lastBufferedRequest;yp.lastBufferedRequest={chunk:qp,encoding:$p,isBuf:Tp,callback:fp,next:null},Jp?Jp.next=yp.lastBufferedRequest:yp.bufferedRequest=yp.lastBufferedRequest,yp.bufferedRequestCount+=1}else Op(mp,yp,!1,Bp,qp,$p,fp);return Vp}function Op(mp,yp,Tp,qp,$p,fp,hp){yp.writelen=qp,yp.writecb=hp,yp.writing=!0,yp.sync=!0,yp.destroyed?yp.onwrite(new lo("write")):Tp?mp._writev($p,yp.onwrite):mp._write($p,fp,yp.onwrite),yp.sync=!1}function Mp(mp,yp,Tp,qp,$p){--yp.pendingcb,Tp?(process.nextTick($p,qp),process.nextTick(Hp,mp,yp),mp._writableState.errorEmitted=!0,_d(mp,qp)):($p(qp),mp._writableState.errorEmitted=!0,_d(mp,qp),Hp(mp,yp))}function Np(mp){mp.writing=!1,mp.writecb=null,mp.length-=mp.writelen,mp.writelen=0}function wp(mp,yp){var Tp=mp._writableState,qp=Tp.sync,$p=Tp.writecb;if(typeof $p!="function")throw new Mi;if(Np(Tp),yp)Mp(mp,Tp,qp,yp,$p);else{var fp=cp(Tp)||mp.destroyed;!fp&&!Tp.corked&&!Tp.bufferProcessing&&Tp.bufferedRequest&&Ip(mp,Tp),qp?process.nextTick(Sp,mp,Tp,fp,$p):Sp(mp,Tp,fp,$p)}}function Sp(mp,yp,Tp,qp){Tp||Cp(mp,yp),yp.pendingcb--,qp(),Hp(mp,yp)}function Cp(mp,yp){yp.length===0&&yp.needDrain&&(yp.needDrain=!1,mp.emit("drain"))}function Ip(mp,yp){yp.bufferProcessing=!0;var Tp=yp.bufferedRequest;if(mp._writev&&Tp&&Tp.next){var qp=yp.bufferedRequestCount,$p=new Array(qp),fp=yp.corkedRequestsFree;fp.entry=Tp;for(var hp=0,Bp=!0;Tp;)$p[hp]=Tp,Tp.isBuf||(Bp=!1),Tp=Tp.next,hp+=1;$p.allBuffers=Bp,Op(mp,yp,!0,yp.length,$p,"",fp.finish),yp.pendingcb++,yp.lastBufferedRequest=null,fp.next?(yp.corkedRequestsFree=fp.next,fp.next=null):yp.corkedRequestsFree=new Ke(yp),yp.bufferedRequestCount=0}else{for(;Tp;){var Vp=Tp.chunk,Jp=Tp.encoding,Xp=Tp.callback,tm=yp.objectMode?1:Vp.length;if(Op(mp,yp,!1,tm,Vp,Jp,Xp),Tp=Tp.next,yp.bufferedRequestCount--,yp.writing)break}Tp===null&&(yp.lastBufferedRequest=null)}yp.bufferedRequest=Tp,yp.bufferProcessing=!1}op.prototype._write=function(mp,yp,Tp){Tp(new Xr("_write()"))},op.prototype._writev=null,op.prototype.end=function(mp,yp,Tp){var qp=this._writableState;return typeof mp=="function"?(Tp=mp,mp=null,yp=null):typeof yp=="function"&&(Tp=yp,yp=null),mp!=null&&this.write(mp,yp),qp.corked&&(qp.corked=1,this.uncork()),qp.ending||zp(this,qp,Tp),this},Object.defineProperty(op.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function cp(mp){return mp.ending&&mp.length===0&&mp.bufferedRequest===null&&!mp.finished&&!mp.writing}function Ep(mp,yp){mp._final(function(Tp){yp.pendingcb--,Tp&&_d(mp,Tp),yp.prefinished=!0,mp.emit("prefinish"),Hp(mp,yp)})}function Fp(mp,yp){!yp.prefinished&&!yp.finalCalled&&(typeof mp._final=="function"&&!yp.destroyed?(yp.pendingcb++,yp.finalCalled=!0,process.nextTick(Ep,mp,yp)):(yp.prefinished=!0,mp.emit("prefinish")))}function Hp(mp,yp){var Tp=cp(yp);if(Tp&&(Fp(mp,yp),yp.pendingcb===0&&(yp.finished=!0,mp.emit("finish"),yp.autoDestroy))){var qp=mp._readableState;(!qp||qp.autoDestroy&&qp.endEmitted)&&mp.destroy()}return Tp}function zp(mp,yp,Tp){yp.ending=!0,Hp(mp,yp),Tp&&(yp.finished?process.nextTick(Tp):mp.once("finish",Tp)),yp.ended=!0,mp.writable=!1}function Gp(mp,yp,Tp){var qp=mp.entry;for(mp.entry=null;qp;){var $p=qp.callback;yp.pendingcb--,$p(Tp),qp=qp.next}yp.corkedRequestsFree.next=mp}return Object.defineProperty(op.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(yp){this._writableState&&(this._writableState.destroyed=yp)}}),op.prototype.destroy=an.destroy,op.prototype._undestroy=an.undestroy,op.prototype._destroy=function(mp,yp){yp(mp)},_stream_writable}var _stream_duplex,hasRequired_stream_duplex;function require_stream_duplex(){if(hasRequired_stream_duplex)return _stream_duplex;hasRequired_stream_duplex=1;var Ke=Object.keys||function(sn){var ln=[];for(var fn in sn)ln.push(fn);return ln};_stream_duplex=Mt;var Ge=require_stream_readable(),$e=require_stream_writable();requireInherits_browser()(Mt,Ge);for(var Ye=Ke($e.prototype),Qe=0;Qe<Ye.length;Qe++){var Je=Ye[Qe];Mt.prototype[Je]||(Mt.prototype[Je]=$e.prototype[Je])}function Mt(sn){if(!(this instanceof Mt))return new Mt(sn);Ge.call(this,sn),$e.call(this,sn),this.allowHalfOpen=!0,sn&&(sn.readable===!1&&(this.readable=!1),sn.writable===!1&&(this.writable=!1),sn.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",nn)))}Object.defineProperty(Mt.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(Mt.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(Mt.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function nn(){this._writableState.ended||process.nextTick(an,this)}function an(sn){sn.end()}return Object.defineProperty(Mt.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(ln){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=ln,this._writableState.destroyed=ln)}}),_stream_duplex}var string_decoder={},hasRequiredString_decoder;function requireString_decoder(){if(hasRequiredString_decoder)return string_decoder;hasRequiredString_decoder=1;var Ke=requireSafeBuffer().Buffer,Ge=Ke.isEncoding||function(uo){switch(uo=""+uo,uo&&uo.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function $e(uo){if(!uo)return"utf8";for(var ho;;)switch(uo){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return uo;default:if(ho)return;uo=(""+uo).toLowerCase(),ho=!0}}function Ye(uo){var ho=$e(uo);if(typeof ho!="string"&&(Ke.isEncoding===Ge||!Ge(uo)))throw new Error("Unknown encoding: "+uo);return ho||uo}string_decoder.StringDecoder=Qe;function Qe(uo){this.encoding=Ye(uo);var ho;switch(this.encoding){case"utf16le":this.text=fn,this.end=hn,ho=4;break;case"utf8":this.fillLast=an,ho=4;break;case"base64":this.text=Xr,this.end=Mi,ho=3;break;default:this.write=co,this.end=lo;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=Ke.allocUnsafe(ho)}Qe.prototype.write=function(uo){if(uo.length===0)return"";var ho,mo;if(this.lastNeed){if(ho=this.fillLast(uo),ho===void 0)return"";mo=this.lastNeed,this.lastNeed=0}else mo=0;return mo<uo.length?ho?ho+this.text(uo,mo):this.text(uo,mo):ho||""},Qe.prototype.end=ln,Qe.prototype.text=sn,Qe.prototype.fillLast=function(uo){if(this.lastNeed<=uo.length)return uo.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);uo.copy(this.lastChar,this.lastTotal-this.lastNeed,0,uo.length),this.lastNeed-=uo.length};function Je(uo){return uo<=127?0:uo>>5===6?2:uo>>4===14?3:uo>>3===30?4:uo>>6===2?-1:-2}function Mt(uo,ho,mo){var _d=ho.length-1;if(_d<mo)return 0;var ep=Je(ho[_d]);return ep>=0?(ep>0&&(uo.lastNeed=ep-1),ep):--_d<mo||ep===-2?0:(ep=Je(ho[_d]),ep>=0?(ep>0&&(uo.lastNeed=ep-2),ep):--_d<mo||ep===-2?0:(ep=Je(ho[_d]),ep>=0?(ep>0&&(ep===2?ep=0:uo.lastNeed=ep-3),ep):0))}function nn(uo,ho,mo){if((ho[0]&192)!==128)return uo.lastNeed=0,"";if(uo.lastNeed>1&&ho.length>1){if((ho[1]&192)!==128)return uo.lastNeed=1,"";if(uo.lastNeed>2&&ho.length>2&&(ho[2]&192)!==128)return uo.lastNeed=2,""}}function an(uo){var ho=this.lastTotal-this.lastNeed,mo=nn(this,uo);if(mo!==void 0)return mo;if(this.lastNeed<=uo.length)return uo.copy(this.lastChar,ho,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);uo.copy(this.lastChar,ho,0,uo.length),this.lastNeed-=uo.length}function sn(uo,ho){var mo=Mt(this,uo,ho);if(!this.lastNeed)return uo.toString("utf8",ho);this.lastTotal=mo;var _d=uo.length-(mo-this.lastNeed);return uo.copy(this.lastChar,0,_d),uo.toString("utf8",ho,_d)}function ln(uo){var ho=uo&&uo.length?this.write(uo):"";return this.lastNeed?ho+"":ho}function fn(uo,ho){if((uo.length-ho)%2===0){var mo=uo.toString("utf16le",ho);if(mo){var _d=mo.charCodeAt(mo.length-1);if(_d>=55296&&_d<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=uo[uo.length-2],this.lastChar[1]=uo[uo.length-1],mo.slice(0,-1)}return mo}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=uo[uo.length-1],uo.toString("utf16le",ho,uo.length-1)}function hn(uo){var ho=uo&&uo.length?this.write(uo):"";if(this.lastNeed){var mo=this.lastTotal-this.lastNeed;return ho+this.lastChar.toString("utf16le",0,mo)}return ho}function Xr(uo,ho){var mo=(uo.length-ho)%3;return mo===0?uo.toString("base64",ho):(this.lastNeed=3-mo,this.lastTotal=3,mo===1?this.lastChar[0]=uo[uo.length-1]:(this.lastChar[0]=uo[uo.length-2],this.lastChar[1]=uo[uo.length-1]),uo.toString("base64",ho,uo.length-mo))}function Mi(uo){var ho=uo&&uo.length?this.write(uo):"";return this.lastNeed?ho+this.lastChar.toString("base64",0,3-this.lastNeed):ho}function co(uo){return uo.toString(this.encoding)}function lo(uo){return uo&&uo.length?this.write(uo):""}return string_decoder}var endOfStream,hasRequiredEndOfStream;function requireEndOfStream(){if(hasRequiredEndOfStream)return endOfStream;hasRequiredEndOfStream=1;var Ke=requireErrorsBrowser().codes.ERR_STREAM_PREMATURE_CLOSE;function Ge(Je){var Mt=!1;return function(){if(!Mt){Mt=!0;for(var nn=arguments.length,an=new Array(nn),sn=0;sn<nn;sn++)an[sn]=arguments[sn];Je.apply(this,an)}}}function $e(){}function Ye(Je){return Je.setHeader&&typeof Je.abort=="function"}function Qe(Je,Mt,nn){if(typeof Mt=="function")return Qe(Je,null,Mt);Mt||(Mt={}),nn=Ge(nn||$e);var an=Mt.readable||Mt.readable!==!1&&Je.readable,sn=Mt.writable||Mt.writable!==!1&&Je.writable,ln=function(){Je.writable||hn()},fn=Je._writableState&&Je._writableState.finished,hn=function(){sn=!1,fn=!0,an||nn.call(Je)},Xr=Je._readableState&&Je._readableState.endEmitted,Mi=function(){an=!1,Xr=!0,sn||nn.call(Je)},co=function(mo){nn.call(Je,mo)},lo=function(){var mo;if(an&&!Xr)return(!Je._readableState||!Je._readableState.ended)&&(mo=new Ke),nn.call(Je,mo);if(sn&&!fn)return(!Je._writableState||!Je._writableState.ended)&&(mo=new Ke),nn.call(Je,mo)},uo=function(){Je.req.on("finish",hn)};return Ye(Je)?(Je.on("complete",hn),Je.on("abort",lo),Je.req?uo():Je.on("request",uo)):sn&&!Je._writableState&&(Je.on("end",ln),Je.on("close",ln)),Je.on("end",Mi),Je.on("finish",hn),Mt.error!==!1&&Je.on("error",co),Je.on("close",lo),function(){Je.removeListener("complete",hn),Je.removeListener("abort",lo),Je.removeListener("request",uo),Je.req&&Je.req.removeListener("finish",hn),Je.removeListener("end",ln),Je.removeListener("close",ln),Je.removeListener("finish",hn),Je.removeListener("end",Mi),Je.removeListener("error",co),Je.removeListener("close",lo)}}return endOfStream=Qe,endOfStream}var async_iterator,hasRequiredAsync_iterator;function requireAsync_iterator(){if(hasRequiredAsync_iterator)return async_iterator;hasRequiredAsync_iterator=1;var Ke;function Ge(mo,_d,ep){return _d=$e(_d),_d in mo?Object.defineProperty(mo,_d,{value:ep,enumerable:!0,configurable:!0,writable:!0}):mo[_d]=ep,mo}function $e(mo){var _d=Ye(mo,"string");return typeof _d=="symbol"?_d:String(_d)}function Ye(mo,_d){if(typeof mo!="object"||mo===null)return mo;var ep=mo[Symbol.toPrimitive];if(ep!==void 0){var rp=ep.call(mo,_d);if(typeof rp!="object")return rp;throw new TypeError("@@toPrimitive must return a primitive value.")}return(_d==="string"?String:Number)(mo)}var Qe=requireEndOfStream(),Je=Symbol("lastResolve"),Mt=Symbol("lastReject"),nn=Symbol("error"),an=Symbol("ended"),sn=Symbol("lastPromise"),ln=Symbol("handlePromise"),fn=Symbol("stream");function hn(mo,_d){return{value:mo,done:_d}}function Xr(mo){var _d=mo[Je];if(_d!==null){var ep=mo[fn].read();ep!==null&&(mo[sn]=null,mo[Je]=null,mo[Mt]=null,_d(hn(ep,!1)))}}function Mi(mo){process.nextTick(Xr,mo)}function co(mo,_d){return function(ep,rp){mo.then(function(){if(_d[an]){ep(hn(void 0,!0));return}_d[ln](ep,rp)},rp)}}var lo=Object.getPrototypeOf(function(){}),uo=Object.setPrototypeOf((Ke={get stream(){return this[fn]},next:function(){var _d=this,ep=this[nn];if(ep!==null)return Promise.reject(ep);if(this[an])return Promise.resolve(hn(void 0,!0));if(this[fn].destroyed)return new Promise(function(ip,lp){process.nextTick(function(){_d[nn]?lp(_d[nn]):ip(hn(void 0,!0))})});var rp=this[sn],sp;if(rp)sp=new Promise(co(rp,this));else{var op=this[fn].read();if(op!==null)return Promise.resolve(hn(op,!1));sp=new Promise(this[ln])}return this[sn]=sp,sp}},Ge(Ke,Symbol.asyncIterator,function(){return this}),Ge(Ke,"return",function(){var _d=this;return new Promise(function(ep,rp){_d[fn].destroy(null,function(sp){if(sp){rp(sp);return}ep(hn(void 0,!0))})})}),Ke),lo),ho=function(_d){var ep,rp=Object.create(uo,(ep={},Ge(ep,fn,{value:_d,writable:!0}),Ge(ep,Je,{value:null,writable:!0}),Ge(ep,Mt,{value:null,writable:!0}),Ge(ep,nn,{value:null,writable:!0}),Ge(ep,an,{value:_d._readableState.endEmitted,writable:!0}),Ge(ep,ln,{value:function(op,ip){var lp=rp[fn].read();lp?(rp[sn]=null,rp[Je]=null,rp[Mt]=null,op(hn(lp,!1))):(rp[Je]=op,rp[Mt]=ip)},writable:!0}),ep));return rp[sn]=null,Qe(_d,function(sp){if(sp&&sp.code!=="ERR_STREAM_PREMATURE_CLOSE"){var op=rp[Mt];op!==null&&(rp[sn]=null,rp[Je]=null,rp[Mt]=null,op(sp)),rp[nn]=sp;return}var ip=rp[Je];ip!==null&&(rp[sn]=null,rp[Je]=null,rp[Mt]=null,ip(hn(void 0,!0))),rp[an]=!0}),_d.on("readable",Mi.bind(null,rp)),rp};return async_iterator=ho,async_iterator}var fromBrowser,hasRequiredFromBrowser;function requireFromBrowser(){return hasRequiredFromBrowser||(hasRequiredFromBrowser=1,fromBrowser=function(){throw new Error("Readable.from is not available in the browser")}),fromBrowser}var _stream_readable,hasRequired_stream_readable;function require_stream_readable(){if(hasRequired_stream_readable)return _stream_readable;hasRequired_stream_readable=1,_stream_readable=ip;var Ke;ip.ReadableState=op,require$$3.EventEmitter;var Ge=function(hp,Bp){return hp.listeners(Bp).length},$e=requireStreamBrowser(),Ye=requireBuffer().Buffer,Qe=(typeof commonjsGlobal<"u"?commonjsGlobal:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function Je(fp){return Ye.from(fp)}function Mt(fp){return Ye.isBuffer(fp)||fp instanceof Qe}var nn=require$$3,an;nn&&nn.debuglog?an=nn.debuglog("stream"):an=function(){};var sn=requireBuffer_list(),ln=requireDestroy(),fn=requireState(),hn=fn.getHighWaterMark,Xr=requireErrorsBrowser().codes,Mi=Xr.ERR_INVALID_ARG_TYPE,co=Xr.ERR_STREAM_PUSH_AFTER_EOF,lo=Xr.ERR_METHOD_NOT_IMPLEMENTED,uo=Xr.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,ho,mo,_d;requireInherits_browser()(ip,$e);var ep=ln.errorOrDestroy,rp=["error","close","destroy","pause","resume"];function sp(fp,hp,Bp){if(typeof fp.prependListener=="function")return fp.prependListener(hp,Bp);!fp._events||!fp._events[hp]?fp.on(hp,Bp):Array.isArray(fp._events[hp])?fp._events[hp].unshift(Bp):fp._events[hp]=[Bp,fp._events[hp]]}function op(fp,hp,Bp){Ke=Ke||require_stream_duplex(),fp=fp||{},typeof Bp!="boolean"&&(Bp=hp instanceof Ke),this.objectMode=!!fp.objectMode,Bp&&(this.objectMode=this.objectMode||!!fp.readableObjectMode),this.highWaterMark=hn(this,fp,"readableHighWaterMark",Bp),this.buffer=new sn,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=fp.emitClose!==!1,this.autoDestroy=!!fp.autoDestroy,this.destroyed=!1,this.defaultEncoding=fp.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,fp.encoding&&(ho||(ho=requireString_decoder().StringDecoder),this.decoder=new ho(fp.encoding),this.encoding=fp.encoding)}function ip(fp){if(Ke=Ke||require_stream_duplex(),!(this instanceof ip))return new ip(fp);var hp=this instanceof Ke;this._readableState=new op(fp,this,hp),this.readable=!0,fp&&(typeof fp.read=="function"&&(this._read=fp.read),typeof fp.destroy=="function"&&(this._destroy=fp.destroy)),$e.call(this)}Object.defineProperty(ip.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(hp){this._readableState&&(this._readableState.destroyed=hp)}}),ip.prototype.destroy=ln.destroy,ip.prototype._undestroy=ln.undestroy,ip.prototype._destroy=function(fp,hp){hp(fp)},ip.prototype.push=function(fp,hp){var Bp=this._readableState,Vp;return Bp.objectMode?Vp=!0:typeof fp=="string"&&(hp=hp||Bp.defaultEncoding,hp!==Bp.encoding&&(fp=Ye.from(fp,hp),hp=""),Vp=!0),lp(this,fp,hp,!1,Vp)},ip.prototype.unshift=function(fp){return lp(this,fp,null,!0,!1)};function lp(fp,hp,Bp,Vp,Jp){an("readableAddChunk",hp);var Xp=fp._readableState;if(hp===null)Xp.reading=!1,wp(fp,Xp);else{var tm;if(Jp||(tm=gp(Xp,hp)),tm)ep(fp,tm);else if(Xp.objectMode||hp&&hp.length>0)if(typeof hp!="string"&&!Xp.objectMode&&Object.getPrototypeOf(hp)!==Ye.prototype&&(hp=Je(hp)),Vp)Xp.endEmitted?ep(fp,new uo):vp(fp,Xp,hp,!0);else if(Xp.ended)ep(fp,new co);else{if(Xp.destroyed)return!1;Xp.reading=!1,Xp.decoder&&!Bp?(hp=Xp.decoder.write(hp),Xp.objectMode||hp.length!==0?vp(fp,Xp,hp,!1):Ip(fp,Xp)):vp(fp,Xp,hp,!1)}else Vp||(Xp.reading=!1,Ip(fp,Xp))}return!Xp.ended&&(Xp.length<Xp.highWaterMark||Xp.length===0)}function vp(fp,hp,Bp,Vp){hp.flowing&&hp.length===0&&!hp.sync?(hp.awaitDrain=0,fp.emit("data",Bp)):(hp.length+=hp.objectMode?1:Bp.length,Vp?hp.buffer.unshift(Bp):hp.buffer.push(Bp),hp.needReadable&&Sp(fp)),Ip(fp,hp)}function gp(fp,hp){var Bp;return!Mt(hp)&&typeof hp!="string"&&hp!==void 0&&!fp.objectMode&&(Bp=new Mi("chunk",["string","Buffer","Uint8Array"],hp)),Bp}ip.prototype.isPaused=function(){return this._readableState.flowing===!1},ip.prototype.setEncoding=function(fp){ho||(ho=requireString_decoder().StringDecoder);var hp=new ho(fp);this._readableState.decoder=hp,this._readableState.encoding=this._readableState.decoder.encoding;for(var Bp=this._readableState.buffer.head,Vp="";Bp!==null;)Vp+=hp.write(Bp.data),Bp=Bp.next;return this._readableState.buffer.clear(),Vp!==""&&this._readableState.buffer.push(Vp),this._readableState.length=Vp.length,this};var Op=1073741824;function Mp(fp){return fp>=Op?fp=Op:(fp--,fp|=fp>>>1,fp|=fp>>>2,fp|=fp>>>4,fp|=fp>>>8,fp|=fp>>>16,fp++),fp}function Np(fp,hp){return fp<=0||hp.length===0&&hp.ended?0:hp.objectMode?1:fp!==fp?hp.flowing&&hp.length?hp.buffer.head.data.length:hp.length:(fp>hp.highWaterMark&&(hp.highWaterMark=Mp(fp)),fp<=hp.length?fp:hp.ended?hp.length:(hp.needReadable=!0,0))}ip.prototype.read=function(fp){an("read",fp),fp=parseInt(fp,10);var hp=this._readableState,Bp=fp;if(fp!==0&&(hp.emittedReadable=!1),fp===0&&hp.needReadable&&((hp.highWaterMark!==0?hp.length>=hp.highWaterMark:hp.length>0)||hp.ended))return an("read: emitReadable",hp.length,hp.ended),hp.length===0&&hp.ended?Tp(this):Sp(this),null;if(fp=Np(fp,hp),fp===0&&hp.ended)return hp.length===0&&Tp(this),null;var Vp=hp.needReadable;an("need readable",Vp),(hp.length===0||hp.length-fp<hp.highWaterMark)&&(Vp=!0,an("length less than watermark",Vp)),hp.ended||hp.reading?(Vp=!1,an("reading or ended",Vp)):Vp&&(an("do read"),hp.reading=!0,hp.sync=!0,hp.length===0&&(hp.needReadable=!0),this._read(hp.highWaterMark),hp.sync=!1,hp.reading||(fp=Np(Bp,hp)));var Jp;return fp>0?Jp=yp(fp,hp):Jp=null,Jp===null?(hp.needReadable=hp.length<=hp.highWaterMark,fp=0):(hp.length-=fp,hp.awaitDrain=0),hp.length===0&&(hp.ended||(hp.needReadable=!0),Bp!==fp&&hp.ended&&Tp(this)),Jp!==null&&this.emit("data",Jp),Jp};function wp(fp,hp){if(an("onEofChunk"),!hp.ended){if(hp.decoder){var Bp=hp.decoder.end();Bp&&Bp.length&&(hp.buffer.push(Bp),hp.length+=hp.objectMode?1:Bp.length)}hp.ended=!0,hp.sync?Sp(fp):(hp.needReadable=!1,hp.emittedReadable||(hp.emittedReadable=!0,Cp(fp)))}}function Sp(fp){var hp=fp._readableState;an("emitReadable",hp.needReadable,hp.emittedReadable),hp.needReadable=!1,hp.emittedReadable||(an("emitReadable",hp.flowing),hp.emittedReadable=!0,process.nextTick(Cp,fp))}function Cp(fp){var hp=fp._readableState;an("emitReadable_",hp.destroyed,hp.length,hp.ended),!hp.destroyed&&(hp.length||hp.ended)&&(fp.emit("readable"),hp.emittedReadable=!1),hp.needReadable=!hp.flowing&&!hp.ended&&hp.length<=hp.highWaterMark,mp(fp)}function Ip(fp,hp){hp.readingMore||(hp.readingMore=!0,process.nextTick(cp,fp,hp))}function cp(fp,hp){for(;!hp.reading&&!hp.ended&&(hp.length<hp.highWaterMark||hp.flowing&&hp.length===0);){var Bp=hp.length;if(an("maybeReadMore read 0"),fp.read(0),Bp===hp.length)break}hp.readingMore=!1}ip.prototype._read=function(fp){ep(this,new lo("_read()"))},ip.prototype.pipe=function(fp,hp){var Bp=this,Vp=this._readableState;switch(Vp.pipesCount){case 0:Vp.pipes=fp;break;case 1:Vp.pipes=[Vp.pipes,fp];break;default:Vp.pipes.push(fp);break}Vp.pipesCount+=1,an("pipe count=%d opts=%j",Vp.pipesCount,hp);var Jp=(!hp||hp.end!==!1)&&fp!==process.stdout&&fp!==process.stderr,Xp=Jp?bm:Km;Vp.endEmitted?process.nextTick(Xp):Bp.once("end",Xp),fp.on("unpipe",tm);function tm(ap,Uo){an("onunpipe"),ap===Bp&&Uo&&Uo.hasUnpiped===!1&&(Uo.hasUnpiped=!0,Nm())}function bm(){an("onend"),fp.end()}var xm=Ep(Bp);fp.on("drain",xm);var Wm=!1;function Nm(){an("cleanup"),fp.removeListener("close",Em),fp.removeListener("finish",_m),fp.removeListener("drain",xm),fp.removeListener("error",Mm),fp.removeListener("unpipe",tm),Bp.removeListener("end",bm),Bp.removeListener("end",Km),Bp.removeListener("data",wm),Wm=!0,Vp.awaitDrain&&(!fp._writableState||fp._writableState.needDrain)&&xm()}Bp.on("data",wm);function wm(ap){an("ondata");var Uo=fp.write(ap);an("dest.write",Uo),Uo===!1&&((Vp.pipesCount===1&&Vp.pipes===fp||Vp.pipesCount>1&&$p(Vp.pipes,fp)!==-1)&&!Wm&&(an("false write response, pause",Vp.awaitDrain),Vp.awaitDrain++),Bp.pause())}function Mm(ap){an("onerror",ap),Km(),fp.removeListener("error",Mm),Ge(fp,"error")===0&&ep(fp,ap)}sp(fp,"error",Mm);function Em(){fp.removeListener("finish",_m),Km()}fp.once("close",Em);function _m(){an("onfinish"),fp.removeListener("close",Em),Km()}fp.once("finish",_m);function Km(){an("unpipe"),Bp.unpipe(fp)}return fp.emit("pipe",Bp),Vp.flowing||(an("pipe resume"),Bp.resume()),fp};function Ep(fp){return function(){var Bp=fp._readableState;an("pipeOnDrain",Bp.awaitDrain),Bp.awaitDrain&&Bp.awaitDrain--,Bp.awaitDrain===0&&Ge(fp,"data")&&(Bp.flowing=!0,mp(fp))}}ip.prototype.unpipe=function(fp){var hp=this._readableState,Bp={hasUnpiped:!1};if(hp.pipesCount===0)return this;if(hp.pipesCount===1)return fp&&fp!==hp.pipes?this:(fp||(fp=hp.pipes),hp.pipes=null,hp.pipesCount=0,hp.flowing=!1,fp&&fp.emit("unpipe",this,Bp),this);if(!fp){var Vp=hp.pipes,Jp=hp.pipesCount;hp.pipes=null,hp.pipesCount=0,hp.flowing=!1;for(var Xp=0;Xp<Jp;Xp++)Vp[Xp].emit("unpipe",this,{hasUnpiped:!1});return this}var tm=$p(hp.pipes,fp);return tm===-1?this:(hp.pipes.splice(tm,1),hp.pipesCount-=1,hp.pipesCount===1&&(hp.pipes=hp.pipes[0]),fp.emit("unpipe",this,Bp),this)},ip.prototype.on=function(fp,hp){var Bp=$e.prototype.on.call(this,fp,hp),Vp=this._readableState;return fp==="data"?(Vp.readableListening=this.listenerCount("readable")>0,Vp.flowing!==!1&&this.resume()):fp==="readable"&&!Vp.endEmitted&&!Vp.readableListening&&(Vp.readableListening=Vp.needReadable=!0,Vp.flowing=!1,Vp.emittedReadable=!1,an("on readable",Vp.length,Vp.reading),Vp.length?Sp(this):Vp.reading||process.nextTick(Hp,this)),Bp},ip.prototype.addListener=ip.prototype.on,ip.prototype.removeListener=function(fp,hp){var Bp=$e.prototype.removeListener.call(this,fp,hp);return fp==="readable"&&process.nextTick(Fp,this),Bp},ip.prototype.removeAllListeners=function(fp){var hp=$e.prototype.removeAllListeners.apply(this,arguments);return(fp==="readable"||fp===void 0)&&process.nextTick(Fp,this),hp};function Fp(fp){var hp=fp._readableState;hp.readableListening=fp.listenerCount("readable")>0,hp.resumeScheduled&&!hp.paused?hp.flowing=!0:fp.listenerCount("data")>0&&fp.resume()}function Hp(fp){an("readable nexttick read 0"),fp.read(0)}ip.prototype.resume=function(){var fp=this._readableState;return fp.flowing||(an("resume"),fp.flowing=!fp.readableListening,zp(this,fp)),fp.paused=!1,this};function zp(fp,hp){hp.resumeScheduled||(hp.resumeScheduled=!0,process.nextTick(Gp,fp,hp))}function Gp(fp,hp){an("resume",hp.reading),hp.reading||fp.read(0),hp.resumeScheduled=!1,fp.emit("resume"),mp(fp),hp.flowing&&!hp.reading&&fp.read(0)}ip.prototype.pause=function(){return an("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(an("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function mp(fp){var hp=fp._readableState;for(an("flow",hp.flowing);hp.flowing&&fp.read()!==null;);}ip.prototype.wrap=function(fp){var hp=this,Bp=this._readableState,Vp=!1;fp.on("end",function(){if(an("wrapped end"),Bp.decoder&&!Bp.ended){var tm=Bp.decoder.end();tm&&tm.length&&hp.push(tm)}hp.push(null)}),fp.on("data",function(tm){if(an("wrapped data"),Bp.decoder&&(tm=Bp.decoder.write(tm)),!(Bp.objectMode&&tm==null)&&!(!Bp.objectMode&&(!tm||!tm.length))){var bm=hp.push(tm);bm||(Vp=!0,fp.pause())}});for(var Jp in fp)this[Jp]===void 0&&typeof fp[Jp]=="function"&&(this[Jp]=function(bm){return function(){return fp[bm].apply(fp,arguments)}}(Jp));for(var Xp=0;Xp<rp.length;Xp++)fp.on(rp[Xp],this.emit.bind(this,rp[Xp]));return this._read=function(tm){an("wrapped _read",tm),Vp&&(Vp=!1,fp.resume())},this},typeof Symbol=="function"&&(ip.prototype[Symbol.asyncIterator]=function(){return mo===void 0&&(mo=requireAsync_iterator()),mo(this)}),Object.defineProperty(ip.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(ip.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(ip.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(hp){this._readableState&&(this._readableState.flowing=hp)}}),ip._fromList=yp,Object.defineProperty(ip.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function yp(fp,hp){if(hp.length===0)return null;var Bp;return hp.objectMode?Bp=hp.buffer.shift():!fp||fp>=hp.length?(hp.decoder?Bp=hp.buffer.join(""):hp.buffer.length===1?Bp=hp.buffer.first():Bp=hp.buffer.concat(hp.length),hp.buffer.clear()):Bp=hp.buffer.consume(fp,hp.decoder),Bp}function Tp(fp){var hp=fp._readableState;an("endReadable",hp.endEmitted),hp.endEmitted||(hp.ended=!0,process.nextTick(qp,hp,fp))}function qp(fp,hp){if(an("endReadableNT",fp.endEmitted,fp.length),!fp.endEmitted&&fp.length===0&&(fp.endEmitted=!0,hp.readable=!1,hp.emit("end"),fp.autoDestroy)){var Bp=hp._writableState;(!Bp||Bp.autoDestroy&&Bp.finished)&&hp.destroy()}}typeof Symbol=="function"&&(ip.from=function(fp,hp){return _d===void 0&&(_d=requireFromBrowser()),_d(ip,fp,hp)});function $p(fp,hp){for(var Bp=0,Vp=fp.length;Bp<Vp;Bp++)if(fp[Bp]===hp)return Bp;return-1}return _stream_readable}var _stream_transform,hasRequired_stream_transform;function require_stream_transform(){if(hasRequired_stream_transform)return _stream_transform;hasRequired_stream_transform=1,_stream_transform=nn;var Ke=requireErrorsBrowser().codes,Ge=Ke.ERR_METHOD_NOT_IMPLEMENTED,$e=Ke.ERR_MULTIPLE_CALLBACK,Ye=Ke.ERR_TRANSFORM_ALREADY_TRANSFORMING,Qe=Ke.ERR_TRANSFORM_WITH_LENGTH_0,Je=require_stream_duplex();requireInherits_browser()(nn,Je);function Mt(ln,fn){var hn=this._transformState;hn.transforming=!1;var Xr=hn.writecb;if(Xr===null)return this.emit("error",new $e);hn.writechunk=null,hn.writecb=null,fn!=null&&this.push(fn),Xr(ln);var Mi=this._readableState;Mi.reading=!1,(Mi.needReadable||Mi.length<Mi.highWaterMark)&&this._read(Mi.highWaterMark)}function nn(ln){if(!(this instanceof nn))return new nn(ln);Je.call(this,ln),this._transformState={afterTransform:Mt.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,ln&&(typeof ln.transform=="function"&&(this._transform=ln.transform),typeof ln.flush=="function"&&(this._flush=ln.flush)),this.on("prefinish",an)}function an(){var ln=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(fn,hn){sn(ln,fn,hn)}):sn(this,null,null)}nn.prototype.push=function(ln,fn){return this._transformState.needTransform=!1,Je.prototype.push.call(this,ln,fn)},nn.prototype._transform=function(ln,fn,hn){hn(new Ge("_transform()"))},nn.prototype._write=function(ln,fn,hn){var Xr=this._transformState;if(Xr.writecb=hn,Xr.writechunk=ln,Xr.writeencoding=fn,!Xr.transforming){var Mi=this._readableState;(Xr.needTransform||Mi.needReadable||Mi.length<Mi.highWaterMark)&&this._read(Mi.highWaterMark)}},nn.prototype._read=function(ln){var fn=this._transformState;fn.writechunk!==null&&!fn.transforming?(fn.transforming=!0,this._transform(fn.writechunk,fn.writeencoding,fn.afterTransform)):fn.needTransform=!0},nn.prototype._destroy=function(ln,fn){Je.prototype._destroy.call(this,ln,function(hn){fn(hn)})};function sn(ln,fn,hn){if(fn)return ln.emit("error",fn);if(hn!=null&&ln.push(hn),ln._writableState.length)throw new Qe;if(ln._transformState.transforming)throw new Ye;return ln.push(null)}return _stream_transform}var _stream_passthrough,hasRequired_stream_passthrough;function require_stream_passthrough(){if(hasRequired_stream_passthrough)return _stream_passthrough;hasRequired_stream_passthrough=1,_stream_passthrough=Ge;var Ke=require_stream_transform();requireInherits_browser()(Ge,Ke);function Ge($e){if(!(this instanceof Ge))return new Ge($e);Ke.call(this,$e)}return Ge.prototype._transform=function($e,Ye,Qe){Qe(null,$e)},_stream_passthrough}var pipeline_1,hasRequiredPipeline;function requirePipeline(){if(hasRequiredPipeline)return pipeline_1;hasRequiredPipeline=1;var Ke;function Ge(hn){var Xr=!1;return function(){Xr||(Xr=!0,hn.apply(void 0,arguments))}}var $e=requireErrorsBrowser().codes,Ye=$e.ERR_MISSING_ARGS,Qe=$e.ERR_STREAM_DESTROYED;function Je(hn){if(hn)throw hn}function Mt(hn){return hn.setHeader&&typeof hn.abort=="function"}function nn(hn,Xr,Mi,co){co=Ge(co);var lo=!1;hn.on("close",function(){lo=!0}),Ke===void 0&&(Ke=requireEndOfStream()),Ke(hn,{readable:Xr,writable:Mi},function(ho){if(ho)return co(ho);lo=!0,co()});var uo=!1;return function(ho){if(!lo&&!uo){if(uo=!0,Mt(hn))return hn.abort();if(typeof hn.destroy=="function")return hn.destroy();co(ho||new Qe("pipe"))}}}function an(hn){hn()}function sn(hn,Xr){return hn.pipe(Xr)}function ln(hn){return!hn.length||typeof hn[hn.length-1]!="function"?Je:hn.pop()}function fn(){for(var hn=arguments.length,Xr=new Array(hn),Mi=0;Mi<hn;Mi++)Xr[Mi]=arguments[Mi];var co=ln(Xr);if(Array.isArray(Xr[0])&&(Xr=Xr[0]),Xr.length<2)throw new Ye("streams");var lo,uo=Xr.map(function(ho,mo){var _d=mo<Xr.length-1,ep=mo>0;return nn(ho,_d,ep,function(rp){lo||(lo=rp),rp&&uo.forEach(an),!_d&&(uo.forEach(an),co(lo))})});return Xr.reduce(sn)}return pipeline_1=fn,pipeline_1}var hasRequiredReadableBrowser;function requireReadableBrowser(){return hasRequiredReadableBrowser||(hasRequiredReadableBrowser=1,function(Ke,Ge){Ge=Ke.exports=require_stream_readable(),Ge.Stream=Ge,Ge.Readable=Ge,Ge.Writable=require_stream_writable(),Ge.Duplex=require_stream_duplex(),Ge.Transform=require_stream_transform(),Ge.PassThrough=require_stream_passthrough(),Ge.finished=requireEndOfStream(),Ge.pipeline=requirePipeline()}(readableBrowser,readableBrowser.exports)),readableBrowser.exports}/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var queueMicrotask_1,hasRequiredQueueMicrotask;function requireQueueMicrotask(){if(hasRequiredQueueMicrotask)return queueMicrotask_1;hasRequiredQueueMicrotask=1;let Ke;return queueMicrotask_1=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:commonjsGlobal):Ge=>(Ke||(Ke=Promise.resolve())).then(Ge).catch($e=>setTimeout(()=>{throw $e},0)),queueMicrotask_1}var errCode,hasRequiredErrCode;function requireErrCode(){if(hasRequiredErrCode)return errCode;hasRequiredErrCode=1;function Ke($e,Ye){for(const Qe in Ye)Object.defineProperty($e,Qe,{value:Ye[Qe],enumerable:!0,configurable:!0});return $e}function Ge($e,Ye,Qe){if(!$e||typeof $e=="string")throw new TypeError("Please pass an Error to err-code");Qe||(Qe={}),typeof Ye=="object"&&(Qe=Ye,Ye=""),Ye&&(Qe.code=Ye);try{return Ke($e,Qe)}catch{Qe.message=$e.message,Qe.stack=$e.stack;const Mt=function(){};return Mt.prototype=Object.create(Object.getPrototypeOf($e)),Ke(new Mt,Qe)}}return errCode=Ge,errCode}/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var simplePeer,hasRequiredSimplePeer;function requireSimplePeer(){if(hasRequiredSimplePeer)return simplePeer;hasRequiredSimplePeer=1;const Ke=requireBrowser$2()("simple-peer"),Ge=requireGetBrowserRtc(),$e=requireBrowser$1(),Ye=requireReadableBrowser(),Qe=requireQueueMicrotask(),Je=requireErrCode(),{Buffer:Mt}=requireBuffer(),nn=64*1024,an=5*1e3,sn=5*1e3;function ln(Xr){return Xr.replace(/a=ice-options:trickle\s\n/g,"")}function fn(Xr){console.warn(Xr)}class hn extends Ye.Duplex{constructor(Mi){if(Mi=Object.assign({allowHalfOpen:!1},Mi),super(Mi),this._id=$e(4).toString("hex").slice(0,7),this._debug("new peer %o",Mi),this.channelName=Mi.initiator?Mi.channelName||$e(20).toString("hex"):null,this.initiator=Mi.initiator||!1,this.channelConfig=Mi.channelConfig||hn.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},hn.config,Mi.config),this.offerOptions=Mi.offerOptions||{},this.answerOptions=Mi.answerOptions||{},this.sdpTransform=Mi.sdpTransform||(co=>co),this.streams=Mi.streams||(Mi.stream?[Mi.stream]:[]),this.trickle=Mi.trickle!==void 0?Mi.trickle:!0,this.allowHalfTrickle=Mi.allowHalfTrickle!==void 0?Mi.allowHalfTrickle:!1,this.iceCompleteTimeout=Mi.iceCompleteTimeout||an,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=Mi.wrtc&&typeof Mi.wrtc=="object"?Mi.wrtc:Ge(),!this._wrtc)throw Je(typeof window>"u"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(co){this.destroy(Je(co,"ERR_PC_CONSTRUCTOR"));return}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=co=>{this._onIceCandidate(co)},typeof this._pc.peerIdentity=="object"&&this._pc.peerIdentity.catch(co=>{this.destroy(Je(co,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=co=>{this._setupData(co)},this.streams&&this.streams.forEach(co=>{this.addStream(co)}),this._pc.ontrack=co=>{this._onTrack(co)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(Mi){if(!this.destroying){if(this.destroyed)throw Je(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if(typeof Mi=="string")try{Mi=JSON.parse(Mi)}catch{Mi={}}this._debug("signal()"),Mi.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),Mi.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(Mi.transceiverRequest.kind,Mi.transceiverRequest.init)),Mi.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(Mi.candidate):this._pendingCandidates.push(Mi.candidate)),Mi.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(Mi)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(co=>{this._addIceCandidate(co)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(co=>{this.destroy(Je(co,"ERR_SET_REMOTE_DESCRIPTION"))}),!Mi.sdp&&!Mi.candidate&&!Mi.renegotiate&&!Mi.transceiverRequest&&this.destroy(Je(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(Mi){const co=new this._wrtc.RTCIceCandidate(Mi);this._pc.addIceCandidate(co).catch(lo=>{!co.address||co.address.endsWith(".local")?fn("Ignoring unsupported ICE candidate."):this.destroy(Je(lo,"ERR_ADD_ICE_CANDIDATE"))})}send(Mi){if(!this.destroying){if(this.destroyed)throw Je(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(Mi)}}addTransceiver(Mi,co){if(!this.destroying){if(this.destroyed)throw Je(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(Mi,co),this._needsNegotiation()}catch(lo){this.destroy(Je(lo,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:Mi,init:co}})}}addStream(Mi){if(!this.destroying){if(this.destroyed)throw Je(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),Mi.getTracks().forEach(co=>{this.addTrack(co,Mi)})}}addTrack(Mi,co){if(this.destroying)return;if(this.destroyed)throw Je(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");const lo=this._senderMap.get(Mi)||new Map;let uo=lo.get(co);if(!uo)uo=this._pc.addTrack(Mi,co),lo.set(co,uo),this._senderMap.set(Mi,lo),this._needsNegotiation();else throw uo.removed?Je(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):Je(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(Mi,co,lo){if(this.destroying)return;if(this.destroyed)throw Je(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");const uo=this._senderMap.get(Mi),ho=uo?uo.get(lo):null;if(!ho)throw Je(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");co&&this._senderMap.set(co,uo),ho.replaceTrack!=null?ho.replaceTrack(co):this.destroy(Je(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK"))}removeTrack(Mi,co){if(this.destroying)return;if(this.destroyed)throw Je(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");const lo=this._senderMap.get(Mi),uo=lo?lo.get(co):null;if(!uo)throw Je(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{uo.removed=!0,this._pc.removeTrack(uo)}catch(ho){ho.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(uo):this.destroy(Je(ho,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(Mi){if(!this.destroying){if(this.destroyed)throw Je(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),Mi.getTracks().forEach(co=>{this.removeTrack(co,Mi)})}}_needsNegotiation(){this._debug("_needsNegotiation"),!this._batchedNegotiation&&(this._batchedNegotiation=!0,Qe(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw Je(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(Mi){this._destroy(Mi,()=>{})}_destroy(Mi,co){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",Mi&&(Mi.message||Mi)),Qe(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",Mi&&(Mi.message||Mi)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch{}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch{}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,Mi&&this.emit("error",Mi),this.emit("close"),co()}))}_setupData(Mi){if(!Mi.channel)return this.destroy(Je(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=Mi.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=nn),this.channelName=this._channel.label,this._channel.onmessage=lo=>{this._onChannelMessage(lo)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=lo=>{const uo=lo.error instanceof Error?lo.error:new Error(`Datachannel error: ${lo.message} ${lo.filename}:${lo.lineno}:${lo.colno}`);this.destroy(Je(uo,"ERR_DATA_CHANNEL"))};let co=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(co&&this._onChannelClose(),co=!0):co=!1},sn)}_read(){}_write(Mi,co,lo){if(this.destroyed)return lo(Je(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(Mi)}catch(uo){return this.destroy(Je(uo,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>nn?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=lo):lo(null)}else this._debug("write before connect"),this._chunk=Mi,this._cb=lo}_onFinish(){if(this.destroyed)return;const Mi=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?Mi():this.once("connect",Mi)}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(Mi=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(Mi.sdp=ln(Mi.sdp)),Mi.sdp=this.sdpTransform(Mi.sdp);const co=()=>{if(this.destroyed)return;const ho=this._pc.localDescription||Mi;this._debug("signal"),this.emit("signal",{type:ho.type,sdp:ho.sdp})},lo=()=>{this._debug("createOffer success"),!this.destroyed&&(this.trickle||this._iceComplete?co():this.once("_iceComplete",co))},uo=ho=>{this.destroy(Je(ho,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(Mi).then(lo).catch(uo)}).catch(Mi=>{this.destroy(Je(Mi,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(Mi=>{!Mi.mid&&Mi.sender.track&&!Mi.requested&&(Mi.requested=!0,this.addTransceiver(Mi.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(Mi=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(Mi.sdp=ln(Mi.sdp)),Mi.sdp=this.sdpTransform(Mi.sdp);const co=()=>{if(this.destroyed)return;const ho=this._pc.localDescription||Mi;this._debug("signal"),this.emit("signal",{type:ho.type,sdp:ho.sdp}),this.initiator||this._requestMissingTransceivers()},lo=()=>{this.destroyed||(this.trickle||this._iceComplete?co():this.once("_iceComplete",co))},uo=ho=>{this.destroy(Je(ho,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(Mi).then(lo).catch(uo)}).catch(Mi=>{this.destroy(Je(Mi,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(Je(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const Mi=this._pc.iceConnectionState,co=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",Mi,co),this.emit("iceStateChange",Mi,co),(Mi==="connected"||Mi==="completed")&&(this._pcReady=!0,this._maybeReady()),Mi==="failed"&&this.destroy(Je(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),Mi==="closed"&&this.destroy(Je(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(Mi){const co=lo=>(Object.prototype.toString.call(lo.values)==="[object Array]"&&lo.values.forEach(uo=>{Object.assign(lo,uo)}),lo);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(lo=>{const uo=[];lo.forEach(ho=>{uo.push(co(ho))}),Mi(null,uo)},lo=>Mi(lo)):this._pc.getStats.length>0?this._pc.getStats(lo=>{if(this.destroyed)return;const uo=[];lo.result().forEach(ho=>{const mo={};ho.names().forEach(_d=>{mo[_d]=ho.stat(_d)}),mo.id=ho.id,mo.type=ho.type,mo.timestamp=ho.timestamp,uo.push(co(mo))}),Mi(null,uo)},lo=>Mi(lo)):Mi(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const Mi=()=>{this.destroyed||this.getStats((co,lo)=>{if(this.destroyed)return;co&&(lo=[]);const uo={},ho={},mo={};let _d=!1;lo.forEach(rp=>{(rp.type==="remotecandidate"||rp.type==="remote-candidate")&&(uo[rp.id]=rp),(rp.type==="localcandidate"||rp.type==="local-candidate")&&(ho[rp.id]=rp),(rp.type==="candidatepair"||rp.type==="candidate-pair")&&(mo[rp.id]=rp)});const ep=rp=>{_d=!0;let sp=ho[rp.localCandidateId];sp&&(sp.ip||sp.address)?(this.localAddress=sp.ip||sp.address,this.localPort=Number(sp.port)):sp&&sp.ipAddress?(this.localAddress=sp.ipAddress,this.localPort=Number(sp.portNumber)):typeof rp.googLocalAddress=="string"&&(sp=rp.googLocalAddress.split(":"),this.localAddress=sp[0],this.localPort=Number(sp[1])),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let op=uo[rp.remoteCandidateId];op&&(op.ip||op.address)?(this.remoteAddress=op.ip||op.address,this.remotePort=Number(op.port)):op&&op.ipAddress?(this.remoteAddress=op.ipAddress,this.remotePort=Number(op.portNumber)):typeof rp.googRemoteAddress=="string"&&(op=rp.googRemoteAddress.split(":"),this.remoteAddress=op[0],this.remotePort=Number(op[1])),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(lo.forEach(rp=>{rp.type==="transport"&&rp.selectedCandidatePairId&&ep(mo[rp.selectedCandidatePairId]),(rp.type==="googCandidatePair"&&rp.googActiveConnection==="true"||(rp.type==="candidatepair"||rp.type==="candidate-pair")&&rp.selected)&&ep(rp)}),!_d&&(!Object.keys(mo).length||Object.keys(ho).length)){setTimeout(Mi,100);return}else this._connecting=!1,this._connected=!0;if(this._chunk){try{this.send(this._chunk)}catch(sp){return this.destroy(Je(sp,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const rp=this._cb;this._cb=null,rp(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};Mi()}_onInterval(){!this._cb||!this._channel||this._channel.bufferedAmount>nn||this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(Mi=>{this._pc.removeTrack(Mi),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(Mi){this.destroyed||(Mi.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:Mi.candidate.candidate,sdpMLineIndex:Mi.candidate.sdpMLineIndex,sdpMid:Mi.candidate.sdpMid}}):!Mi.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),Mi.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(Mi){if(this.destroyed)return;let co=Mi.data;co instanceof ArrayBuffer&&(co=Mt.from(co)),this.push(co)}_onChannelBufferedAmountLow(){if(this.destroyed||!this._cb)return;this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const Mi=this._cb;this._cb=null,Mi(null)}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(Mi){this.destroyed||Mi.streams.forEach(co=>{this._debug("on track"),this.emit("track",Mi.track,co),this._remoteTracks.push({track:Mi.track,stream:co}),!this._remoteStreams.some(lo=>lo.id===co.id)&&(this._remoteStreams.push(co),Qe(()=>{this._debug("on stream"),this.emit("stream",co)}))})}_debug(){const Mi=[].slice.call(arguments);Mi[0]="["+this._id+"] "+Mi[0],Ke.apply(null,Mi)}}return hn.WEBRTC_SUPPORT=!!Ge(),hn.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},hn.channelConfig={},simplePeer=hn,simplePeer}var simplePeerExports=requireSimplePeer();const Peer=getDefaultExportFromCjs(simplePeerExports);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var t=function(Ke,Ge){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function($e,Ye){$e.__proto__=Ye}||function($e,Ye){for(var Qe in Ye)Ye.hasOwnProperty(Qe)&&($e[Qe]=Ye[Qe])})(Ke,Ge)};function e(Ke,Ge){function $e(){this.constructor=Ke}t(Ke,Ge),Ke.prototype=Ge===null?Object.create(Ge):($e.prototype=Ge.prototype,new $e)}function n(Ke,Ge,$e,Ye){return new($e||($e=Promise))(function(Qe,Je){function Mt(sn){try{an(Ye.next(sn))}catch(ln){Je(ln)}}function nn(sn){try{an(Ye.throw(sn))}catch(ln){Je(ln)}}function an(sn){sn.done?Qe(sn.value):new $e(function(ln){ln(sn.value)}).then(Mt,nn)}an((Ye=Ye.apply(Ke,[])).next())})}function r(Ke,Ge){var $e,Ye,Qe,Je,Mt={label:0,sent:function(){if(1&Qe[0])throw Qe[1];return Qe[1]},trys:[],ops:[]};return Je={next:nn(0),throw:nn(1),return:nn(2)},typeof Symbol=="function"&&(Je[Symbol.iterator]=function(){return this}),Je;function nn(an){return function(sn){return function(ln){if($e)throw new TypeError("Generator is already executing.");for(;Mt;)try{if($e=1,Ye&&(Qe=2&ln[0]?Ye.return:ln[0]?Ye.throw||((Qe=Ye.return)&&Qe.call(Ye),0):Ye.next)&&!(Qe=Qe.call(Ye,ln[1])).done)return Qe;switch(Ye=0,Qe&&(ln=[2&ln[0],Qe.value]),ln[0]){case 0:case 1:Qe=ln;break;case 4:return Mt.label++,{value:ln[1],done:!1};case 5:Mt.label++,Ye=ln[1],ln=[0];continue;case 7:ln=Mt.ops.pop(),Mt.trys.pop();continue;default:if(!(Qe=(Qe=Mt.trys).length>0&&Qe[Qe.length-1])&&(ln[0]===6||ln[0]===2)){Mt=0;continue}if(ln[0]===3&&(!Qe||ln[1]>Qe[0]&&ln[1]<Qe[3])){Mt.label=ln[1];break}if(ln[0]===6&&Mt.label<Qe[1]){Mt.label=Qe[1],Qe=ln;break}if(Qe&&Mt.label<Qe[2]){Mt.label=Qe[2],Mt.ops.push(ln);break}Qe[2]&&Mt.ops.pop(),Mt.trys.pop();continue}ln=Ge.call(Ke,Mt)}catch(fn){ln=[6,fn],Ye=0}finally{$e=Qe=0}if(5&ln[0])throw ln[1];return{value:ln[0]?ln[1]:void 0,done:!0}}([an,sn])}}}var o=function(){function Ke(Ge){this.global=Ge,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return Ke.prototype.setPlatform=function(Ge,$e){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+$e+"."),this.platformName=Ge,this.platform=$e},Ke.prototype.registerFlag=function(Ge,$e,Ye){if(this.flagRegistry[Ge]={evaluationFn:$e,setHook:Ye},this.urlFlags[Ge]!=null){var Qe=this.urlFlags[Ge];console.warn("Setting feature override from URL "+Ge+": "+Qe+"."),this.set(Ge,Qe)}},Ke.prototype.get=function(Ge){return Ge in this.flags?this.flags[Ge]:(this.flags[Ge]=this.evaluateFlag(Ge),this.flags[Ge])},Ke.prototype.getNumber=function(Ge){return this.get(Ge)},Ke.prototype.getBool=function(Ge){return this.get(Ge)},Ke.prototype.getFlags=function(){return this.flags},Object.defineProperty(Ke.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),Ke.prototype.set=function(Ge,$e){if(this.flagRegistry[Ge]==null)throw new Error("Cannot set flag "+Ge+" as it has not been registered.");this.flags[Ge]=$e,this.flagRegistry[Ge].setHook!=null&&this.flagRegistry[Ge].setHook($e)},Ke.prototype.evaluateFlag=function(Ge){if(this.flagRegistry[Ge]==null)throw new Error("Cannot evaluate flag '"+Ge+"': no evaluation function found.");return this.flagRegistry[Ge].evaluationFn()},Ke.prototype.setFlags=function(Ge){this.flags=Object.assign({},Ge)},Ke.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},Ke.prototype.populateURLFlags=function(){var Ge=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var $e,Ye,Qe=($e=this.global.location.search,Ye={},$e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(Je){for(var Mt=[],nn=1;nn<arguments.length;nn++)Mt[nn-1]=arguments[nn];return a(Ye,Mt[0],Mt[1]),Mt.join("=")}),Ye);"tfjsflags"in Qe&&Qe.tfjsflags.split(",").forEach(function(Je){var Mt=Je.split(":"),nn=Mt[0],an=Mt[1];Ge.urlFlags[nn]=function(sn,ln){if((ln=ln.toLowerCase())==="true"||ln==="false")return ln==="true";if(""+ +ln===ln)return+ln;throw new Error("Could not parse value flag value "+ln+" for flag "+sn+".")}(nn,an)})}},Ke}();function a(Ke,Ge,$e){Ke[decodeURIComponent(Ge)]=decodeURIComponent($e||"")}function i(){return s}var s=null,u=new Map,c=new Map;function l(Ke,Ge){var $e=g(Ke,Ge);return u.get($e)}function h(Ke){return c.get(Ke)}function f(Ke){for(var Ge=u.entries(),$e=[];;){var Ye=Ge.next(),Qe=Ye.done,Je=Ye.value;if(Qe)break;var Mt=Je[0],nn=Je[1];Mt.split("_")[0]===Ke&&$e.push(nn)}return $e}function d(Ke){var Ge=Ke.kernelName,$e=Ke.backendName,Ye=g(Ge,$e);if(u.has(Ye))throw new Error("The kernel '"+Ge+"' for backend '"+$e+"' is already registered");u.set(Ye,Ke)}function p(Ke){var Ge=Ke.kernelName;c.has(Ge)&&console.warn("Overriding the gradient for '"+Ge+"'"),c.set(Ge,Ke)}function g(Ke,Ge){return Ge+"_"+Ke}function x(Ke,Ge,$e){return Math.max(Ke,Math.min(Ge,$e))}function b(Ke){return Ke%2==0?Ke:Ke+1}function w(Ke){for(var Ge=0,$e=0;$e<Ke.length;$e++)Ge+=Ke[$e];return Ge}function C(Ke,Ge){if(!Ke)throw new Error(typeof Ge=="string"?Ge:Ge())}function E(Ke,Ge,$e){$e===void 0&&($e=""),C(S(Ke,Ge),function(){return $e+" Shapes "+Ke+" and "+Ge+" must match"})}function R(Ke){C(Ke!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function I(Ke,Ge,$e){if(Ge===void 0&&(Ge=[]),$e===void 0&&($e=!1),Ge==null&&(Ge=[]),Array.isArray(Ke)||V(Ke)&&!$e)for(var Ye=0;Ye<Ke.length;++Ye)I(Ke[Ye],Ge,$e);else Ge.push(Ke);return Ge}function k(Ke){if(Ke.length===0)return 1;for(var Ge=Ke[0],$e=1;$e<Ke.length;$e++)Ge*=Ke[$e];return Ge}function S(Ke,Ge){if(Ke===Ge)return!0;if(Ke==null||Ge==null||Ke.length!==Ge.length)return!1;for(var $e=0;$e<Ke.length;$e++)if(Ke[$e]!==Ge[$e])return!1;return!0}function A(Ke){return Ke%1==0}function D(Ke){if(Math.tanh!=null)return Math.tanh(Ke);if(Ke===1/0)return 1;if(Ke===-1/0)return-1;var Ge=Math.exp(2*Ke);return(Ge-1)/(Ge+1)}function T(Ke){var Ge=Math.ceil(Math.sqrt(Ke));return[Ge,Math.ceil(Ke/Ge)]}function N(Ke,Ge){return Ge<=Ke.length?Ke:Ke+" ".repeat(Ge-Ke.length)}function F(Ke,Ge,$e){return Ge===void 0&&(Ge=function(Ye){return 0}),new Promise(function(Ye,Qe){var Je=0,Mt=function(){if(Ke())Ye();else{Je++;var nn=Ge(Je);$e!=null&&Je>=$e?Qe():setTimeout(Mt,nn)}};Mt()})}function _(Ke,Ge){for(var $e=1,Ye=-1,Qe=0;Qe<Ke.length;++Qe)if(Ke[Qe]>=0)$e*=Ke[Qe];else if(Ke[Qe]===-1){if(Ye!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+Ye+" and dim "+Qe);Ye=Qe}else if(Ke[Qe]<0)throw Error("Shapes can not be < 0. Found "+Ke[Qe]+" at dim "+Qe);if(Ye===-1){if(Ge>0&&Ge!==$e)throw Error("Size("+Ge+") must match the product of shape "+Ke);return Ke}if($e===0)throw Error("Cannot infer the missing size in ["+Ke+"] when there are 0 elements");if(Ge%$e!=0)throw Error("The implicit shape can't be a fractional number. Got "+Ge+" / "+$e);var Je=Ke.slice();return Je[Ye]=Ge/$e,Je}function O(Ke,Ge){var $e=Ge.length;return C((Ke=Ke==null?Ge.map(function(Ye,Qe){return Qe}):[].concat(Ke)).every(function(Ye){return Ye>=-$e&&Ye<$e}),function(){return"All values in axis param must be in range [-"+$e+", "+$e+") but got axis "+Ke}),C(Ke.every(function(Ye){return A(Ye)}),function(){return"All values in axis param must be integers but got axis "+Ke}),Ke.map(function(Ye){return Ye<0?$e+Ye:Ye})}function M(Ke,Ge){for(var $e=[],Ye=[],Qe=Ge!=null&&Array.isArray(Ge)&&Ge.length===0,Je=Ge==null||Qe?null:O(Ge,Ke).sort(),Mt=0,nn=0;nn<Ke.length;++nn){if(Je!=null){if(Je[Mt]===nn&&Ke[nn]!==1)throw new Error("Can't squeeze axis "+nn+" since its dim '"+Ke[nn]+"' is not 1");(Je[Mt]==null||Je[Mt]>nn)&&Ke[nn]===1&&($e.push(Ke[nn]),Ye.push(nn)),Je[Mt]<=nn&&Mt++}Ke[nn]!==1&&($e.push(Ke[nn]),Ye.push(nn))}return{newShape:$e,keptDims:Ye}}function B(Ke,Ge){var $e=null;if(Ke==null||Ke==="float32")$e=new Float32Array(Ge);else if(Ke==="int32")$e=new Int32Array(Ge);else{if(Ke!=="bool")throw new Error("Unknown data type "+Ke);$e=new Uint8Array(Ge)}return $e}function P(Ke,Ge){var $e=null;if(Ke==null||Ke==="float32")$e=new Float32Array(Ge);else if(Ke==="int32")$e=new Int32Array(Ge);else if(Ke==="bool")$e=new Uint8Array(Ge);else{if(Ke!=="string")throw new Error("Unknown data type "+Ke);$e=new Array(Ge)}return $e}function L(Ke,Ge){for(var $e=0;$e<Ke.length;$e++){var Ye=Ke[$e];if(isNaN(Ye)||!isFinite(Ye))throw Error("A tensor of type "+Ge+" being uploaded contains "+Ye+".")}}function W(Ke){return Ke==="bool"||Ke==="complex64"||Ke==="float32"||Ke==="int32"||Ke==="string"}function U(Ke,Ge){return Ge!=="complex64"&&(Ge!=="float32"||Ke==="complex64")&&(Ge!=="int32"||Ke==="float32"||Ke==="complex64")&&(Ge!=="bool"||Ke!=="bool")}function V(Ke){return Ke instanceof Float32Array||Ke instanceof Int32Array||Ke instanceof Uint8Array}function z(Ke){if(Ke==="float32"||Ke==="int32")return 4;if(Ke==="complex64")return 8;if(Ke==="bool")return 1;throw new Error("Unknown dtype "+Ke)}function G(Ke){if(Ke==null)return 0;var Ge=0;return Ke.forEach(function($e){return Ge+=$e.length}),Ge}function H(Ke){return typeof Ke=="string"||Ke instanceof String}function q(Ke){return typeof Ke=="boolean"}function K(Ke){return typeof Ke=="number"}function j(Ke){return Array.isArray(Ke)?j(Ke[0]):Ke instanceof Float32Array?"float32":Ke instanceof Int32Array||Ke instanceof Uint8Array?"int32":K(Ke)?"float32":H(Ke)?"string":q(Ke)?"bool":"float32"}function X(Ke){return!!(Ke&&Ke.constructor&&Ke.call&&Ke.apply)}function Y(Ke,Ge){for(var $e=Ge;$e<Ke;++$e)if(Ke%$e==0)return $e;return Ke}function $(Ke){var Ge=Ke.length;if(Ge<2)return[];var $e=new Array(Ge-1);$e[Ge-2]=Ke[Ge-1];for(var Ye=Ge-3;Ye>=0;--Ye)$e[Ye]=$e[Ye+1]*Ke[Ye+1];return $e}function Q(Ke,Ge,$e){if(Ge==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(Ke)&&(Ke=I(Ke)),$e&&L(Ke,Ge),function(Je,Mt){return Je instanceof Float32Array&&Mt==="float32"||Je instanceof Int32Array&&Mt==="int32"||Je instanceof Uint8Array&&Mt==="bool"}(Ke,Ge))return Ke;if(Ge==null||Ge==="float32"||Ge==="complex64")return new Float32Array(Ke);if(Ge==="int32")return new Int32Array(Ke);if(Ge==="bool"){for(var Ye=new Uint8Array(Ke.length),Qe=0;Qe<Ye.length;++Qe)Math.round(Ke[Qe])!==0&&(Ye[Qe]=1);return Ye}throw new Error("Unknown data type "+Ge)}function J(Ke,Ge){if(Ke.length===0)return Ge[0];var $e=Ke.reduce(function(Ye,Qe){return Ye*Qe});if($e===0)return[];if($e!==Ge.length)throw new Error("["+Ke+"] does not match the input size.");return function Ye(Qe,Je,Mt){var nn=new Array;if(Je.length===1)for(var an=Je[0],sn=0;sn<an;sn++)nn[sn]=Mt[Qe+sn];else{an=Je[0];var ln=Je.slice(1),fn=ln.reduce(function(hn,Xr){return hn*Xr});for(sn=0;sn<an;sn++)nn[sn]=Ye(Qe+sn*fn,ln,Mt)}return nn}(0,Ke,Ge)}function Z(Ke,Ge){for(var $e=tt(Ke,Ge),Ye=0;Ye<$e.length;Ye++)$e[Ye]=1;return $e}function tt(Ke,Ge){if(Ge==null||Ge==="float32"||Ge==="complex64")return new Float32Array(Ke);if(Ge==="int32")return new Int32Array(Ke);if(Ge==="bool")return new Uint8Array(Ke);throw new Error("Unknown data type "+Ge)}function et(){return i().platform.now()}function nt(Ke){Ke.forEach(function(Ge){C(Number.isInteger(Ge)&&Ge>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+Ke+"]."})})}function rt(Ke,Ge){return Ge===void 0&&(Ge="utf-8"),Ge=Ge||"utf-8",i().platform.encode(Ke,Ge)}function ot(Ke,Ge){return Ge===void 0&&(Ge="utf-8"),Ge=Ge||"utf-8",i().platform.decode(Ke,Ge)}function at(Ke,Ge,$e){if(Ge===0)return 0;if(Ge===1)return Ke[0];for(var Ye=Ke[Ke.length-1],Qe=0;Qe<Ke.length-1;++Qe)Ye+=$e[Qe]*Ke[Qe];return Ye}function it(Ke,Ge,$e){if(Ge===0)return[];if(Ge===1)return[Ke];for(var Ye=new Array(Ge),Qe=0;Qe<Ye.length-1;++Qe)Ye[Qe]=Math.floor(Ke/$e[Qe]),Ke-=Ye[Qe]*$e[Qe];return Ye[Ye.length-1]=Ke,Ye}var ut=function(){function Ke(Ge,$e){this.backendTimer=Ge,this.logger=$e,$e==null&&(this.logger=new ct)}return Ke.prototype.profileKernel=function(Ge,$e,Ye){var Qe,Je=this,Mt=this.backendTimer.time(function(){Qe=Ye()});return Qe.forEach(function(nn){nn.data().then(function(an){(function(sn,ln,fn){if(ln!=="float32")return!1;for(var hn=0;hn<sn.length;hn++){var Xr=sn[hn];if(isNaN(Xr)||!isFinite(Xr))return console.warn("Found "+Xr+" in the result of '"+fn+"'"),!0}})(an,nn.dtype,Ge),Mt.then(function(sn){var ln="";sn.getExtraProfileInfo!=null&&(ln=sn.getExtraProfileInfo()),Je.logger.logKernelProfile(Ge,nn,an,sn.kernelMs,$e,ln)})})}),Qe},Ke}(),ct=function(){function Ke(){}return Ke.prototype.logKernelProfile=function(Ge,$e,Ye,Qe,Je,Mt){var nn=typeof Qe=="number"?N(Qe+"ms",9):Qe.error,an=N(Ge,25),sn=$e.rank,ln=$e.size,fn=N($e.shape.toString(),14),hn="";for(var Xr in Je){var Mi=Je[Xr].shape||$e.shape,co=Mi.length;hn+=Xr+": "+co+"D "+(co>0?Mi:"")+" "}console.log("%c"+an+"	%c"+nn+"	%c"+sn+"D "+fn+"	%c"+ln+"	%c"+hn+"	%c"+Mt,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},Ke}(),lt=20,ht=3,ft=7;function dt(Ke,Ge,$e,Ye){var Qe=$(Ge),Je=function(sn,ln,fn,hn){var Xr=k(ln),Mi=hn[hn.length-1],co=new Array(Mi).fill(0),lo=ln.length,uo=fn==="complex64"?mt(sn):sn;if(lo>1)for(var ho=0;ho<Xr/Mi;ho++)for(var mo=ho*Mi,_d=0;_d<Mi;_d++)co[_d]=Math.max(co[_d],pt(uo[mo+_d],0,fn).length);return co}(Ke,Ge,$e,Qe),Mt=Ge.length,nn=function sn(ln,fn,hn,Xr,Mi,co){co===void 0&&(co=!0);var lo=hn==="complex64"?2:1,uo=fn[0],ho=fn.length;if(ho===0)return hn==="complex64"?[pt(mt(ln)[0],0,hn)]:hn==="bool"?[vt(ln[0])]:[ln[0].toString()];if(ho===1){if(uo>lt){var mo=ht*lo,_d=Array.from(ln.slice(0,mo)),ep=Array.from(ln.slice((uo-ht)*lo,uo*lo));return hn==="complex64"&&(_d=mt(_d),ep=mt(ep)),["["+_d.map(function(Np,wp){return pt(Np,Mi[wp],hn)}).join(", ")+", ..., "+ep.map(function(Np,wp){return pt(Np,Mi[uo-ht+wp],hn)}).join(", ")+"]"]}return["["+(hn==="complex64"?mt(ln):Array.from(ln)).map(function(Np,wp){return pt(Np,Mi[wp],hn)}).join(", ")+"]"]}var rp=fn.slice(1),sp=Xr.slice(1),op=Xr[0]*lo,ip=[];if(uo>lt){for(var lp=0;lp<ht;lp++){var vp=(gp=lp*op)+op;ip.push.apply(ip,sn(ln.slice(gp,vp),rp,hn,sp,Mi,!1))}for(ip.push("..."),lp=uo-ht;lp<uo;lp++)vp=(gp=lp*op)+op,ip.push.apply(ip,sn(ln.slice(gp,vp),rp,hn,sp,Mi,lp===uo-1))}else for(lp=0;lp<uo;lp++){var gp;vp=(gp=lp*op)+op,ip.push.apply(ip,sn(ln.slice(gp,vp),rp,hn,sp,Mi,lp===uo-1))}var Op=ho===2?",":"";for(ip[0]="["+ip[0]+Op,lp=1;lp<ip.length-1;lp++)ip[lp]=" "+ip[lp]+Op;var Mp=`,
`;for(lp=2;lp<ho;lp++)Mp+=`
`;return ip[ip.length-1]=" "+ip[ip.length-1]+"]"+(co?"":Mp),ip}(Ke,Ge,$e,Qe,Je),an=["Tensor"];return Ye&&(an.push("  dtype: "+$e),an.push("  rank: "+Mt),an.push("  shape: ["+Ge+"]"),an.push("  values:")),an.push(nn.map(function(sn){return"    "+sn}).join(`
`)),an.join(`
`)}function pt(Ke,Ge,$e){return N(Array.isArray(Ke)?parseFloat(Ke[0].toFixed(ft))+" + "+parseFloat(Ke[1].toFixed(ft))+"j":H(Ke)?"'"+Ke+"'":$e==="bool"?vt(Ke):parseFloat(Ke.toFixed(ft)).toString(),Ge)}function vt(Ke){return Ke===0?"false":"true"}function mt(Ke){for(var Ge=[],$e=0;$e<Ke.length;$e+=2)Ge.push([Ke[$e],Ke[$e+1]]);return Ge}var gt=function(){function Ke(Ge,$e,Ye){var Qe=this;if(this.dtype=$e,this.shape=Ge.slice(),this.size=k(Ge),Ye!=null){var Je=Ye.length;C(Je===this.size,function(){return"Length of values '"+Je+"' does not match the size inferred by the shape '"+Qe.size+"'."})}if($e==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=Ye||P($e,this.size),this.strides=$(Ge)}return Ke.prototype.set=function(Ge){for(var $e=this,Ye=[],Qe=1;Qe<arguments.length;Qe++)Ye[Qe-1]=arguments[Qe];Ye.length===0&&(Ye=[0]),C(Ye.length===this.rank,function(){return"The number of provided coordinates ("+Ye.length+") must match the rank ("+$e.rank+")"});var Je=this.locToIndex(Ye);this.values[Je]=Ge},Ke.prototype.get=function(){for(var Ge=[],$e=0;$e<arguments.length;$e++)Ge[$e]=arguments[$e];Ge.length===0&&(Ge=[0]);for(var Ye=0,Qe=0,Je=Ge;Qe<Je.length;Qe++){var Mt=Je[Qe];if(Mt<0||Mt>=this.shape[Ye]){var nn="Requested out of range element at "+Ge+".   Buffer shape="+this.shape;throw new Error(nn)}Ye++}for(var an=Ge[Ge.length-1],sn=0;sn<Ge.length-1;++sn)an+=this.strides[sn]*Ge[sn];return this.values[an]},Ke.prototype.locToIndex=function(Ge){if(this.rank===0)return 0;if(this.rank===1)return Ge[0];for(var $e=Ge[Ge.length-1],Ye=0;Ye<Ge.length-1;++Ye)$e+=this.strides[Ye]*Ge[Ye];return $e},Ke.prototype.indexToLoc=function(Ge){if(this.rank===0)return[];if(this.rank===1)return[Ge];for(var $e=new Array(this.shape.length),Ye=0;Ye<$e.length-1;++Ye)$e[Ye]=Math.floor(Ge/this.strides[Ye]),Ge-=$e[Ye]*this.strides[Ye];return $e[$e.length-1]=Ge,$e},Object.defineProperty(Ke.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),Ke.prototype.toTensor=function(){return yt().makeTensor(this.values,this.shape,this.dtype)},Ke}(),yt=null,xt=null,bt=null,wt=function(){function Ke(Ge,$e,Ye,Qe){this.kept=!1,this.isDisposedInternal=!1,this.shape=Ge.slice(),this.dtype=$e||"float32",this.size=k(Ge),this.strides=$(Ge),this.dataId=Ye,this.id=Qe,this.rankType=this.rank<5?this.rank.toString():"higher"}return Ke.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},Ke.prototype.asScalar=function(){return this.throwIfDisposed(),C(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},Ke.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},Ke.prototype.as2D=function(Ge,$e){return this.throwIfDisposed(),this.reshape([Ge,$e])},Ke.prototype.as3D=function(Ge,$e,Ye){return this.throwIfDisposed(),this.reshape([Ge,$e,Ye])},Ke.prototype.as4D=function(Ge,$e,Ye,Qe){return this.throwIfDisposed(),this.reshape([Ge,$e,Ye,Qe])},Ke.prototype.as5D=function(Ge,$e,Ye,Qe,Je){return this.throwIfDisposed(),this.reshape([Ge,$e,Ye,Qe,Je])},Ke.prototype.asType=function(Ge){return this.throwIfDisposed(),xt.cast(this,Ge)},Object.defineProperty(Ke.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),Ke.prototype.buffer=function(){return n(this,void 0,void 0,function(){var Ge;return r(this,function($e){switch($e.label){case 0:return[4,this.data()];case 1:return Ge=$e.sent(),[2,xt.buffer(this.shape,this.dtype,Ge)]}})})},Ke.prototype.bufferSync=function(){return xt.buffer(this.shape,this.dtype,this.dataSync())},Ke.prototype.array=function(){return n(this,void 0,void 0,function(){var Ge;return r(this,function($e){switch($e.label){case 0:return[4,this.data()];case 1:return Ge=$e.sent(),[2,J(this.shape,Ge)]}})})},Ke.prototype.arraySync=function(){return J(this.shape,this.dataSync())},Ke.prototype.data=function(){return n(this,void 0,void 0,function(){var Ge,$e;return r(this,function(Ye){switch(Ye.label){case 0:return this.throwIfDisposed(),Ge=yt().read(this.dataId),this.dtype!=="string"?[3,2]:[4,Ge];case 1:$e=Ye.sent();try{return[2,$e.map(function(Qe){return ot(Qe)})]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}Ye.label=2;case 2:return[2,Ge]}})})},Ke.prototype.dataSync=function(){this.throwIfDisposed();var Ge=yt().readSync(this.dataId);if(this.dtype==="string")try{return Ge.map(function($e){return ot($e)})}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return Ge},Ke.prototype.bytes=function(){return n(this,void 0,void 0,function(){var Ge;return r(this,function($e){switch($e.label){case 0:return this.throwIfDisposed(),[4,yt().read(this.dataId)];case 1:return Ge=$e.sent(),this.dtype==="string"?[2,Ge]:[2,new Uint8Array(Ge.buffer)]}})})},Ke.prototype.dispose=function(){this.isDisposed||(yt().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(Ke.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),Ke.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},Ke.prototype.toFloat=function(){return this.asType("float32")},Ke.prototype.toInt=function(){return this.asType("int32")},Ke.prototype.toBool=function(){return this.asType("bool")},Ke.prototype.print=function(Ge){return Ge===void 0&&(Ge=!1),xt.print(this,Ge)},Ke.prototype.reshape=function(Ge){return this.throwIfDisposed(),xt.reshape(this,Ge)},Ke.prototype.reshapeAs=function(Ge){return this.throwIfDisposed(),this.reshape(Ge.shape)},Ke.prototype.expandDims=function(Ge){return Ge===void 0&&(Ge=0),xt.expandDims(this,Ge)},Ke.prototype.cumsum=function(Ge,$e,Ye){return Ge===void 0&&(Ge=0),$e===void 0&&($e=!1),Ye===void 0&&(Ye=!1),xt.cumsum(this,Ge,$e,Ye)},Ke.prototype.squeeze=function(Ge){return this.throwIfDisposed(),xt.squeeze(this,Ge)},Ke.prototype.clone=function(){return this.throwIfDisposed(),xt.clone(this)},Ke.prototype.oneHot=function(Ge,$e,Ye){return this.throwIfDisposed(),xt.oneHot(this,Ge,$e,Ye)},Ke.prototype.toString=function(Ge){return Ge===void 0&&(Ge=!1),dt(this.dataSync(),this.shape,this.dtype,Ge)},Ke.prototype.tile=function(Ge){return this.throwIfDisposed(),xt.tile(this,Ge)},Ke.prototype.gather=function(Ge,$e){return $e===void 0&&($e=0),this.throwIfDisposed(),xt.gather(this,Ge,$e)},Ke.prototype.matMul=function(Ge,$e,Ye){return $e===void 0&&($e=!1),Ye===void 0&&(Ye=!1),this.throwIfDisposed(),xt.matMul(this,Ge,$e,Ye)},Ke.prototype.dot=function(Ge){return this.throwIfDisposed(),xt.dot(this,Ge)},Ke.prototype.norm=function(Ge,$e,Ye){return Ge===void 0&&(Ge="euclidean"),$e===void 0&&($e=null),Ye===void 0&&(Ye=!1),this.throwIfDisposed(),xt.norm(this,Ge,$e,Ye)},Ke.prototype.slice=function(Ge,$e){return this.throwIfDisposed(),xt.slice(this,Ge,$e)},Ke.prototype.reverse=function(Ge){return this.throwIfDisposed(),xt.reverse(this,Ge)},Ke.prototype.concat=function(Ge,$e){return $e===void 0&&($e=0),this.throwIfDisposed(),Ge instanceof Ke&&(Ge=[Ge]),xt.concat([this].concat(Ge),$e)},Ke.prototype.split=function(Ge,$e){return $e===void 0&&($e=0),this.throwIfDisposed(),xt.split(this,Ge,$e)},Ke.prototype.stack=function(Ge,$e){return $e===void 0&&($e=0),xt.stack([this,Ge],$e)},Ke.prototype.unstack=function(Ge){return Ge===void 0&&(Ge=0),xt.unstack(this,Ge)},Ke.prototype.pad=function(Ge,$e){return $e===void 0&&($e=0),xt.pad(this,Ge,$e)},Ke.prototype.batchNormalization=function(Ge,$e,Ye,Qe,Je){return Ye===void 0&&(Ye=.001),bt("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(Ge,$e,Je,Qe,Ye)},Ke.prototype.batchNorm=function(Ge,$e,Ye,Qe,Je){return Je===void 0&&(Je=.001),this.throwIfDisposed(),xt.batchNorm(this,Ge,$e,Ye,Qe,Je)},Ke.prototype.all=function(Ge,$e){return Ge===void 0&&(Ge=null),$e===void 0&&($e=!1),this.throwIfDisposed(),xt.all(this,Ge,$e)},Ke.prototype.any=function(Ge,$e){return Ge===void 0&&(Ge=null),$e===void 0&&($e=!1),this.throwIfDisposed(),xt.any(this,Ge,$e)},Ke.prototype.logSumExp=function(Ge,$e){return Ge===void 0&&(Ge=null),$e===void 0&&($e=!1),this.throwIfDisposed(),xt.logSumExp(this,Ge,$e)},Ke.prototype.sum=function(Ge,$e){return Ge===void 0&&(Ge=null),$e===void 0&&($e=!1),this.throwIfDisposed(),xt.sum(this,Ge,$e)},Ke.prototype.prod=function(Ge,$e){return Ge===void 0&&(Ge=null),$e===void 0&&($e=!1),this.throwIfDisposed(),xt.prod(this,Ge,$e)},Ke.prototype.mean=function(Ge,$e){return Ge===void 0&&(Ge=null),$e===void 0&&($e=!1),this.throwIfDisposed(),xt.mean(this,Ge,$e)},Ke.prototype.min=function(Ge,$e){return Ge===void 0&&(Ge=null),$e===void 0&&($e=!1),this.throwIfDisposed(),xt.min(this,Ge,$e)},Ke.prototype.max=function(Ge,$e){return Ge===void 0&&(Ge=null),$e===void 0&&($e=!1),this.throwIfDisposed(),xt.max(this,Ge,$e)},Ke.prototype.argMin=function(Ge){return Ge===void 0&&(Ge=null),this.throwIfDisposed(),xt.argMin(this,Ge)},Ke.prototype.argMax=function(Ge){return Ge===void 0&&(Ge=null),this.throwIfDisposed(),xt.argMax(this,Ge)},Ke.prototype.cast=function(Ge){return this.throwIfDisposed(),xt.cast(this,Ge)},Ke.prototype.add=function(Ge){return this.throwIfDisposed(),xt.add(this,Ge)},Ke.prototype.addStrict=function(Ge){return this.throwIfDisposed(),xt.addStrict(this,Ge)},Ke.prototype.atan2=function(Ge){return this.throwIfDisposed(),xt.atan2(this,Ge)},Ke.prototype.sub=function(Ge){return this.throwIfDisposed(),xt.sub(this,Ge)},Ke.prototype.subStrict=function(Ge){return this.throwIfDisposed(),xt.subStrict(this,Ge)},Ke.prototype.pow=function(Ge){return this.throwIfDisposed(),xt.pow(this,Ge)},Ke.prototype.powStrict=function(Ge){return this.throwIfDisposed(),xt.powStrict(this,Ge)},Ke.prototype.mul=function(Ge){return this.throwIfDisposed(),xt.mul(this,Ge)},Ke.prototype.mulStrict=function(Ge){return this.throwIfDisposed(),xt.mulStrict(this,Ge)},Ke.prototype.div=function(Ge){return this.throwIfDisposed(),xt.div(this,Ge)},Ke.prototype.divNoNan=function(Ge){return this.throwIfDisposed(),xt.divNoNan(this,Ge)},Ke.prototype.floorDiv=function(Ge){return this.throwIfDisposed(),xt.floorDiv(this,Ge)},Ke.prototype.divStrict=function(Ge){return this.throwIfDisposed(),xt.divStrict(this,Ge)},Ke.prototype.minimum=function(Ge){return this.throwIfDisposed(),xt.minimum(this,Ge)},Ke.prototype.minimumStrict=function(Ge){return this.throwIfDisposed(),xt.minimumStrict(this,Ge)},Ke.prototype.maximum=function(Ge){return this.throwIfDisposed(),xt.maximum(this,Ge)},Ke.prototype.maximumStrict=function(Ge){return this.throwIfDisposed(),xt.maximumStrict(this,Ge)},Ke.prototype.mod=function(Ge){return this.throwIfDisposed(),xt.mod(this,Ge)},Ke.prototype.modStrict=function(Ge){return this.throwIfDisposed(),xt.modStrict(this,Ge)},Ke.prototype.squaredDifferenceStrict=function(Ge){return this.throwIfDisposed(),xt.squaredDifferenceStrict(this,Ge)},Ke.prototype.transpose=function(Ge){return this.throwIfDisposed(),xt.transpose(this,Ge)},Ke.prototype.notEqual=function(Ge){return this.throwIfDisposed(),xt.notEqual(this,Ge)},Ke.prototype.notEqualStrict=function(Ge){return this.throwIfDisposed(),xt.notEqualStrict(this,Ge)},Ke.prototype.less=function(Ge){return this.throwIfDisposed(),xt.less(this,Ge)},Ke.prototype.lessStrict=function(Ge){return this.throwIfDisposed(),xt.lessStrict(this,Ge)},Ke.prototype.equal=function(Ge){return this.throwIfDisposed(),xt.equal(this,Ge)},Ke.prototype.equalStrict=function(Ge){return this.throwIfDisposed(),xt.equalStrict(this,Ge)},Ke.prototype.lessEqual=function(Ge){return this.throwIfDisposed(),xt.lessEqual(this,Ge)},Ke.prototype.lessEqualStrict=function(Ge){return this.throwIfDisposed(),xt.lessEqualStrict(this,Ge)},Ke.prototype.greater=function(Ge){return this.throwIfDisposed(),xt.greater(this,Ge)},Ke.prototype.greaterStrict=function(Ge){return this.throwIfDisposed(),xt.greaterStrict(this,Ge)},Ke.prototype.greaterEqual=function(Ge){return this.throwIfDisposed(),xt.greaterEqual(this,Ge)},Ke.prototype.greaterEqualStrict=function(Ge){return this.throwIfDisposed(),xt.greaterEqualStrict(this,Ge)},Ke.prototype.logicalAnd=function(Ge){return this.throwIfDisposed(),xt.logicalAnd(this,Ge)},Ke.prototype.logicalOr=function(Ge){return this.throwIfDisposed(),xt.logicalOr(this,Ge)},Ke.prototype.logicalNot=function(){return this.throwIfDisposed(),xt.logicalNot(this)},Ke.prototype.logicalXor=function(Ge){return this.throwIfDisposed(),xt.logicalXor(this,Ge)},Ke.prototype.where=function(Ge,$e){return this.throwIfDisposed(),xt.where(Ge,this,$e)},Ke.prototype.neg=function(){return this.throwIfDisposed(),xt.neg(this)},Ke.prototype.ceil=function(){return this.throwIfDisposed(),xt.ceil(this)},Ke.prototype.floor=function(){return this.throwIfDisposed(),xt.floor(this)},Ke.prototype.sign=function(){return this.throwIfDisposed(),xt.sign(this)},Ke.prototype.isNaN=function(){return this.throwIfDisposed(),xt.isNaN(this)},Ke.prototype.isInf=function(){return this.throwIfDisposed(),xt.isInf(this)},Ke.prototype.isFinite=function(){return this.throwIfDisposed(),xt.isFinite(this)},Ke.prototype.exp=function(){return this.throwIfDisposed(),xt.exp(this)},Ke.prototype.expm1=function(){return this.throwIfDisposed(),xt.expm1(this)},Ke.prototype.log=function(){return this.throwIfDisposed(),xt.log(this)},Ke.prototype.log1p=function(){return this.throwIfDisposed(),xt.log1p(this)},Ke.prototype.sqrt=function(){return this.throwIfDisposed(),xt.sqrt(this)},Ke.prototype.rsqrt=function(){return this.throwIfDisposed(),xt.rsqrt(this)},Ke.prototype.square=function(){return this.throwIfDisposed(),xt.square(this)},Ke.prototype.reciprocal=function(){return this.throwIfDisposed(),xt.reciprocal(this)},Ke.prototype.abs=function(){return this.throwIfDisposed(),xt.abs(this)},Ke.prototype.clipByValue=function(Ge,$e){return this.throwIfDisposed(),xt.clipByValue(this,Ge,$e)},Ke.prototype.relu=function(){return this.throwIfDisposed(),xt.relu(this)},Ke.prototype.relu6=function(){return this.throwIfDisposed(),xt.relu6(this)},Ke.prototype.elu=function(){return this.throwIfDisposed(),xt.elu(this)},Ke.prototype.selu=function(){return this.throwIfDisposed(),xt.selu(this)},Ke.prototype.leakyRelu=function(Ge){return Ge===void 0&&(Ge=.2),this.throwIfDisposed(),xt.leakyRelu(this,Ge)},Ke.prototype.prelu=function(Ge){return this.throwIfDisposed(),xt.prelu(this,Ge)},Ke.prototype.sigmoid=function(){return this.throwIfDisposed(),xt.sigmoid(this)},Ke.prototype.logSigmoid=function(){return this.throwIfDisposed(),xt.logSigmoid(this)},Ke.prototype.softplus=function(){return this.throwIfDisposed(),xt.softplus(this)},Ke.prototype.zerosLike=function(){return this.throwIfDisposed(),xt.zerosLike(this)},Ke.prototype.onesLike=function(){return this.throwIfDisposed(),xt.onesLike(this)},Ke.prototype.sin=function(){return this.throwIfDisposed(),xt.sin(this)},Ke.prototype.cos=function(){return this.throwIfDisposed(),xt.cos(this)},Ke.prototype.tan=function(){return this.throwIfDisposed(),xt.tan(this)},Ke.prototype.asin=function(){return this.throwIfDisposed(),xt.asin(this)},Ke.prototype.acos=function(){return this.throwIfDisposed(),xt.acos(this)},Ke.prototype.atan=function(){return this.throwIfDisposed(),xt.atan(this)},Ke.prototype.sinh=function(){return this.throwIfDisposed(),xt.sinh(this)},Ke.prototype.cosh=function(){return this.throwIfDisposed(),xt.cosh(this)},Ke.prototype.tanh=function(){return this.throwIfDisposed(),xt.tanh(this)},Ke.prototype.asinh=function(){return this.throwIfDisposed(),xt.asinh(this)},Ke.prototype.acosh=function(){return this.throwIfDisposed(),xt.acosh(this)},Ke.prototype.atanh=function(){return this.throwIfDisposed(),xt.atanh(this)},Ke.prototype.erf=function(){return this.throwIfDisposed(),xt.erf(this)},Ke.prototype.round=function(){return this.throwIfDisposed(),xt.round(this)},Ke.prototype.step=function(Ge){return Ge===void 0&&(Ge=0),this.throwIfDisposed(),xt.step(this,Ge)},Ke.prototype.softmax=function(Ge){return Ge===void 0&&(Ge=-1),this.throwIfDisposed(),xt.softmax(this,Ge)},Ke.prototype.logSoftmax=function(Ge){return Ge===void 0&&(Ge=-1),this.throwIfDisposed(),xt.logSoftmax(this,Ge)},Ke.prototype.resizeBilinear=function(Ge,$e){return $e===void 0&&($e=!1),this.throwIfDisposed(),xt.image.resizeBilinear(this,Ge,$e)},Ke.prototype.resizeNearestNeighbor=function(Ge,$e){return $e===void 0&&($e=!1),this.throwIfDisposed(),xt.image.resizeNearestNeighbor(this,Ge,$e)},Ke.prototype.conv1d=function(Ge,$e,Ye,Qe,Je,Mt){return Qe===void 0&&(Qe="NWC"),Je===void 0&&(Je=1),this.throwIfDisposed(),xt.conv1d(this,Ge,$e,Ye,Qe,Je,Mt)},Ke.prototype.conv2d=function(Ge,$e,Ye,Qe,Je,Mt){return Qe===void 0&&(Qe="NHWC"),Je===void 0&&(Je=[1,1]),this.throwIfDisposed(),xt.conv2d(this,Ge,$e,Ye,Qe,Je,Mt)},Ke.prototype.conv2dTranspose=function(Ge,$e,Ye,Qe,Je){return this.throwIfDisposed(),xt.conv2dTranspose(this,Ge,$e,Ye,Qe,Je)},Ke.prototype.depthwiseConv2D=function(Ge,$e,Ye,Qe,Je,Mt){return Qe===void 0&&(Qe="NHWC"),Je===void 0&&(Je=[1,1]),this.throwIfDisposed(),xt.depthwiseConv2d(this,Ge,$e,Ye,Qe,Je,Mt)},Ke.prototype.separableConv2d=function(Ge,$e,Ye,Qe,Je,Mt){return Je===void 0&&(Je=[1,1]),Mt===void 0&&(Mt="NHWC"),this.throwIfDisposed(),xt.separableConv2d(this,Ge,$e,Ye,Qe,Je,Mt)},Ke.prototype.avgPool=function(Ge,$e,Ye,Qe){return this.throwIfDisposed(),xt.avgPool(this,Ge,$e,Ye,Qe)},Ke.prototype.maxPool=function(Ge,$e,Ye,Qe){return this.throwIfDisposed(),xt.maxPool(this,Ge,$e,Ye,Qe)},Ke.prototype.localResponseNormalization=function(Ge,$e,Ye,Qe){return Ge===void 0&&(Ge=5),$e===void 0&&($e=1),Ye===void 0&&(Ye=1),Qe===void 0&&(Qe=.5),xt.localResponseNormalization(this,Ge,$e,Ye,Qe)},Ke.prototype.pool=function(Ge,$e,Ye,Qe,Je){return this.throwIfDisposed(),xt.pool(this,Ge,$e,Ye,Qe,Je)},Ke.prototype.variable=function(Ge,$e,Ye){return Ge===void 0&&(Ge=!0),this.throwIfDisposed(),yt().makeVariable(this,Ge,$e,Ye)},Ke.prototype.unsortedSegmentSum=function(Ge,$e){return this.throwIfDisposed(),xt.unsortedSegmentSum(this,Ge,$e)},Ke.prototype.batchToSpaceND=function(Ge,$e){return this.throwIfDisposed(),xt.batchToSpaceND(this,Ge,$e)},Ke.prototype.spaceToBatchND=function(Ge,$e){return this.throwIfDisposed(),xt.spaceToBatchND(this,Ge,$e)},Ke.prototype.topk=function(Ge,$e){return Ge===void 0&&(Ge=1),$e===void 0&&($e=!0),this.throwIfDisposed(),xt.topk(this,Ge,$e)},Ke.prototype.stridedSlice=function(Ge,$e,Ye,Qe,Je,Mt,nn,an){return Qe===void 0&&(Qe=0),Je===void 0&&(Je=0),Mt===void 0&&(Mt=0),nn===void 0&&(nn=0),an===void 0&&(an=0),this.throwIfDisposed(),xt.stridedSlice(this,Ge,$e,Ye,Qe,Je,Mt,nn,an)},Ke.prototype.depthToSpace=function(Ge,$e){return this.throwIfDisposed(),xt.depthToSpace(this,Ge,$e)},Ke.prototype.fft=function(){return this.throwIfDisposed(),xt.spectral.fft(this)},Ke.prototype.ifft=function(){return this.throwIfDisposed(),xt.spectral.ifft(this)},Ke.prototype.rfft=function(){return this.throwIfDisposed(),xt.spectral.rfft(this)},Ke.prototype.irfft=function(){return this.throwIfDisposed(),xt.spectral.irfft(this)},Ke}();Object.defineProperty(wt,Symbol.hasInstance,{value:function(Ke){return!!Ke&&Ke.dataId!=null&&Ke.shape!=null&&Ke.dtype!=null}});var Ct,Et,Rt,It,kt,St=function(Ke){function Ge($e,Ye,Qe,Je){var Mt=Ke.call(this,$e.shape,$e.dtype,$e.dataId,Je)||this;return Mt.trainable=Ye,Mt.name=Qe,Mt}return e(Ge,Ke),Ge.prototype.assign=function($e){if($e.dtype!==this.dtype)throw new Error("dtype of the new value ("+$e.dtype+") and previous value ("+this.dtype+") must match");if(!S($e.shape,this.shape))throw new Error("shape of the new value ("+$e.shape+") and previous value ("+this.shape+") must match");yt().disposeTensor(this),this.dataId=$e.dataId,yt().incRef(this,null)},Ge.prototype.dispose=function(){yt().disposeVariable(this),this.isDisposedInternal=!0},Ge}(wt);Object.defineProperty(St,Symbol.hasInstance,{value:function(Ke){return Ke instanceof wt&&Ke.assign!=null&&Ke.assign instanceof Function}}),function(Ke){Ke.R0="R0",Ke.R1="R1",Ke.R2="R2",Ke.R3="R3",Ke.R4="R4",Ke.R5="R5",Ke.R6="R6"}(Ct||(Ct={})),function(Ke){Ke.float32="float32",Ke.int32="int32",Ke.bool="int32",Ke.complex64="complex64"}(Et||(Et={})),function(Ke){Ke.float32="float32",Ke.int32="int32",Ke.bool="bool",Ke.complex64="complex64"}(Rt||(Rt={})),function(Ke){Ke.float32="float32",Ke.int32="float32",Ke.bool="float32",Ke.complex64="complex64"}(It||(It={})),function(Ke){Ke.float32="complex64",Ke.int32="complex64",Ke.bool="complex64",Ke.complex64="complex64"}(kt||(kt={}));var At={float32:It,int32:Et,bool:Rt,complex64:kt};function Dt(Ke,Ge){if(Ke==="string"||Ge==="string"){if(Ke==="string"&&Ge==="string")return"string";throw new Error("Can not upcast "+Ke+" with "+Ge)}return At[Ke][Ge]}function Tt(Ke){return Dt(Ke,"int32")}function Nt(Ke,Ge){if(Ke.dtype===Ge.dtype)return[Ke,Ge];var $e=Dt(Ke.dtype,Ge.dtype);return[Ke.cast($e),Ge.cast($e)]}function Ft(Ke,Ge){C(Ke.dtype===Ge.dtype,function(){return"The dtypes of the first("+Ke.dtype+") and second("+Ge.dtype+") input must match"})}function _t(Ke){var Ge=[];return function $e(Ye,Qe,Je){if(Ye!=null){if(Ye instanceof wt)return void Qe.push(Ye);if(Mt=Ye,!(!Array.isArray(Mt)&&typeof Mt!="object")){var Mt,nn=Ye;for(var an in nn){var sn=nn[an];Je.has(sn)||(Je.add(sn),$e(sn,Qe,Je))}}}}(Ke,Ge,new Set),Ge}var Ot,Bt=function(){function Ke(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return Ke.prototype.dispose=function(){for(var Ge in this.registeredVariables)this.registeredVariables[Ge].dispose()},Ke}(),Pt=function(){function Ke(Ge){this.ENV=Ge,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Bt}return Ke.prototype.ready=function(){return n(this,void 0,void 0,function(){var Ge,$e,Ye;return r(this,function(Qe){switch(Qe.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];Ge=this.getSortedBackends(),$e=0,Qe.label=1;case 1:return $e<Ge.length?(Ye=Ge[$e],[4,this.initializeBackend(Ye).success]):[3,5];case 2:return Qe.sent()?[4,this.setBackend(Ye)]:[3,4];case 3:return Qe.sent(),[2];case 4:return $e++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(Ke.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var Ge=this.initializeBackendsAndReturnBest(),$e=Ge.name;if(Ge.asyncInit)throw new Error("The highest priority backend '"+$e+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend($e)}return this.backendInstance},enumerable:!0,configurable:!0}),Ke.prototype.backendNames=function(){return Object.keys(this.registryFactory)},Ke.prototype.findBackend=function(Ge){return!(Ge in this.registry)&&(!(Ge in this.registryFactory)||this.initializeBackend(Ge).asyncInit)?null:this.registry[Ge]},Ke.prototype.findBackendFactory=function(Ge){return Ge in this.registryFactory?this.registryFactory[Ge].factory:null},Ke.prototype.registerBackend=function(Ge,$e,Ye){return Ye===void 0&&(Ye=1),Ge in this.registryFactory?(console.warn(Ge+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[Ge]={factory:$e,priority:Ye},!0)},Ke.prototype.setBackend=function(Ge){return n(this,void 0,void 0,function(){var $e,Ye,Qe;return r(this,function(Je){switch(Je.label){case 0:if(this.registryFactory[Ge]==null)throw new Error("Backend name '"+Ge+"' not found in registry");return this.backendName=Ge,this.registry[Ge]!=null?[3,4]:(this.backendInstance=null,$e=this.initializeBackend(Ge),Ye=$e.success,$e.asyncInit?[4,Ye]:[3,2]);case 1:return Qe=Je.sent(),[3,3];case 2:Qe=Ye,Je.label=3;case 3:if(!Qe)return[2,!1];Je.label=4;case 4:return this.backendInstance=this.registry[Ge],this.setupRegisteredKernels(),this.profiler=new ut(this.backendInstance),[2,!0]}})})},Ke.prototype.setupRegisteredKernels=function(){var Ge=this;f(this.backendName).forEach(function($e){$e.setupFunc!=null&&$e.setupFunc(Ge.backendInstance)})},Ke.prototype.disposeRegisteredKernels=function(Ge){var $e=this;f(Ge).forEach(function(Ye){Ye.disposeFunc!=null&&Ye.disposeFunc($e.registry[Ge])})},Ke.prototype.initializeBackend=function(Ge){var $e=this,Ye=this.registryFactory[Ge];if(Ye==null)throw new Error("Cannot initialize backend "+Ge+", no registration found.");try{var Qe=Ye.factory();if(Promise.resolve(Qe)===Qe){var Je=++this.pendingBackendInitId,Mt=Qe.then(function(nn){return!(Je<$e.pendingBackendInitId)&&($e.registry[Ge]=nn,$e.pendingBackendInit=null,!0)}).catch(function(nn){return!(Je<$e.pendingBackendInitId)&&($e.pendingBackendInit=null,console.warn("Initialization of backend "+Ge+" failed"),console.warn(nn.stack||nn.message),!1)});return this.pendingBackendInit=Mt,{success:Mt,asyncInit:!0}}return this.registry[Ge]=Qe,{success:!0,asyncInit:!1}}catch(nn){return console.warn("Initialization of backend "+Ge+" failed"),console.warn(nn.stack||nn.message),{success:!1,asyncInit:!1}}},Ke.prototype.removeBackend=function(Ge){if(!(Ge in this.registryFactory))throw new Error(Ge+" backend not found in registry");this.backendName===Ge&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,Ge in this.registry&&(this.disposeRegisteredKernels(Ge),this.registry[Ge].dispose(),delete this.registry[Ge]),delete this.registryFactory[Ge],this.backendName===Ge&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},Ke.prototype.getSortedBackends=function(){var Ge=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function($e,Ye){return Ge.registryFactory[Ye].priority-Ge.registryFactory[$e].priority})},Ke.prototype.initializeBackendsAndReturnBest=function(){for(var Ge=this.getSortedBackends(),$e=0;$e<Ge.length;$e++){var Ye=Ge[$e],Qe=this.initializeBackend(Ye),Je=Qe.success,Mt=Qe.asyncInit;if(Mt||Je)return{name:Ye,asyncInit:Mt}}throw new Error("Could not initialize any backends, all backend initializations failed.")},Ke.prototype.moveData=function(Ge,$e){var Ye=this.state.tensorInfo.get($e),Qe=Ye.backend,Je=this.readSync($e);Qe.disposeData($e),Ye.backend=Ge,Ge.move($e,Je,Ye.shape,Ye.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},Ke.prototype.tidy=function(Ge,$e){var Ye,Qe=this,Je=null;if($e==null){if(typeof Ge!="function")throw new Error("Please provide a function to tidy()");$e=Ge}else{if(typeof Ge!="string"&&!(Ge instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof $e!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");Je=Ge}return this.scopedRun(function(){return Qe.startScope(Je)},function(){return Qe.endScope(Ye)},function(){return(Ye=$e())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),Ye})},Ke.prototype.scopedRun=function(Ge,$e,Ye){Ge();try{var Qe=Ye();return $e(),Qe}catch(Je){throw $e(),Je}},Ke.prototype.nextTensorId=function(){return Ke.nextTensorId++},Ke.prototype.nextVariableId=function(){return Ke.nextVariableId++},Ke.prototype.clone=function(Ge){var $e=this.makeTensorFromDataId(Ge.dataId,Ge.shape,Ge.dtype),Ye={x:Ge};return this.addTapeNode(this.state.activeScope.name,Ye,[$e],function(Qe){return{x:function(){return Qe.toFloat()}}},[]),$e},Ke.prototype.runKernel=function(Ge,$e,Ye,Qe,Je){return this.runKernelFunc(null,$e,null,Ge,Ye,Qe,Je)},Ke.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},Ke.prototype.checkKernelForMemLeak=function(Ge,$e,Ye){var Qe=this.backend.numDataIds(),Je=0;Ye.forEach(function(an){Je+=an.dtype==="complex64"?3:1});var Mt=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],nn=Qe-$e-Je-Mt;if(nn>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+nn+" data ids) after running '"+Ge+"'")},Ke.prototype.runKernelFunc=function(Ge,$e,Ye,Qe,Je,Mt,nn){var an,sn=this;Mt===void 0&&(Mt=[]),nn===void 0&&(nn=[]);var ln=[],fn=this.isTapeOn();Qe==null&&(Qe=this.state.activeScope!=null?this.state.activeScope.name:"");var hn,Xr=function(ho){fn&&(ln=ho.map(function(mo){return sn.keep(sn.clone(mo))}))},Mi=this.state.numBytes,co=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var lo,uo=l(Qe,this.backendName);return hn=uo!=null?function(){var ho=sn.backend.numDataIds();lo=uo.kernelFunc({inputs:$e,attrs:Je,backend:sn.backend});var mo=Array.isArray(lo)?lo:[lo];sn.shouldCheckForMemLeaks()&&sn.checkKernelForMemLeak(Qe,ho,mo);var _d=mo.map(function(rp){var sp=rp.dataId,op=rp.shape,ip=rp.dtype;return sn.makeTensorFromDataId(sp,op,ip)}),ep=_d.filter(function(rp,sp){return nn[sp]});return Xr((Mt||[]).slice().concat(ep)),_d}:function(){var ho=sn.backend.numDataIds();lo=sn.tidy(function(){return Ge(sn.backend,Xr)});var mo=Array.isArray(lo)?lo:[lo];return sn.shouldCheckForMemLeaks()&&sn.checkKernelForMemLeak(Qe,ho,mo),mo},this.scopedRun(function(){return sn.state.kernelDepth++},function(){return sn.state.kernelDepth--},function(){an=sn.ENV.getBool("DEBUG")?sn.profiler.profileKernel(Qe,$e,function(){return hn()}):hn()}),fn&&this.addTapeNode(Qe,$e,an,Ye,ln),this.state.profiling&&this.state.activeProfile.kernels.push({name:Qe,bytesAdded:this.state.numBytes-Mi,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-co,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys($e).map(function(ho){return $e[ho].shape}),outputShapes:an.map(function(ho){return ho.shape})}),Array.isArray(lo)?an:an[0]},Ke.prototype.makeTensor=function(Ge,$e,Ye,Qe){if(Ge==null)throw new Error("Values passed to engine.makeTensor() are null");Ye=Ye||"float32",Qe=Qe||this.backend;var Je=Ge;Ye==="string"&&H(Ge[0])&&(Je=Ge.map(function(ln){return rt(ln)}));var Mt=Qe.write(Je,$e,Ye),nn=new wt($e,Ye,Mt,this.nextTensorId());if(this.incRef(nn,Qe),Ye==="string"){var an=this.state.tensorInfo.get(Mt),sn=G(Je);this.state.numBytes+=sn-an.bytes,an.bytes=sn}return nn},Ke.prototype.makeTensorFromDataId=function(Ge,$e,Ye,Qe){var Je=new wt($e,Ye=Ye||"float32",Ge,this.nextTensorId());return this.incRef(Je,Qe),Je},Ke.prototype.makeVariable=function(Ge,$e,Ye,Qe){$e===void 0&&($e=!0),Ye=Ye||this.nextVariableId().toString(),Qe!=null&&Qe!==Ge.dtype&&(Ge=Ge.asType(Qe));var Je=new St(Ge,$e,Ye,this.nextTensorId());if(this.state.registeredVariables[Je.name]!=null)throw new Error("Variable with name "+Je.name+" was already registered");return this.state.registeredVariables[Je.name]=Je,this.incRef(Je,this.backend),Je},Ke.prototype.incRef=function(Ge,$e){var Ye=this.state.tensorInfo.has(Ge.dataId)?this.state.tensorInfo.get(Ge.dataId).refCount:0;if(this.state.numTensors++,Ge.dtype==="string"&&this.state.numStringTensors++,Ye===0){this.state.numDataBuffers++;var Qe=0;Ge.dtype!=="complex64"&&Ge.dtype!=="string"&&(Qe=Ge.size*z(Ge.dtype)),this.state.tensorInfo.set(Ge.dataId,{backend:$e||this.backend,dtype:Ge.dtype,shape:Ge.shape,bytes:Qe,refCount:0}),this.state.numBytes+=Qe}this.state.tensorInfo.get(Ge.dataId).refCount++,Ge instanceof St||this.track(Ge)},Ke.prototype.disposeTensor=function(Ge){if(this.state.tensorInfo.has(Ge.dataId)){this.state.numTensors--,Ge.dtype==="string"&&this.state.numStringTensors--;var $e=this.state.tensorInfo.get(Ge.dataId);$e.refCount<=1?(Ge.dtype!=="complex64"&&(this.state.numBytes-=$e.bytes),this.state.numDataBuffers--,$e.backend.disposeData(Ge.dataId),this.state.tensorInfo.delete(Ge.dataId)):this.state.tensorInfo.get(Ge.dataId).refCount--}},Ke.prototype.disposeVariables=function(){for(var Ge in this.state.registeredVariables){var $e=this.state.registeredVariables[Ge];this.disposeVariable($e)}},Ke.prototype.disposeVariable=function(Ge){this.disposeTensor(Ge),this.state.registeredVariables[Ge.name]!=null&&delete this.state.registeredVariables[Ge.name]},Ke.prototype.memory=function(){var Ge=this.backend.memory();return Ge.numTensors=this.state.numTensors,Ge.numDataBuffers=this.state.numDataBuffers,Ge.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(Ge.unreliable=!0,Ge.reasons==null&&(Ge.reasons=[]),Ge.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),Ge},Ke.prototype.profile=function(Ge){return n(this,void 0,void 0,function(){var $e,Ye;return r(this,function(Qe){return this.state.profiling=!0,$e=this.state.numBytes,Ye=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=Ge(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(Je){return Je.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-$e,this.state.activeProfile.newTensors=this.state.numTensors-Ye,[2,this.state.activeProfile]})})},Ke.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},Ke.prototype.addTapeNode=function(Ge,$e,Ye,Qe,Je){var Mt=this,nn={id:this.state.nextTapeNodeId++,kernelName:Ge,inputs:$e,outputs:Ye,saved:Je},an=h(Ge);an!=null&&(Qe=an.gradFunc),Qe!=null&&(nn.gradient=function(sn){return sn=sn.map(function(ln,fn){if(ln==null){var hn=Ye[fn],Xr=tt(hn.size,hn.dtype);return Mt.makeTensor(Xr,hn.shape,hn.dtype)}return ln}),Qe(sn.length>1?sn:sn[0],Je)}),this.state.activeTape.push(nn)},Ke.prototype.keep=function(Ge){return Ge.kept=!0,Ge},Ke.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},Ke.prototype.endTape=function(){this.state.gradientDepth--},Ke.prototype.startScope=function(Ge){var $e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};Ge&&($e.name=Ge),this.state.scopeStack.push($e),this.state.activeScope=$e},Ke.prototype.endScope=function(Ge){for(var $e=this,Ye=_t(Ge),Qe=new Set(Ye.map(function(an){return an.id})),Je=0;Je<this.state.activeScope.track.length;Je++){var Mt=this.state.activeScope.track[Je];Mt.kept||Qe.has(Mt.id)||Mt.dispose()}var nn=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],Ye.forEach(function(an){an.kept||an.scopeId!==nn.id||$e.track(an)})},Ke.prototype.gradients=function(Ge,$e,Ye,Qe){var Je=this;if(Qe===void 0&&(Qe=!1),C($e.length>0,function(){return"gradients() received an empty list of xs."}),Ye!=null&&Ye.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+Ye.dtype+"'");var Mt=this.scopedRun(function(){return Je.startTape()},function(){return Je.endTape()},function(){return Je.tidy("forward",Ge)});C(Mt instanceof wt,function(){return"The result y returned by f() must be a tensor."});var nn=function(an,sn,ln){for(var fn={},hn={},Xr=0;Xr<sn.length;Xr++)fn[sn[Xr].id]=!0;for(Xr=0;Xr<an.length;Xr++){var Mi=(rp=an[Xr]).inputs;for(var co in Mi){for(var lo=Mi[co],uo=!1,ho=0;ho<sn.length;ho++)if(fn[lo.id]){rp.outputs.forEach(function(lp){return fn[lp.id]=!0}),uo=!0,hn[rp.id]=!0;break}if(uo)break}}var mo={};mo[ln.id]=!0;var _d={};for(Xr=an.length-1;Xr>=0;Xr--)for(Mi=(rp=an[Xr]).inputs,ho=0;ho<rp.outputs.length;ho++)if(mo[rp.outputs[ho].id]){for(var co in Mi)mo[Mi[co].id]=!0,_d[rp.id]=!0;break}var ep=[];for(Xr=0;Xr<an.length;Xr++){var rp;if(hn[(rp=an[Xr]).id]&&_d[rp.id]){var sp={};for(var co in rp.inputs){var op=rp.inputs[co];fn[op.id]&&(sp[co]=op)}var ip=Object.assign({},rp);ip.inputs=sp,ip.outputs=rp.outputs,ep.push(ip)}}return ep}(this.state.activeTape,$e,Mt);if(!Qe&&nn.length===0&&$e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var an,sn,ln={};ln[Mt.id]=Ye??(an=Mt.shape,sn=Z(k(an),"float32"),Lt.makeTensor(sn,an,"float32")),function(hn,Xr,Mi){for(var co=function(uo){var ho=Xr[uo],mo=[];if(ho.outputs.forEach(function(sp){var op=hn[sp.id];op!=null?mo.push(op):mo.push(null)}),ho.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+ho.kernelName+".");var _d=ho.gradient(mo),ep=function(sp){if(!(sp in _d))throw new Error("Cannot backprop through input "+sp+". Available gradients found: "+Object.keys(_d)+".");var op=Mi(function(){return _d[sp]()});if(op.dtype!=="float32")throw new Error("Error in gradient for op "+ho.kernelName+". The gradient of input "+sp+" must have 'float32' dtype, but has '"+op.dtype+"'");var ip=ho.inputs[sp];if(!S(op.shape,ip.shape))throw new Error("Error in gradient for op "+ho.kernelName+". The gradient of input '"+sp+"' has shape '"+op.shape+"', which does not match the shape of the input '"+ip.shape+"'");if(hn[ip.id]==null)hn[ip.id]=op;else{var lp=hn[ip.id];hn[ip.id]=lp.add(op),lp.dispose()}};for(var rp in ho.inputs)ep(rp)},lo=Xr.length-1;lo>=0;lo--)co(lo)}(ln,nn,function(hn){return Je.tidy(hn)});var fn=$e.map(function(hn){return ln[hn.id]});return Je.state.gradientDepth===0&&(Je.state.activeTape.forEach(function(hn){for(var Xr=0,Mi=hn.saved;Xr<Mi.length;Xr++)Mi[Xr].dispose()}),Je.state.activeTape=null),{value:Mt,grads:fn}})},Ke.prototype.customGrad=function(Ge){var $e=this;return C(X(Ge),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var Ye,Qe=[],Je=0;Je<arguments.length;Je++)Qe[Je]=arguments[Je];C(Qe.every(function(nn){return nn instanceof wt}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var Mt={};return Qe.forEach(function(nn,an){Mt[an]=nn}),$e.runKernelFunc(function(nn,an){return C((Ye=Ge.apply(void 0,Qe.concat([an]))).value instanceof wt,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),C(X(Ye.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),Ye.value},Mt,function(nn,an){var sn=Ye.gradFunc(nn,an),ln=Array.isArray(sn)?sn:[sn];C(ln.length===Qe.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),C(ln.every(function(hn){return hn instanceof wt}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var fn={};return ln.forEach(function(hn,Xr){fn[Xr]=function(){return hn}}),fn})}},Ke.prototype.readSync=function(Ge){return this.state.tensorInfo.get(Ge).backend.readSync(Ge)},Ke.prototype.read=function(Ge){return this.state.tensorInfo.get(Ge).backend.read(Ge)},Ke.prototype.time=function(Ge){return n(this,void 0,void 0,function(){var $e,Ye;return r(this,function(Qe){switch(Qe.label){case 0:return $e=et(),[4,this.backend.time(Ge)];case 1:return(Ye=Qe.sent()).wallMs=et()-$e,[2,Ye]}})})},Ke.prototype.track=function(Ge){return this.state.activeScope!=null&&(Ge.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(Ge)),Ge},Object.defineProperty(Ke.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),Ke.prototype.reset=function(){for(var Ge in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Bt,this.registry)this.disposeRegisteredKernels(Ge),this.registry[Ge].dispose(),delete this.registry[Ge];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},Ke.nextTensorId=0,Ke.nextVariableId=0,Ke}(),Lt=function(){var Ke=function(){if(Ot==null){var $e=void 0;if(typeof window<"u")$e=window;else if(typeof global<"u")$e=global;else if(typeof process<"u")$e=process;else{if(typeof self>"u")throw new Error("Could not find a global object");$e=self}Ot=$e}return Ot}();if(Ke._tfengine==null){var Ge=new o(Ke);Ke._tfengine=new Pt(Ge)}return function($e){s=$e}(Ke._tfengine.ENV),yt=function(){return Ke._tfengine},Ke._tfengine}();function Wt(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var Ut=i();Ut.registerFlag("DEBUG",function(){return!1},function(Ke){Ke&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),Ut.registerFlag("IS_BROWSER",function(){return Wt()}),Ut.registerFlag("IS_NODE",function(){return typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0}),Ut.registerFlag("IS_CHROME",function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),Ut.registerFlag("PROD",function(){return!1}),Ut.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return Ut.getBool("DEBUG")}),Ut.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),Ut.registerFlag("IS_TEST",function(){return!1});var Vt,zt,Gt,Ht={},qt={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Kt(Ke,Ge){Ht[Ke]=Ge}function jt(Ke){Ke in Ht||(Ht[Ke]=function($e){if($e!==1&&$e!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var Ye=function(Qe){if(typeof OffscreenCanvas<"u"&&Qe===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}($e);return Ye.addEventListener("webglcontextlost",function(Qe){Qe.preventDefault(),delete Ht[$e]},!1),$e===1?Ye.getContext("webgl",qt)||Ye.getContext("experimental-webgl",qt):Ye.getContext("webgl2",qt)}(Ke));var Ge=Ht[Ke];return Ge.isContextLost()?(delete Ht[Ke],jt(Ke)):(Ge.disable(Ge.DEPTH_TEST),Ge.disable(Ge.STENCIL_TEST),Ge.disable(Ge.BLEND),Ge.disable(Ge.DITHER),Ge.disable(Ge.POLYGON_OFFSET_FILL),Ge.disable(Ge.SAMPLE_COVERAGE),Ge.enable(Ge.SCISSOR_TEST),Ge.enable(Ge.CULL_FACE),Ge.cullFace(Ge.BACK),Ht[Ke])}function Xt(Ke,Ge){return[Ge,Ke]}function Yt(Ke){var Ge=k(Ke);return T(Math.ceil(Ge/4))}function $t(Ke,Ge){return[Math.max(1,Math.ceil(Ge/2)),Math.max(1,Math.ceil(Ke/2))]}function Qt(Ke,Ge){var $e,Ye,Qe,Je,Mt,nn,an,sn,ln,fn=Ke;return i().getNumber("WEBGL_VERSION")===2?($e=fn.R32F,Ye=fn.R16F,Qe=fn.RGBA16F,Je=fn.RGBA32F,Mt=fn.RED,nn=4,an=1,sn=fn.HALF_FLOAT,ln=fn.FLOAT):($e=Ke.RGBA,Ye=Ke.RGBA,Qe=Ke.RGBA,Je=fn.RGBA,Mt=Ke.RGBA,nn=4,an=4,sn=Ge!=null?Ge.HALF_FLOAT_OES:null,ln=Ke.FLOAT),{internalFormatFloat:$e,internalFormatHalfFloat:Ye,internalFormatPackedHalfFloat:Qe,internalFormatPackedFloat:Je,textureFormatFloat:Mt,downloadTextureFormat:Ke.RGBA,downloadUnpackNumChannels:nn,defaultNumChannels:an,textureTypeHalfFloat:sn,textureTypeFloat:ln}}function Jt(Ke,Ge,$e){var Ye=$e();return Ge&&function(Qe){var Je=Qe.getError();if(Je!==Qe.NO_ERROR)throw new Error("WebGL Error: "+ne(Qe,Je))}(Ke),Ye}(function(Ke){Ke[Ke.DENSE=0]="DENSE",Ke[Ke.SHARED_BATCH=1]="SHARED_BATCH"})(Vt||(Vt={})),function(Ke){Ke[Ke.RENDER=0]="RENDER",Ke[Ke.UPLOAD=1]="UPLOAD",Ke[Ke.PIXELS=2]="PIXELS",Ke[Ke.DOWNLOAD=3]="DOWNLOAD"}(zt||(zt={})),function(Ke){Ke[Ke.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",Ke[Ke.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",Ke[Ke.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",Ke[Ke.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",Ke[Ke.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Gt||(Gt={}));var Zt=596e-10,te=65504;function ee(Ke){return!!(i().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||Ke===0||Zt<Math.abs(Ke)&&Math.abs(Ke)<te)}function ne(Ke,Ge){switch(Ge){case Ke.NO_ERROR:return"NO_ERROR";case Ke.INVALID_ENUM:return"INVALID_ENUM";case Ke.INVALID_VALUE:return"INVALID_VALUE";case Ke.INVALID_OPERATION:return"INVALID_OPERATION";case Ke.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case Ke.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case Ke.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+Ge}}function re(Ke,Ge,$e){return ke(Ke,Ge,function(){return Ke.getExtension($e)},'Extension "'+$e+'" not supported on this browser.')}function oe(Ke,Ge,$e){var Ye=ke(Ke,Ge,function(){return Ke.createShader(Ke.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(Jt(Ke,Ge,function(){return Ke.shaderSource(Ye,$e)}),Jt(Ke,Ge,function(){return Ke.compileShader(Ye)}),Ke.getShaderParameter(Ye,Ke.COMPILE_STATUS)===!1)throw console.log(Ke.getShaderInfoLog(Ye)),new Error("Failed to compile vertex shader.");return Ye}function ae(Ke,Ge,$e){var Ye=ke(Ke,Ge,function(){return Ke.createShader(Ke.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(Jt(Ke,Ge,function(){return Ke.shaderSource(Ye,$e)}),Jt(Ke,Ge,function(){return Ke.compileShader(Ye)}),Ke.getShaderParameter(Ye,Ke.COMPILE_STATUS)===!1)throw function(Qe,Je){var Mt=ue.exec(Je);if(Mt==null)return console.log("Couldn't parse line number in error: "+Je),void console.log(Qe);for(var nn=+Mt[1],an=Qe.split(`
`),sn=an.length.toString().length+2,ln=an.map(function(lo,uo){return N((uo+1).toString(),sn)+lo}),fn=0,hn=0;hn<ln.length;hn++)fn=Math.max(ln[hn].length,fn);var Xr=ln.slice(0,nn-1),Mi=ln.slice(nn-1,nn),co=ln.slice(nn);console.log(Xr.join(`
`)),console.log(Je.split(`
`)[0]),console.log("%c "+N(Mi[0],fn),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(co.join(`
`))}($e,Ke.getShaderInfoLog(Ye)),new Error("Failed to compile fragment shader.");return Ye}var ie,se,ue=/ERROR: [0-9]+:([0-9]+):/g;function ce(Ke,Ge){return ke(Ke,Ge,function(){return Ke.createProgram()},"Unable to create WebGLProgram.")}function le(Ke,Ge,$e){if(Jt(Ke,Ge,function(){return Ke.linkProgram($e)}),Ke.getProgramParameter($e,Ke.LINK_STATUS)===!1)throw console.log(Ke.getProgramInfoLog($e)),new Error("Failed to link vertex and fragment shaders.")}function he(Ke,Ge,$e){if(Jt(Ke,Ge,function(){return Ke.validateProgram($e)}),Ke.getProgramParameter($e,Ke.VALIDATE_STATUS)===!1)throw console.log(Ke.getProgramInfoLog($e)),new Error("Shader program validation failed.")}function fe(Ke,Ge,$e){var Ye=ke(Ke,Ge,function(){return Ke.createBuffer()},"Unable to create WebGLBuffer");return Jt(Ke,Ge,function(){return Ke.bindBuffer(Ke.ARRAY_BUFFER,Ye)}),Jt(Ke,Ge,function(){return Ke.bufferData(Ke.ARRAY_BUFFER,$e,Ke.STATIC_DRAW)}),Ye}function de(Ke,Ge,$e){var Ye=ke(Ke,Ge,function(){return Ke.createBuffer()},"Unable to create WebGLBuffer");return Jt(Ke,Ge,function(){return Ke.bindBuffer(Ke.ELEMENT_ARRAY_BUFFER,Ye)}),Jt(Ke,Ge,function(){return Ke.bufferData(Ke.ELEMENT_ARRAY_BUFFER,$e,Ke.STATIC_DRAW)}),Ye}function pe(Ke,Ge){return ke(Ke,Ge,function(){return Ke.createTexture()},"Unable to create WebGLTexture.")}function ve(Ke,Ge){var $e=i().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(Ke<=0||Ge<=0){var Ye="["+Ke+"x"+Ge+"]";throw new Error("Requested texture size "+Ye+" is invalid.")}if(Ke>$e||Ge>$e)throw Ye="["+Ke+"x"+Ge+"]",new Error("Requested texture size "+Ye+" greater than WebGL maximum on this browser / GPU "+("["+$e+"x"+$e+"]")+".")}function me(Ke,Ge){return ke(Ke,Ge,function(){return Ke.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function ge(Ke,Ge,$e,Ye,Qe,Je,Mt,nn){var an=Ke.getAttribLocation($e,Ye);return an!==-1&&(Jt(Ke,Ge,function(){return Ke.bindBuffer(Ke.ARRAY_BUFFER,Qe)}),Jt(Ke,Ge,function(){return Ke.vertexAttribPointer(an,Je,Ke.FLOAT,!1,Mt,nn)}),Jt(Ke,Ge,function(){return Ke.enableVertexAttribArray(an)}),!0)}function ye(Ke,Ge,$e,Ye){Se(Ke,Ye),Jt(Ke,Ge,function(){return Ke.activeTexture(Ke.TEXTURE0+Ye)}),Jt(Ke,Ge,function(){return Ke.bindTexture(Ke.TEXTURE_2D,$e)})}function xe(Ke,Ge,$e,Ye){return ke(Ke,Ge,function(){return Ke.getUniformLocation($e,Ye)},'uniform "'+Ye+'" not present in program.')}function be(Ke,Ge,$e){return Ke.getUniformLocation(Ge,$e)}function we(Ke,Ge,$e,Ye,Qe,Je){Jt(Ke,Ge,function(){return ye(Ke,Ge,Ye,Je)}),Jt(Ke,Ge,function(){return Ke.uniform1i(Qe,Je)})}function Ce(Ke,Ge,$e,Ye){Jt(Ke,Ge,function(){return Ke.bindFramebuffer(Ke.FRAMEBUFFER,Ye)}),Jt(Ke,Ge,function(){return Ke.framebufferTexture2D(Ke.FRAMEBUFFER,Ke.COLOR_ATTACHMENT0,Ke.TEXTURE_2D,$e,0)})}function Ee(Ke,Ge,$e){Jt(Ke,Ge,function(){return Ke.bindFramebuffer(Ke.FRAMEBUFFER,$e)}),Jt(Ke,Ge,function(){return Ke.framebufferTexture2D(Ke.FRAMEBUFFER,Ke.COLOR_ATTACHMENT0,Ke.TEXTURE_2D,null,0)})}function Re(Ke){var Ge=Ke.checkFramebufferStatus(Ke.FRAMEBUFFER);if(Ge!==Ke.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+Ie(Ke,Ge))}function Ie(Ke,Ge){switch(Ge){case Ke.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case Ke.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case Ke.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case Ke.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+Ge}}function ke(Ke,Ge,$e,Ye){var Qe=Jt(Ke,Ge,function(){return $e()});if(Qe==null)throw new Error(Ye);return Qe}function Se(Ke,Ge){var $e=Ke.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,Ye=Ge+Ke.TEXTURE0;if(Ye<Ke.TEXTURE0||Ye>$e)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+$e+"]")+".")}function Ae(Ke,Ge){return Ge===void 0&&(Ge=2),k(Ke.slice(0,Ke.length-Ge))}function De(Ke){if(Ke.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[Ke.length>1?Ke[Ke.length-2]:1,Ke[Ke.length-1]]}function Te(Ke){var Ge=[1,1,1];return Ke.length===0||Ke.length===1&&Ke[0]===1||(Ge=[Ae(Ke)].concat(De(Ke))),Ge}function Ne(Ke,Ge){var $e;Ge===void 0&&(Ge=!1);var Ye=i().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(Ge&&(Ye*=2,(Ke=Ke.map(function(sn,ln){return ln>=Ke.length-2?b(Ke[ln]):Ke[ln]})).length===1&&(Ke=[2,Ke[0]])),Ke.length!==2){var Qe=M(Ke);Ke=Qe.newShape}var Je=k(Ke);if(Ke.length<=1&&Je<=Ye)return[1,Je];if(Ke.length===2&&Ke[0]<=Ye&&Ke[1]<=Ye)return Ke;if(Ke.length===3&&Ke[0]*Ke[1]<=Ye&&Ke[2]<=Ye)return[Ke[0]*Ke[1],Ke[2]];if(Ke.length===3&&Ke[0]<=Ye&&Ke[1]*Ke[2]<=Ye)return[Ke[0],Ke[1]*Ke[2]];if(Ke.length===4&&Ke[0]*Ke[1]*Ke[2]<=Ye&&Ke[3]<=Ye)return[Ke[0]*Ke[1]*Ke[2],Ke[3]];if(Ke.length===4&&Ke[0]<=Ye&&Ke[1]*Ke[2]*Ke[3]<=Ye)return[Ke[0],Ke[1]*Ke[2]*Ke[3]];if(Ge){var Mt=Ae(Ke),nn=2,an=2;return Ke.length&&(nn=($e=De(Ke))[0],an=$e[1]),T(Je=Mt*(nn/2)*(an/2)).map(function(sn){return 2*sn})}return T(Je)}function Fe(Ke){return Ke%2==0}function _e(Ke,Ge){if(S(Ke=Ke.slice(-2),Ge=Ge.slice(-2))||!Ke.length||!Ge.length||Ke[0]===0||Ke[1]===0||Ge[0]===0||Ge[1]===0)return!0;if(Ke.length!==Ge.length){var $e=Ke.slice(-1)[0],Ye=Ge.slice(-1)[0];if($e===Ye||Fe($e)&&Fe(Ye)&&(Ke[0]===1||Ge[0]===1))return!0}return Ke[1]===Ge[1]&&Fe(Ke[0])&&Fe(Ge[0])}function Oe(Ke){if(ie==null){var Ge=jt(Ke);ie=Ge.getParameter(Ge.MAX_TEXTURE_SIZE)}return ie}function Me(Ke){if(se==null){var Ge=jt(Ke);se=Ge.getParameter(Ge.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,se)}function Be(Ke){if(Ke===0)return 0;var Ge=jt(Ke);return Pe(Ge,"EXT_disjoint_timer_query_webgl2")&&Ke===2?2:Pe(Ge,"EXT_disjoint_timer_query")?1:0}function Pe(Ke,Ge){return Ke.getExtension(Ge)!=null}function Le(Ke){try{if(jt(Ke)!=null)return!0}catch{return!1}return!1}function We(Ke){if(Ke===0)return!1;var Ge=jt(Ke);if(Ke===1){if(!Pe(Ge,"OES_texture_float"))return!1}else if(!Pe(Ge,"EXT_color_buffer_float"))return!1;return Ve(Ge)}function Ue(Ke){if(Ke===0)return!1;var Ge=jt(Ke);if(Ke!==1){if(Pe(Ge,"EXT_color_buffer_float"))return Ve(Ge);if(Pe(Ge,"EXT_color_buffer_half_float")){var $e=Ge.getExtension("EXT_color_buffer_half_float");return function(Ye,Qe){var Je=Qt(Ye,Qe),Mt=Ye.createTexture();Ye.bindTexture(Ye.TEXTURE_2D,Mt),Ye.texImage2D(Ye.TEXTURE_2D,0,Je.internalFormatHalfFloat,1,1,0,Je.textureFormatFloat,Je.textureTypeHalfFloat,null);var nn=Ye.createFramebuffer();Ye.bindFramebuffer(Ye.FRAMEBUFFER,nn),Ye.framebufferTexture2D(Ye.FRAMEBUFFER,Ye.COLOR_ATTACHMENT0,Ye.TEXTURE_2D,Mt,0);var an=Ye.checkFramebufferStatus(Ye.FRAMEBUFFER)===Ye.FRAMEBUFFER_COMPLETE;return Ye.bindTexture(Ye.TEXTURE_2D,null),Ye.bindFramebuffer(Ye.FRAMEBUFFER,null),Ye.deleteTexture(Mt),Ye.deleteFramebuffer(nn),an}(Ge,$e)}return!1}return!!Pe(Ge,"OES_texture_float")&&!!Pe(Ge,"WEBGL_color_buffer_float")&&Ve(Ge)}function Ve(Ke){var Ge=Qt(Ke),$e=Ke.createTexture();Ke.bindTexture(Ke.TEXTURE_2D,$e),Ke.texImage2D(Ke.TEXTURE_2D,0,Ge.internalFormatFloat,1,1,0,Ge.textureFormatFloat,Ge.textureTypeFloat,null);var Ye=Ke.createFramebuffer();Ke.bindFramebuffer(Ke.FRAMEBUFFER,Ye),Ke.framebufferTexture2D(Ke.FRAMEBUFFER,Ke.COLOR_ATTACHMENT0,Ke.TEXTURE_2D,$e,0);var Qe=Ke.checkFramebufferStatus(Ke.FRAMEBUFFER)===Ke.FRAMEBUFFER_COMPLETE;return Ke.bindTexture(Ke.TEXTURE_2D,null),Ke.bindFramebuffer(Ke.FRAMEBUFFER,null),Ke.deleteTexture($e),Ke.deleteFramebuffer(Ye),Qe}function ze(Ke){return Ke===2&&jt(Ke).fenceSync!=null}var He=i();function Xe(Ke){i().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(Ke+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function Ze(Ke,Ge){return Lt.tidy(Ke,Ge)}function tn(Ke){_t(Ke).forEach(function(Ge){return Ge.dispose()})}function en(Ke){return Lt.keep(Ke)}function dn(){for(var Ke=[],Ge=0;Ge<arguments.length;Ge++)Ke[Ge]=arguments[Ge];i().getBool("IS_TEST")||console.warn.apply(console,Ke)}function pn(Ke,Ge){var $e=Ke;if(V(Ke))return Ge==="string"?[]:[Ke.length];if(!Array.isArray(Ke))return[];for(var Ye=[];Array.isArray($e)||V($e)&&Ge!=="string";)Ye.push($e.length),$e=$e[0];return Array.isArray(Ke)&&i().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function Qe(Je,Mt,nn){if(nn=nn||[],!Array.isArray(Je)&&!V(Je))return void C(Mt.length===0,function(){return"Element arr["+nn.join("][")+"] is a primitive, but should be an array/TypedArray of "+Mt[0]+" elements"});C(Mt.length>0,function(){return"Element arr["+nn.join("][")+"] should be a primitive, but is an array of "+Je.length+" elements"}),C(Je.length===Mt[0],function(){return"Element arr["+nn.join("][")+"] should have "+Mt[0]+" elements, but has "+Je.length+" elements"});for(var an=Mt.slice(1),sn=0;sn<Je.length;++sn)Qe(Je[sn],an,nn.concat(sn))}(Ke,Ye,[]),Ye}function vn(Ke,Ge,$e,Ye){if(Ke!=null&&(Ke!=="numeric"&&Ke!==Ge||Ke==="numeric"&&Ge==="string"))throw new Error("Argument '"+$e+"' passed to '"+Ye+"' must be "+Ke+" tensor, but got "+Ge+" tensor")}function mn(Ke,Ge,$e,Ye){if(Ye===void 0&&(Ye="numeric"),Ke instanceof wt)return vn(Ye,Ke.dtype,Ge,$e),Ke;var Qe=j(Ke);if(Qe!=="string"&&["bool","int32","float32"].indexOf(Ye)>=0&&(Qe=Ye),vn(Ye,Qe,Ge,$e),Ke==null||!V(Ke)&&!Array.isArray(Ke)&&typeof Ke!="number"&&typeof Ke!="boolean"&&typeof Ke!="string"){var Je=Ke==null?"null":Ke.constructor.name;throw new Error("Argument '"+Ge+"' passed to '"+$e+"' must be a Tensor or TensorLike, but got '"+Je+"'")}var Mt=pn(Ke,Qe);V(Ke)||Array.isArray(Ke)||(Ke=[Ke]);var nn=Qe!=="string"?Q(Ke,Qe,i().getBool("DEBUG")):I(Ke,[],!0);return Lt.makeTensor(nn,Mt,Qe)}function gn(Ke,Ge,$e,Ye){if(Ye===void 0&&(Ye="numeric"),!Array.isArray(Ke))throw new Error("Argument "+Ge+" passed to "+$e+" must be a `Tensor[]` or `TensorLike[]`");return Ke.map(function(Qe,Je){return mn(Qe,Ge+"["+Je+"]",$e)},Ye)}function yn(Ke,Ge){for(var $e=0;$e<Ke.length;++$e)if(Ke[Ke.length-$e-1]!==Ge-1-$e)return!1;return!0}function xn(Ke,Ge,$e){for(var Ye=Ke.length+Ge.length,Qe=[],Je=0,Mt=0,nn=0;nn<Ye;nn++)$e.indexOf(nn)===-1?Qe.push(Ke[Je++]):Qe.push(Ge[Mt++]);return Qe}function bn(Ke,Ge){for(var $e=[],Ye=Ke.length,Qe=0;Qe<Ye;Qe++)Ge.indexOf(Qe)===-1&&$e.push(Ke[Qe]);return[$e,Ge.map(function(Je){return Ke[Je]})]}function wn(Ke,Ge){return xn(Ke,Ge.map(function($e){return 1}),Ge)}function Cn(Ke,Ge,$e){C(yn(Ge,$e),function(){return Ke+" supports only inner-most axes for now. Got axes "+Ge+" and rank-"+$e+" input."})}function En(Ke,Ge){if(yn(Ke,Ge))return null;for(var $e=[],Ye=0;Ye<Ge;++Ye)Ke.indexOf(Ye)===-1&&$e.push(Ye);return Ke.forEach(function(Qe){return $e.push(Qe)}),$e}function Rn(Ke){return Ke.map(function(Ge,$e){return[$e,Ge]}).sort(function(Ge,$e){return Ge[1]-$e[1]}).map(function(Ge){return Ge[0]})}function In(Ke,Ge){for(var $e=[],Ye=Ge-Ke;Ye<Ge;++Ye)$e.push(Ye);return $e}function kn(Ke,Ge){var $e=Ke[0].length;Ke.forEach(function(Qe,Je){C(Qe.length===$e,function(){return"Error in concat"+$e+"D: rank of tensors["+Je+"] must be the same as the rank of the rest ("+$e+")"})}),C(Ge>=0&&Ge<$e,function(){return"Error in concat"+$e+"D: axis must be between 0 and "+($e-1)+"."});var Ye=Ke[0];Ke.forEach(function(Qe,Je){for(var Mt=0;Mt<$e;Mt++)C(Mt===Ge||Qe[Mt]===Ye[Mt],function(){return"Error in concat"+$e+"D: Shape of tensors["+Je+"] ("+Qe+") does not match the shape of the rest ("+Ye+") along the non-concatenated axis "+Je+"."})})}function Sn(Ke,Ge){for(var $e=Ke[0].slice(),Ye=1;Ye<Ke.length;Ye++)$e[Ge]+=Ke[Ye][Ge];return $e}function An(Ke){var Ge=Object.keys(Ke);if(Ge.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+Ge.length+" keys.");var $e=Ge[0],Ye=Ke[$e];$e.endsWith("_")&&($e=$e.substring(0,$e.length-1));var Qe=function(){for(var Je=[],Mt=0;Mt<arguments.length;Mt++)Je[Mt]=arguments[Mt];Lt.startScope($e);try{var nn=Ye.apply(void 0,Je);return nn instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),Lt.endScope(nn),nn}catch(an){throw Lt.endScope(null),an}};return Object.defineProperty(Qe,"name",{value:$e,configurable:!0}),Qe}He.registerFlag("HAS_WEBGL",function(){return He.getNumber("WEBGL_VERSION")>0}),He.registerFlag("WEBGL_VERSION",function(){return Le(2)?2:Le(1)?1:0}),He.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return He.get("WEBGL_VERSION")===2}),He.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),He.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),He.registerFlag("WEBGL_PACK",function(){return He.getBool("HAS_WEBGL")}),He.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return He.getBool("WEBGL_PACK")}),He.registerFlag("WEBGL_PACK_CLIP",function(){return He.getBool("WEBGL_PACK")}),He.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),He.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return He.getBool("WEBGL_PACK")}),He.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return He.getBool("WEBGL_PACK")}),He.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return He.getBool("WEBGL_PACK")}),He.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return He.getBool("WEBGL_PACK")}),He.registerFlag("WEBGL_PACK_REDUCE",function(){return He.getBool("WEBGL_PACK")}),He.registerFlag("WEBGL_LAZILY_UNPACK",function(){return He.getBool("WEBGL_PACK")}),He.registerFlag("WEBGL_CONV_IM2COL",function(){return He.getBool("WEBGL_PACK")}),He.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return Oe(He.getNumber("WEBGL_VERSION"))}),He.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return Me(He.getNumber("WEBGL_VERSION"))}),He.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var Ke=He.getNumber("WEBGL_VERSION");return Ke===0?0:Be(Ke)}),He.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return He.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(Ke=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(Ke)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(Ke.substr(0,4))));var Ke}),He.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return We(He.getNumber("WEBGL_VERSION"))}),He.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!He.getBool("WEBGL_FORCE_F16_TEXTURES")&&He.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),He.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return Ue(He.getNumber("WEBGL_VERSION"))}),He.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return ze(He.getNumber("WEBGL_VERSION"))}),He.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return He.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),bt=Xe;var Dn=An({complex_:function(Ke,Ge){var $e=mn(Ke,"real","complex"),Ye=mn(Ge,"imag","complex");return E($e.shape,Ye.shape,"real and imag shapes, "+$e.shape+" and "+Ye.shape+", must match in call to tf.complex()."),Lt.runKernelFunc(function(Qe){return Qe.complex($e,Ye)},{$real:$e,$imag:Ye})}}),Tn=An({real_:function(Ke){var Ge=mn(Ke,"input","real");return Lt.runKernelFunc(function($e){return $e.real(Ge)},{$input:Ge})}}),Nn=An({imag_:function(Ke){var Ge=mn(Ke,"input","imag");return Lt.runKernelFunc(function($e){return $e.imag(Ge)},{$input:Ge})}});function Fn(Ke,Ge,$e){return _n(Ke,Ge,pn(Ke,$e),$e)}function _n(Ke,Ge,$e,Ye){if(Ye==null&&(Ye=j(Ke)),Ye==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!V(Ke)&&!Array.isArray(Ke)&&typeof Ke!="number"&&typeof Ke!="boolean"&&typeof Ke!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(Ge!=null){nt(Ge);var Qe=k(Ge),Je=k($e);C(Qe===Je,function(){return"Based on the provided shape, ["+Ge+"], the tensor should have "+Qe+" values but has "+Je});for(var Mt=0;Mt<$e.length;++Mt){var nn=$e[Mt],an=Mt!==$e.length-1||nn!==k(Ge.slice(Mt));C($e[Mt]===Ge[Mt]||!an,function(){return"Error creating a new Tensor. Inferred shape ("+$e+") does not match the provided shape ("+Ge+"). "})}}return V(Ke)||Array.isArray(Ke)||(Ke=[Ke]),Ge=Ge||$e,Ke=Ye!=="string"?Q(Ke,Ye,i().getBool("DEBUG")):I(Ke,[],!0),Lt.makeTensor(Ke,Ge,Ye)}function On(Ke,Ge){if((V(Ke)&&Ge!=="string"||Array.isArray(Ke))&&Ge!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(Ge==="string"&&V(Ke)&&!(Ke instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return _n(Ke,[],[],Ge)}function Mn(Ke,Ge){R(Ke);var $e=pn(Ke,Ge);if($e.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return _n(Ke,null,$e,Ge)}function Bn(Ke,Ge,$e){if(R(Ke),Ge!=null&&Ge.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var Ye=pn(Ke,$e);if(Ye.length!==2&&Ye.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(Ye.length===1&&Ge==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return _n(Ke,Ge,Ye,$e)}function Pn(Ke,Ge,$e){if(R(Ke),Ge!=null&&Ge.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var Ye=pn(Ke,$e);if(Ye.length!==3&&Ye.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(Ye.length===1&&Ge==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return _n(Ke,Ge,Ye,$e)}function Ln(Ke,Ge,$e){if(R(Ke),Ge!=null&&Ge.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var Ye=pn(Ke,$e);if(Ye.length!==4&&Ye.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(Ye.length===1&&Ge==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return _n(Ke,Ge,Ye,$e)}function Wn(Ke,Ge,$e){if(R(Ke),Ge!=null&&Ge.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var Ye=pn(Ke,$e);if(Ye.length!==5&&Ye.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(Ye.length===1&&Ge==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return _n(Ke,Ge,Ye,$e)}function Un(Ke,Ge,$e){if(R(Ke),Ge!=null&&Ge.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var Ye=pn(Ke,$e);if(Ye.length!==6&&Ye.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(Ye.length===1&&Ge==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return _n(Ke,Ge=Ge||Ye,Ye,$e)}function Vn(Ke,Ge,$e,Ye){return Ge===void 0&&(Ge=!0),Lt.makeVariable(Ke,Ge,$e,Ye)}function zn(Ke,Ge){if(Ge===void 0&&(Ge="float32"),Ge==="complex64"){var $e=zn(Ke,"float32"),Ye=Gn(Ke,"float32");return Dn($e,Ye)}var Qe=Z(k(Ke),Ge);return Lt.makeTensor(Qe,Ke,Ge)}function Gn(Ke,Ge){if(Ge===void 0&&(Ge="float32"),Ge==="complex64"){var $e=Gn(Ke,"float32"),Ye=Gn(Ke,"float32");return Dn($e,Ye)}var Qe=tt(k(Ke),Ge);return Lt.makeTensor(Qe,Ke,Ge)}function Hn(Ke,Ge,$e){return Lt.runKernelFunc(function(Ye){return Ye.fill(Ke,Ge,$e)},{})}function qn(Ke,Ge,$e){if($e<=0)throw new Error("The number of values should be positive.");return Lt.runKernelFunc(function(Ye){return Ye.linspace(Ke,Ge,$e)},{})}function Kn(Ke,Ge,$e,Ye){if($e===void 0&&($e=1),Ye===void 0&&(Ye="float32"),$e===0)throw new Error("Cannot have a step of zero");if(Ke===Ge||Ke<Ge&&$e<0||Ge<Ke&&$e>1)return Gn([0],Ye);var Qe=tt(Math.abs(Math.ceil((Ge-Ke)/$e)),Ye);Ge<Ke&&$e===1&&($e=-1),Qe[0]=Ke;for(var Je=1;Je<Qe.length;Je++)Qe[Je]=Qe[Je-1]+$e;return Mn(Qe,Ye)}var jn=An({onesLike_:function(Ke){var Ge=mn(Ke,"x","onesLike");if(Ge.dtype==="complex64"){var $e=jn(Tn(Ge)),Ye=Xn(Nn(Ge));return Dn($e,Ye)}return Lt.runKernelFunc(function(Qe){return Qe.onesLike(Ge)},{$x:Ge},function(Qe,Je){return{$x:function(){return Xn(Qe)}}})}}),Xn=An({zerosLike_:function(Ke){var Ge=mn(Ke,"x","zerosLike");return Lt.runKernelFunc(function($e){return $e.zerosLike(Ge)},{$x:Ge},function($e,Ye){return{$x:function(){return Xn($e)}}})}}),Yn=An({concat_:function(Ke,Ge){Ge===void 0&&(Ge=0),C(Ke.length>=1,function(){return"Pass at least one tensor to concat"});var $e=gn(Ke,"tensors","concat");$e[0].dtype==="complex64"&&$e.forEach(function(nn){if(nn.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+nn.dtype+". ")}),Ge=O(Ge,$e[0].shape)[0];var Ye=Sn($e.map(function(nn){return nn.shape}),Ge);if(k(Ye)===0)return Fn([],Ye);if(($e=$e.filter(function(nn){return nn.size>0})).length===1)return $e[0];var Qe=$e.map(function(nn){return nn.shape});kn(Qe,Ge);var Je=$e,Mt={axis:Ge};return Lt.runKernelFunc(function(nn){return nn.concat($e,Ge)},Je,function(nn){var an=Qe.map(function(sn){return sn[Ge]});return tr(nn,an,Ge).map(function(sn){return function(){return sn}})},"Concat",Mt)}}),$n=An({concat1d_:function(Ke){return Yn(Ke,0)}}),Qn=An({concat2d_:function(Ke,Ge){return Yn(Ke,Ge)}}),Jn=An({concat3d_:function(Ke,Ge){return Yn(Ke,Ge)}}),Zn=An({concat4d_:function(Ke,Ge){return Yn(Ke,Ge)}}),tr=An({split_:function(Ke,Ge,$e){$e===void 0&&($e=0);var Ye,Qe=mn(Ke,"x","split");return $e=O($e,Qe.shape)[0],typeof Ge=="number"?(C(Qe.shape[$e]%Ge==0,function(){return"Number of splits must evenly divide the axis."}),Ye=new Array(Ge).fill(Qe.shape[$e]/Ge)):(C(Qe.shape[$e]===Ge.reduce(function(Je,Mt){return Je+Mt}),function(){return"The sum of sizes must match the size of the axis dimension."}),Ye=Ge),Lt.runKernelFunc(function(Je){return Je.split(Qe,Ye,$e)},{$x:Qe},function(Je){return{$x:function(){return Yn(Je,$e)}}})}});function er(Ke,Ge){return Ke(Ge={exports:{}},Ge.exports),Ge.exports}var nr=er(function(Ke){(function(Ge,$e,Ye){function Qe(nn){var an,sn=this,ln=(an=4022871197,function(fn){fn=fn.toString();for(var hn=0;hn<fn.length;hn++){var Xr=.02519603282416938*(an+=fn.charCodeAt(hn));Xr-=an=Xr>>>0,an=(Xr*=an)>>>0,an+=4294967296*(Xr-=an)}return 23283064365386963e-26*(an>>>0)});sn.next=function(){var fn=2091639*sn.s0+23283064365386963e-26*sn.c;return sn.s0=sn.s1,sn.s1=sn.s2,sn.s2=fn-(sn.c=0|fn)},sn.c=1,sn.s0=ln(" "),sn.s1=ln(" "),sn.s2=ln(" "),sn.s0-=ln(nn),sn.s0<0&&(sn.s0+=1),sn.s1-=ln(nn),sn.s1<0&&(sn.s1+=1),sn.s2-=ln(nn),sn.s2<0&&(sn.s2+=1),ln=null}function Je(nn,an){return an.c=nn.c,an.s0=nn.s0,an.s1=nn.s1,an.s2=nn.s2,an}function Mt(nn,an){var sn=new Qe(nn),ln=an&&an.state,fn=sn.next;return fn.int32=function(){return 4294967296*sn.next()|0},fn.double=function(){return fn()+11102230246251565e-32*(2097152*fn()|0)},fn.quick=fn,ln&&(typeof ln=="object"&&Je(ln,sn),fn.state=function(){return Je(sn,{})}),fn}$e&&$e.exports?$e.exports=Mt:this.alea=Mt})(0,Ke)}),rr=er(function(Ke){(function(Ge,$e,Ye){function Qe(nn){var an=this,sn="";an.x=0,an.y=0,an.z=0,an.w=0,an.next=function(){var fn=an.x^an.x<<11;return an.x=an.y,an.y=an.z,an.z=an.w,an.w^=an.w>>>19^fn^fn>>>8},nn===(0|nn)?an.x=nn:sn+=nn;for(var ln=0;ln<sn.length+64;ln++)an.x^=0|sn.charCodeAt(ln),an.next()}function Je(nn,an){return an.x=nn.x,an.y=nn.y,an.z=nn.z,an.w=nn.w,an}function Mt(nn,an){var sn=new Qe(nn),ln=an&&an.state,fn=function(){return(sn.next()>>>0)/4294967296};return fn.double=function(){do var hn=((sn.next()>>>11)+(sn.next()>>>0)/4294967296)/2097152;while(hn===0);return hn},fn.int32=sn.next,fn.quick=fn,ln&&(typeof ln=="object"&&Je(ln,sn),fn.state=function(){return Je(sn,{})}),fn}$e&&$e.exports?$e.exports=Mt:this.xor128=Mt})(0,Ke)}),or=er(function(Ke){(function(Ge,$e,Ye){function Qe(nn){var an=this,sn="";an.next=function(){var fn=an.x^an.x>>>2;return an.x=an.y,an.y=an.z,an.z=an.w,an.w=an.v,(an.d=an.d+362437|0)+(an.v=an.v^an.v<<4^fn^fn<<1)|0},an.x=0,an.y=0,an.z=0,an.w=0,an.v=0,nn===(0|nn)?an.x=nn:sn+=nn;for(var ln=0;ln<sn.length+64;ln++)an.x^=0|sn.charCodeAt(ln),ln==sn.length&&(an.d=an.x<<10^an.x>>>4),an.next()}function Je(nn,an){return an.x=nn.x,an.y=nn.y,an.z=nn.z,an.w=nn.w,an.v=nn.v,an.d=nn.d,an}function Mt(nn,an){var sn=new Qe(nn),ln=an&&an.state,fn=function(){return(sn.next()>>>0)/4294967296};return fn.double=function(){do var hn=((sn.next()>>>11)+(sn.next()>>>0)/4294967296)/2097152;while(hn===0);return hn},fn.int32=sn.next,fn.quick=fn,ln&&(typeof ln=="object"&&Je(ln,sn),fn.state=function(){return Je(sn,{})}),fn}$e&&$e.exports?$e.exports=Mt:this.xorwow=Mt})(0,Ke)}),ar=er(function(Ke){(function(Ge,$e,Ye){function Qe(nn){var an=this;an.next=function(){var sn,ln,fn=an.x,hn=an.i;return sn=fn[hn],ln=(sn^=sn>>>7)^sn<<24,ln^=(sn=fn[hn+1&7])^sn>>>10,ln^=(sn=fn[hn+3&7])^sn>>>3,ln^=(sn=fn[hn+4&7])^sn<<7,sn=fn[hn+7&7],ln^=(sn^=sn<<13)^sn<<9,fn[hn]=ln,an.i=hn+1&7,ln},function(sn,ln){var fn,hn=[];if(ln===(0|ln))hn[0]=ln;else for(ln=""+ln,fn=0;fn<ln.length;++fn)hn[7&fn]=hn[7&fn]<<15^ln.charCodeAt(fn)+hn[fn+1&7]<<13;for(;hn.length<8;)hn.push(0);for(fn=0;fn<8&&hn[fn]===0;++fn);for(fn==8?hn[7]=-1:hn[fn],sn.x=hn,sn.i=0,fn=256;fn>0;--fn)sn.next()}(an,nn)}function Je(nn,an){return an.x=nn.x.slice(),an.i=nn.i,an}function Mt(nn,an){nn==null&&(nn=+new Date);var sn=new Qe(nn),ln=an&&an.state,fn=function(){return(sn.next()>>>0)/4294967296};return fn.double=function(){do var hn=((sn.next()>>>11)+(sn.next()>>>0)/4294967296)/2097152;while(hn===0);return hn},fn.int32=sn.next,fn.quick=fn,ln&&(ln.x&&Je(ln,sn),fn.state=function(){return Je(sn,{})}),fn}$e&&$e.exports?$e.exports=Mt:this.xorshift7=Mt})(0,Ke)}),ir=er(function(Ke){(function(Ge,$e,Ye){function Qe(nn){var an=this;an.next=function(){var sn,ln,fn=an.w,hn=an.X,Xr=an.i;return an.w=fn=fn+1640531527|0,ln=hn[Xr+34&127],sn=hn[Xr=Xr+1&127],ln^=ln<<13,sn^=sn<<17,ln^=ln>>>15,sn^=sn>>>12,ln=hn[Xr]=ln^sn,an.i=Xr,ln+(fn^fn>>>16)|0},function(sn,ln){var fn,hn,Xr,Mi,co,lo=[],uo=128;for(ln===(0|ln)?(hn=ln,ln=null):(ln+="\0",hn=0,uo=Math.max(uo,ln.length)),Xr=0,Mi=-32;Mi<uo;++Mi)ln&&(hn^=ln.charCodeAt((Mi+32)%ln.length)),Mi===0&&(co=hn),hn^=hn<<10,hn^=hn>>>15,hn^=hn<<4,hn^=hn>>>13,Mi>=0&&(co=co+1640531527|0,Xr=(fn=lo[127&Mi]^=hn+co)==0?Xr+1:0);for(Xr>=128&&(lo[127&(ln&&ln.length||0)]=-1),Xr=127,Mi=512;Mi>0;--Mi)hn=lo[Xr+34&127],fn=lo[Xr=Xr+1&127],hn^=hn<<13,fn^=fn<<17,hn^=hn>>>15,fn^=fn>>>12,lo[Xr]=hn^fn;sn.w=co,sn.X=lo,sn.i=Xr}(an,nn)}function Je(nn,an){return an.i=nn.i,an.w=nn.w,an.X=nn.X.slice(),an}function Mt(nn,an){nn==null&&(nn=+new Date);var sn=new Qe(nn),ln=an&&an.state,fn=function(){return(sn.next()>>>0)/4294967296};return fn.double=function(){do var hn=((sn.next()>>>11)+(sn.next()>>>0)/4294967296)/2097152;while(hn===0);return hn},fn.int32=sn.next,fn.quick=fn,ln&&(ln.X&&Je(ln,sn),fn.state=function(){return Je(sn,{})}),fn}$e&&$e.exports?$e.exports=Mt:this.xor4096=Mt})(0,Ke)}),sr=er(function(Ke){(function(Ge,$e,Ye){function Qe(nn){var an=this,sn="";an.next=function(){var fn=an.b,hn=an.c,Xr=an.d,Mi=an.a;return fn=fn<<25^fn>>>7^hn,hn=hn-Xr|0,Xr=Xr<<24^Xr>>>8^Mi,Mi=Mi-fn|0,an.b=fn=fn<<20^fn>>>12^hn,an.c=hn=hn-Xr|0,an.d=Xr<<16^hn>>>16^Mi,an.a=Mi-fn|0},an.a=0,an.b=0,an.c=-1640531527,an.d=1367130551,nn===Math.floor(nn)?(an.a=nn/4294967296|0,an.b=0|nn):sn+=nn;for(var ln=0;ln<sn.length+20;ln++)an.b^=0|sn.charCodeAt(ln),an.next()}function Je(nn,an){return an.a=nn.a,an.b=nn.b,an.c=nn.c,an.d=nn.d,an}function Mt(nn,an){var sn=new Qe(nn),ln=an&&an.state,fn=function(){return(sn.next()>>>0)/4294967296};return fn.double=function(){do var hn=((sn.next()>>>11)+(sn.next()>>>0)/4294967296)/2097152;while(hn===0);return hn},fn.int32=sn.next,fn.quick=fn,ln&&(typeof ln=="object"&&Je(ln,sn),fn.state=function(){return Je(sn,{})}),fn}$e&&$e.exports?$e.exports=Mt:this.tychei=Mt})(0,Ke)}),ur=er(function(Ke){(function(Ge,$e){var Ye,Qe=this,Je=256,Mt=6,nn="random",an=$e.pow(Je,Mt),sn=$e.pow(2,52),ln=2*sn,fn=Je-1;function hn(uo,ho,mo){var _d=[],ep=co(function op(ip,lp){var vp,gp=[],Op=typeof ip;if(lp&&Op=="object")for(vp in ip)try{gp.push(op(ip[vp],lp-1))}catch{}return gp.length?gp:Op=="string"?ip:ip+"\0"}((ho=ho==1?{entropy:!0}:ho||{}).entropy?[uo,lo(Ge)]:uo??function(){try{var op;return Ye&&(op=Ye.randomBytes)?op=op(Je):(op=new Uint8Array(Je),(Qe.crypto||Qe.msCrypto).getRandomValues(op)),lo(op)}catch{var ip=Qe.navigator,lp=ip&&ip.plugins;return[+new Date,Qe,lp,Qe.screen,lo(Ge)]}}(),3),_d),rp=new Xr(_d),sp=function(){for(var op=rp.g(Mt),ip=an,lp=0;op<sn;)op=(op+lp)*Je,ip*=Je,lp=rp.g(1);for(;op>=ln;)op/=2,ip/=2,lp>>>=1;return(op+lp)/ip};return sp.int32=function(){return 0|rp.g(4)},sp.quick=function(){return rp.g(4)/4294967296},sp.double=sp,co(lo(rp.S),Ge),(ho.pass||mo||function(op,ip,lp,vp){return vp&&(vp.S&&Mi(vp,rp),op.state=function(){return Mi(rp,{})}),lp?($e[nn]=op,ip):op})(sp,ep,"global"in ho?ho.global:this==$e,ho.state)}function Xr(uo){var ho,mo=uo.length,_d=this,ep=0,rp=_d.i=_d.j=0,sp=_d.S=[];for(mo||(uo=[mo++]);ep<Je;)sp[ep]=ep++;for(ep=0;ep<Je;ep++)sp[ep]=sp[rp=fn&rp+uo[ep%mo]+(ho=sp[ep])],sp[rp]=ho;(_d.g=function(op){for(var ip,lp=0,vp=_d.i,gp=_d.j,Op=_d.S;op--;)ip=Op[vp=fn&vp+1],lp=lp*Je+Op[fn&(Op[vp]=Op[gp=fn&gp+ip])+(Op[gp]=ip)];return _d.i=vp,_d.j=gp,lp})(Je)}function Mi(uo,ho){return ho.i=uo.i,ho.j=uo.j,ho.S=uo.S.slice(),ho}function co(uo,ho){for(var mo,_d=uo+"",ep=0;ep<_d.length;)ho[fn&ep]=fn&(mo^=19*ho[fn&ep])+_d.charCodeAt(ep++);return lo(ho)}function lo(uo){return String.fromCharCode.apply(0,uo)}if($e["seed"+nn]=hn,co($e.random(),Ge),Ke.exports){Ke.exports=hn;try{Ye=require("crypto")}catch{}}})([],Math)});ur.alea=nr,ur.xor128=rr,ur.xorwow=or,ur.xorshift7=ar,ur.xor4096=ir,ur.tychei=sr;var cr=ur.alea,lr=function(){function Ke(Ge,$e,Ye,Qe,Je){this.mean=Ge,this.stdDev=$e,this.dtype=Ye,this.nextVal=NaN,this.truncated=Qe,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var Mt=Je||Math.random();this.random=cr(Mt.toString())}return Ke.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var Ge=this.nextVal;return this.nextVal=NaN,Ge}for(var $e,Ye,Qe=!1;!Qe;){var Je=void 0,Mt=void 0,nn=void 0;do nn=(Je=2*this.random()-1)*Je+(Mt=2*this.random()-1)*Mt;while(nn>=1||nn===0);var an=Math.sqrt(-2*Math.log(nn)/nn);$e=this.mean+this.stdDev*Je*an,Ye=this.mean+this.stdDev*Mt*an,this.truncated&&!this.isValidTruncated($e)||(Qe=!0)}return this.truncated&&!this.isValidTruncated(Ye)||(this.nextVal=this.convertValue(Ye)),this.convertValue($e)},Ke.prototype.convertValue=function(Ge){return this.dtype==null||this.dtype==="float32"?Ge:Math.round(Ge)},Ke.prototype.isValidTruncated=function(Ge){return Ge<=this.upper&&Ge>=this.lower},Ke}(),hr=function(){function Ke(Ge,$e,Ye,Qe){this.alpha=Ge,this.beta=1/$e,this.dtype=Ye;var Je=Qe||Math.random();this.randu=cr(Je.toString()),this.randn=new lr(0,1,Ye,!1,this.randu()),this.d=Ge<1?Ge+2/3:Ge-1/3,this.c=1/Math.sqrt(9*this.d)}return Ke.prototype.nextValue=function(){for(var Ge,$e,Ye,Qe,Je,Mt;;){do Qe=this.randn.nextValue(),Mt=1+this.c*Qe;while(Mt<=0);if(Mt*=Mt*Mt,$e=1-.331*(Ge=Qe*Qe)*Ge,Ye=.5*Ge+this.d*(1-Mt+Math.log(Mt)),(Je=this.randu())<$e||Math.log(Je)<Ye)break}return Mt=1/this.beta*this.d*Mt,this.alpha<1&&(Mt*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(Mt)},Ke.prototype.convertValue=function(Ge){return this.dtype==="float32"?Ge:Math.round(Ge)},Ke}(),fr=function(){function Ke(Ge,$e,Ye,Qe){var Je=this;if(Ge===void 0&&(Ge=0),$e===void 0&&($e=1),this.canReturnFloat=function(){return Je.dtype==null||Je.dtype==="float32"},this.min=Ge,this.range=$e-Ge,this.dtype=Ye,Qe==null&&(Qe=Math.random()),typeof Qe=="number"&&(Qe=Qe.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+Ge+" - "+$e+" <= 1 and dtype is not float");this.random=cr(Qe)}return Ke.prototype.convertValue=function(Ge){return this.canReturnFloat()?Ge:Math.round(Ge)},Ke.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},Ke}();function dr(Ke,Ge,$e){return Ge===void 0&&(Ge="float32"),Ge=Ge||"float32",nt(Ke),new gt(Ke,Ge,$e)}function pr(Ke,Ge){Ge===void 0&&(Ge=!1),console.log(Ke.toString(Ge))}var vr=An({batchToSpaceND_:function(Ke,Ge,$e){var Ye=mn(Ke,"x","batchToSpaceND"),Qe=Ge.reduce(function(Je,Mt){return Je*Mt});return C(Ye.rank>=1+Ge.length,function(){return"input rank is "+Ye.rank+" but should be > than blockShape.length "+Ge.length}),C($e.length===Ge.length,function(){return"crops.length is "+$e.length+" but should be equal to blockShape.length  "+Ge.length}),C(Ye.shape[0]%Qe==0,function(){return"input tensor batch is "+Ye.shape[0]+" but is not divisible by the product of the elements of blockShape "+Ge.join(" * ")+" === "+Qe}),Lt.runKernelFunc(function(Je){return Je.batchToSpaceND(Ye,Ge,$e)},{$x:Ye},function(Je){return{$x:function(){return Je.spaceToBatchND(Ge,$e)}}})}}),mr=An({broadcastTo_:function(Ke,Ge){var $e=mn(Ke,"broadcastTo","x"),Ye=$e.shape;if(Ge.some(function(an){return!(an>0)||an%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+Ge+"].");if(Ge.length<$e.rank)throw new Error("broadcastTo(): shape.length="+Ge.length+" < input.rank="+$e.rank+".");if(Ge.length>$e.rank){for(var Qe=$e.shape.slice();Qe.length<Ge.length;)Qe.unshift(1);$e=$e.reshape(Qe)}for(var Je=Array.from(Ge),Mt=Ge.length-1;Mt>=0;Mt--)if($e.shape[Mt]===Ge[Mt])Je[Mt]=1;else if($e.shape[Mt]!==1)throw new Error("broadcastTo(): ["+Ye+"] cannot be broadcast to ["+Ge+"].");var nn=Je.map(function(an,sn){return an>1?sn:-1}).filter(function(an){return an>=0});return nn.length===0?$e.clone():Lt.runKernelFunc(function(an){return an.tile($e,Je)},{input:$e},function(an){return{input:function(){return an.sum(nn,!0)}}})}}),gr=An({cast_:function(Ke,Ge){var $e=mn(Ke,"x","cast");if(!W(Ge))throw new Error("Failed to cast to unknown dtype "+Ge);if(Ge==="string"&&$e.dtype!=="string"||Ge!=="string"&&$e.dtype==="string")throw new Error("Only strings can be casted to strings");var Ye={dtype:Ge};return Lt.runKernelFunc(function(Qe){return Qe.cast($e,Ge)},{x:$e},function(Qe){return{x:function(){return Qe.clone()}}},"Cast",Ye)}}),yr=An({clone_:function(Ke){var Ge=mn(Ke,"x","clone",null);return Lt.runKernelFunc(function(){return Lt.makeTensorFromDataId(Ge.dataId,Ge.shape,Ge.dtype)},{$x:Ge},function($e){return{$x:function(){return $e.toFloat()}}})}}),xr=An({cumsum_:function(Ke,Ge,$e,Ye){Ge===void 0&&(Ge=0),$e===void 0&&($e=!1),Ye===void 0&&(Ye=!1);var Qe=mn(Ke,"x","cumsum"),Je=En([Ge|=0],Qe.rank),Mt=Qe;Je!=null&&(Mt=Qe.transpose(Je));var nn=In(1,Qe.rank)[0],an=Lt.runKernelFunc(function(sn){return sn.cumsum(Mt,nn,$e,Ye)},{permutedX:Mt},function(sn){return{permutedX:function(){return sn.cumsum(Ge,$e,!Ye)}}});return Je!=null&&(an=an.transpose(Je)),an}}),br=An({depthToSpace_:function(Ke,Ge,$e){$e===void 0&&($e="NHWC");var Ye=mn(Ke,"x","depthToSpace"),Qe=$e==="NHWC"?Ye.shape[1]:Ye.shape[2],Je=$e==="NHWC"?Ye.shape[2]:Ye.shape[3],Mt=$e==="NHWC"?Ye.shape[3]:Ye.shape[1];return C(Qe*Ge>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+Qe+" and "+Ge+`  for depthToSpace with input shape
      `+Ye.shape}),C(Je*Ge>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+Je+" and "+Ge+` for depthToSpace with input shape
          `+Ye.shape}),C(Mt%(Ge*Ge)==0,function(){return"Dimension size must be evenly divisible by "+Ge*Ge+" but is "+Mt+" for depthToSpace with input shape "+Ye.shape}),Lt.runKernelFunc(function(nn){return nn.depthToSpace(Ye,Ge,$e)},{$x:Ye})}}),wr=An({expandDims_:function(Ke,Ge){Ge===void 0&&(Ge=0);var $e=mn(Ke,"x","expandDims",null);C(Ge<=$e.rank,function(){return"Axis must be <= rank of the tensor"});var Ye=$e.shape.slice();return Ge<0&&(C(-($e.rank+1)<=Ge,function(){return"Axis must be in the interval ["+-($e.rank+1)+", "+$e.rank+"]"}),Ge=$e.rank+Ge+1),Ye.splice(Ge,0,1),Or($e,Ye)}}),Cr=An({eye_:function(Ke,Ge,$e,Ye){Ye===void 0&&(Ye="float32"),Ge==null&&(Ge=Ke);for(var Qe=dr([Ke,Ge],Ye),Je=Ke<=Ge?Ke:Ge,Mt=0;Mt<Je;++Mt)Qe.set(1,Mt,Mt);var nn=Qe.toTensor().as2D(Ke,Ge);if($e==null)return nn;if($e.length===1)return Lr(wr(nn,0),[$e[0],1,1]);if($e.length===2)return Lr(wr(wr(nn,0),0),[$e[0],$e[1],1,1]);if($e.length===3)return Lr(wr(wr(wr(nn,0),0),0),[$e[0],$e[1],$e[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+$e.length+"D.")}}),Er=An({multinomial_:function(Ke,Ge,$e,Ye){Ye===void 0&&(Ye=!1);var Qe=mn(Ke,"logits","multinomial"),Je=Qe.size,Mt=Qe.rank;if(Je<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+Je+".");if(Mt>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+Mt);$e=$e||Math.random();var nn=Mt===1?Qe.as2D(1,-1):Qe,an=Lt.runKernelFunc(function(sn){return sn.multinomial(nn,Ye,Ge,$e)},{logits2D:nn});return Mt===1?an.as1D():an}}),Rr=An({oneHot_:function(Ke,Ge,$e,Ye){if($e===void 0&&($e=1),Ye===void 0&&(Ye=0),Ge<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+Ge);var Qe=mn(Ke,"indices","oneHot","int32"),Je=Qe.shape.concat([Ge]);return Qe=Qe.flatten(),Lt.runKernelFunc(function(Mt){return Mt.oneHot(Qe,Ge,$e,Ye)},{$indices:Qe},function(Mt){return{$indices:function(){return Gn(Qe.shape,"float32")}}}).reshape(Je)}}),Ir=An({pad_:function(Ke,Ge,$e){$e===void 0&&($e=0);var Ye=mn(Ke,"x","pad");if(Ye.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var Qe={paddings:Ge,constantValue:$e};return Lt.runKernelFunc(function(Je){return Je.pad(Ye,Ge,$e)},{x:Ye},function(Je){var Mt=Ge.map(function(nn){return nn[0]});return{x:function(){return Je.slice(Mt,Ye.shape)}}},"PadV2",Qe)}}),kr=An({pad1d_:function(Ke,Ge,$e){return $e===void 0&&($e=0),C(Ge.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),Ir(Ke,[Ge],$e)}}),Sr=An({pad2d_:function(Ke,Ge,$e){return $e===void 0&&($e=0),C(Ge.length===2&&Ge[0].length===2&&Ge[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Ir(Ke,Ge,$e)}}),Ar=An({pad3d_:function(Ke,Ge,$e){return $e===void 0&&($e=0),C(Ge.length===3&&Ge[0].length===2&&Ge[1].length===2&&Ge[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Ir(Ke,Ge,$e)}}),Dr=An({pad4d_:function(Ke,Ge,$e){return $e===void 0&&($e=0),C(Ge.length===4&&Ge[0].length===2&&Ge[1].length===2&&Ge[2].length===2&&Ge[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Ir(Ke,Ge,$e)}}),Tr=An({rand_:function(Ke,Ge,$e){var Ye=k(Ke),Qe=null;if($e==null||$e==="float32")Qe=new Float32Array(Ye);else if($e==="int32")Qe=new Int32Array(Ye);else{if($e!=="bool")throw new Error("Unknown data type "+$e);Qe=new Uint8Array(Ye)}for(var Je=0;Je<Ye;Je++)Qe[Je]=Ge();return Lt.makeTensor(Qe,Ke,$e)}}),Nr=An({randomNormal_:function(Ke,Ge,$e,Ye,Qe){if(Ge===void 0&&(Ge=0),$e===void 0&&($e=1),Ye!=null&&Ye==="bool")throw new Error("Unsupported data type "+Ye);for(var Je=new lr(Ge,$e,Ye,!1,Qe),Mt=dr(Ke,Ye),nn=0;nn<Mt.values.length;nn++)Mt.values[nn]=Je.nextValue();return Mt.toTensor()}}),Fr=An({randomGamma_:function(Ke,Ge,$e,Ye,Qe){if($e===void 0&&($e=1),Ye===void 0&&(Ye="float32"),$e==null&&($e=1),Ye==null&&(Ye="float32"),Ye!=="float32"&&Ye!=="int32")throw new Error("Unsupported data type "+Ye);for(var Je=new hr(Ge,$e,Ye,Qe),Mt=dr(Ke,Ye),nn=0;nn<Mt.values.length;nn++)Mt.values[nn]=Je.nextValue();return Mt.toTensor()}}),_r=An({randomUniform_:function(Ke,Ge,$e,Ye,Qe){Ge===void 0&&(Ge=0),$e===void 0&&($e=1),Ye===void 0&&(Ye="float32");for(var Je=dr(Ke,Ye),Mt=new fr(Ge,$e,null,Qe),nn=0;nn<Je.values.length;nn++)Je.values[nn]=Mt.nextValue();return Je.toTensor()}}),Or=An({reshape_:function(Ke,Ge){var $e=mn(Ke,"x","reshape",null);Ge=_(Ge,$e.size),C($e.size===k(Ge),function(){return"new shape and old shape must have the same number of elements."});var Ye={shape:Ge};return Lt.runKernelFunc(function(Qe){return Qe.reshape($e,Ge)},{x:$e},function(Qe){return{x:function(){return Qe.reshape($e.shape)}}},"Reshape",Ye)}}),Mr=An({spaceToBatchND_:function(Ke,Ge,$e){var Ye=mn(Ke,"x","spaceToBatchND");return C(Ye.rank>=1+Ge.length,function(){return"input rank "+Ye.rank+" should be > than [blockShape] "+Ge.length}),C($e.length===Ge.length,function(){return"paddings.shape[0] "+$e.length+" must be equal to [blockShape] "+Ge.length}),C(Ye.shape.reduce(function(Qe,Je,Mt){return Mt>0&&Mt<=Ge.length?Qe&&(Je+$e[Mt-1][0]+$e[Mt-1][1])%Ge[Mt-1]==0:Qe},!0),function(){return"input spatial dimensions "+Ye.shape.slice(1)+" with paddings "+$e.toString()+" must be divisible by blockShapes "+Ge.toString()}),Lt.runKernelFunc(function(Qe){return Qe.spaceToBatchND(Ye,Ge,$e)},{$x:Ye},function(Qe){return{$x:function(){return Qe.batchToSpaceND(Ge,$e)}}})}}),Br=An({squeeze_:function(Ke,Ge){var $e=mn(Ke,"x","squeeze");return Or($e,M($e.shape,Ge).newShape)}}),Pr=An({stack_:function(Ke,Ge){Ge===void 0&&(Ge=0);var $e=gn(Ke,"tensors","stack");if(C($e.length>=1,function(){return"Pass at least one tensor to tf.stack"}),$e.length===1)return $e[0].expandDims(Ge);var Ye=$e[0].rank,Qe=$e[0].shape,Je=$e[0].dtype;C(Ge<=Ye,function(){return"Axis must be <= rank of the tensor"}),$e.forEach(function(nn){E(Qe,nn.shape,"All tensors passed to stack must have matching shapes")}),$e.forEach(function(nn){C(Je===nn.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var Mt=$e.map(function(nn){return nn.expandDims(Ge)});return Yn(Mt,Ge)}}),Lr=An({tile_:function(Ke,Ge){var $e=mn(Ke,"x","tile",null);C($e.rank===Ge.length,function(){return"Error in transpose: rank of input "+$e.rank+" must match length of reps "+Ge+"."});var Ye=[$e],Qe={reps:Ge};return Lt.runKernelFunc(function(Je,Mt){var nn=Je.tile($e,Ge);return Mt([$e]),nn},{x:$e},function(Je,Mt){var nn=Mt[0];return{x:function(){var an=Xn(nn);if(nn.rank===1)for(var sn=0;sn<Ge[0];++sn)an=an.add(Je.slice([sn*nn.shape[0]],[nn.shape[0]]));else if(nn.rank===2)for(sn=0;sn<Ge[0];++sn)for(var ln=0;ln<Ge[1];++ln)an=an.add(Je.slice([sn*nn.shape[0],ln*nn.shape[1]],[nn.shape[0],nn.shape[1]]));else if(nn.rank===3)for(sn=0;sn<Ge[0];++sn)for(ln=0;ln<Ge[1];++ln)for(var fn=0;fn<Ge[2];++fn)an=an.add(Je.slice([sn*nn.shape[0],ln*nn.shape[1],fn*nn.shape[2]],[nn.shape[0],nn.shape[1],nn.shape[2]]));else{if(nn.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+nn.rank+" tensors yet.");for(sn=0;sn<Ge[0];++sn)for(ln=0;ln<Ge[1];++ln)for(fn=0;fn<Ge[2];++fn)for(var hn=0;hn<Ge[3];++hn)an=an.add(Je.slice([sn*nn.shape[0],ln*nn.shape[1],fn*nn.shape[2],hn*nn.shape[3]],[nn.shape[0],nn.shape[1],nn.shape[2],nn.shape[3]]))}return an}}},"Tile",Qe,Ye)}}),Wr=An({truncatedNormal_:function(Ke,Ge,$e,Ye,Qe){if(Ge===void 0&&(Ge=0),$e===void 0&&($e=1),Ye!=null&&Ye==="bool")throw new Error("Unsupported data type "+Ye);for(var Je=new lr(Ge,$e,Ye,!0,Qe),Mt=dr(Ke,Ye),nn=0;nn<Mt.values.length;nn++)Mt.values[nn]=Je.nextValue();return Mt.toTensor()}}),Ur=An({unstack_:function(Ke,Ge){Ge===void 0&&(Ge=0),Ge=Ge||0;var $e=mn(Ke,"x","unstack");C(Ge>=-$e.shape.length&&Ge<$e.shape.length,function(){return"Axis = "+Ge+" is not in [-"+$e.shape.length+", "+$e.shape.length+")"}),Ge<0&&(Ge+=$e.shape.length);var Ye={axis:Ge};return Lt.runKernelFunc(function(Qe){return Qe.unstack($e,Ge)},{x:$e},function(Qe){return{x:function(){return Pr(Qe,Ge)}}},"Unpack",Ye)}}),Vr=function(Ke,Ge){return n(this,void 0,void 0,function(){var $e,Ye,Qe,Je,Mt,nn,an,sn,ln,fn;return r(this,function(hn){switch(hn.label){case 0:return $e=mn(Ke,"x","setdiff1d"),Ye=mn(Ge,"y","setdiff1d"),C($e.dtype===Ye.dtype,function(){return"x and y should have the same dtype, but got x ("+$e.dtype+") and y ("+Ye.dtype+")."}),C($e.rank===1,function(){return"x should be 1D tensor, but got x ("+$e.shape+")."}),C(Ye.rank===1,function(){return"y should be 1D tensor, but got y ("+Ye.shape+")."}),[4,$e.data()];case 1:return Qe=hn.sent(),[4,Ye.data()];case 2:for(Je=hn.sent(),Mt=new Set(Je),nn=0,ln=0;ln<Qe.length;ln++)Mt.has(Qe[ln])||nn++;for(an=new gt([nn],$e.dtype),sn=new gt([nn],"int32"),ln=0,fn=0;ln<Qe.length;ln++)Mt.has(Qe[ln])||(an.values[fn]=Qe[ln],sn.values[fn]=ln,fn++);return[2,[an.toTensor(),sn.toTensor()]]}})})};function zr(Ke,Ge,$e,Ye){Ye===void 0&&(Ye=!0);var Qe=[];if(Ye)(Qe=Qe.concat(Ge.slice(0))).push(Ke[0]/$e),Qe=Qe.concat(Ke.slice(1));else{Qe=Qe.concat(Ke[0]);for(var Je=Ge.length,Mt=0;Mt<Je;++Mt)Qe=Qe.concat([Ke[Mt+1]/Ge[Mt],Ge[Mt]]);Qe=Qe.concat(Ke.slice(Je+1))}return Qe}function Gr(Ke,Ge,$e){$e===void 0&&($e=!0);var Ye=[];if($e){Ye.push(Ge);for(var Qe=Ge+1;Qe<Ke;++Qe)Qe<=2*Ge?(Ye.push(Qe),Ye.push(Qe-(Ge+1))):Ye.push(Qe)}else{var Je=[],Mt=[];for(Qe=1;Qe<Ke;++Qe)Qe>=2*Ge+1||Qe%2==1?Mt.push(Qe):Je.push(Qe);Ye.push.apply(Ye,Je),Ye.push(0),Ye.push.apply(Ye,Mt)}return Ye}function Hr(Ke,Ge,$e,Ye){Ye===void 0&&(Ye=!0);var Qe=[];Ye?Qe.push(Ke[0]/$e):Qe.push(Ke[0]*$e);for(var Je=1;Je<Ke.length;++Je)Je<=Ge.length?Ye?Qe.push(Ge[Je-1]*Ke[Je]):Qe.push(Ke[Je]/Ge[Je-1]):Qe.push(Ke[Je]);return Qe}function qr(Ke,Ge){for(var $e=[0],Ye=0;Ye<Ge;++Ye)$e.push(Ke[Ye][0]);return $e}function Kr(Ke,Ge,$e){for(var Ye=Ke.slice(0,1),Qe=0;Qe<$e;++Qe)Ye.push(Ke[Qe+1]-Ge[Qe][0]-Ge[Qe][1]);return Ye}function jr(Ke,Ge){if(Ke.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+Ke.rank+".");if(Ge.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+Ge.rank+".");if(Ge.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+Ge.dtype+".");if(Ge.shape[Ge.rank-1]>Ke.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+Ge.shape[Ge.rank-1]+" vs. "+Ke.rank);if(Ke.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+Ke.shape+".");for(var $e=Ge.shape,Ye=$e[$e.length-1],Qe=1,Je=0;Je<$e.length-1;++Je)Qe*=$e[Je];var Mt=Ke.shape,nn=$e.slice();nn.pop();var an=1;for(Je=Ye;Je<Ke.rank;++Je)an*=Mt[Je],nn.push(Mt[Je]);var sn=$(Ke.shape).map(function(ln){return ln/an}).concat([1]).slice(0,Ye);return[nn,Qe,an,sn]}var Yr=30;function $r(Ke){return Ke<=Yr?Ke:Y(Ke,Math.floor(Math.sqrt(Ke)))}function Qr(Ke,Ge,$e){var Ye=Ge.rank>1?Ge.shape[Ge.rank-1]:1,Qe=Ge.rank>1?Ge.rank-1:1,Je="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+$e.shape+", indices.shape: "+Ge.shape+", shape: "+Ke+", sliceDim: "+Ye+", and batchDim: "+Qe+".";if($e.rank<Qe)throw new Error(Je+" update.rank < "+Qe+". ");if(Ke.length<Ye+($e.rank-Qe))throw new Error(Je+" Output shape length < "+(Ye+($e.rank-Qe)));if($e.rank!==Qe+Ke.length-Ye)throw new Error(Je+" update.rank != "+(Qe+Ke.length-Ye));for(var Mt=0;Mt<Qe;++Mt)if($e.shape[Mt]!==Ge.shape[Mt])throw new Error(Je+" updates.shape["+Mt+"] ("+$e.shape[Mt]+") != indices.shape["+Mt+"] ("+Ge.shape[Mt]+").");for(Mt=0;Mt<$e.rank-Qe;++Mt)if($e.shape[Mt+Qe]!==Ke[Mt+Ye])throw new Error(Je+" updates.shape["+(Mt+Qe)+"] ("+$e.shape[Mt+Qe]+") != shape["+(Mt+Qe)+"] ("+Ke[Mt+Qe]+")")}function Jr(Ke,Ge,$e){if(Ge.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+Ge.rank+".");if(Ke.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+Ke.rank+".");if(Ge.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+Ge.dtype);if($e.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+$e);if($e.length===0){if(Ge.size===0)throw new Error("Indices specified for empty output. indices shape: "+Ge.shape);if(Ke.size===0)throw new Error("Updates specified for empty output. updates shape: "+Ke.shape)}Qr($e,Ge,Ke)}function Zr(Ke,Ge,$e){for(var Ye=Ge.shape.length,Qe=Ye>1?Ge.shape[Ye-1]:1,Je=$e.length,Mt=1,nn=Qe;nn<Je;++nn)Mt*=$e[nn];var an=Qe<1?1:Qe;return{sliceRank:Qe,numUpdates:k(Ge.shape)/an,sliceSize:Mt,strides:$($e.slice(0,Qe)).concat([1]),outputSize:k($e)}}function eo(Ke,Ge,$e){C(Ke.rank===Ge.length,function(){return"Error in slice"+Ke.rank+"D: Length of begin "+Ge+" must match the rank of the array ("+Ke.rank+")."}),C(Ke.rank===$e.length,function(){return"Error in slice"+Ke.rank+"D: Length of size "+$e+" must match the rank of the array ("+Ke.rank+")."});for(var Ye=function(Je){C(Ge[Je]+$e[Je]<=Ke.shape[Je],function(){return"Error in slice"+Ke.rank+"D: begin["+Je+"] + size["+Je+"] ("+(Ge[Je]+$e[Je])+") would overflow input.shape["+Je+"] ("+Ke.shape[Je]+")"})},Qe=0;Qe<Ke.rank;++Qe)Ye(Qe)}function no(Ke){for(var Ge=[],$e=0;Ke>0;)1&Ke&&Ge.push($e),Ke/=2,$e++;return Ge}function ro(Ke,Ge,$e){for(var Ye=[],Qe=0;Qe<Ke.length;Qe++)Ye[Qe]=Math.ceil((Ge[Qe]-Ke[Qe])/$e[Qe]);return Ye}function oo(Ke,Ge,$e,Ye,Qe){var Je=Ge[Qe],Mt=$e[Qe]||1;(Ke&1<<Qe||Je==null)&&(Je=Mt>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var nn=Ye[Qe];return Je<0&&(Je+=nn),Je=x(0,Je,nn-1)}function ao(Ke,Ge,$e,Ye,Qe){var Je=Ge[Qe],Mt=$e[Qe]||1;(Ke&1<<Qe||Je==null)&&(Je=Mt>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var nn=Ye[Qe];return Je<0&&(Je+=nn),Je=Mt>0?x(0,Je,nn):x(-1,Je,nn-1)}function io(Ke,Ge,$e){for(var Ye=$e.length,Qe=0;Qe<$e.length;Qe++)if($e[Qe]>1){Ye=Qe;break}for(Qe=Ye+1;Qe<$e.length;Qe++)if(Ge[Qe]>0||$e[Qe]!==Ke[Qe])return!1;return!0}function so(Ke,Ge){for(var $e=Ke.length>0?Ke[Ke.length-1]:1,Ye=0;Ye<Ke.length-1;Ye++)$e+=Ke[Ye]*Ge[Ye];return $e}function po(Ke,Ge){C(X(Ke),function(){return"The f passed in variableGrads(f) must be a function"}),C(Ge==null||Array.isArray(Ge)&&Ge.every(function(ln){return ln instanceof St}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var $e=Ge!=null;if(!$e)for(var Ye in Ge=[],Lt.registeredVariables)Ge.push(Lt.registeredVariables[Ye]);var Qe=$e?Ge.filter(function(ln){return!ln.trainable}):null,Je=Ge.length;C((Ge=Ge.filter(function(ln){return ln.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+Je+" variables is trainable."});var Mt=Lt.gradients(Ke,Ge,null,!0),nn=Mt.value,an=Mt.grads;C(an.some(function(ln){return ln!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),C(nn.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+nn.rank+" tensor"});var sn={};return Ge.forEach(function(ln,fn){an[fn]!=null&&(sn[ln.name]=an[fn])}),Qe!=null&&Qe.forEach(function(ln){return sn[ln.name]=null}),{value:nn,grads:sn}}function vo(Ke){return Lt.customGrad(Ke)}var go=An({softmax_:function(Ke,Ge){Ge===void 0&&(Ge=-1);var $e=mn(Ke,"logits","softmax","float32");if(Ge===-1&&(Ge=$e.rank-1),Ge!==$e.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+$e.rank+" and dim was "+Ge);return Lt.runKernelFunc(function(Ye,Qe){var Je=Ye.softmax($e,Ge);return Qe([Je]),Je},{logits:$e},function(Ye,Qe){var Je=Qe[0],Mt=Ye.mul(Je);return{logits:function(){return Mt.sub(Mt.sum([Ge],!0).mul(Je))}}},"Softmax",{dim:Ge},[],[!0])}}),yo=An({logSoftmax_:function(Ke,Ge){Ge===void 0&&(Ge=-1);var $e=mn(Ke,"logits","logSoftmax");if(Ge===-1&&(Ge=$e.rank-1),Ge!==$e.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+$e.rank+" and axis was "+Ge);return vo(function(Ye,Qe){var Je=Ye.max(Ge,!0),Mt=Ye.sub(Je),nn=Mt.toFloat().sub(Mt.exp().sum(Ge,!0).log());return Qe([nn]),{value:nn,gradFunc:function(an,sn){var ln=sn[0].exp();return an.sub(an.sum(Ge,!0).mul(ln))}}})($e)}}),xo=function(){function Ke(Ge,$e){this.backend=Ge,this.dataMover=$e,this.data=new WeakMap,this.dataIdsCount=0}return Ke.prototype.get=function(Ge){return this.data.has(Ge)||this.dataMover.moveData(this.backend,Ge),this.data.get(Ge)},Ke.prototype.set=function(Ge,$e){this.dataIdsCount++,this.data.set(Ge,$e)},Ke.prototype.has=function(Ge){return this.data.has(Ge)},Ke.prototype.delete=function(Ge){return this.dataIdsCount--,this.data.delete(Ge)},Ke.prototype.numDataIds=function(){return this.dataIdsCount},Ke}(),bo=function(){function Ke(){}return Ke.prototype.time=function(Ge){return wo("time")},Ke.prototype.read=function(Ge){return wo("read")},Ke.prototype.readSync=function(Ge){return wo("readSync")},Ke.prototype.numDataIds=function(){return wo("numDataIds")},Ke.prototype.disposeData=function(Ge){return wo("disposeData")},Ke.prototype.write=function(Ge,$e,Ye){return wo("write")},Ke.prototype.move=function(Ge,$e,Ye,Qe){return wo("move")},Ke.prototype.memory=function(){return wo("memory")},Ke.prototype.floatPrecision=function(){return wo("floatPrecision")},Ke.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},Ke.prototype.batchMatMul=function(Ge,$e,Ye,Qe){return wo("batchMatMul")},Ke.prototype.fusedBatchMatMul=function(Ge){return Ge.a,Ge.b,Ge.transposeA,Ge.transposeB,Ge.bias,Ge.activation,Ge.preluActivationWeights,wo("fusedBatchMatMul")},Ke.prototype.slice=function(Ge,$e,Ye){return wo("slice")},Ke.prototype.stridedSlice=function(Ge,$e,Ye,Qe){return wo("stridedSlice")},Ke.prototype.unstack=function(Ge,$e){return wo("unstack")},Ke.prototype.reverse=function(Ge,$e){return wo("reverse")},Ke.prototype.concat=function(Ge,$e){return wo("concat")},Ke.prototype.neg=function(Ge){return wo("neg")},Ke.prototype.add=function(Ge,$e){return wo("add")},Ke.prototype.addN=function(Ge){return wo("addN")},Ke.prototype.subtract=function(Ge,$e){return wo("subtract")},Ke.prototype.multiply=function(Ge,$e){return wo("multiply")},Ke.prototype.realDivide=function(Ge,$e){return wo("realDivide")},Ke.prototype.floorDiv=function(Ge,$e){return wo("floorDiv")},Ke.prototype.sum=function(Ge,$e){return wo("sum")},Ke.prototype.prod=function(Ge,$e){return wo("prod")},Ke.prototype.unsortedSegmentSum=function(Ge,$e,Ye){return wo("unsortedSegmentSum")},Ke.prototype.argMin=function(Ge,$e){return wo("argMin")},Ke.prototype.argMax=function(Ge,$e){return wo("argMax")},Ke.prototype.equal=function(Ge,$e){return wo("equal")},Ke.prototype.notEqual=function(Ge,$e){return wo("notEqual")},Ke.prototype.less=function(Ge,$e){return wo("less")},Ke.prototype.lessEqual=function(Ge,$e){return wo("lessEqual")},Ke.prototype.greater=function(Ge,$e){return wo("greater")},Ke.prototype.greaterEqual=function(Ge,$e){return wo("greaterEqual")},Ke.prototype.logicalNot=function(Ge){return wo("logicalNot")},Ke.prototype.logicalAnd=function(Ge,$e){return wo("logicalAnd")},Ke.prototype.logicalOr=function(Ge,$e){return wo("logicalOr")},Ke.prototype.where=function(Ge){return wo("where")},Ke.prototype.select=function(Ge,$e,Ye){return wo("select")},Ke.prototype.topk=function(Ge,$e,Ye){return wo("topk")},Ke.prototype.min=function(Ge,$e){return wo("min")},Ke.prototype.minimum=function(Ge,$e){return wo("minimum")},Ke.prototype.mod=function(Ge,$e){return wo("mod")},Ke.prototype.max=function(Ge,$e){return wo("max")},Ke.prototype.maximum=function(Ge,$e){return wo("maximum")},Ke.prototype.all=function(Ge,$e){return wo("all")},Ke.prototype.any=function(Ge,$e){return wo("any")},Ke.prototype.squaredDifference=function(Ge,$e){return wo("squaredDifference")},Ke.prototype.ceil=function(Ge){return wo("ceil")},Ke.prototype.floor=function(Ge){return wo("floor")},Ke.prototype.round=function(Ge){return wo("round")},Ke.prototype.sign=function(Ge){return wo("sign")},Ke.prototype.isNaN=function(Ge){return wo("isNaN")},Ke.prototype.isInf=function(Ge){return wo("isInf")},Ke.prototype.isFinite=function(Ge){return wo("isFinite")},Ke.prototype.pow=function(Ge,$e){return wo("pow")},Ke.prototype.exp=function(Ge){return wo("exp")},Ke.prototype.expm1=function(Ge){return wo("expm1")},Ke.prototype.softmax=function(Ge,$e){return wo("softmax")},Ke.prototype.log=function(Ge){return wo("log")},Ke.prototype.log1p=function(Ge){return wo("log1p")},Ke.prototype.sqrt=function(Ge){return wo("sqrt")},Ke.prototype.rsqrt=function(Ge){return wo("rsqrt")},Ke.prototype.square=function(Ge){return wo("square")},Ke.prototype.reciprocal=function(Ge){return wo("reciprocal")},Ke.prototype.relu=function(Ge){return wo("relu")},Ke.prototype.relu6=function(Ge){return wo("relu6")},Ke.prototype.prelu=function(Ge,$e){return wo("prelu")},Ke.prototype.elu=function(Ge){return wo("elu")},Ke.prototype.eluDer=function(Ge,$e){return wo("eluDer")},Ke.prototype.selu=function(Ge){return wo("selu")},Ke.prototype.int=function(Ge){return wo("int")},Ke.prototype.clip=function(Ge,$e,Ye){return wo("clip")},Ke.prototype.abs=function(Ge){return wo("abs")},Ke.prototype.complexAbs=function(Ge){return wo("complexAbs")},Ke.prototype.sigmoid=function(Ge){return wo("sigmoid")},Ke.prototype.softplus=function(Ge){return wo("softplus")},Ke.prototype.sin=function(Ge){return wo("sin")},Ke.prototype.cos=function(Ge){return wo("cos")},Ke.prototype.tan=function(Ge){return wo("tan")},Ke.prototype.asin=function(Ge){return wo("asin")},Ke.prototype.acos=function(Ge){return wo("acos")},Ke.prototype.atan=function(Ge){return wo("atan")},Ke.prototype.atan2=function(Ge,$e){return wo("atan2")},Ke.prototype.sinh=function(Ge){return wo("sinh")},Ke.prototype.cosh=function(Ge){return wo("cosh")},Ke.prototype.tanh=function(Ge){return wo("tanh")},Ke.prototype.asinh=function(Ge){return wo("asinh")},Ke.prototype.acosh=function(Ge){return wo("acosh")},Ke.prototype.atanh=function(Ge){return wo("atanh")},Ke.prototype.erf=function(Ge){return wo("erf")},Ke.prototype.step=function(Ge,$e){return wo("step")},Ke.prototype.fusedConv2d=function(Ge){return Ge.input,Ge.filter,Ge.convInfo,Ge.bias,Ge.activation,Ge.preluActivationWeights,wo("fusedConv2d")},Ke.prototype.conv2d=function(Ge,$e,Ye){return wo("conv2d")},Ke.prototype.conv2dDerInput=function(Ge,$e,Ye){return wo("conv2dDerInput")},Ke.prototype.conv2dDerFilter=function(Ge,$e,Ye){return wo("conv2dDerFilter")},Ke.prototype.fusedDepthwiseConv2D=function(Ge){return Ge.input,Ge.filter,Ge.convInfo,Ge.bias,Ge.activation,Ge.preluActivationWeights,wo("fusedDepthwiseConv2D")},Ke.prototype.depthwiseConv2D=function(Ge,$e,Ye){return wo("depthwiseConv2D")},Ke.prototype.depthwiseConv2DDerInput=function(Ge,$e,Ye){return wo("depthwiseConv2DDerInput")},Ke.prototype.depthwiseConv2DDerFilter=function(Ge,$e,Ye){return wo("depthwiseConv2DDerFilter")},Ke.prototype.conv3d=function(Ge,$e,Ye){return wo("conv3d")},Ke.prototype.conv3dDerInput=function(Ge,$e,Ye){return wo("conv3dDerInput")},Ke.prototype.conv3dDerFilter=function(Ge,$e,Ye){return wo("conv3dDerFilter")},Ke.prototype.maxPool=function(Ge,$e){return wo("maxPool")},Ke.prototype.maxPoolBackprop=function(Ge,$e,Ye,Qe){return wo("maxPoolBackprop")},Ke.prototype.avgPool=function(Ge,$e){return wo("avgPool")},Ke.prototype.avgPoolBackprop=function(Ge,$e,Ye){return wo("avgPoolBackprop")},Ke.prototype.avgPool3d=function(Ge,$e){return wo("avgPool3d")},Ke.prototype.avgPool3dBackprop=function(Ge,$e,Ye){return wo("avgPool3dBackprop")},Ke.prototype.maxPool3d=function(Ge,$e){return wo("maxPool3d")},Ke.prototype.maxPool3dBackprop=function(Ge,$e,Ye,Qe){return wo("maxPool3dBackprop")},Ke.prototype.reshape=function(Ge,$e){return wo("reshape")},Ke.prototype.cast=function(Ge,$e){return wo("cast")},Ke.prototype.tile=function(Ge,$e){return wo("tile")},Ke.prototype.pad=function(Ge,$e,Ye){return wo("pad")},Ke.prototype.transpose=function(Ge,$e){return wo("transpose")},Ke.prototype.gather=function(Ge,$e,Ye){return wo("gather")},Ke.prototype.gatherND=function(Ge,$e){return wo("gatherND")},Ke.prototype.scatterND=function(Ge,$e,Ye){return wo("scatterND")},Ke.prototype.batchToSpaceND=function(Ge,$e,Ye){return wo("batchToSpaceND")},Ke.prototype.spaceToBatchND=function(Ge,$e,Ye){return wo("spaceToBatchND")},Ke.prototype.resizeBilinear=function(Ge,$e,Ye,Qe){return wo("resizeBilinear")},Ke.prototype.resizeBilinearBackprop=function(Ge,$e,Ye){return wo("resizeBilinearBackprop")},Ke.prototype.resizeNearestNeighbor=function(Ge,$e,Ye,Qe){return wo("resizeNearestNeighbor")},Ke.prototype.resizeNearestNeighborBackprop=function(Ge,$e,Ye){return wo("resizeNearestNeighborBackprop")},Ke.prototype.batchNormalization=function(Ge,$e,Ye,Qe,Je,Mt){return wo("batchNormalization")},Ke.prototype.localResponseNormalization4D=function(Ge,$e,Ye,Qe,Je){return wo("localResponseNormalization4D")},Ke.prototype.LRNGrad=function(Ge,$e,Ye,Qe,Je,Mt,nn){return wo("LRNGrad")},Ke.prototype.multinomial=function(Ge,$e,Ye,Qe){return wo("multinomial")},Ke.prototype.oneHot=function(Ge,$e,Ye,Qe){return wo("oneHot")},Ke.prototype.cumsum=function(Ge,$e,Ye,Qe){return wo("cumsum")},Ke.prototype.nonMaxSuppression=function(Ge,$e,Ye,Qe,Je){return wo("nonMaxSuppression")},Ke.prototype.fft=function(Ge){return wo("fft")},Ke.prototype.ifft=function(Ge){return wo("ifft")},Ke.prototype.complex=function(Ge,$e){return wo("complex")},Ke.prototype.real=function(Ge){return wo("real")},Ke.prototype.imag=function(Ge){return wo("imag")},Ke.prototype.cropAndResize=function(Ge,$e,Ye,Qe,Je,Mt){return wo("cropAndResize")},Ke.prototype.depthToSpace=function(Ge,$e,Ye){return wo("depthToSpace")},Ke.prototype.split=function(Ge,$e,Ye){return wo("split")},Ke.prototype.sparseToDense=function(Ge,$e,Ye,Qe){return wo("sparseToDense")},Ke.prototype.diag=function(Ge){return wo("diag")},Ke.prototype.fill=function(Ge,$e,Ye){return wo("fill")},Ke.prototype.onesLike=function(Ge){return wo("onesLike")},Ke.prototype.zerosLike=function(Ge){return wo("zerosLike")},Ke.prototype.linspace=function(Ge,$e,Ye){return wo("linspace")},Ke.prototype.dispose=function(){return wo("dispose")},Ke}();function wo(Ke){throw new Error("'"+Ke+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function Co(Ke,Ge){for(var $e=Ke.length,Ye=[],Qe=0;Qe<$e;Qe++){var Je=$e-1-Qe,Mt=Ke[Je]||1;(Ge[Ge.length-1-Qe]||1)>1&&Mt===1&&Ye.unshift(Je)}return Ye}function Eo(Ke,Ge){for(var $e=[],Ye=0;Ye<Ge.length;Ye++){var Qe=Ke[Ke.length-Ye-1],Je=Ge.length-Ye-1,Mt=Ge[Je];(Qe==null||Qe===1&&Mt>1)&&$e.unshift(Je)}return $e}function Ro(Ke,Ge){for(var $e=[],Ye=Math.max(Ke.length,Ge.length),Qe=0;Qe<Ye;Qe++){var Je=Ke[Ke.length-Qe-1];Je==null&&(Je=1);var Mt=Ge[Ge.length-Qe-1];if(Mt==null&&(Mt=1),Je===1)$e.unshift(Mt);else if(Mt===1)$e.unshift(Je);else{if(Je!==Mt)throw Error("Operands could not be broadcast together with shapes "+Ke+" and "+Ge+".");$e.unshift(Je)}}return $e}function Io(Ke,Ge,$e,Ye,Qe,Je,Mt){Mt===void 0&&(Mt="channelsLast");var nn,an=To(Ge),sn=an[0],ln=an[1];if(Mt==="channelsLast")nn=[sn,ln,Ke[3],Ke[3]];else{if(Mt!=="channelsFirst")throw new Error("Unknown dataFormat "+Mt);nn=[sn,ln,Ke[1],Ke[1]]}return So(Ke,nn,$e,Ye,Qe,Je,!1,Mt)}function ko(Ke,Ge,$e,Ye,Qe,Je,Mt){Mt===void 0&&(Mt="NDHWC");var nn,an,sn=No(Ge),ln=sn[0],fn=sn[1],hn=sn[2];if(Mt==="NDHWC")an="channelsLast",nn=[ln,fn,hn,Ke[4],Ke[4]];else{if(Mt!=="NCDHW")throw new Error("Unknown dataFormat "+Mt);an="channelsFirst",nn=[ln,fn,hn,Ke[1],Ke[1]]}return Ao(Ke,nn,$e,Ye,Qe,!1,an,Je)}function So(Ke,Ge,$e,Ye,Qe,Je,Mt,nn){Mt===void 0&&(Mt=!1),nn===void 0&&(nn="channelsLast");var an=[-1,-1,-1,-1],sn=an[0],ln=an[1],fn=an[2],hn=an[3];if(nn==="channelsLast")sn=Ke[0],ln=Ke[1],fn=Ke[2],hn=Ke[3];else{if(nn!=="channelsFirst")throw new Error("Unknown dataFormat "+nn);sn=Ke[0],hn=Ke[1],ln=Ke[2],fn=Ke[3]}var Xr,Mi=Ge[0],co=Ge[1],lo=Ge[3],uo=To($e),ho=uo[0],mo=uo[1],_d=To(Ye),ep=_d[0],rp=_d[1],sp=Fo(Mi,ep),op=Fo(co,rp),ip=function(Mp,Np,wp,Sp,Cp,Ip,cp,Ep){var Fp,Hp,zp;if(typeof Mp=="number"){Fp={top:Mp,bottom:Mp,left:Mp,right:Mp,type:Mp===0?"VALID":"NUMBER"};var Gp=function(fp,hp,Bp,Vp,Jp){Vp==null&&(Vp=Do(fp,hp,Bp));var Xp=fp[0],tm=fp[1],bm=_o((Xp-hp+2*Vp)/Bp+1,Jp);C(A(bm),function(){return"The output # of rows ("+bm+") must be an integer. Change the stride and/or zero pad parameters"});var xm=_o((tm-hp+2*Vp)/Bp+1,Jp);return C(A(xm),function(){return"The output # of columns ("+xm+") must be an integer. Change the stride and/or zero pad parameters"}),[bm,xm]}([Np,wp],Ip,Sp,Mp,Ep);Hp=Gp[0],zp=Gp[1]}else if(Mp==="same"){Hp=Math.ceil(Np/Sp),zp=Math.ceil(wp/Cp);var mp=Math.max(0,(Hp-1)*Sp+Ip-Np),yp=Math.max(0,(zp-1)*Cp+cp-wp),Tp=Math.floor(mp/2),qp=mp-Tp,$p=Math.floor(yp/2);Fp={top:Tp,bottom:qp,left:$p,right:yp-$p,type:"SAME"}}else{if(Mp!=="valid")throw Error("Unknown padding parameter: "+Mp);Fp={top:0,bottom:0,left:0,right:0,type:"VALID"},Hp=Math.ceil((Np-Ip+1)/Sp),zp=Math.ceil((wp-cp+1)/Cp)}return{padInfo:Fp,outHeight:Hp,outWidth:zp}}(Qe,ln,fn,ho,mo,sp,op,Je),lp=ip.padInfo,vp=ip.outHeight,gp=ip.outWidth,Op=Mt?lo*hn:lo;return nn==="channelsFirst"?Xr=[sn,Op,vp,gp]:nn==="channelsLast"&&(Xr=[sn,vp,gp,Op]),{batchSize:sn,dataFormat:nn,inHeight:ln,inWidth:fn,inChannels:hn,outHeight:vp,outWidth:gp,outChannels:Op,padInfo:lp,strideHeight:ho,strideWidth:mo,filterHeight:Mi,filterWidth:co,effectiveFilterHeight:sp,effectiveFilterWidth:op,dilationHeight:ep,dilationWidth:rp,inShape:Ke,outShape:Xr,filterShape:Ge}}function Ao(Ke,Ge,$e,Ye,Qe,Je,Mt,nn){Je===void 0&&(Je=!1),Mt===void 0&&(Mt="channelsLast");var an=[-1,-1,-1,-1,-1],sn=an[0],ln=an[1],fn=an[2],hn=an[3],Xr=an[4];if(Mt==="channelsLast")sn=Ke[0],ln=Ke[1],fn=Ke[2],hn=Ke[3],Xr=Ke[4];else{if(Mt!=="channelsFirst")throw new Error("Unknown dataFormat "+Mt);sn=Ke[0],Xr=Ke[1],ln=Ke[2],fn=Ke[3],hn=Ke[4]}var Mi,co=Ge[0],lo=Ge[1],uo=Ge[2],ho=Ge[4],mo=No($e),_d=mo[0],ep=mo[1],rp=mo[2],sp=No(Ye),op=sp[0],ip=sp[1],lp=sp[2],vp=Fo(co,op),gp=Fo(lo,ip),Op=Fo(uo,lp),Mp=function(cp,Ep,Fp,Hp,zp,Gp,mp,yp,Tp,qp,$p){var fp,hp,Bp,Vp;if(typeof cp=="number"){fp={top:cp,bottom:cp,left:cp,right:cp,front:cp,back:cp,type:cp===0?"VALID":"NUMBER"};var Jp=function(Em,_m,Km,ap,Uo,tp){Uo==null&&(Uo=Do(Em,_m,ap));var dp=Em[0],xp=Em[1],kp=Em[2],Pp=_o((dp-_m+2*Uo)/ap+1,tp);C(A(Pp),function(){return"The output # of depths ("+Pp+") must be an integer. Change the stride and/or zero pad parameters"});var Qp=_o((xp-_m+2*Uo)/ap+1,tp);C(A(Qp),function(){return"The output # of rows ("+Qp+") must be an integer. Change the stride and/or zero pad parameters"});var dm=_o((kp-_m+2*Uo)/ap+1,tp);return C(A(dm),function(){return"The output # of columns ("+dm+") must be an integer. Change the stride and/or zero pad parameters"}),[Pp,Qp,dm,Km]}([Ep,Fp,Hp,1],yp,1,zp,cp,$p);hp=Jp[0],Bp=Jp[1],Vp=Jp[2]}else if(cp==="same"){hp=Math.ceil(Ep/zp),Bp=Math.ceil(Fp/Gp),Vp=Math.ceil(Hp/mp);var Xp=(hp-1)*zp+yp-Ep,tm=(Bp-1)*Gp+Tp-Fp,bm=(Vp-1)*mp+qp-Hp,xm=Math.floor(Xp/2),Wm=Xp-xm,Nm=Math.floor(tm/2),wm=tm-Nm,Mm=Math.floor(bm/2);fp={top:Nm,bottom:wm,left:Mm,right:bm-Mm,front:xm,back:Wm,type:"SAME"}}else{if(cp!=="valid")throw Error("Unknown padding parameter: "+cp);fp={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},hp=Math.ceil((Ep-yp+1)/zp),Bp=Math.ceil((Fp-Tp+1)/Gp),Vp=Math.ceil((Hp-qp+1)/mp)}return{padInfo:fp,outDepth:hp,outHeight:Bp,outWidth:Vp}}(Qe,ln,fn,hn,_d,ep,rp,vp,gp,Op,nn),Np=Mp.padInfo,wp=Mp.outDepth,Sp=Mp.outHeight,Cp=Mp.outWidth,Ip=Je?ho*Xr:ho;return Mt==="channelsFirst"?Mi=[sn,Ip,wp,Sp,Cp]:Mt==="channelsLast"&&(Mi=[sn,wp,Sp,Cp,Ip]),{batchSize:sn,dataFormat:Mt,inDepth:ln,inHeight:fn,inWidth:hn,inChannels:Xr,outDepth:wp,outHeight:Sp,outWidth:Cp,outChannels:Ip,padInfo:Np,strideDepth:_d,strideHeight:ep,strideWidth:rp,filterDepth:co,filterHeight:lo,filterWidth:uo,effectiveFilterDepth:vp,effectiveFilterHeight:gp,effectiveFilterWidth:Op,dilationDepth:op,dilationHeight:ip,dilationWidth:lp,inShape:Ke,outShape:Mi,filterShape:Ge}}function Do(Ke,Ge,$e,Ye){Ye===void 0&&(Ye=1);var Qe=Fo(Ge,Ye);return Math.floor((Ke[0]*($e-1)-$e+Qe)/2)}function To(Ke){return typeof Ke=="number"?[Ke,Ke,Ke]:Ke.length===2?[Ke[0],Ke[1],1]:Ke}function No(Ke){return typeof Ke=="number"?[Ke,Ke,Ke]:Ke}function Fo(Ke,Ge){return Ge<=1?Ke:Ke+(Ke-1)*(Ge-1)}function _o(Ke,Ge){if(!Ge)return Ke;switch(Ge){case"round":return Math.round(Ke);case"ceil":return Math.ceil(Ke);case"floor":return Math.floor(Ke);default:throw new Error("Unknown roundingMode "+Ge)}}function Oo(Ke){var Ge=To(Ke),$e=Ge[0],Ye=Ge[1],Qe=Ge[2];return $e===1&&Ye===1&&Qe===1}function Mo(Ke,Ge){return Oo(Ke)||Oo(Ge)}function Bo(Ke){if(Ke==="NHWC")return"channelsLast";if(Ke==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+Ke)}function Po(Ke,Ge,$e){if(Ge==="complex64"){if(Ke.dtype==="complex64")return Ke.clone();var Ye=Gn(Ke.shape),Qe=Ke.toFloat(),Je=$e.complex(Qe,Ye);return Ye.dispose(),Qe.dispose(),Je}if(!U(Ke.dtype,Ge))return Lt.makeTensorFromDataId(Ke.dataId,Ke.shape,Ge);if(Ke.dtype==="complex64"){var Mt=$e.real(Ke);return Je=Mt.cast(Ge),Mt.dispose(),Je}if(Ge==="int32")return $e.int(Ke);if(Ge==="bool"){var nn=On(0,Ke.dtype);return Je=$e.notEqual(Ke,nn),nn.dispose(),Je}throw new Error("Error in Cast: failed to cast "+Ke.dtype+" to "+Ge)}function Lo(Ke,Ge){return Lt.makeTensorFromDataId(Ke.dataId,Ge,Ke.dtype)}function Wo(Ke,Ge,$e){var Ye=(Ge-Ke)/($e-1),Qe=tt($e,"float32");Qe[0]=Ke;for(var Je=1;Je<Qe.length;Je++)Qe[Je]=Qe[Je-1]+Ye;return Mn(Qe,"float32")}function Vo(Ke,Ge){if(Ke.length!==Ge.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+Ke.length+", imag: "+Ge.length+".");for(var $e=new Float32Array(2*Ke.length),Ye=0;Ye<$e.length;Ye+=2)$e[Ye]=Ke[Ye/2],$e[Ye+1]=Ge[Ye/2];return $e}function zo(Ke,Ge){return{real:Ke[2*Ge],imag:Ke[2*Ge+1]}}function Go(Ke,Ge,$e,Ye){Ke[2*Ye]=Ge,Ke[2*Ye+1]=$e}function Ho(Ke,Ge,$e){var Ye=($e?2:-2)*Math.PI*(Ke/Ge);return{real:Math.cos(Ye),imag:Math.sin(Ye)}}function qo(Ke,Ge,$e){var Ye=function(Je,Mt,nn){return function(an,sn,ln){for(var fn=0,hn=an.length,Xr=0,Mi=!1;fn<hn;){var co=ln(sn,an[Xr=fn+(hn-fn>>>1)]);co>0?fn=Xr+1:(hn=Xr,Mi=!co)}return Mi?fn:-fn-1}(Je,Mt,nn||Ko)}(Ke,Ge,$e),Qe=Ye<0?-(Ye+1):Ye;Ke.splice(Qe,0,Ge)}function Ko(Ke,Ge){return Ke>Ge?1:Ke<Ge?-1:0}function jo(Ke,Ge,$e,Ye,Qe){return Yo(Ke,Ge,$e,Ye,Qe,0).selectedIndices}function Xo(Ke,Ge,$e,Ye,Qe,Je){var Mt=Yo(Ke,Ge,$e,Ye,Qe,Je);return Mt.numValidOutputs.dispose(),{selectedIndices:Mt.selectedIndices,selectedScores:Mt.selectedScores}}function Yo(Ke,Ge,$e,Ye,Qe,Je,Mt,nn){nn===void 0&&(nn=!1);for(var an=Array.from(Ge).map(function(_d,ep){return{score:_d,boxIndex:ep,suppressBeginIndex:0}}).filter(function(_d){return _d.score>Qe}).sort(Jo),sn=Je>0?-.5/Je:0,ln=[],fn=[];ln.length<$e&&an.length>0;){var hn=an.pop(),Xr=hn.score,Mi=hn.boxIndex,co=hn.suppressBeginIndex;if(Xr<Qe)break;for(var lo=!1,uo=ln.length-1;uo>=co;--uo){var ho=$o(Ke,Mi,ln[uo]);if(ho>=Ye){lo=!0;break}if(hn.score=hn.score*Qo(Ye,sn,ho),hn.score<=Qe)break}hn.suppressBeginIndex=ln.length,lo||(hn.score===Xr?(ln.push(Mi),fn.push(hn.score)):hn.score>Qe&&qo(an,hn,Jo))}var mo=ln.length;return nn&&(ln.fill(0,mo),fn.fill(0,mo)),{selectedIndices:Mn(ln,"int32"),selectedScores:Mn(fn,"float32"),numValidOutputs:On(mo,"int32")}}function $o(Ke,Ge,$e){var Ye=Ke.subarray(4*Ge,4*Ge+4),Qe=Ke.subarray(4*$e,4*$e+4),Je=Math.min(Ye[0],Ye[2]),Mt=Math.min(Ye[1],Ye[3]),nn=Math.max(Ye[0],Ye[2]),an=Math.max(Ye[1],Ye[3]),sn=Math.min(Qe[0],Qe[2]),ln=Math.min(Qe[1],Qe[3]),fn=Math.max(Qe[0],Qe[2]),hn=Math.max(Qe[1],Qe[3]),Xr=(nn-Je)*(an-Mt),Mi=(fn-sn)*(hn-ln);if(Xr<=0||Mi<=0)return 0;var co=Math.max(Je,sn),lo=Math.max(Mt,ln),uo=Math.min(nn,fn),ho=Math.min(an,hn),mo=Math.max(uo-co,0)*Math.max(ho-lo,0);return mo/(Xr+Mi-mo)}function Qo(Ke,Ge,$e){var Ye=Math.exp(Ge*$e*$e);return $e<=Ke?Ye:0}function Jo(Ke,Ge){return Ke.score-Ge.score||Ke.score===Ge.score&&Ge.boxIndex-Ke.boxIndex}function Zo(Ke,Ge,$e){var Ye=new Array(Ke.rank).fill(0),Qe=Ke.shape.slice();return Ge.map(function(Je){Qe[$e]=Je;var Mt=Ke.slice(Ye,Qe);return Ye[$e]+=Je,Mt})}function ta(Ke,Ge){for(var $e=new Array(Ke.rank),Ye=0;Ye<$e.length;Ye++)$e[Ye]=Ke.shape[Ye]*Ge[Ye];var Qe=dr($e,Ke.dtype);for(Ye=0;Ye<Qe.values.length;++Ye){for(var Je=Qe.indexToLoc(Ye),Mt=new Array(Ke.rank),nn=0;nn<Mt.length;nn++)Mt[nn]=Je[nn]%Ke.shape[nn];var an=Ke.locToIndex(Mt);Qe.values[Ye]=Ke.values[an]}return Qe.toTensor()}function ea(Ke,Ge,$e,Ye,Qe){for(var Je=Ge[Ge.length-1],Mt=[Ke.length/Je,Je],nn=Mt[0],an=Mt[1],sn=B($e,nn*Ye),ln=B("int32",nn*Ye),fn=0;fn<nn;fn++){for(var hn=fn*an,Xr=Ke.subarray(hn,hn+an),Mi=[],co=0;co<Xr.length;co++)Mi.push({value:Xr[co],index:co});Mi.sort(function(_d,ep){return ep.value-_d.value});var lo=fn*Ye,uo=sn.subarray(lo,lo+Ye),ho=ln.subarray(lo,lo+Ye);for(co=0;co<Ye;co++)uo[co]=Mi[co].value,ho[co]=Mi[co].index}var mo=Ge.slice();return mo[mo.length-1]=Ye,[Fn(sn,mo,$e),Fn(ln,mo,"int32")]}function na(Ke,Ge){for(var $e=[],Ye=0;Ye<Ge.length;Ye++)Ge[Ye]&&$e.push(Ye);var Qe=dr(Ke,"int32"),Je=dr([$e.length,Ke.length],"int32");for(Ye=0;Ye<$e.length;Ye++){var Mt=Qe.indexToLoc($e[Ye]),nn=Ye*Ke.length;Je.values.set(Mt,nn)}return Je.toTensor()}var ra=function(Ke,Ge){this.outputShape=[],this.outputShape=Ke,this.variableNames=Ge.map(function(Qe,Je){return"T"+Je});var $e=[];this.variableNames.forEach(function(Qe){$e.push("float v"+Qe+" = get"+Qe+"AtOutCoords();")});var Ye=this.variableNames.map(function(Qe){return"v"+Qe}).join(" + ");this.userCode=`
      void main() {
        `+$e.join(`
        `)+`

        float result = `+Ye+`;
        setOutput(result);
      }
    `},oa=function(Ke,Ge){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Ke,this.variableNames=Ge.map(function(Qe,Je){return"T"+Je});var $e=[];this.variableNames.forEach(function(Qe){$e.push("vec4 v"+Qe+" = get"+Qe+"AtOutCoords();")});var Ye=this.variableNames.map(function(Qe){return"v"+Qe}).join(" + ");this.userCode=`
      void main() {
        `+$e.join(`
        `)+`

        vec4 result = `+Ye+`;
        setOutput(result);
      }
    `},aa=function(Ke,Ge,$e){this.variableNames=["A"];var Ye=Ke.windowSize,Qe=Ke.batchSize,Je=Ke.inSize,Mt=Math.ceil(Je/Ye);$e||this.variableNames.push("bestIndicesA"),this.outputShape=[Qe,Mt];var nn=Ge==="max"?">":"<",an=$e?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+Ye+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+Ye+`; i++) {
          int inIdx = `+an+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+nn+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function ia(Ke,Ge){return["x","y","z","w","u","v"].slice(0,Ge).map(function($e){return Ke+"."+$e})}function sa(Ke,Ge){return Ge===1?[Ke]:ia(Ke,Ge)}function ua(){var Ke,Ge,$e,Ye,Qe,Je,Mt,nn,an,sn;return i().getNumber("WEBGL_VERSION")===2?(Ke="#version 300 es",Ge="in",$e="out",Ye="in",Qe="texture",Je="outputColor",Mt="out vec4 outputColor;",nn=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,an="",sn=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(Ke="",Ge="attribute",$e="varying",Ye="varying",Qe="texture2D",Je="gl_FragColor",Mt="",nn=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,an=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,sn=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:Ke,attribute:Ge,varyingVs:$e,varyingFs:Ye,texture2D:Qe,output:Je,defineOutput:Mt,defineSpecialNaN:nn,defineSpecialInf:an,defineRound:sn}}function ca(Ke,Ge,$e){$e===void 0&&($e="index");var Ye=$(Ge);return Ye.map(function(Qe,Je){return"int "+Ke[Je]+" = "+$e+" / "+Qe+"; "+(Je===Ye.length-1?"int "+Ke[Je+1]+" = "+$e+" - "+Ke[Je]+" * "+Qe:"index -= "+Ke[Je]+" * "+Qe)+";"}).join("")}function la(Ke){var Ge=$(Ke).map(function($e){return $e.toString()});return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+Ge[0]+" + coords.y * "+Ge[1]+` + coords.z;
  }
`}var ha=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function fa(Ke,Ge,$e,Ye){var Qe=[];Ke.forEach(function(Xr){var Mi=k(Xr.shapeInfo.logicalShape);Xr.shapeInfo.isUniform?Qe.push("uniform float "+Xr.name+(Mi>1?"["+Mi+"]":"")+";"):(Qe.push("uniform sampler2D "+Xr.name+";"),Qe.push("uniform int offset"+Xr.name+";"))});var Je,Mt,nn=Qe.join(`
`),an=Ke.map(function(Xr){return function(Mi,co,lo){lo===void 0&&(lo=!1);var uo="";uo+=lo?pa(Mi):da(Mi);var ho=Mi.shapeInfo.logicalShape,mo=co.logicalShape;return ho.length<=mo.length&&(uo+=lo?function(_d,ep){var rp,sp=_d.name,op=sp.charAt(0).toUpperCase()+sp.slice(1),ip="get"+op+"AtOutCoords",lp=_d.shapeInfo.logicalShape.length,vp=ep.logicalShape.length,gp=Co(_d.shapeInfo.logicalShape,ep.logicalShape),Op=wa(vp),Mp=vp-lp,Np=["x","y","z","w","u","v"];rp=lp===0?"":vp<2&&gp.length>=1?"coords = 0;":gp.map(function(Fp){return"coords."+Np[Fp+Mp]+" = 0;"}).join(`
`);var wp="";wp=vp<2&&lp>0?"coords":_d.shapeInfo.logicalShape.map(function(Fp,Hp){return"coords."+Np[Hp+Mp]}).join(", ");var Sp="return outputValue;",Cp=k(_d.shapeInfo.logicalShape)===1,Ip=k(ep.logicalShape)===1;if(lp!==1||Cp||Ip){if(Cp&&!Ip)Sp=vp===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(gp.length){var cp=lp-2,Ep=lp-1;gp.indexOf(cp)>-1&&gp.indexOf(Ep)>-1?Sp="return vec4(outputValue.x);":gp.indexOf(cp)>-1?Sp="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":gp.indexOf(Ep)>-1&&(Sp="return vec4(outputValue.xx, outputValue.zz);")}}else Sp=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+ip+`() {
      `+Op+` coords = getOutputCoords();
      `+rp+`
      vec4 outputValue = get`+op+"("+wp+`);
      `+Sp+`
    }
  `}(Mi,co):function(_d,ep){var rp=_d.name,sp=rp.charAt(0).toUpperCase()+rp.slice(1),op="get"+sp+"AtOutCoords",ip=ep.texShape,lp=_d.shapeInfo.texShape,vp=_d.shapeInfo.logicalShape.length,gp=ep.logicalShape.length;if(!_d.shapeInfo.isUniform&&vp===gp&&_d.shapeInfo.flatOffset==null&&S(lp,ip))return`
      float `+op+`() {
        return sampleTexture(`+rp+`, resultUV);
      }
    `;var Op,Mp=wa(gp),Np=Co(_d.shapeInfo.logicalShape,ep.logicalShape),wp=gp-vp,Sp=["x","y","z","w","u","v"];Op=vp===0?"":gp<2&&Np.length>=1?"coords = 0;":Np.map(function(Ip){return"coords."+Sp[Ip+wp]+" = 0;"}).join(`
`);var Cp="";return Cp=gp<2&&vp>0?"coords":_d.shapeInfo.logicalShape.map(function(Ip,cp){return"coords."+Sp[cp+wp]}).join(", "),`
    float `+op+`() {
      `+Mp+` coords = getOutputCoords();
      `+Op+`
      return get`+sp+"("+Cp+`);
    }
  `}(Mi,co)),uo}(Xr,Ge,Ye)}).join(`
`),sn=Ge.texShape,ln=ua(),fn=function(Xr){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+Xr.texture2D+`(textureSampler, uv).r;
    }
  `}(ln),hn=function(Xr){return Xr.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+Xr.varyingFs+` vec2 resultUV;
    `+Xr.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+Xr.defineSpecialNaN+`
    `+Xr.defineSpecialInf+`
    `+Xr.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+va+`
    `+ma+`
    `+ga+`
  `}(ln);return Ge.isPacked?(Je=function(Xr,Mi){switch(Xr.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(_d,ep){var rp=[Math.ceil(ep[0]/2),Math.ceil(ep[1]/2)];return rp[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+rp[1]+`.0);
      }
    `:rp[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+rp[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+rp[0]+", "+rp[1]+`));
      return 2 * (resTexRC.x * `+rp[1]+` + resTexRC.y);
    }
  `}(0,Mi);case 2:return function(_d,ep){var rp=[Math.ceil(ep[0]/2),Math.ceil(ep[1]/2)];if(S(_d,ep))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+rp[0]+", "+rp[1]+`));
      }
    `;var sp=Math.ceil(_d[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+rp[0]+", "+rp[1]+`));

      int index = resTexRC.x * `+rp[1]+` + resTexRC.y;
      int r = 2 * (index / `+sp+`);
      int c = imod(index, `+sp+`) * 2;

      return ivec2(r, c);
    }
  `}(Xr,Mi);case 3:return co=Xr,lo=Mi,uo=[Math.ceil(lo[0]/2),Math.ceil(lo[1]/2)],ho=Math.ceil(co[2]/2),mo=ho*Math.ceil(co[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+uo[0]+", "+uo[1]+`));
      int index = resTexRC.x * `+uo[1]+` + resTexRC.y;

      int b = index / `+mo+`;
      index -= b * `+mo+`;

      int r = 2 * (index / `+ho+`);
      int c = imod(index, `+ho+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return function(_d,ep){for(var rp=[Math.ceil(ep[0]/2),Math.ceil(ep[1]/2)],sp=Math.ceil(_d[_d.length-1]/2),op=sp*Math.ceil(_d[_d.length-2]/2),ip=op,lp="",vp="b, r, c",gp=2;gp<_d.length-1;gp++)ip*=_d[_d.length-gp-1],lp=`
      int b`+gp+" = index / "+ip+`;
      index -= b`+gp+" * "+ip+`;
    `+lp,vp="b"+gp+", "+vp;return`
    ivec`+_d.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+rp[0]+", "+rp[1]+`));
      int index = resTexRC.x * `+rp[1]+` + resTexRC.y;

      `+lp+`

      int b = index / `+op+`;
      index -= b * `+op+`;

      int r = 2 * (index / `+sp+`);
      int c = imod(index, `+sp+`) * 2;

      return ivec`+_d.length+"("+vp+`);
    }
  `}(Xr,Mi)}var co,lo,uo,ho,mo}(Ge.logicalShape,sn),Mt=function(Xr){return`
    void setOutput(vec4 val) {
      `+Xr.output+` = val;
    }
  `}(ln)):(Je=function(Xr,Mi){switch(Xr.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(uo,ho){return ho[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+ho[1]+`.0);
      }
    `:ho[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+ho[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+ho[0]+", "+ho[1]+`));
      return resTexRC.x * `+ho[1]+` + resTexRC.y;
    }
  `}(0,Mi);case 2:return function(uo,ho){return S(uo,ho)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+ho[0]+", "+ho[1]+`));
      }
    `:uo[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+ho[0]+", "+ho[1]+`));
        int index = resTexRC.x * `+ho[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:uo[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+ho[0]+", "+ho[1]+`));
        int index = resTexRC.x * `+ho[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+ho[0]+", "+ho[1]+`));
      int index = resTexRC.x * `+ho[1]+` + resTexRC.y;
      int r = index / `+uo[1]+`;
      int c = index - r * `+uo[1]+`;
      return ivec2(r, c);
    }
  `}(Xr,Mi);case 3:return co=Mi,lo=ca(["r","c","d"],Xr),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+co[0]+", "+co[1]+`));
      int index = resTexRC.x * `+co[1]+` + resTexRC.y;
      `+lo+`
      return ivec3(r, c, d);
    }
  `;case 4:return function(uo,ho){var mo=ca(["r","c","d","d2"],uo);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+ho[0]+", "+ho[1]+`));
      int index = resTexRC.x * `+ho[1]+` + resTexRC.y;
      `+mo+`
      return ivec4(r, c, d, d2);
    }
  `}(Xr,Mi);case 5:return function(uo,ho){var mo=ca(["r","c","d","d2","d3"],uo);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+ho[0]+`,
                             `+ho[1]+`));

      int index = resTexRC.x * `+ho[1]+` + resTexRC.y;

      `+mo+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}(Xr,Mi);case 6:return function(uo,ho){var mo=ca(["r","c","d","d2","d3","d4"],uo);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+ho[0]+", "+ho[1]+`));
      int index = resTexRC.x * `+ho[1]+` + resTexRC.y;

      `+mo+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}(Xr,Mi);default:throw new Error(Xr.length+"-D output sampling is not yet supported")}var co,lo}(Ge.logicalShape,sn),Mt=function(Xr){return`
    void setOutput(float val) {
      `+Xr.output+` = vec4(val, 0, 0, 0);
    }
  `}(ln)),Ye&&(hn+=ya),[hn,fn,Mt,nn,Je,an,$e].join(`
`)}function da(Ke){var Ge=Ke.shapeInfo.logicalShape;switch(Ge.length){case 0:return function($e){var Ye=$e.name,Qe="get"+Ye.charAt(0).toUpperCase()+Ye.slice(1);if($e.shapeInfo.isUniform)return"float "+Qe+"() {return "+Ye+";}";var Je=$e.shapeInfo.texShape,Mt=Je[0],nn=Je[1];if(Mt===1&&nn===1)return`
      float `+Qe+`() {
        return sampleTexture(`+Ye+`, halfCR);
      }
    `;var an=$e.shapeInfo.texShape,sn=an[0],ln=an[1],fn=xa(Ye);return`
    float `+Qe+`() {
      vec2 uv = uvFromFlat(`+sn+", "+ln+", "+fn+`);
      return sampleTexture(`+Ye+`, uv);
    }
  `}(Ke);case 1:return function($e){var Ye=$e.name,Qe="get"+Ye.charAt(0).toUpperCase()+Ye.slice(1);if($e.shapeInfo.isUniform)return`
      float `+Qe+`(int index) {
        `+ba($e)+`
      }
    `;var Je=$e.shapeInfo.texShape,Mt=Je[0],nn=Je[1];if(nn===1&&Mt===1)return`
      float `+Qe+`(int index) {
        return sampleTexture(`+Ye+`, halfCR);
      }
    `;var an=xa(Ye);return nn===1?`
      float `+Qe+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+an+") + 0.5) / "+Mt+`.0);
        return sampleTexture(`+Ye+`, uv);
      }
    `:Mt===1?`
      float `+Qe+`(int index) {
        vec2 uv = vec2((float(index + `+an+") + 0.5) / "+nn+`.0, 0.5);
        return sampleTexture(`+Ye+`, uv);
      }
    `:`
    float `+Qe+`(int index) {
      vec2 uv = uvFromFlat(`+Mt+", "+nn+", index + "+an+`);
      return sampleTexture(`+Ye+`, uv);
    }
  `}(Ke);case 2:return function($e){var Ye=$e.shapeInfo.logicalShape,Qe=$e.name,Je="get"+Qe.charAt(0).toUpperCase()+Qe.slice(1),Mt=$e.shapeInfo.texShape;if(Mt!=null&&S(Ye,Mt)){var nn=Mt[0],an=Mt[1];return`
    float `+Je+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+an+".0, "+nn+`.0);
      return sampleTexture(`+Qe+`, uv);
    }
  `}var sn=M(Ye),ln=sn.newShape,fn=sn.keptDims,hn=ln;if(hn.length<Ye.length){var Xr=Ca($e,hn);return`
      `+da(Xr)+`
      float `+Je+`(int row, int col) {
        return `+Je+"("+Ea(["row","col"],fn)+`);
      }
    `}if($e.shapeInfo.isUniform)return`
      float `+Je+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+Ye[1]+`, 1)));
        `+ba($e)+`
      }
    `;var Mi=Mt[0],co=Mt[1],lo=xa(Qe);return co===1?`
    float `+Je+`(int row, int col) {
      float index = dot(vec3(row, col, `+lo+"), vec3("+Ye[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+Mi+`.0);
      return sampleTexture(`+Qe+`, uv);
    }
  `:Mi===1?`
    float `+Je+`(int row, int col) {
      float index = dot(vec3(row, col, `+lo+"), vec3("+Ye[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+co+`.0, 0.5);
      return sampleTexture(`+Qe+`, uv);
    }
  `:`
  float `+Je+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+Ye[1]+" + col + "+lo+`;
    vec2 uv = uvFromFlat(`+Mi+", "+co+`, index);
    return sampleTexture(`+Qe+`, uv);
  }
`}(Ke);case 3:return function($e){var Ye=$e.shapeInfo.logicalShape,Qe=$e.name,Je="get"+Qe.charAt(0).toUpperCase()+Qe.slice(1),Mt=Ye[1]*Ye[2],nn=Ye[2],an=M(Ye),sn=an.newShape,ln=an.keptDims,fn=sn;if(fn.length<Ye.length){var hn=Ca($e,fn);return`
        `+da(hn)+`
        float `+Je+`(int row, int col, int depth) {
          return `+Je+"("+Ea(["row","col","depth"],ln)+`);
        }
      `}if($e.shapeInfo.isUniform)return`
      float `+Je+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+Mt+", "+nn+`, 1)));
        `+ba($e)+`
      }
    `;var Xr=$e.shapeInfo.texShape,Mi=Xr[0],co=Xr[1],lo=$e.shapeInfo.flatOffset;if(co===Mt&&lo==null)return`
        float `+Je+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+nn+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+co+".0, "+Mi+`.0);
          return sampleTexture(`+Qe+`, uv);
        }
      `;if(co===nn&&lo==null)return`
    float `+Je+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+Ye[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+co+".0, "+Mi+`.0);
      return sampleTexture(`+Qe+`, uv);
    }
  `;var uo=xa(Qe);return`
      float `+Je+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+Mt+" + col * "+nn+" + depth + "+uo+`;
        vec2 uv = uvFromFlat(`+Mi+", "+co+`, index);
        return sampleTexture(`+Qe+`, uv);
      }
  `}(Ke);case 4:return function($e){var Ye=$e.shapeInfo.logicalShape,Qe=$e.name,Je="get"+Qe.charAt(0).toUpperCase()+Qe.slice(1),Mt=Ye[3],nn=Ye[2]*Mt,an=Ye[1]*nn,sn=M(Ye),ln=sn.newShape,fn=sn.keptDims;if(ln.length<Ye.length){var hn=Ca($e,ln);return`
      `+da(hn)+`
      float `+Je+`(int row, int col, int depth, int depth2) {
        return `+Je+"("+Ea(["row","col","depth","depth2"],fn)+`);
      }
    `}if($e.shapeInfo.isUniform)return`
      float `+Je+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+an+", "+nn+", "+Mt+`, 1)));
        `+ba($e)+`
      }
    `;var Xr=$e.shapeInfo.flatOffset,Mi=$e.shapeInfo.texShape,co=Mi[0],lo=Mi[1];if(lo===an&&Xr==null)return`
      float `+Je+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+nn+", "+Mt+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+lo+".0, "+co+`.0);
        return sampleTexture(`+Qe+`, uv);
      }
    `;if(lo===Mt&&Xr==null)return`
      float `+Je+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+Ye[1]*Ye[2]+", "+Ye[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+lo+".0, "+co+`.0);
        return sampleTexture(`+Qe+`, uv);
      }
    `;var uo=xa(Qe);return`
    float `+Je+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+an+" + col * "+nn+` +
          depth * `+Mt+` + depth2;
      vec2 uv = uvFromFlat(`+co+", "+lo+", index + "+uo+`);
      return sampleTexture(`+Qe+`, uv);
    }
  `}(Ke);case 5:return function($e){var Ye=$e.shapeInfo.logicalShape,Qe=$e.name,Je="get"+Qe.charAt(0).toUpperCase()+Qe.slice(1),Mt=Ye[4],nn=Ye[3]*Mt,an=Ye[2]*nn,sn=Ye[1]*an,ln=M(Ye),fn=ln.newShape,hn=ln.keptDims;if(fn.length<Ye.length){var Xr=Ca($e,fn);return`
      `+da(Xr)+`
      float `+Je+`(int row, int col, int depth, int depth2, int depth3) {
        return `+Je+"("+Ea(["row","col","depth","depth2","depth3"],hn)+`);
      }
    `}if($e.shapeInfo.isUniform)return`
      float `+Je+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+sn+", "+an+", "+nn+", "+Mt+`)) +
          depth3;
        `+ba($e)+`
      }
    `;var Mi=$e.shapeInfo.flatOffset,co=$e.shapeInfo.texShape,lo=co[0],uo=co[1];if(uo===sn&&Mi==null)return`
      float `+Je+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+an+", "+nn+", "+Mt+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+uo+".0, "+lo+`.0);
        return sampleTexture(`+Qe+`, uv);
      }
    `;if(uo===Mt&&Mi==null)return`
      float `+Je+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+Ye[1]*Ye[2]*Ye[3]+`,
               `+Ye[2]*Ye[3]+", "+Ye[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+uo+".0, "+lo+`.0);
        return sampleTexture(`+Qe+`, uv);
      }
    `;var ho=xa(Qe);return`
    float `+Je+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+sn+" + col * "+an+" + depth * "+nn+` +
          depth2 * `+Mt+" + depth3 + "+ho+`;
      vec2 uv = uvFromFlat(`+lo+", "+uo+`, index);
      return sampleTexture(`+Qe+`, uv);
    }
  `}(Ke);case 6:return function($e){var Ye=$e.shapeInfo.logicalShape,Qe=$e.name,Je="get"+Qe.charAt(0).toUpperCase()+Qe.slice(1),Mt=M(Ye),nn=Mt.newShape,an=Mt.keptDims;if(nn.length<Ye.length){var sn=Ca($e,nn);return`
      `+da(sn)+`
      float `+Je+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+Je+"("+Ea(["row","col","depth","depth2","depth3","depth4"],an)+`);
      }
    `}var ln=Ye[5],fn=Ye[4]*ln,hn=Ye[3]*fn,Xr=Ye[2]*hn,Mi=Ye[1]*Xr;if($e.shapeInfo.isUniform)return`
      float `+Je+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+Mi+", "+Xr+", "+hn+", "+fn+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+ln+`, 1)));
        `+ba($e)+`
      }
    `;var co=$e.shapeInfo.flatOffset,lo=$e.shapeInfo.texShape,uo=lo[0],ho=lo[1];if(ho===Mi&&co==null)return`
      float `+Je+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+Xr+", "+hn+", "+fn+", "+ln+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+ho+".0, "+uo+`.0);
        return sampleTexture(`+Qe+`, uv);
      }
    `;if(ho===ln&&co==null)return`
      float `+Je+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+Ye[1]*Ye[2]*Ye[3]*Ye[4]+`,
               `+Ye[2]*Ye[3]*Ye[4]+`,
               `+Ye[3]*Ye[4]+`,
               `+Ye[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+ho+".0, "+uo+`.0);
        return sampleTexture(`+Qe+`, uv);
      }
    `;var mo=xa(Qe);return`
    float `+Je+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+Mi+" + col * "+Xr+" + depth * "+hn+` +
          depth2 * `+fn+" + depth3 * "+ln+" + depth4 + "+mo+`;
      vec2 uv = uvFromFlat(`+uo+", "+ho+`, index);
      return sampleTexture(`+Qe+`, uv);
    }
  `}(Ke);default:throw new Error(Ge.length+"-D input sampling is not yet supported")}}function pa(Ke){var Ge,$e,Ye;switch(Ke.shapeInfo.logicalShape.length){case 0:return Ge=Ke.name,$e="get"+Ge.charAt(0).toUpperCase()+Ge.slice(1),Ye=ua(),`
    vec4 `+$e+`() {
      return `+Ye.texture2D+"("+Ge+`, halfCR);
    }
  `;case 1:return function(Qe){var Je=Qe.name,Mt="get"+Je.charAt(0).toUpperCase()+Je.slice(1),nn=Qe.shapeInfo.texShape,an=[Math.ceil(nn[0]/2),Math.ceil(nn[1]/2)],sn=ua();return`
    vec4 `+Mt+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+an[0]+", "+an[1]+`, index);
      return `+sn.texture2D+"("+Je+`, uv);
    }
  `}(Ke);case 2:return function(Qe){var Je=Qe.shapeInfo.logicalShape,Mt=Qe.name,nn="get"+Mt.charAt(0).toUpperCase()+Mt.slice(1),an=Qe.shapeInfo.texShape,sn=an[0],ln=an[1],fn=ua();if(an!=null&&S(Je,an))return`
      vec4 `+nn+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+ln+".0, "+sn+`.0);

        return `+fn.texture2D+"("+Mt+`, uv);
      }
    `;var hn=[Math.ceil(an[0]/2),Math.ceil(an[1]/2)],Xr=Math.ceil(Je[1]/2);return`
    vec4 `+nn+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+Xr+", "+hn[0]+", "+hn[1]+`, row, col);
      return `+fn.texture2D+"("+Mt+`, uv);
    }
  `}(Ke);case 3:return function(Qe){var Je=Qe.shapeInfo.logicalShape,Mt=Qe.name,nn="get"+Mt.charAt(0).toUpperCase()+Mt.slice(1),an=Qe.shapeInfo.texShape,sn=[Math.ceil(an[0]/2),Math.ceil(an[1]/2)];if(Je[0]===1){var ln=Je.slice(1),fn=Ca(Qe,ln);return`
        `+pa(fn)+`
        vec4 `+nn+`(int b, int row, int col) {
          return `+nn+"("+Ea(["b","row","col"],[1,2])+`);
        }
      `}var hn=sn[0],Xr=sn[1],Mi=Math.ceil(Je[2]/2),co=Mi*Math.ceil(Je[1]/2),lo=ua();return`
    vec4 `+nn+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+hn+", "+Xr+", "+co+", "+Mi+`, b, row, col);
      return `+lo.texture2D+"("+Mt+`, uv);
    }
  `}(Ke);default:return function(Qe){for(var Je=Qe.shapeInfo.logicalShape,Mt=Je.length,nn=Qe.name,an="get"+nn.charAt(0).toUpperCase()+nn.slice(1),sn=Qe.shapeInfo.texShape,ln=[Math.ceil(sn[0]/2),Math.ceil(sn[1]/2)],fn=ln[0],hn=ln[1],Xr=Math.ceil(Je[Mt-1]/2),Mi=Xr*Math.ceil(Je[Mt-2]/2),co="int b, int row, int col",lo="b * "+Mi+" + (row / 2) * "+Xr+" + (col / 2)",uo=2;uo<Mt-1;uo++)co="int b"+uo+", "+co,Mi*=Je[Mt-uo-1],lo="b"+uo+" * "+Mi+" + "+lo;var ho=ua();return`
    vec4 `+an+"("+co+`) {
      int index = `+lo+`;
      int texR = index / `+hn+`;
      int texC = index - texR * `+hn+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+hn+", "+fn+`);
      return `+ho.texture2D+"("+nn+`, uv);
    }
  `}(Ke)}}var va=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,ma=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,ga=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,ya=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function xa(Ke){return"offset"+Ke}function ba(Ke){var Ge=Ke.name,$e=k(Ke.shapeInfo.logicalShape);return $e<2?"return "+Ge+";":`
    for (int i = 0; i < `+$e+`; i++) {
      if (i == index) {
        return `+Ge+`[i];
      }
    }
  `}function wa(Ke){if(Ke<=1)return"int";if(Ke===2)return"ivec2";if(Ke===3)return"ivec3";if(Ke===4)return"ivec4";if(Ke===5)return"ivec5";if(Ke===6)return"ivec6";throw Error("GPU for rank "+Ke+" is not yet supported")}function Ca(Ke,Ge){var $e=JSON.parse(JSON.stringify(Ke));return $e.shapeInfo.logicalShape=Ge,$e}function Ea(Ke,Ge){return Ge.map(function($e){return Ke[$e]}).join(", ")}var Ra=function(Ke,Ge,$e,Ye){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,C(Ke.length>2,function(){return"Packed arg"+($e.charAt(0).toUpperCase()+$e.slice(1))+" supports only inputs with rank above 2."});var Qe=Ke[Ke.length-1],Je=Math.ceil(Qe/Ge);this.outputShape=Ke.slice(0,-1),Je>1&&this.outputShape.push(Je),Ye||this.variableNames.push("bestIndicesA");var Mt,nn,an=this.outputShape,sn=an.length,ln=wa(sn),fn=sa("coords",sn);if(Je===1){var hn=wa(nn=sn+1);Mt=`
        `+hn+" sourceLocR = "+hn+"("+fn.join()+`, 0);
        ++`+fn[sn-1]+`;
        `+hn+" sourceLocG = "+hn+"("+fn.join()+`, 0);
        ++`+fn[sn-2]+`;
        `+hn+" sourceLocA = "+hn+"("+fn.join()+`, 0);
        --`+fn[sn-1]+`;
        `+hn+" sourceLocB = "+hn+"("+fn.join()+`, 0);
        --`+fn[sn-2]+";"}else nn=sn,Mt=`
        `+ln+` sourceLocR = coords;
        ++`+fn[sn-1]+`;
        `+ln+` sourceLocG = coords;
        ++`+fn[sn-2]+`;
        `+ln+` sourceLocA = coords;
        --`+fn[sn-1]+`;
        `+ln+` sourceLocB = coords;
        --`+fn[sn-2]+";";var Xr=["x","y","z","w","u","v"].slice(0,nn),Mi="."+Xr[nn-1],co=Xr.map(function(op){return"int "+op}),lo=sa("sourceLocR",nn-1).concat("inIdx.r"),uo=sa("sourceLocG",nn-1).concat("inIdx.g"),ho=sa("sourceLocB",nn-1).concat("inIdx.b"),mo=sa("sourceLocA",nn-1).concat("inIdx.a"),_d=$e==="max"?"greaterThan":"lessThan",ep=Ye?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+lo.join()+`),
                             getBestIndicesAChannel(`+uo.join()+`),
                             getBestIndicesAChannel(`+ho.join()+`),
                             getBestIndicesAChannel(`+mo.join()+")));",rp=`vec4(
            getAChannel(`+lo.join()+`),
            hasNextCol ? getAChannel(`+uo.join()+`) : 0.,
            hasNextRow ? getAChannel(`+ho.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+mo.join()+") : 0.)",sp=Ye?"":`
      float getBestIndicesAChannel(`+co.join()+`) {
        return getChannel(getBestIndicesA(`+Xr.join()+`),
                                          vec2(`+Xr.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+co.join()+`) {
        return getChannel(getA(`+Xr.join()+`),
                               vec2(`+Xr.slice(-2).join()+`));
      }
      `+sp+`
      void main() {
        `+ln+` coords = getOutputCoords();
        bool hasNextCol = `+fn[sn-1]+" < "+(an[sn-1]-1)+`;
        bool hasNextRow = `+fn[sn-2]+" < "+(an[sn-2]-1)+`;
        `+Mt+`
        ivec4 srcIdx = ivec4(sourceLocR`+Mi+", sourceLocG"+Mi+`,
          sourceLocB`+Mi+", sourceLocA"+Mi+") * "+Ge+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+rp+`;

        for (int i = 0; i < `+Ge+`; i++) {
          inIdx = srcIdx;
          `+ep+`
          vec4 candidate = `+rp+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+_d+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},Ia=function(Ke){this.variableNames=["dy"],this.outputShape=Ke.inShape;var Ge=Ke.filterHeight,$e=Ke.filterWidth,Ye=Ke.strideHeight,Qe=Ke.strideWidth,Je=Ke.dilationHeight,Mt=Ke.dilationWidth,nn=Ke.effectiveFilterHeight,an=Ke.effectiveFilterWidth,sn=nn-1-Ke.padInfo.top,ln=an-1-Ke.padInfo.left,fn=1/(Ge*$e);this.userCode=`
      const ivec2 pads = ivec2(`+sn+", "+ln+`);
      const float avgMultiplier = float(`+fn+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+nn+`;
            wR += `+Je+`) {
          float dyR = float(dyRCorner + wR) / `+Ye+`.0;

          if (dyR < 0.0 || dyR >= `+Ke.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+an+`;
            wC+= `+Mt+`) {
            float dyC = float(dyCCorner + wC) / `+Qe+`.0;

            if (dyC < 0.0 || dyC >= `+Ke.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},ka=function(Ke){this.variableNames=["dy"],this.outputShape=Ke.inShape;var Ge=Ke.filterDepth,$e=Ke.filterHeight,Ye=Ke.filterWidth,Qe=Ke.strideDepth,Je=Ke.strideHeight,Mt=Ke.strideWidth,nn=Ke.dilationDepth,an=Ke.dilationHeight,sn=Ke.dilationWidth,ln=Ke.effectiveFilterDepth,fn=Ke.effectiveFilterHeight,hn=Ke.effectiveFilterWidth,Xr=ln-1-Ke.padInfo.front,Mi=fn-1-Ke.padInfo.top,co=hn-1-Ke.padInfo.left,lo=1/(Ge*$e*Ye);this.userCode=`
      const ivec3 pads = ivec3(`+Xr+", "+Mi+", "+co+`);
      const float avgMultiplier = float(`+lo+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+ln+`;
            wD += `+nn+`) {
          float dyD = float(dyDCorner + wD) / `+Qe+`.0;

          if (dyD < 0.0 || dyD >= `+Ke.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+fn+`;
              wR += `+an+`) {
            float dyR = float(dyRCorner + wR) / `+Je+`.0;

            if (dyR < 0.0 || dyR >= `+Ke.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+hn+`;
                wC += `+sn+`) {
              float dyC = float(dyCCorner + wC) / `+Mt+`.0;

              if (dyC < 0.0 || dyC >= `+Ke.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},Sa=function(Ke,Ge,$e,Ye,Qe,Je){this.outputShape=[],this.variableNames=["x","mean","variance"],Ro(Ke,Ge),Ro(Ke,$e);var Mt="0.0";Ye!=null&&(Ro(Ke,Ye),this.variableNames.push("offset"),Mt="getOffsetAtOutCoords()");var nn="1.0";Qe!=null&&(Ro(Ke,Qe),this.variableNames.push("scale"),nn="getScaleAtOutCoords()"),this.outputShape=Ke,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+Mt+`;
        float scale = `+nn+`;
        float inv = scale * inversesqrt(variance + float(`+Je+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},Aa=function(Ke,Ge,$e,Ye,Qe,Je){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Ro(Ke,Ge),Ro(Ke,$e);var Mt="vec4(0.0)";Ye!=null&&(Ro(Ke,Ye),this.variableNames.push("offset"),Mt="getOffsetAtOutCoords()");var nn="vec4(1.0)";Qe!=null&&(Ro(Ke,Qe),this.variableNames.push("scale"),nn="getScaleAtOutCoords()"),this.outputShape=Ke,this.userCode=`
      void main() {
        vec4 offset = `+Mt+`;
        vec4 scale = `+nn+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+Je+`));

        setOutput((x - mean) * inv + offset);
      }
    `},Da="return areal * breal - aimag * bimag;",Ta="return areal * bimag + aimag * breal;",Na=function(Ke,Ge,$e){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Ro(Ge,$e),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+Ke+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},Fa="return a + b;",_a="return a - b;",Oa="return a * b;",Ma="return (a < 0.) ? b * a : a;",Ba=function(Ke,Ge,$e){this.variableNames=["A","B"],this.outputShape=Ro(Ge,$e),this.userCode=`
      float binaryOperation(float a, float b) {
        `+Ke+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},Pa=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,La=function(Ke,Ge,$e,Ye){Ye===void 0&&(Ye=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Ro(Ge,$e);var Qe=this.outputShape.length,Je="";if(Ye)if(Qe===0||k(this.outputShape)===1)Je=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(Je=`
          `+wa(Qe)+` coords = getOutputCoords();
        `,Qe===1)Je+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var Mt=sa("coords",Qe);Je+=`
            bool nextRowOutOfBounds =
              (`+Mt[Qe-2]+" + 1) >= "+this.outputShape[Qe-2]+`;
            bool nextColOutOfBounds =
              (`+Mt[Qe-1]+" + 1) >= "+this.outputShape[Qe-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+Ke+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+Je+`

        setOutput(result);
      }
    `},Wa=function(){function Ke(Ge){this.variableNames=["A"],this.outputShape=Ge,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return Ke.prototype.getCustomSetupFunc=function(Ge,$e){var Ye=this;return function(Qe,Je){Ye.minLoc==null&&(Ye.minLoc=Qe.getUniformLocationNoThrow(Je,"minVal"),Ye.maxLoc=Qe.getUniformLocationNoThrow(Je,"maxVal")),Qe.gl.uniform1f(Ye.minLoc,Ge),Qe.gl.uniform1f(Ye.maxLoc,$e)}},Ke}(),Ua=function(){function Ke(Ge){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Ge,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return Ke.prototype.getCustomSetupFunc=function(Ge,$e){var Ye=this;return function(Qe,Je){Ye.minLoc==null&&(Ye.minLoc=Qe.getUniformLocationNoThrow(Je,"minVal"),Ye.maxLoc=Qe.getUniformLocationNoThrow(Je,"maxVal")),Qe.gl.uniform1f(Ye.minLoc,Ge),Qe.gl.uniform1f(Ye.maxLoc,$e)}},Ke}(),Va=function(Ke){this.variableNames=["real","imag"],this.outputShape=Ke,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},za=function(Ke){this.outputShape=[],this.outputShape=Sn(Ke,1),this.variableNames=Ke.map(function(nn,an){return"T"+an});var Ge=new Array(Ke.length-1);Ge[0]=Ke[0][1];for(var $e=1;$e<Ge.length;$e++)Ge[$e]=Ge[$e-1]+Ke[$e][1];var Ye=["if (yC < "+Ge[0]+") setOutput(getT0(yR, yC));"];for($e=1;$e<Ge.length;$e++){var Qe=Ge[$e-1];Ye.push("else if (yC < "+Ge[$e]+") setOutput(getT"+$e+"(yR, yC-"+Qe+"));")}var Je=Ge.length,Mt=Ge[Ge.length-1];Ye.push("else setOutput(getT"+Je+"(yR, yC-"+Mt+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+Ye.join(`
        `)+`
      }
    `},Ga=function(Ke,Ge){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Sn(Ke,Ge);var $e=this.outputShape,Ye=$e.length,Qe=wa(Ye),Je=sa("coords",Ye),Mt=["x","y","z","w","u","v"].slice(0,Ye);this.variableNames=Ke.map(function(lo,uo){return"T"+uo});var nn=new Array(Ke.length-1);nn[0]=Ke[0][Ge];for(var an=1;an<nn.length;an++)nn[an]=nn[an-1]+Ke[an][Ge];var sn=Mt[Ge],ln=Mt.slice(-2),fn=Mt.join(),hn="if ("+sn+" < "+nn[0]+`) {
        return getChannel(
            getT0(`+fn+"), vec2("+ln.join()+`));
        }`;for(an=1;an<nn.length;an++){var Xr=nn[an-1];hn+=`
        if (`+sn+" < "+nn[an]+"  && "+sn+" >= "+nn[an-1]+`) {
          return getChannel(
            getT`+an+"("+Ha(Mt,sn,Xr)+`),
            vec2(`+Ha(ln,sn,Xr)+`));
        }`}var Mi=nn.length,co=nn[nn.length-1];hn+=`
        return getChannel(
          getT`+Mi+"("+Ha(Mt,sn,co)+`),
          vec2(`+Ha(ln,sn,co)+"));",this.userCode=`
      float getValue(`+Mt.map(function(lo){return"int "+lo})+`) {
        `+hn+`
      }

      void main() {
        `+Qe+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+Je+`), 0., 0., 0.);

        `+Je[Ye-1]+" = "+Je[Ye-1]+` + 1;
        if (`+Je[Ye-1]+" < "+$e[Ye-1]+`) {
          result.g = getValue(`+Je+`);
        }

        `+Je[Ye-2]+" = "+Je[Ye-2]+` + 1;
        if (`+Je[Ye-2]+" < "+$e[Ye-2]+`) {
          result.a = getValue(`+Je+`);
        }

        `+Je[Ye-1]+" = "+Je[Ye-1]+` - 1;
        if (`+Je[Ye-2]+" < "+$e[Ye-2]+` &&
            `+Je[Ye-1]+" < "+$e[Ye-1]+`) {
          result.b = getValue(`+Je+`);
        }
        setOutput(result);
      }
    `};function Ha(Ke,Ge,$e){var Ye=Ke.indexOf(Ge);return Ke.map(function(Qe,Je){return Je===Ye?Qe+" - "+$e:Qe}).join()}var qa=function(Ke){this.variableNames=["x","dy"],this.outputShape=Ke.filterShape;var Ge=Ke.strideHeight,$e=Ke.strideWidth,Ye=Ke.padInfo.top,Qe=Ke.padInfo.left,Je=Ke.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+Ke.batchSize+`; b++) {
          for (int yR = 0; yR < `+Ke.outHeight+`; yR++) {
            int xR = wR + yR * `+Ge+" - "+Ye+`;

            if (xR < 0 || xR >= `+Ke.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+Ke.outWidth+`; yC++) {
              int xC = wC + yC * `+$e+" - "+Qe+`;

              if (xC < 0 || xC >= `+Ke.inWidth+`) {
                continue;
              }

              if (`+Je+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},Ka=function(Ke){this.variableNames=["dy","W"],this.outputShape=Ke.inShape;var Ge=Ke.filterHeight,$e=Ke.filterWidth,Ye=Ke.strideHeight,Qe=Ke.strideWidth,Je=Ke.dataFormat==="channelsLast",Mt=Ge-1-Ke.padInfo.top,nn=$e-1-Ke.padInfo.left,an=Je?1:2,sn=Je?2:3,ln=Je?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+Mt+", "+nn+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+ln+`];

        ivec2 dyCorner = ivec2(coords[`+an+"], coords["+sn+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+Ge+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+Ye+`.0;

          if (dyR < 0.0 || dyR >= `+Ke.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+Ge+` - 1 - wR;

          for (int wC = 0; wC < `+$e+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+Qe+`.0;

            if (dyC < 0.0 || dyC >= `+Ke.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+$e+` - 1 - wC;

            for (int d2 = 0; d2 < `+Ke.outChannels+`; d2++) {

              if (`+Je+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},ja=function(Ke){this.variableNames=["x","dy"],this.outputShape=Ke.filterShape;var Ge=Ke.strideDepth,$e=Ke.strideHeight,Ye=Ke.strideWidth,Qe=Ke.padInfo.front,Je=Ke.padInfo.top,Mt=Ke.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+Ke.batchSize+`; b++) {
          for (int yF = 0; yF < `+Ke.outDepth+`; yF++) {
            int xF = wF + yF * `+Ge+" - "+Qe+`;

            if (xF < 0 || xF >= `+Ke.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+Ke.outHeight+`; yR++) {
              int xR = wR + yR * `+$e+" - "+Je+`;

              if (xR < 0 || xR >= `+Ke.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+Ke.outWidth+`; yC++) {
                int xC = wC + yC * `+Ye+" - "+Mt+`;

                if (xC < 0 || xC >= `+Ke.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},Xa=function(Ke){this.variableNames=["dy","W"],this.outputShape=Ke.inShape;var Ge=Ke.filterDepth,$e=Ke.filterHeight,Ye=Ke.filterWidth,Qe=Ke.strideDepth,Je=Ke.strideHeight,Mt=Ke.strideWidth,nn=Ge-1-Ke.padInfo.front,an=$e-1-Ke.padInfo.top,sn=Ye-1-Ke.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+nn+", "+an+", "+sn+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+Ge+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+Qe+`.0;

          if (dyF < 0.0 || dyF >= `+Ke.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+Ge+` - 1 - wF;

          for (int wR = 0; wR < `+$e+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+Je+`.0;

            if (dyR < 0.0 || dyR >= `+Ke.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+$e+` - 1 - wR;

            for (int wC = 0; wC < `+Ye+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+Mt+`.0;

              if (dyC < 0.0 || dyC >= `+Ke.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+Ye+` - 1 - wC;

              for (int d2 = 0; d2 < `+Ke.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},Ya=function(Ke){this.variableNames=["x","dy"],this.outputShape=Ke.filterShape;var Ge=Ke.strideHeight,$e=Ke.strideWidth,Ye=Ke.padInfo.top,Qe=Ke.padInfo.left,Je=Ke.outChannels/Ke.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+Je+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+Ke.batchSize+`; b++) {
          for (int yR = 0; yR < `+Ke.outHeight+`; yR++) {
            int xR = wR + yR * `+Ge+" - "+Ye+`;

            if (xR < 0 || xR >= `+Ke.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+Ke.outWidth+`; yC++) {
              int xC = wC + yC * `+$e+" - "+Qe+`;

              if (xC < 0 || xC >= `+Ke.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},$a=function(Ke){this.variableNames=["dy","W"],this.outputShape=Ke.inShape;var Ge=Ke.filterHeight,$e=Ke.filterWidth,Ye=Ke.strideHeight,Qe=Ke.strideWidth,Je=Ge-1-Ke.padInfo.top,Mt=$e-1-Ke.padInfo.left,nn=Ke.outChannels/Ke.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+Je+", "+Mt+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+Ge+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+Ye+`.0;

          if (dyR < 0.0 || dyR >= `+Ke.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+Ge+` - 1 - wR;

          for (int wC = 0; wC < `+$e+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+Qe+`.0;

            if (dyC < 0.0 || dyC >= `+Ke.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+$e+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+nn+`; dm++) {
              int d2 = d1 * `+nn+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},Qa=function(Ke,Ge,$e,Ye){Ge===void 0&&(Ge=!1),$e===void 0&&($e=null),Ye===void 0&&(Ye=!1),this.variableNames=["x","W"],this.outputShape=Ke.outShape;var Qe=Ke.padInfo.top,Je=Ke.padInfo.left,Mt=Ke.strideHeight,nn=Ke.strideWidth,an=Ke.dilationHeight,sn=Ke.dilationWidth,ln=Ke.filterHeight,fn=Ke.filterWidth,hn=4*Math.floor(Ke.inChannels/4),Xr=Ke.inChannels%4,Mi=Ke.dataFormat==="channelsLast",co=Mi?1:2,lo=Mi?2:3,uo=Mi?3:1,ho="",mo="";$e&&(ho=Ye?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+$e+`
        }`:`
          float activation(float x) {
            `+$e+`
          }
        `,mo="result = activation(result);");var _d=Ge?"result += getBiasAtOutCoords();":"";Ge&&this.variableNames.push("bias"),Ye&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+ho+`

      const ivec2 strides = ivec2(`+Mt+", "+nn+`);
      const ivec2 pads = ivec2(`+Qe+", "+Je+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+uo+`];

        ivec2 xRCCorner =
            ivec2(coords[`+co+"], coords["+lo+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+ln+`; wR++) {
          int xR = xRCorner + wR * `+an+`;

          if (xR < 0 || xR >= `+Ke.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+fn+`; wC++) {
            int xC = xCCorner + wC * `+sn+`;

            if (xC < 0 || xC >= `+Ke.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+hn+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+Mi+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(Xr===1)+`) {

              if (`+Mi+`) {
                dotProd +=
                    getX(batch, xR, xC, `+hn+`) *
                    getW(wR, wC, `+hn+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+hn+`, xR, xC) *
                    getW(wR, wC, `+hn+`, d2);
              }

            } else if (`+(Xr===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+hn+`, d2),
                getW(wR, wC, `+hn+` + 1, d2)
              );

              if (`+Mi+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+hn+`),
                  getX(batch, xR, xC, `+hn+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+hn+`, xR, xC),
                  getX(batch, `+hn+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(Xr===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+hn+`, d2),
                getW(wR, wC, `+hn+` + 1, d2),
                getW(wR, wC, `+hn+` + 2, d2)
              );

              if (`+Mi+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+hn+`),
                  getX(batch, xR, xC, `+hn+` + 1),
                  getX(batch, xR, xC, `+hn+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+hn+`, xR, xC),
                  getX(batch, `+hn+` + 1, xR, xC),
                  getX(batch, `+hn+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+_d+`
        `+mo+`
        setOutput(result);
      }
    `},Ja=function(Ke){this.variableNames=["x","W"],this.outputShape=Ke.outShape;var Ge=Ke.padInfo.front,$e=Ke.padInfo.top,Ye=Ke.padInfo.left,Qe=Ke.strideDepth,Je=Ke.strideHeight,Mt=Ke.strideWidth,nn=Ke.dilationDepth,an=Ke.dilationHeight,sn=Ke.dilationWidth,ln=Ke.filterDepth,fn=Ke.filterHeight,hn=Ke.filterWidth,Xr=4*Math.floor(Ke.inChannels/4),Mi=Ke.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+Qe+", "+Je+", "+Mt+`);
      const ivec3 pads = ivec3(`+Ge+", "+$e+", "+Ye+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+ln+`; wF++) {
          int xF = xFCorner + wF * `+nn+`;

          if (xF < 0 || xF >= `+Ke.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+fn+`; wR++) {
            int xR = xRCorner + wR * `+an+`;

            if (xR < 0 || xR >= `+Ke.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+hn+`; wC++) {
              int xC = xCCorner + wC * `+sn+`;

              if (xC < 0 || xC >= `+Ke.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+Xr+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(Mi===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+Xr+`) *
                  getW(wF, wR, wC, `+Xr+`, d2);
              } else if (`+(Mi===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+Xr+`),
                  getX(batch, xF, xR, xC, `+Xr+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+Xr+`, d2),
                  getW(wF, wR, wC, `+Xr+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(Mi===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+Xr+`),
                  getX(batch, xF, xR, xC, `+Xr+` + 1),
                  getX(batch, xF, xR, xC, `+Xr+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+Xr+`, d2),
                  getW(wF, wR, wC, `+Xr+` + 1, d2),
                  getW(wF, wR, wC, `+Xr+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},Za=function(Ke,Ge,$e,Ye){Ge===void 0&&(Ge=!1),$e===void 0&&($e=null),Ye===void 0&&(Ye=!1),this.variableNames=["x","W"],this.outputShape=Ke.outShape;var Qe=Ke.inHeight,Je=Ke.inWidth,Mt=Ke.padInfo.top,nn=Ke.padInfo.left,an=Ke.strideHeight,sn=Ke.strideWidth,ln=Ke.dilationHeight,fn=Ke.dilationWidth,hn=Ke.filterHeight,Xr=Ke.filterWidth,Mi=Ke.outChannels/Ke.inChannels,co="",lo="";$e&&(co=Ye?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+$e+`
        }`:`
          float activation(float x) {
            `+$e+`
          }
        `,lo="result = activation(result);");var uo=Ge?"result += getBiasAtOutCoords();":"";Ge&&this.variableNames.push("bias"),Ye&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+co+`

      const ivec2 strides = ivec2(`+an+", "+sn+`);
      const ivec2 pads = ivec2(`+Mt+", "+nn+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+Mi+`;
        int q = d2 - d1 * `+Mi+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+hn+`; wR++) {
          int xR = xRCorner + wR * `+ln+`;

          if (xR < 0 || xR >= `+Qe+`) {
            continue;
          }

          for (int wC = 0; wC < `+Xr+`; wC++) {
            int xC = xCCorner + wC * `+fn+`;

            if (xC < 0 || xC >= `+Je+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+uo+`
        `+lo+`
        setOutput(result);
      }
    `},ti=function(Ke,Ge,$e,Ye){Ge===void 0&&(Ge=!1),$e===void 0&&($e=null),Ye===void 0&&(Ye=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Ke.outShape;for(var Qe=Ke.inHeight,Je=Ke.inWidth,Mt=Ke.padInfo.top,nn=Ke.padInfo.left,an=Ke.strideHeight,sn=Ke.strideWidth,ln=Ke.dilationHeight,fn=Ke.dilationWidth,hn=Ke.filterHeight,Xr=Ke.filterWidth,Mi=Xr,co="int xR; int xC; int xCOffset;",lo=0;lo<hn;lo++)for(var uo=0;uo<Xr;uo++)co+=`
          vec4 xTexelR`+lo+"C"+2*uo+` = vec4(0.);
          vec4 wR`+lo+"C"+uo+` = vec4(0.);
          vec4 xR`+lo+"C"+uo+" = vec4(0.);";for(lo=0;lo<hn;lo++)for(var ho=0;ho<Mi;ho++){if(co+=`
          xR = xRCorner + `+lo*ln+`;
          xC = xCCorner + `+(uo=2*ho)*fn+`;
        `,sn===1){if(uo<Xr&&(co+=nn%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+Qe+" && xCOffset >= 0 && xCOffset < "+Je+`) {
                  xTexelR`+lo+"C"+uo+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+Je+`) {
                    xTexelR`+lo+"C"+uo+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+lo+"C"+uo+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+Qe+" && xCOffset >= 0 && xCOffset < "+Je+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+Je+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+lo+"C"+uo+" = vec4(previous.zw, xTexelR"+lo+"C"+uo+`.xy);
                } else {
                  xR`+lo+"C"+uo+" = vec4(0, 0, xTexelR"+lo+"C"+uo+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+Qe+" && xC >= 0 && xC < "+Je+`) {
                  xTexelR`+lo+"C"+uo+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+lo+"C"+uo+` = vec4(0.);
                }

                xR`+lo+"C"+uo+" = xTexelR"+lo+"C"+uo+`;
              `,uo+1<Xr)){var mo=nn%2==0?b(fn):fn;fn%2==0&&nn%2==1||fn%2!=0&&nn%2!=1?(co+=`
                  xCOffset = xC + `+nn%2+" + "+mo+`;

                  if(xR >= 0 && xR < `+Qe+` &&
                    xCOffset >= 0 && xCOffset < `+Je+`) {
                    xTexelR`+lo+"C"+(uo+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,fn>1&&(co+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+Qe+` &&
                      xCOffset >= 0 && xCOffset < `+Je+`) {
                      xTexelR`+lo+"C"+uo+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+lo+"C"+uo+` = vec4(0.);
                    }
                  `),co+=`
                  xR`+lo+"C"+(uo+1)+` = vec4(
                    xTexelR`+lo+"C"+uo+".zw, xTexelR"+lo+"C"+(uo+2)+`.xy);
                `):co+=`
                  xCOffset = xC + `+mo+`;

                  if(xR >= 0 && xR < `+Qe+` &&
                    xCOffset >= 0 && xCOffset < `+Je+`) {
                    xTexelR`+lo+"C"+(uo+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+lo+"C"+(uo+1)+" = xTexelR"+lo+"C"+(uo+2)+`;
                `}}else uo<Xr&&(co+=`
              if(xR >= 0 && xR < `+Qe+`) {
            `,nn%2==1?(co+=`
                xCOffset = xC + 1 - `+sn+`;
                if(xCOffset >= 0 && xCOffset < `+Je+`) {
                  xTexelR`+lo+"C"+uo+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+lo+"C"+uo+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+Je+`) {
                  xTexelR`+lo+"C"+(uo+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+lo+"C"+(uo+2)+` = vec4(0.);
                }

                xR`+lo+"C"+uo+` = vec4(
                  xTexelR`+lo+"C"+uo+".zw, xTexelR"+lo+"C"+(uo+2)+`.zw);
              `,uo+1<Xr&&(co+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+sn+`;
                  if(xCOffset >= 0 && xCOffset < `+Je+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+lo+"C"+(uo+1)+" = vec4(xTexelR"+lo+"C"+(uo+2)+`.xy, final.xy);
                `)):(co+=`
                if(xC >= 0 && xC < `+Je+`) {
                  xTexelR`+lo+"C"+uo+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+lo+"C"+uo+` = vec4(0.);
                }

                xCOffset = xC + `+sn+`;
                if(xCOffset >= 0 && xCOffset < `+Je+`) {
                  xTexelR`+lo+"C"+(uo+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+lo+"C"+(uo+2)+` = vec4(0.);
                }

                xR`+lo+"C"+uo+` = vec4(
                  xTexelR`+lo+"C"+uo+".xy, xTexelR"+lo+"C"+(uo+2)+`.xy);
              `,uo+1<Xr&&(co+=`
                  xR`+lo+"C"+(uo+1)+` = vec4(
                    xTexelR`+lo+"C"+uo+".zw, xTexelR"+lo+"C"+(uo+2)+`.zw);
                `)),co+="}");uo<Xr&&(co+=`
            vec4 wTexelR`+lo+"C"+uo+" = getW("+lo+", "+uo+`, d1, q);
            wR`+lo+"C"+uo+" = vec4(wTexelR"+lo+"C"+uo+".xz, wTexelR"+lo+"C"+uo+`.xz);
          `,uo+1<Xr&&(co+=`
              vec4 wTexelR`+lo+"C"+(uo+1)+" = getW("+lo+", "+(uo+1)+`, d1, q);
              wR`+lo+"C"+(uo+1)+` =
                vec4(wTexelR`+lo+"C"+(uo+1)+".xz, wTexelR"+lo+"C"+(uo+1)+".xz);"))}for(lo=0;lo<hn;lo++)for(uo=0;uo<Xr;uo++)co+="dotProd += xR"+lo+"C"+uo+" * wR"+lo+"C"+uo+";";var _d="",ep="";$e&&(_d=Ye?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+$e+`
        }`:`vec4 activation(vec4 x) {
          `+$e+`
        }`,ep="result = activation(result);");var rp=Ge?"result += getBiasAtOutCoords();":"";Ge&&this.variableNames.push("bias"),Ye&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+_d+`

      const ivec2 strides = ivec2(`+an+", "+sn+`);
      const ivec2 pads = ivec2(`+Mt+", "+nn+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+co+`

        vec4 result = dotProd;
        `+rp+`
        `+ep+`
        setOutput(result);
      }
    `},ei=function(Ke,Ge,$e,Ye,Qe){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var Je=Ke[0],Mt=Ke[1],nn=Ke[2],an=Ke[3],sn=Ge[0],ln=$e[0],fn=$e[1];this.outputShape=[sn,ln,fn,an];var hn=Ye==="bilinear"?1:0,Xr=[Mt-1+".0",nn-1+".0"],Mi=Xr[0],co=Xr[1],lo=ln>1?[""+(Mt-1)/(ln-1),"(y2-y1) * height_ratio","y1*"+Mi+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+Mi],uo=lo[0],ho=lo[1],mo=lo[2],_d=fn>1?[""+(nn-1)/(fn-1),"(x2-x1) * width_ratio","x1*"+co+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+co],ep=_d[0],rp=_d[1],sp=_d[2];this.userCode=`
      const float height_ratio = float(`+uo+`);
      const float width_ratio = float(`+ep+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+Je+`) {
          return;
        }

        float height_scale = `+ho+`;
        float width_scale = `+rp+`;

        float in_y = `+mo+`;
        if( in_y < 0.0 || in_y > `+Mi+` ) {
          setOutput(float(`+Qe+`));
          return;
        }
        float in_x = `+sp+`;
        if( in_x < 0.0 || in_x > `+co+` ) {
          setOutput(float(`+Qe+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+hn+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},ni=function(Ke,Ge,$e){this.variableNames=["x"],this.outputShape=Ke;var Ye=Ke.length,Qe=Ke[Ke.length-1],Je=$e?"<":">";this.userCode=`
      int getIndex(int i) {
        `+($e?"return "+Qe+" -i - 1;":"return i;")+`
      }

      void main() {
        `+wa(Ye)+` coords = getOutputCoords();
        int end = `+ri(Ye,"coords")+`;
        float val = 0.0;
        for (int i = `+Qe+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+Je+` end) {
            continue;
          }
          if (idx == end && `+Ge+`) {
            continue;
          }
          `+ri(Ye,"coords")+` = idx;
          val += getX(`+function(Mt,nn){if(Mt===1)return""+nn;if(Mt===2)return nn+".x, "+nn+".y";if(Mt===3)return nn+".x, "+nn+".y, "+nn+".z";if(Mt===4)return nn+".x, "+nn+".y, "+nn+".z, "+nn+".w";throw Error("Cumulative sum for rank "+Mt+" is not yet supported")}(Ye,"coords")+`);
        }
        setOutput(val);
      }
    `};function ri(Ke,Ge){if(Ke===1)return""+Ge;if(Ke===2)return Ge+".y";if(Ke===3)return Ge+".z";if(Ke===4)return Ge+".w";throw Error("Cumulative sum for rank "+Ke+" is not yet supported")}var oi=function(Ke){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Vt.DENSE;var Ge=Yt(Ke),$e=ua();this.outputShape=Ke,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+ca(["r","c","d"],Ke)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+Ge[0]+", "+Ge[1]+`));
        int index = 4 * (resTexRC.x * `+Ge[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+$e.output+` = result;
      }
    `},ai=function(Ke){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Vt.DENSE;var Ge=Yt(Ke),$e=ua();this.outputShape=Ke,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+ca(["r","c","d"],Ke)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+Ge[0]+", "+Ge[1]+`));
        int index = 4 * (resTexRC.x * `+Ge[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+$e.output+` = result;
      }
    `},ii=function(){function Ke(Ge,$e,Ye){this.variableNames=["x"],this.outputShape=[],this.outputShape=Ge,this.blockSize=$e,this.dataFormat=Ye,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+$e+`;
      int offset_h = imod(h, `+$e+`);
      int in_w = w / `+$e+`;
      int offset_w = imod(w, `+$e+`);
      int offset_d = (offset_h * `+$e+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return Ke.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},Ke.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},Ke.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},Ke.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},Ke.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},Ke}(),si=function(Ke){this.variableNames=["X"],this.outputShape=[Ke,Ke],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},ui=function(Ke){this.variableNames=["A"],this.outTexUsage=zt.DOWNLOAD;var Ge=ua();this.outputShape=Ke,this.userCode=`
      `+ha+`

      void main() {
        float x = getAAtOutCoords();
        `+Ge.output+` = encode_float(x);
      }
    `},ci=function(Ke){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=zt.DOWNLOAD;var Ge=ua();this.outputShape=Ke,this.userCode=`
      `+ha+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+Ge.output+` = encode_float(x);
      }
    `},li=function(Ke,Ge,$e){$e===void 0&&($e=!1),this.variableNames=["A"];var Ye=ua(),Qe=Ge[0],Je=Ge[1];this.outputShape=Ke;var Mt="result";$e&&(Mt="floor(result * 255. + 0.5)"),this.userCode=`
      `+la(Ke)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+Je+`;
        int c = imod(flatIndex, `+Je+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+Je+".0, "+Qe+`.0);
        vec4 values = `+Ye.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+Ye.output+" = vec4("+Mt+`, 0., 0., 0.);
      }
    `},hi=function(Ke,Ge,$e){$e===void 0&&($e=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var Ye=ua(),Qe=Ge[0],Je=Ge[1];this.outputShape=Ke;var Mt="",nn="result";$e&&(nn="floor(result * 255. + 0.5)");for(var an=0;an<=1;an++)for(var sn=0;sn<=1;sn++){var ln=2*an+sn;Mt+=`
          localCoords = coords;
          if(localCoords[2] + `+sn+" < "+Ke[2]+`) {
            localCoords[2] += `+sn+`;
            if(localCoords[1] + `+an+" < "+Ke[1]+`) {
              localCoords[1] += `+an+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+Je+`;
              c = imod(flatIndex, `+Je+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+Je+".0, "+Qe+`.0);
              values = `+Ye.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+ln+`] = values[0];
              } else if(offset == 1) {
                result[`+ln+`] = values[1];
              } else if(offset == 2) {
                result[`+ln+`] = values[2];
              } else {
                result[`+ln+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+la(Ke)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+Mt+`

        `+Ye.output+" = "+nn+`;
      }
    `},fi="return real * expR - imag * expI;",di="return real * expI + imag * expR;",pi=function(Ke,Ge,$e){this.variableNames=["real","imag"];var Ye=Ge[1];this.outputShape=Ge;var Qe=$e?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,Je=$e?Ye+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+Qe+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+Ke+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+Ye+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+Ye+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+Je+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},vi=function(){function Ke(Ge,$e){this.outputShape=[],this.variableNames=["x"],this.outputShape=Ge,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return Ke.prototype.getCustomSetupFunc=function(Ge){var $e=this;return function(Ye,Qe){$e.valueLoc==null&&($e.valueLoc=Ye.getUniformLocationNoThrow(Qe,"value")),Ye.gl.uniform1f($e.valueLoc,Ge)}},Ke}(),mi=function(Ke,Ge,$e){this.variableNames=["A","indices"];var Ye=Ke.slice();Ye[$e]=Ge,this.outputShape=Ye,this.rank=Ye.length;var Qe=wa(this.rank),Je=function(Mt,nn){var an=Mt.length;if(an>4)throw Error("Gather for rank "+an+" is not yet supported");if(an===1)return"int(getIndices(resRC))";for(var sn=["resRC.x","resRC.y","resRC.z","resRC.w"],ln=[],fn=0;fn<Mt.length;fn++)fn===nn?ln.push("int(getIndices("+sn[fn]+"))"):ln.push(""+sn[fn]);return ln.join()}(Ke,$e);this.userCode=`
      void main() {
        `+Qe+` resRC = getOutputCoords();
        setOutput(getA(`+Je+`));
      }
    `},gi=function(Ke,Ge,$e){this.sliceDim=Ke,this.strides=Ge,this.variableNames=["x","indices"],this.outputShape=$e;var Ye=wa(Ge.length),Qe=wa($e.length),Je=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+Ye+" strides = "+Ye+"("+this.strides+`);
         void main() {
          `+Qe+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+Je+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function yi(Ke,Ge){var $e=ua();return oe(Ke,Ge,$e.version+`
    precision highp float;
    `+$e.attribute+` vec3 clipSpacePos;
    `+$e.attribute+` vec2 uv;
    `+$e.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function xi(Ke,Ge){return fe(Ke,Ge,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function bi(Ke,Ge){return de(Ke,Ge,new Uint16Array([0,1,2,2,1,3]))}function wi(Ke,Ge,$e,Ye,Qe,Je,Mt){ve($e,Ye);var nn=pe(Ke,Ge),an=Ke.TEXTURE_2D;return Jt(Ke,Ge,function(){return Ke.bindTexture(an,nn)}),Jt(Ke,Ge,function(){return Ke.texParameteri(an,Ke.TEXTURE_WRAP_S,Ke.CLAMP_TO_EDGE)}),Jt(Ke,Ge,function(){return Ke.texParameteri(an,Ke.TEXTURE_WRAP_T,Ke.CLAMP_TO_EDGE)}),Jt(Ke,Ge,function(){return Ke.texParameteri(an,Ke.TEXTURE_MIN_FILTER,Ke.NEAREST)}),Jt(Ke,Ge,function(){return Ke.texParameteri(an,Ke.TEXTURE_MAG_FILTER,Ke.NEAREST)}),Jt(Ke,Ge,function(){return Ke.texImage2D(an,0,Qe,$e,Ye,0,Je,Mt,null)}),Jt(Ke,Ge,function(){return Ke.bindTexture(Ke.TEXTURE_2D,null)}),nn}function Ci(Ke,Ge,$e,Ye,Qe){var Je=Xt($e,Ye);return wi(Ke,Ge,Je[0],Je[1],Qe.internalFormatFloat,Qe.textureFormatFloat,Ke.FLOAT)}function Ei(Ke,Ge,$e,Ye,Qe){var Je=Xt($e,Ye);return wi(Ke,Ge,Je[0],Je[1],Qe.internalFormatHalfFloat,Qe.textureFormatFloat,Qe.textureTypeHalfFloat)}function Ri(Ke,Ge,$e,Ye,Qe){var Je=Xt($e,Ye);return wi(Ke,Ge,Je[0],Je[1],Ke.RGBA,Ke.RGBA,Ke.UNSIGNED_BYTE)}function Ii(Ke,Ge,$e,Ye,Qe){var Je=$t($e,Ye);return wi(Ke,Ge,Je[0],Je[1],Qe.internalFormatPackedFloat,Ke.RGBA,Ke.FLOAT)}function ki(Ke,Ge,$e,Ye,Qe){var Je=$t($e,Ye);return wi(Ke,Ge,Je[0],Je[1],Qe.internalFormatPackedHalfFloat,Ke.RGBA,Qe.textureTypeHalfFloat)}function Si(Ke,Ge,$e,Ye){return Jt(Ke,Ge,function(){return Ke.bindBuffer(Ke.ARRAY_BUFFER,Ye)}),ge(Ke,Ge,$e,"clipSpacePos",Ye,3,20,0)&&ge(Ke,Ge,$e,"uv",Ye,2,20,12)}function Ai(Ke,Ge,$e,Ye,Qe,Je,Mt){var nn,an,sn;Jt(Ke,Ge,function(){return Ke.bindTexture(Ke.TEXTURE_2D,$e)}),Je instanceof Uint8Array?(nn=new Uint8Array(Ye*Qe*4),an=Ke.UNSIGNED_BYTE,sn=Ke.RGBA):(nn=new Float32Array(Ye*Qe*4),an=Ke.FLOAT,sn=Mt.internalFormatPackedFloat),nn.set(Je),Jt(Ke,Ge,function(){return Ke.texImage2D(Ke.TEXTURE_2D,0,sn,Ye,Qe,0,Ke.RGBA,an,nn)}),Jt(Ke,Ge,function(){return Ke.bindTexture(Ke.TEXTURE_2D,null)})}function Di(Ke,Ge,$e,Ye){Jt(Ke,Ge,function(){return Ke.bindTexture(Ke.TEXTURE_2D,$e)}),Ye.data instanceof Uint8Array?Jt(Ke,Ge,function(){return Ke.texImage2D(Ke.TEXTURE_2D,0,Ke.RGBA,Ye.width,Ye.height,0,Ke.RGBA,Ke.UNSIGNED_BYTE,Ye.data)}):Jt(Ke,Ge,function(){return Ke.texImage2D(Ke.TEXTURE_2D,0,Ke.RGBA,Ke.RGBA,Ke.UNSIGNED_BYTE,Ye)}),Jt(Ke,Ge,function(){return Ke.bindTexture(Ke.TEXTURE_2D,null)})}function Ti(Ke,Ge,$e,Ye,Qe){var Je=Ke.createBuffer();Jt(Ke,Ge,function(){return Ke.bindBuffer(Ke.PIXEL_PACK_BUFFER,Je)});var Mt=16*$e*Ye;return Jt(Ke,Ge,function(){return Ke.bufferData(Ke.PIXEL_PACK_BUFFER,Mt,Ke.STREAM_READ)}),Jt(Ke,Ge,function(){return Ke.readPixels(0,0,Ye,$e,Ke.RGBA,Ke.FLOAT,0)}),Jt(Ke,Ge,function(){return Ke.bindBuffer(Ke.PIXEL_PACK_BUFFER,null)}),Je}function Ni(Ke,Ge,$e){var Ye=Ke,Qe=new Float32Array($e);return Ye.bindBuffer(Ye.PIXEL_PACK_BUFFER,Ge),Ye.getBufferSubData(Ye.PIXEL_PACK_BUFFER,0,Qe),Ye.bindBuffer(Ye.PIXEL_PACK_BUFFER,null),Qe}function Fi(Ke,Ge,$e,Ye,Qe){var Je=Xt($e,Ye),Mt=Je[0],nn=Je[1],an=new Uint8Array($e*Ye*4);return Jt(Ke,Ge,function(){return Ke.readPixels(0,0,Mt,nn,Qe.downloadTextureFormat,Ke.UNSIGNED_BYTE,an)}),new Float32Array(an.buffer)}function _i(Ke,Ge,$e,Ye,Qe,Je,Mt,nn){var an=Ke,sn=new Float32Array(function(ln,fn){var hn=$t(ln,fn);return hn[0]*hn[1]*4}(Je,Mt));return an.bindBuffer(an.PIXEL_PACK_BUFFER,Ge),an.getBufferSubData(an.PIXEL_PACK_BUFFER,0,sn),an.bindBuffer(an.PIXEL_PACK_BUFFER,null),sn}function Oi(Ke,Ge,$e,Ye){var Qe=new Float32Array($e*Ye*4);return Jt(Ke,Ge,function(){return Ke.readPixels(0,0,Ye,$e,Ke.RGBA,Ke.FLOAT,Qe)}),Qe}var Bi=function(){function Ke(Ge){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var $e=i().getNumber("WEBGL_VERSION");Ge!=null?(this.gl=Ge,Kt($e,Ge)):this.gl=jt($e);var Ye="WEBGL_color_buffer_float";if(i().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=re(this.gl,this.debug,"OES_texture_float"),Pe(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=re(this.gl,this.debug,"OES_texture_half_float");else if(i().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(Ye),Pe(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=re(this.gl,this.debug,"EXT_color_buffer_half_float");else if(i().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(Ye="EXT_color_buffer_float",Pe(this.gl,Ye))this.colorBufferFloatExtension=this.gl.getExtension(Ye);else{if(!Pe(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=xi(this.gl,this.debug),this.indexBuffer=bi(this.gl,this.debug),this.framebuffer=me(this.gl,this.debug),this.textureConfig=Qt(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(Ke.prototype,"debug",{get:function(){return i().getBool("DEBUG")},enumerable:!0,configurable:!0}),Ke.prototype.dispose=function(){var Ge=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var $e=this.gl;Jt($e,this.debug,function(){return $e.finish()}),Jt($e,this.debug,function(){return $e.bindFramebuffer($e.FRAMEBUFFER,null)}),Jt($e,this.debug,function(){return $e.deleteFramebuffer(Ge.framebuffer)}),Jt($e,this.debug,function(){return $e.bindBuffer($e.ARRAY_BUFFER,null)}),Jt($e,this.debug,function(){return $e.bindBuffer($e.ELEMENT_ARRAY_BUFFER,null)}),Jt($e,this.debug,function(){return $e.deleteBuffer(Ge.indexBuffer)}),this.disposed=!0}},Ke.prototype.createFloat32MatrixTexture=function(Ge,$e){return this.throwIfDisposed(),Ci(this.gl,this.debug,Ge,$e,this.textureConfig)},Ke.prototype.createFloat16MatrixTexture=function(Ge,$e){return this.throwIfDisposed(),Ei(this.gl,this.debug,Ge,$e,this.textureConfig)},Ke.prototype.createUnsignedBytesMatrixTexture=function(Ge,$e){return this.throwIfDisposed(),Ri(this.gl,this.debug,Ge,$e,this.textureConfig)},Ke.prototype.uploadPixelDataToTexture=function(Ge,$e){this.throwIfDisposed(),Di(this.gl,this.debug,Ge,$e)},Ke.prototype.uploadDenseMatrixToTexture=function(Ge,$e,Ye,Qe){this.throwIfDisposed(),Ai(this.gl,this.debug,Ge,$e,Ye,Qe,this.textureConfig)},Ke.prototype.createFloat16PackedMatrixTexture=function(Ge,$e){return this.throwIfDisposed(),ki(this.gl,this.debug,Ge,$e,this.textureConfig)},Ke.prototype.createPackedMatrixTexture=function(Ge,$e){return this.throwIfDisposed(),Ii(this.gl,this.debug,Ge,$e,this.textureConfig)},Ke.prototype.deleteMatrixTexture=function(Ge){var $e=this;this.throwIfDisposed(),this.outputTexture===Ge&&(Ee(this.gl,this.debug,this.framebuffer),this.outputTexture=null),Jt(this.gl,this.debug,function(){return $e.gl.deleteTexture(Ge)})},Ke.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(Ge,$e,Ye){var Qe=this;return this.downloadMatrixDriver(Ge,function(){return Fi(Qe.gl,Qe.debug,$e,Ye,Qe.textureConfig)})},Ke.prototype.downloadPackedMatrixFromBuffer=function(Ge,$e,Ye,Qe,Je,Mt){return _i(this.gl,Ge,0,0,0,Je,Mt,this.textureConfig)},Ke.prototype.downloadFloat32MatrixFromBuffer=function(Ge,$e){return Ni(this.gl,Ge,$e)},Ke.prototype.createBufferFromTexture=function(Ge,$e,Ye){this.bindTextureToFrameBuffer(Ge);var Qe=Ti(this.gl,this.debug,$e,Ye,this.textureConfig);return this.unbindTextureToFrameBuffer(),Qe},Ke.prototype.createAndWaitForFence=function(){var Ge=this.createFence(this.gl);return this.pollFence(Ge)},Ke.prototype.createFence=function(Ge){var $e,Ye,Qe=this;if(i().getBool("WEBGL_FENCE_API_ENABLED")){var Je=Ge,Mt=Je.fenceSync(Je.SYNC_GPU_COMMANDS_COMPLETE,0);Ge.flush(),Ye=function(){var nn=Je.clientWaitSync(Mt,0,0);return nn===Je.ALREADY_SIGNALED||nn===Je.CONDITION_SATISFIED},$e=Mt}else i().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?($e=this.beginQuery(),this.endQuery(),Ye=function(){return Qe.isQueryAvailable($e,i().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):Ye=function(){return!0};return{query:$e,isFencePassed:Ye}},Ke.prototype.downloadMatrixFromPackedTexture=function(Ge,$e,Ye){var Qe=this;return this.downloadMatrixDriver(Ge,function(){return Oi(Qe.gl,Qe.debug,$e,Ye)})},Ke.prototype.createProgram=function(Ge){this.throwIfDisposed();var $e=this.gl,Ye=ae($e,this.debug,Ge),Qe=yi($e,this.debug),Je=ce($e,this.debug);return Jt($e,this.debug,function(){return $e.attachShader(Je,Qe)}),Jt($e,this.debug,function(){return $e.attachShader(Je,Ye)}),le($e,this.debug,Je),this.debug&&he($e,this.debug,Je),this.vertexAttrsAreBound||(this.setProgram(Je),this.vertexAttrsAreBound=Si($e,this.debug,this.program,this.vertexBuffer)),Je},Ke.prototype.deleteProgram=function(Ge){var $e=this;this.throwIfDisposed(),Ge===this.program&&(this.program=null),Ge!=null&&Jt(this.gl,this.debug,function(){return $e.gl.deleteProgram(Ge)})},Ke.prototype.setProgram=function(Ge){var $e=this;this.throwIfDisposed(),this.program=Ge,this.program!=null&&this.debug&&he(this.gl,this.debug,this.program),Jt(this.gl,this.debug,function(){return $e.gl.useProgram(Ge)})},Ke.prototype.getUniformLocation=function(Ge,$e,Ye){return Ye===void 0&&(Ye=!0),this.throwIfDisposed(),Ye?xe(this.gl,this.debug,Ge,$e):be(this.gl,Ge,$e)},Ke.prototype.getAttributeLocation=function(Ge,$e){var Ye=this;return this.throwIfDisposed(),Jt(this.gl,this.debug,function(){return Ye.gl.getAttribLocation(Ge,$e)})},Ke.prototype.getUniformLocationNoThrow=function(Ge,$e){return this.throwIfDisposed(),this.gl.getUniformLocation(Ge,$e)},Ke.prototype.setInputMatrixTexture=function(Ge,$e,Ye){this.throwIfDisposed(),this.throwIfNoProgram(),we(this.gl,this.debug,this.program,Ge,$e,Ye)},Ke.prototype.setOutputMatrixTexture=function(Ge,$e,Ye){this.setOutputMatrixTextureDriver(Ge,Ye,$e)},Ke.prototype.setOutputPackedMatrixTexture=function(Ge,$e,Ye){this.throwIfDisposed();var Qe=$t($e,Ye),Je=Qe[0],Mt=Qe[1];this.setOutputMatrixTextureDriver(Ge,Je,Mt)},Ke.prototype.setOutputMatrixWriteRegion=function(Ge,$e,Ye,Qe){this.setOutputMatrixWriteRegionDriver(Ye,Ge,Qe,$e)},Ke.prototype.setOutputPackedMatrixWriteRegion=function(Ge,$e,Ye,Qe){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},Ke.prototype.debugValidate=function(){this.program!=null&&he(this.gl,this.debug,this.program),Re(this.gl)},Ke.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var Ge=this.gl;this.debug&&this.debugValidate(),Jt(Ge,this.debug,function(){return Ge.drawElements(Ge.TRIANGLES,6,Ge.UNSIGNED_SHORT,0)})},Ke.prototype.blockUntilAllProgramsCompleted=function(){var Ge=this;this.throwIfDisposed(),Jt(this.gl,this.debug,function(){return Ge.gl.finish()})},Ke.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=re(this.gl,this.debug,i().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},Ke.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},Ke.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},Ke.prototype.beginQuery=function(){if(i().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var Ge=this.gl,$e=this.getQueryTimerExtensionWebGL2(),Ye=Ge.createQuery();return Ge.beginQuery($e.TIME_ELAPSED_EXT,Ye),Ye}var Qe=this.getQueryTimerExtensionWebGL1(),Je=Qe.createQueryEXT();return Qe.beginQueryEXT(Qe.TIME_ELAPSED_EXT,Je),Je},Ke.prototype.endQuery=function(){if(i().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var Ge=this.getQueryTimerExtensionWebGL1();Ge.endQueryEXT(Ge.TIME_ELAPSED_EXT)}else{var $e=this.gl,Ye=this.getQueryTimerExtensionWebGL2();$e.endQuery(Ye.TIME_ELAPSED_EXT)}},Ke.prototype.waitForQueryAndGetTime=function(Ge){return n(this,void 0,void 0,function(){var $e=this;return r(this,function(Ye){switch(Ye.label){case 0:return[4,F(function(){return $e.disposed||$e.isQueryAvailable(Ge,i().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return Ye.sent(),[2,this.getQueryTime(Ge,i().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},Ke.prototype.getQueryTime=function(Ge,$e){if($e===0)return null;if($e===2){var Ye=this.gl;return Ye.getQueryParameter(Ge,Ye.QUERY_RESULT)/1e6}var Qe=this.getQueryTimerExtensionWebGL1();return Qe.getQueryObjectEXT(Ge,Qe.QUERY_RESULT_EXT)/1e6},Ke.prototype.isQueryAvailable=function(Ge,$e){if($e===0)return!0;if($e===2){var Ye=this.gl,Qe=this.getQueryTimerExtensionWebGL2(),Je=Ye.getQueryParameter(Ge,Ye.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(Qe.GPU_DISJOINT_EXT)),Je&&!this.disjoint}return Je=(Qe=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(Ge,Qe.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(Qe.GPU_DISJOINT_EXT)),Je&&!this.disjoint},Ke.prototype.pollFence=function(Ge){var $e=this;return new Promise(function(Ye){$e.addItemToPoll(function(){return Ge.isFencePassed()},function(){return Ye()})})},Ke.prototype.pollItems=function(){for(var Ge=function(Ye){for(var Qe=0;Qe<Ye.length&&Ye[Qe]();++Qe);return Qe-1}(this.itemsToPoll.map(function(Ye){return Ye.isDoneFn})),$e=0;$e<=Ge;++$e)(0,this.itemsToPoll[$e].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(Ge+1)},Ke.prototype.addItemToPoll=function(Ge,$e){var Ye=this;this.itemsToPoll.push({isDoneFn:Ge,resolveFn:$e}),this.itemsToPoll.length>1||F(function(){return Ye.pollItems(),Ye.itemsToPoll.length===0})},Ke.prototype.bindTextureToFrameBuffer=function(Ge){this.throwIfDisposed(),Ce(this.gl,this.debug,Ge,this.framebuffer),this.debug&&Re(this.gl)},Ke.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(Ce(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&Re(this.gl)):Ee(this.gl,this.debug,this.framebuffer)},Ke.prototype.downloadMatrixDriver=function(Ge,$e){this.bindTextureToFrameBuffer(Ge);var Ye=$e();return this.unbindTextureToFrameBuffer(),Ye},Ke.prototype.setOutputMatrixTextureDriver=function(Ge,$e,Ye){this.throwIfDisposed();var Qe=this.gl;Ce(Qe,this.debug,Ge,this.framebuffer),this.debug&&Re(Qe),this.outputTexture=Ge,Jt(Qe,this.debug,function(){return Qe.viewport(0,0,$e,Ye)}),Jt(Qe,this.debug,function(){return Qe.scissor(0,0,$e,Ye)})},Ke.prototype.setOutputMatrixWriteRegionDriver=function(Ge,$e,Ye,Qe){var Je=this;this.throwIfDisposed(),Jt(this.gl,this.debug,function(){return Je.gl.scissor(Ge,$e,Ye,Qe)})},Ke.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},Ke.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},Ke}();function Pi(Ke,Ge){if(Ke.length!==Ge.length)throw Error("Binary was compiled with "+Ke.length+" inputs, but was executed with "+Ge.length+" inputs");Ke.forEach(function($e,Ye){var Qe=$e.logicalShape,Je=Ge[Ye],Mt=Je.shape;if(!S(Qe,Mt))throw Error("Binary was compiled with different shapes than the current args. Shapes "+Qe+" and "+Mt+" must match");if(!$e.isUniform||!Je.isUniform){var nn=$e.texShape,an=Je.isUniform?null:Je.texData.texShape;if(!S(nn,an))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+nn+" and "+an+" must match")}})}var Li=function(Ke,Ge,$e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Ke;for(var Ye=$e.filterWidth,Qe=$e.inChannels,Je=$e.strideWidth,Mt=$e.strideHeight,nn=$e.padInfo,an=$e.outWidth,sn=$e.dilationWidth,ln=$e.dilationHeight,fn=$e.dataFormat,hn=nn.left,Xr=nn.top,Mi=Qe*Ye,co=ua(),lo=fn==="channelsLast",uo=lo?0:1,ho=lo?1:2,mo="",_d=0;_d<=1;_d++)for(var ep=0;ep<=1;ep++)mo+=`
          blockIndex = rc.y + `+ep+`;
          pos = rc.x + `+_d+`;

          if(blockIndex < `+Ke[1]+" && pos < "+Ke[0]+`) {
            offsetY = int(blockIndex / (`+an+")) * "+Mt+" - "+Xr+`;
            d0 = offsetY + `+ln+" * (pos / "+Mi+`);

            if(d0 < `+Ge[uo]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+an+".) * "+Je+". - "+hn+`.);
              d1 = offsetX + `+sn+" * (int(mod(float(pos), "+Mi+".) / "+Qe+`.));

              if(d1 < `+Ge[ho]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+Qe+`.));

                if (`+lo+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*_d+ep)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*_d+ep)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+mo+`

        `+co.output+` = result;
      }
    `},Wi=function(Ke,Ge,$e,Ye,Qe){this.variableNames=["x"],this.outputShape=[];var Je,Mt=Ge,nn=Ke[3]-1;this.outputShape=Ke;var an="float("+$e+") + float("+Ye+") * sum";Je=Qe===.5?"inversesqrt("+an+")":Qe===1?"1.0/("+an+")":"exp(log("+an+") * float(-"+Qe+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+Mt+"; j <= "+Mt+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+nn+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+Je+`;
        setOutput(val);
      }
    `},Ui=function(Ke,Ge,$e,Ye,Qe){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=Ke,this.depth=Ke[3],this.depthRadius=Ge,this.bias=$e,this.alpha=Ye,this.beta=Qe,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+Ge+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+Ge+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+Ye+") * norm + float("+$e+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+Ye+`)
                * float(`+Qe+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+Qe+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},Vi=function(Ke,Ge,$e,Ye,Qe){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var Je,Mt=Ge,nn=Ke[3]-1;this.outputShape=Ke;var an="float("+$e+") + float("+Ye+") * sum";Je=Qe===.5?"inversesqrt("+an+")":Qe===1?"1.0/("+an+")":"exp(log("+an+") * float(-"+Qe+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+Mt+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+Mt+"; j <= "+Mt+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+nn+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+Je+`;
        setOutput(result);
      }
    `},zi=function(Ke){this.variableNames=["dy","maxPos"],this.outputShape=Ke.inShape;var Ge=Ke.strideHeight,$e=Ke.strideWidth,Ye=Ke.dilationHeight,Qe=Ke.effectiveFilterHeight,Je=Ke.effectiveFilterWidth,Mt=Qe-1-Ke.padInfo.top,nn=Je-1-Ke.padInfo.left,an=Qe*Je-1;this.userCode=`
      const ivec2 pads = ivec2(`+Mt+", "+nn+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+Qe+`;
          wR += `+Ye+`) {
          float dyR = float(dyRCorner + wR) / `+Ge+`.0;

          if (dyR < 0.0 || dyR >= `+Ke.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+Je+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+$e+`.0;

            if (dyC < 0.0 || dyC >= `+Ke.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+an+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+Je+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},Gi=function(Ke){this.variableNames=["dy","maxPos"],this.outputShape=Ke.inShape;var Ge=Ke.strideDepth,$e=Ke.strideHeight,Ye=Ke.strideWidth,Qe=Ke.dilationDepth,Je=Ke.dilationHeight,Mt=Ke.dilationWidth,nn=Ke.effectiveFilterDepth,an=Ke.effectiveFilterHeight,sn=Ke.effectiveFilterWidth,ln=nn-1-Ke.padInfo.front,fn=an-1-Ke.padInfo.top,hn=sn-1-Ke.padInfo.left,Xr=nn*an*sn-1;this.userCode=`
      const ivec3 pads = ivec3(`+ln+", "+fn+", "+hn+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+nn+`;
           wD += `+Qe+`) {
          float dyD = float(dyDCorner + wD) / `+Ge+`.0;

          if (dyD < 0.0 || dyD >= `+Ke.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+an+`;
              wR += `+Je+`) {
            float dyR = float(dyRCorner + wR) / `+$e+`.0;

            if (dyR < 0.0 || dyR >= `+Ke.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+sn+`;
                wC += `+Mt+`) {
              float dyC = float(dyCCorner + wC) / `+Ye+`.0;

              if (dyC < 0.0 || dyC >= `+Ke.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+Xr+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+an+" * "+sn+` +
                  wR * `+sn+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},Hi=function(Ke,Ge,$e,Ye,Qe,Je,Mt){$e===void 0&&($e=!1),Ye===void 0&&(Ye=!1),Qe===void 0&&(Qe=!1),Je===void 0&&(Je=null),Mt===void 0&&(Mt=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Ge;var nn=$e?Ke[1]:Ke[2],an=Math.ceil(nn/2),sn=$e?"i * 2, rc.y":"rc.y, i * 2",ln=Ye?"rc.z, i * 2":"i * 2, rc.z",fn=$e?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],hn=Ye?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],Xr="",Mi="";Je&&(Xr=Mt?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+Je+`
        }`:`vec4 activation(vec4 x) {
          `+Je+`
        }`,Mi="result = activation(result);");var co=Qe?"result += getBiasAtOutCoords();":"";Qe&&this.variableNames.push("bias"),Mt&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+Xr+`

      const float sharedDimension = `+an+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+an+`; i++) {
          vec4 a = getMatrixA(rc.x, `+sn+`);
          vec4 b = getMatrixB(rc.x, `+ln+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+fn[0]+" * "+hn[0]+`);
          result += (`+fn[1]+" * "+hn[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+co+`

        `+Mi+`

        setOutput(result);
      }
    `},qi=function(){function Ke(Ge,$e,Ye){this.variableNames=["probs"],this.outputShape=[Ge,Ye],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+($e-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+($e-1)+`));
      }
    `}return Ke.prototype.getCustomSetupFunc=function(Ge){var $e=this;return function(Ye,Qe){$e.seedLoc==null&&($e.seedLoc=Ye.getUniformLocation(Qe,"seed")),Ye.gl.uniform1f($e.seedLoc,Ge)}},Ke}(),Ki=function(Ke,Ge,$e,Ye){this.variableNames=["indices"],this.outputShape=[Ke,Ge],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+Ye+"), float("+$e+`),
                      float(index == coords.y)));
      }
    `},ji=function(Ke){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=Ke;var Ge=Ke.length;if(Ge===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var $e=sa("rc",Ge),Ye=wa(Ge),Qe=function(nn,an,sn){if(nn===1)return"rc > "+an[0];for(var ln="",fn=nn-2;fn<nn;fn++)ln+=sn[fn]+" >= "+an[fn],fn<nn-1&&(ln+="||");return ln}(Ge,Ke,$e),Je=function(nn,an,sn,ln){if(nn===1)return"";var fn=ln.slice(-2);return`
    int r = `+fn[0]+`;
    int c = `+fn[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+an+`;
    bool rEdge = rp1 >= `+sn+`;
  `}(Ge,Ke[Ke.length-1],Ke[Ke.length-2],$e),Mt=function(nn,an){var sn=nn.length,ln=function(fn,hn){for(var Xr=[],Mi=0;Mi<=1;Mi++)for(var co=0;co<=1;co++){for(var lo=(Mi===0?"r":"rp1")+", "+(co===0?"c":"cp1"),uo=2;uo<fn;uo++)lo=hn[hn.length-1-uo]+","+lo;Xr.push(lo)}return Xr}(sn,an);return sn===1?`getA(rc),
            rc + 1 >= `+nn[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+ln[0]+`),
          cEdge ? 0. : getA(`+ln[1]+`),
          rEdge ? 0. : getA(`+ln[2]+`),
          rEdge || cEdge ? 0. : getA(`+ln[3]+")"}(Ke,$e);this.userCode=`
        void main() {
          `+Ye+` rc = getOutputCoords();

          if(`+Qe+`) {
            setOutput(vec4(0));
          } else {
            `+Je+`

            setOutput(vec4(`+Mt+`));
          }
        }
      `}},Xi=function(Ke,Ge,$e){this.variableNames=["x"],this.outputShape=Ge.map(function(an,sn){return an[0]+Ke[sn]+an[1]});var Ye=Ke.length,Qe=wa(Ye),Je=Ge.map(function(an){return an[0]}).join(","),Mt=Ge.map(function(an,sn){return an[0]+Ke[sn]}).join(","),nn=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,Ye);this.userCode=Ye!==1?`
      `+Qe+" start = "+Qe+"("+Je+`);
      `+Qe+" end = "+Qe+"("+Mt+`);

      void main() {
        `+Qe+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+$e+`));
        } else {
          `+Qe+` coords = outC - start;
          setOutput(getX(`+nn+`));
        }
      }
    `:`
        int start = `+Je+`;
        int end = `+Mt+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+$e+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},Yi=function(Ke,Ge,$e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Ge.map(function(lo,uo){return lo[0]+Ke[uo]+lo[1]});for(var Ye=Ke.length,Qe=wa(Ye),Je=Ge.map(function(lo){return lo[0]}).join(","),Mt=Ge.map(function(lo,uo){return lo[0]+Ke[uo]}).join(","),nn=sa("rc",Ye),an=sa("source",Ye),sn=nn[Ye-1]+" < "+this.outputShape[Ye-1],ln=Ye===1?"source":"vec2("+an.slice(-2).join()+")",fn=[Qe+" rc = outputLoc;",nn[Ye-1]+` += 1;
       if(`+sn+`) {
      `,Ye===1?"":`}
       rc = outputLoc;
       `+nn[Ye-2]+` += 1;
       if(`+nn[Ye-2]+" < "+this.outputShape[Ye-2]+") {",Ye===1?"":"  "+nn[Ye-1]+` += 1;
         if(`+sn+") {"],hn=Ye===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",Xr="",Mi=0,co=Ye===1?2:4;Mi<co;Mi++)Xr+=`
        `+fn[Mi]+`
        if (`+hn+`) {
          result[`+Mi+"] = float("+$e+`);
        } else {
          `+Qe+` source = rc - start;
          result[`+Mi+"] = getChannel(getX("+an.join()+"), "+ln+`);
        }
      `;Xr+=Ye===1?"} ":"}}",this.userCode=`
      const `+Qe+" start = "+Qe+"("+Je+`);
      const `+Qe+" end = "+Qe+"("+Mt+`);

      void main() {
        `+Qe+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+Xr+`
        setOutput(result);
      }
    `},$i=function(Ke,Ge,$e){if(this.variableNames=["x"],Ge==="avg"&&$e)throw new Error("Cannot compute positions for average pool.");var Ye=Ke.filterWidth,Qe=Ke.strideHeight,Je=Ke.strideWidth,Mt=Ke.dilationHeight,nn=Ke.dilationWidth,an=Ke.effectiveFilterHeight,sn=Ke.effectiveFilterWidth,ln=Ke.padInfo.top,fn=Ke.padInfo.left;this.outputShape=Ke.outShape;var hn=Ge==="avg",Xr="0.0";if(hn||(Xr="-1.0 / 1e-20"),$e)this.userCode=`
        const ivec2 strides = ivec2(`+Qe+", "+Je+`);
        const ivec2 pads = ivec2(`+ln+", "+fn+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+an+`;
              wR += `+Mt+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+Ke.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+sn+`;
                wC += `+nn+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+Ke.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+sn+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var Mi=Ge+"("+Ge+"("+Ge+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";Ge==="avg"&&(Mi="avgValue / count");var co=4*Math.floor(Ye/4),lo=Ye%4,uo=`
      if (`+hn+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+Qe+", "+Je+`);
      const ivec2 pads = ivec2(`+ln+", "+fn+`);
      const float initializationValue = `+Xr+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+Ke.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+Xr+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+an+`;
            wR += `+Mt+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+Ke.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+co+`; wC += 4) {
            int xC = xCCorner + wC * `+nn+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+nn+`, d),
              getValue(batch, xR, xC + 2 * `+nn+`, d),
              getValue(batch, xR, xC + 3 * `+nn+`, d)
            );

            `+uo+`
          }

          int xC = xCCorner + `+co+`;
          if (`+(lo===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+uo+`
          } else if (`+(lo===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+nn+`, d),
              initializationValue,
              initializationValue
            );

            `+uo+`
          } else if (`+(lo===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+nn+`, d),
              getValue(batch, xR, xC + 2 * `+nn+`, d),
              initializationValue
            );

            `+uo+`
          }
        }
        setOutput(`+Mi+`);
      }
    `}},Qi=function(Ke,Ge,$e){if(this.variableNames=["x"],Ge==="avg"&&$e)throw new Error("Cannot compute positions for average pool.");var Ye=Ke.filterWidth,Qe=Ke.strideDepth,Je=Ke.strideHeight,Mt=Ke.strideWidth,nn=Ke.dilationDepth,an=Ke.dilationHeight,sn=Ke.dilationWidth,ln=Ke.effectiveFilterDepth,fn=Ke.effectiveFilterHeight,hn=Ke.effectiveFilterWidth,Xr=Ke.padInfo.front,Mi=Ke.padInfo.top,co=Ke.padInfo.left;this.outputShape=Ke.outShape;var lo=Ge==="avg",uo="0.0";if(lo||(uo="-1.0 / 1e-20"),$e)this.userCode=`
        const ivec3 strides =
            ivec3(`+Qe+", "+Je+", "+Mt+`);
        const ivec3 pads = ivec3(`+Xr+", "+Mi+", "+co+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+ln+`;
              wD += `+nn+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+Ke.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+fn+`;
                wR += `+an+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+Ke.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+hn+`;
                  wC += `+sn+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+Ke.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+fn+" * "+hn+` +
                      wR * `+hn+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var ho=Ge+"("+Ge+"("+Ge+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";Ge==="avg"&&(ho="avgValue / count");var mo=4*Math.floor(Ye/4),_d=Ye%4,ep=`
      if (`+lo+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+Qe+", "+Je+", "+Mt+`);
      const ivec3 pads = ivec3(`+Xr+", "+Mi+", "+co+`);
      const float initializationValue = `+uo+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+Ke.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+uo+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+ln+`;
            wD += `+nn+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+Ke.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+fn+`;
            wR += `+an+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+Ke.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+mo+`; wC += 4) {
              int xC = xCCorner + wC * `+sn+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+sn+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+sn+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+sn+`, ch)
              );

              `+ep+`
            }

            int xC = xCCorner + `+mo+`;
            if (`+(_d===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+ep+`
            } else if (`+(_d===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+sn+`, ch),
                initializationValue,
                initializationValue
              );

              `+ep+`
            } else if (`+(_d===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+sn+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+sn+`, ch),
                initializationValue
              );

              `+ep+`
            }
          }
          setOutput(`+ho+`);
        }
      }
    `}},Ji=function(Ke,Ge){this.variableNames=["x"];var $e=Ke.windowSize,Ye=Ke.batchSize,Qe=Ke.inSize,Je=Math.ceil(Qe/$e);this.outputShape=[Ye,Je];var Mt="0.0",nn="";Ge==="prod"?Mt="1.0":Ge==="min"?(Mt="1.0 / 1e-20",nn="min"):Ge==="max"&&(Mt="-1.0 / 1e-20",nn="max");var an=Ge+"("+Ge+"("+Ge+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";Ge==="sum"?an="sumValue":Ge==="prod"?an="prodValue":Ge==="all"?an="allValue":Ge==="any"&&(an="anyValue");var sn=4*Math.floor($e/4),ln=$e%4,fn=`
      if (`+(Ge==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(Ge==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+nn+`(values, minMaxValue);
      }
    `,hn="vec4";Ge==="all"?(Mt="1.0",fn=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,hn="bvec4"):Ge==="any"&&(Mt="0.0",fn=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,hn="bvec4");var Xr="";Qe%$e>0&&(Xr=`
        if (inIdx < 0 || inIdx >= `+Qe+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+Mt+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+Xr+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+$e+`;

        vec4 minMaxValue = vec4(`+Mt+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+sn+`; i += 4) {
          int inIdx = inOffset + i;
          `+hn+" values = "+hn+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+fn+`
        }

        int inIdx = inOffset + `+sn+`;
        if (`+(ln===1)+`) {
          `+hn+" values = "+hn+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+fn+`
        } else if (`+(ln===2)+`) {
          `+hn+" values = "+hn+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+fn+`
        } else if (`+(ln===3)+`) {
          `+hn+" values = "+hn+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+fn+`
        }
        setOutput(`+an+`);
      }
    `},Zi=function(Ke,Ge){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Ke;for(var $e="",Ye=0;Ye<4;Ye++){var Qe="thisRC = rc;";Ye%2==1&&(Qe+="thisRC.z += 1;"),Ye>1&&(Qe+="thisRC.y += 1;"),$e+=`
        `+Qe+`
        `+(Ye>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+Ye+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(Ye>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+ca(["r","c","d"],Ge)+`
      return ivec3(r, c, d);
    }
  
      `+la(Ke)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+Ke[1]+`;
        int cols = `+Ke[2]+`;

        `+$e+`

        setOutput(result);
      }
    `},ts=function(Ke,Ge,$e){this.variableNames=["dy"],this.outputShape=[],this.outputShape=Ge.shape;var Ye=Ge.shape,Qe=Ye[1],Je=Ye[2],Mt=Ke.shape,nn=Mt[1],an=Mt[2],sn=[$e&&nn>1?Qe-1:Qe,$e&&an>1?Je-1:Je],ln=[$e&&nn>1?nn-1:nn,$e&&an>1?an-1:an],fn=sn[0]/ln[0],hn=sn[1]/ln[1],Xr=1/fn,Mi=1/hn,co=2*Math.ceil(Xr)+2,lo=2*Math.ceil(Mi)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+fn+`);
        const float widthScale = float(`+hn+`);

        const float invHeightScale = float(`+Xr+`);
        const float invWidthScale = float(`+Mi+`);

        const int winHeight = int(`+co+`);
        const int winWidth = int(`+lo+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+nn+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+an+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(Qe-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(Je-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},es=function(Ke,Ge,$e,Ye){this.variableNames=["A"],this.outputShape=[];var Qe=Ke[0],Je=Ke[1],Mt=Ke[2],nn=Ke[3];this.outputShape=[Qe,Ge,$e,nn];var an=[Ye&&Ge>1?Je-1:Je,Ye&&$e>1?Mt-1:Mt],sn=[Ye&&Ge>1?Ge-1:Ge,Ye&&$e>1?$e-1:$e];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+an[0]/sn[0]+`,
          `+an[1]/sn[1]+`);
      const vec2 inputShapeRC = vec2(`+Je+".0, "+Mt+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},ns=function(Ke,Ge,$e,Ye){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var Qe=Ke[0],Je=Ke[1],Mt=Ke[2],nn=Ke[3];this.outputShape=[Qe,Ge,$e,nn];var an=[Ye&&Ge>1?Je-1:Je,Ye&&$e>1?Mt-1:Mt],sn=[Ye&&Ge>1?Ge-1:Ge,Ye&&$e>1?$e-1:$e];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+an[0]/sn[0]+`,
          `+an[1]/sn[1]+`,
          `+an[1]/sn[1]+`);
      const vec3 inputShapeRC = vec3(`+Je+".0, "+Mt+`.0,
                                     `+Mt+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(nn-1)+`;
        bool hasNextRow = coords.z < `+($e-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},rs=function(Ke,Ge,$e){this.variableNames=["dy"],this.outputShape=[],this.outputShape=Ge.shape;var Ye=Ge.shape,Qe=Ye[1],Je=Ye[2],Mt=Ke.shape,nn=Mt[1],an=Mt[2],sn=[$e&&nn>1?Qe-1:Qe,$e&&an>1?Je-1:Je],ln=[$e&&nn>1?nn-1:nn,$e&&an>1?an-1:an],fn=sn[0]/ln[0],hn=sn[1]/ln[1],Xr=1/fn,Mi=1/hn,co=2*Math.ceil(Xr)+2,lo=2*Math.ceil(Mi)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+fn+`);
        const float widthScale = float(`+hn+`);

        const float invHeightScale = float(`+Xr+`);
        const float invWidthScale = float(`+Mi+`);

        const int winHeight = int(`+co+`);
        const int winWidth = int(`+lo+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+nn+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+an+`) {
              continue;
            }

            float sourceFracRow =
              float(`+sn[0]+`) *
                (float(dyR) / float(`+ln[0]+`));

            float sourceFracCol =
                float(`+sn[1]+`) *
                  (float(dyC) / float(`+ln[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+Qe+`) - 1),
                `+$e+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+Je+`) - 1),
                `+$e+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},os=function(Ke,Ge,$e,Ye){this.variableNames=["A"],this.outputShape=[];var Qe=Ke[0],Je=Ke[1],Mt=Ke[2],nn=Ke[3];this.outputShape=[Qe,Ge,$e,nn];var an=[Ye&&Ge>1?Je-1:Je,Ye&&$e>1?Mt-1:Mt],sn=[Ye&&Ge>1?Ge-1:Ge,Ye&&$e>1?$e-1:$e],ln=Ye?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+an[0]/sn[0]+`,
          `+an[1]/sn[1]+`);
      const vec2 inputShapeRC = vec2(`+Je+".0, "+Mt+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+ln+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},as=function(Ke,Ge){this.variableNames=["x"];var $e=Ke.length;if($e>4)throw new Error("WebGL backend: Reverse of rank-"+$e+" tensor is not yet supported");if(this.outputShape=Ke,$e!==1){var Ye=Ke.map(function(Je,Mt){return function(nn){return Ge.indexOf(nn)!==-1&&Ke[nn]!==1?Ke[nn]+" - coords["+nn+"] - 1":"coords["+nn+"]"}(Mt)}).join(","),Qe=wa($e);this.userCode=`
      void main() {
        `+Qe+` coords = getOutputCoords();
        setOutput(getX(`+Ye+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+Ke[0]+` - coord - 1));
        }
      `},is=function(Ke,Ge){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var $e=Ke.length;if($e>4)throw new Error("WebGL backend: Reverse of rank-"+$e+" tensor is not yet supported");this.outputShape=Ke;var Ye=sa("rc",$e),Qe=Ye[$e-1]+" + 1 < "+this.outputShape[$e-1],Je=Ye[$e-2]+" + 1 < "+this.outputShape[$e-2],Mt=wa($e);function nn(an){var sn=Ke.map(function(ln,fn){return function(hn,Xr){return Ge.indexOf(hn)!==-1&&Ke[hn]!==1?Ke[hn]+" - "+Xr[hn]+" - 1":""+Xr[hn]}(fn,an)});return"getChannel(getX("+sn.join(",")+"), vec2("+sn.slice(-2).join(",")+"))"}this.userCode=$e===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+Ke[0]+` - rc - 1),
            `+Ke[0]+` - rc - 1);
          if(`+Qe+`){
              result.g = getChannel(getX(`+Ke[0]+` - (rc  + 1) - 1),
                `+Ke[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+Mt+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+function(an){return nn(an)}(Ye.slice())+`;
          if(`+Qe+`){
            result.g = `+function(an){return an[$e-1]="("+an[$e-1]+" + 1)",nn(an)}(Ye.slice())+`;
          }
          if(`+Je+`) {
            result.b = `+function(an){return an[$e-2]="("+an[$e-2]+" + 1)",nn(an)}(Ye.slice())+`;
            if(`+Qe+`) {
              result.a = `+function(an){return an[$e-1]="("+an[$e-1]+" + 1)",an[$e-2]="("+an[$e-2]+" + 1)",nn(an)}(Ye.slice())+`;
            }
          }
          setOutput(result);
        }
    `},ss=function(Ke,Ge,$e,Ye,Qe,Je,Mt){this.variableNames=["updates","indices","defaultValue"],this.outputShape=Je;var nn=wa(Qe.length),an=wa(Je.length),sn="";$e===1?sn="i":$e===2&&(sn="i, j");var ln="getIndices("+sn+")",fn="";Ye===1?fn="i":Ye===2&&(fn="i, coords[1]");var hn="getUpdates("+fn+")",Xr=Ge>1?"strides[j]":"strides";this.userCode=`
        `+nn+" strides = "+nn+"("+Qe+`);

        void main() {
          `+an+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+Ke+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+Ge+`; j++) {
              int index = round(`+ln+`);
              flattenedIndex += index * `+Xr+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+hn+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},us=function(Ke,Ge){this.variableNames=["x","segmentIds"];var $e=Ke.windowSize,Ye=Ke.batchSize,Qe=Ke.inSize,Je=Ke.numSegments,Mt=Je*Math.ceil(Qe/$e);this.outputShape=[Ye,Mt];var nn=4*Math.floor($e/4),an=$e%4,sn=`
        sumValue += dot(values, segFilter);
    `,ln="";Qe%$e>0&&(ln=`
        if (inIdx < 0 || inIdx >= `+Qe+`) {
          return initializationValue;
        }
      `);var fn="";Qe%$e>0&&(fn=`
        if (inIdx < 0 || inIdx >= `+Qe+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+ln+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+fn+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+Je+")) * float("+$e+`));
        int currentSeg = int(mod(float(outIdx), float(`+Je+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+nn+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+sn+`
        }

        int inIdx = inOffset + `+nn+`;
        if (`+(an===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+sn+`
        } else if (`+(an===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+sn+`
        } else if (`+(an===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+sn+`
        }
        setOutput(sumValue);
      }
    `},cs=function(Ke,Ge,$e){var Ye,Qe;if(this.variableNames=["c","a","b"],this.outputShape=Ge,$e>4)throw Error("Where for rank "+$e+" is not yet supported");if($e===1)Qe="resRC",Ye="resRC";else{for(var Je=["resRC.x","resRC.y","resRC.z","resRC.w"],Mt=[],nn=[],an=0;an<Ge.length;an++)nn.push(""+Je[an]),an<Ke&&Mt.push(""+Je[an]);Ye=Mt.join(),Qe=nn.join()}var sn=wa($e);this.userCode=`
      void main() {
        `+sn+` resRC = getOutputCoords();
        float cVal = getC(`+Ye+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+Qe+`));
        } else {
          setOutput(getB(`+Qe+`));
        }
      }
    `},ls=function(){function Ke(Ge){this.variableNames=["source"],this.outputShape=Ge,this.rank=Ge.length;var $e,Ye=wa(this.rank),Qe="uniform int start["+this.rank+"];",Je=function(Mt){if(Mt===1)return"sourceLoc";if(Mt<=6)return hs.slice(0,Mt).map(function(nn){return"sourceLoc."+nn}).join(",");throw Error("Slicing for rank "+Mt+" is not yet supported")}(this.rank);$e=`
        `+Ye+` sourceLoc;
        `+Ye+` coords = getOutputCoords();
        `+Ge.map(function(Mt,nn){return"sourceLoc."+hs[nn]+" = start["+nn+"] + coords."+hs[nn]+";"}).join(`
`)+`
      `,this.userCode=`
      `+Qe+`
      void main() {
        `+$e+`
        setOutput(getSource(`+Je+`));
      }
    `}return Ke.prototype.getCustomSetupFunc=function(Ge){var $e=this;if(Ge.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+Ge.length+")");return function(Ye,Qe){$e.startLoc==null&&($e.startLoc=Ye.getUniformLocationNoThrow(Qe,"start"),$e.startLoc==null)||Ye.gl.uniform1iv($e.startLoc,Ge)}},Ke}(),hs=["x","y","z","w","u","v"],fs=function(){function Ke(Ge){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Ge,this.rank=Ge.length;var $e=wa(this.rank),Ye=sa("coords",this.rank),Qe=sa("sourceLoc",this.rank),Je=this.rank===1?"sourceLoc":"vec2("+Qe.slice(-2).join()+")",Mt="getChannel(getSource("+Qe.join()+"), "+Je+")",nn=`
      result.x = `+Mt+`;
      if (++`+Ye[this.rank-1]+" < "+Ge[this.rank-1]+`) {
        ++`+Qe[this.rank-1]+`;
        result.y = `+Mt+`;
        --`+Qe[this.rank-1]+`;
      }
    `,an=this.rank===1?"":`
      --`+Ye[this.rank-1]+`;
      if (++`+Ye[this.rank-2]+" < "+Ge[this.rank-2]+`) {
        ++`+Qe[this.rank-2]+`;
        result.z = `+Mt+`;
        if (++`+Ye[this.rank-1]+" < "+Ge[this.rank-1]+`) {
          ++`+Qe[this.rank-1]+`;
          result.w = `+Mt+`;
        }
      }
    `,sn=this.rank<=4?`sourceLoc = coords +
            `+$e+"("+Ge.map(function(ln,fn){return"start["+fn+"]"}).join()+");":Ge.map(function(ln,fn){return Qe[fn]+" = "+Ye[fn]+" + start["+fn+"];"}).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+$e+` coords = getOutputCoords();
        `+$e+` sourceLoc;
        `+sn+`
        vec4 result = vec4(0.);
        `+nn+`
        `+an+`
        setOutput(result);
      }
    `}return Ke.prototype.getCustomSetupFunc=function(Ge){var $e=this;if(Ge.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+Ge.length+")");return function(Ye,Qe){$e.startLoc==null&&($e.startLoc=Ye.getUniformLocationNoThrow(Qe,"start"),$e.startLoc==null)||Ye.gl.uniform1iv($e.startLoc,Ge)}},Ke}(),ds=function(Ke,Ge,$e){this.variableNames=["x"],this.outputShape=$e;var Ye=$e.length,Qe=wa($e.length),Je=wa($e.length),Mt="";if(Ye===1)Mt="coords * strides + begin";else{var nn=0;Mt=$e.map(function(an,sn){return nn++,$e.length===1?"coords * strides["+sn+"] + begin["+sn+"]":"coords["+(nn-1)+"] * strides["+sn+"] + begin["+sn+"]"}).join(",")}this.userCode=`
      `+Qe+" begin = "+Qe+"("+Ke+`);
      `+Qe+" strides = "+Qe+"("+Ge+`);

      void main() {
        `+Je+` coords = getOutputCoords();
        setOutput(getX(`+Mt+`));
      }
    `},ps=function(){function Ke(Ge){this.gpgpu=Ge,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return Ke.prototype.acquireTexture=function(Ge,$e,Ye){var Qe,Je=vs($e,Ye),Mt=ms(Ge,Je,Ye);if(Mt in this.freeTextures||(this.freeTextures[Mt]=[]),Mt in this.usedTextures||(this.usedTextures[Mt]=[]),this.freeTextures[Mt].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var nn=this.freeTextures[Mt].shift();return this.usedTextures[Mt].push(nn),nn}return this.numUsedTextures++,this.log(),Je===Gt.PACKED_2X2_FLOAT32?Qe=this.gpgpu.createPackedMatrixTexture(Ge[0],Ge[1]):Je===Gt.PACKED_2X2_FLOAT16?Qe=this.gpgpu.createFloat16PackedMatrixTexture(Ge[0],Ge[1]):Je===Gt.UNPACKED_FLOAT32?Qe=this.gpgpu.createFloat32MatrixTexture(Ge[0],Ge[1]):Je===Gt.UNPACKED_FLOAT16?Qe=this.gpgpu.createFloat16MatrixTexture(Ge[0],Ge[1]):Je===Gt.PACKED_4X1_UNSIGNED_BYTE&&(Qe=this.gpgpu.createUnsignedBytesMatrixTexture(Ge[0],Ge[1])),this.usedTextures[Mt].push(Qe),Qe},Ke.prototype.releaseTexture=function(Ge,$e,Ye,Qe){if(this.freeTextures!=null){var Je=ms($e,vs(Ye,Qe),Qe);Je in this.freeTextures||(this.freeTextures[Je]=[]),this.freeTextures[Je].push(Ge),this.numFreeTextures++,this.numUsedTextures--;var Mt=this.usedTextures[Je],nn=Mt.indexOf(Ge);if(nn<0)throw new Error("Cannot release a texture that was never provided by this texture manager");Mt.splice(nn,1),this.log()}},Ke.prototype.log=function(){if(this.logEnabled){var Ge=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+Ge+")")}},Ke.prototype.getNumUsedTextures=function(){return this.numUsedTextures},Ke.prototype.getNumFreeTextures=function(){return this.numFreeTextures},Ke.prototype.dispose=function(){var Ge=this;if(this.freeTextures!=null){for(var $e in this.freeTextures)this.freeTextures[$e].forEach(function(Ye){Ge.gpgpu.deleteMatrixTexture(Ye)});for(var $e in this.usedTextures)this.usedTextures[$e].forEach(function(Qe){Ge.gpgpu.deleteMatrixTexture(Qe)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},Ke}();function vs(Ke,Ge){if(Ke===zt.UPLOAD)return Gt.PACKED_2X2_FLOAT32;if(Ke===zt.RENDER||Ke==null)return function($e){return i().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?$e?Gt.PACKED_2X2_FLOAT32:Gt.UNPACKED_FLOAT32:$e?Gt.PACKED_2X2_FLOAT16:Gt.UNPACKED_FLOAT16}(Ge);if(Ke===zt.DOWNLOAD||Ke===zt.PIXELS)return Gt.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+Ke)}function ms(Ke,Ge,$e){return Ke[0]+"_"+Ke[1]+"_"+Ge+"_"+$e}var gs=function(Ke,Ge){this.variableNames=["A"];for(var $e=new Array(Ke.length),Ye=0;Ye<$e.length;Ye++)$e[Ye]=Ke[Ye]*Ge[Ye];this.outputShape=$e,this.rank=$e.length;var Qe=wa(this.rank),Je=function(Mt){var nn=Mt.length;if(nn>5)throw Error("Tile for rank "+nn+" is not yet supported");if(nn===1)return"imod(resRC, "+Mt[0]+")";for(var an=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],sn=[],ln=0;ln<Mt.length;ln++)sn.push("imod("+an[ln]+", "+Mt[ln]+")");return sn.join()}(Ke);this.userCode=`
      void main() {
        `+Qe+` resRC = getOutputCoords();
        setOutput(getA(`+Je+`));
      }
    `},ys=function(Ke,Ge){this.variableNames=["A"];for(var $e=new Array(Ke.length),Ye=0;Ye<$e.length;Ye++)$e[Ye]=Ke[Ge[Ye]];this.outputShape=$e,this.rank=$e.length;var Qe=wa(this.rank),Je=function(Mt){var nn=Mt.length;if(nn>6)throw Error("Transpose for rank "+nn+" is not yet supported");for(var an=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],sn=new Array(nn),ln=0;ln<Mt.length;ln++)sn[Mt[ln]]=an[ln];return sn.join()}(Ge);this.userCode=`
    void main() {
      `+Qe+` resRC = getOutputCoords();
      setOutput(getA(`+Je+`));
    }
    `},xs=function(Ke,Ge){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var $e=new Array(Ke.length),Ye=0;Ye<$e.length;Ye++)$e[Ye]=Ke[Ge[Ye]];if(this.outputShape=$e,this.rank=$e.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var Qe=wa(this.rank),Je=ia("rc",this.rank),Mt=new Array(this.rank);for(Ye=0;Ye<Ge.length;Ye++)Mt[Ge[Ye]]=Je[Ye];var nn="vec2("+Mt.slice(-2).join()+")",an="++"+Je[this.rank-1]+" < "+$e[this.rank-1],sn="getChannel(getA("+Mt.join()+"), "+nn+")";this.userCode=`
    void main() {
      `+Qe+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+sn+`;
      if(`+an+`) {
        result[1] = `+sn+`;
      }
      --`+Je[this.rank-1]+`;
      if(++`+Je[this.rank-2]+" < "+$e[this.rank-2]+`) {
        result[2] = `+sn+`;
        if(`+an+`) {
          result[3] = `+sn+`;
        }
      }
      setOutput(result);
    }
    `},bs=1.7580993408473768,ws=1.0507009873554805,Cs=function(Ke,Ge){this.variableNames=["A"],this.outputShape=Ke,this.userCode=`
      float unaryOperation(float x) {
        `+Ge+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},Es="if (isnan(x)) return x;",Rs="return x;",Is="return abs(x);",ks=Es+`
  return (x < 0.0) ? 0.0 : x;
`,Ss=Es+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,As="return (x >= 0.0) ? x : (exp(x) - 1.0);",Ds=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+bs+`;
  float scale = `+ws+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,Ts="return -x;",Ns="return ceil(x);",Fs="return floor(x);",_s="return exp(x);",Os="return exp(x) - 1.0;",Ms=Es+`
  return sin(x);
`,Bs=Es+`
  return cos(x);
`,Ps=Es+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,Ls=Es+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,Ws=Es+`
  return atan(x);
`,Us=Es+"return log(x + sqrt(x * x + 1.0));",Vs=Es+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,zs=Es+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,Gs="return x;",Hs="return x;",qs=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Ks=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,js=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Xs=function(Ke,Ge){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Ke,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+Ge+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},Ys=function(Ke){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=Ke;var Ge=Ke.length,$e=sa("rc",Ge),Ye=wa(Ge),Qe=function(nn,an){if(nn===1)return"rc";for(var sn="",ln=0;ln<nn;ln++)sn+=an[ln],ln<nn-1&&(sn+=",");return sn}(Ge,$e),Je=$e.slice(-2),Mt=Ge<=1?"rc":"vec2("+Je.join(",")+")";this.userCode=`
      void main() {
        `+Ye+` rc = getOutputCoords();
        vec4 packedInput = getA(`+Qe+`);

        setOutput(getChannel(packedInput, `+Mt+`));
      }
    `},$s={};function Qs(Ke,Ge){if(Ge===void 0&&(Ge=!1),Ke==="linear")return Ge?Hs:Rs;if(Ke==="relu")return Ge?qs:ks;if(Ke==="elu")return Ge?js:As;if(Ke==="relu6")return Ge?Ks:Ss;if(Ke==="prelu")return Ge?Pa:Ma;throw new Error("Activation "+Ke+" has not been implemented for the WebGL backend.")}var Js=600,Zs=function(Ke){function Ge($e){var Ye,Qe=Ke.call(this)||this;if(Qe.pendingRead=new WeakMap,Qe.pendingDisposal=new WeakSet,Qe.dataRefCount=new WeakMap,Qe.numBytesInGPU=0,Qe.uploadWaitMs=0,Qe.downloadWaitMs=0,Qe.warnedAboutMemory=!1,Qe.pendingDeletes=0,Qe.disposed=!1,!i().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if($e==null){var Je=jt(i().getNumber("WEBGL_VERSION"));Qe.binaryCache=((Ye=i().getNumber("WEBGL_VERSION"))in $s||($s[Ye]={}),$s[Ye]),Qe.gpgpu=new Bi(Je),Qe.canvas=Je.canvas,Qe.gpgpuCreatedLocally=!0}else Qe.gpgpu=$e,Qe.binaryCache={},Qe.gpgpuCreatedLocally=!1,Qe.canvas=$e.gl.canvas;return Qe.textureManager=new ps(Qe.gpgpu),Qe.numMBBeforeWarning=i().global.screen==null?1024:i().global.screen.height*i().global.screen.width*window.devicePixelRatio*Js/1024/1024,Qe.texData=new xo(Qe,Lt),Qe}return e(Ge,Ke),Ge.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},Ge.prototype.write=function($e,Ye,Qe){if(i().getBool("DEBUG")&&this.checkNumericalProblems($e),Qe==="complex64"&&$e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var Je={};return this.texData.set(Je,{shape:Ye,dtype:Qe,values:$e,usage:zt.UPLOAD}),Je},Ge.prototype.move=function($e,Ye,Qe,Je){if(i().getBool("DEBUG")&&this.checkNumericalProblems(Ye),Je==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set($e,{shape:Qe,dtype:Je,values:Ye,usage:zt.UPLOAD})},Ge.prototype.readSync=function($e){var Ye=this.texData.get($e),Qe=Ye.values,Je=Ye.dtype,Mt=Ye.complexTensors,nn=Ye.slice,an=Ye.shape,sn=Ye.isPacked;if(nn!=null){var ln=void 0;ln=sn?new Xs(an,Gs):new Cs(an,Gs);var fn=this.runWebGLProgram(ln,[{dataId:$e,shape:an,dtype:Je}],Je),hn=this.readSync(fn.dataId);return this.disposeData(fn.dataId),hn}if(Qe!=null)return this.convertAndCacheOnCPU($e);if(Je==="string")return Qe;var Xr,Mi,co=this.activeTimers!=null;return co&&(Xr=et()),Je==="complex64"?Mi=Vo(Mt.real.dataSync(),Mt.imag.dataSync()):Mi=this.getValuesFromTexture($e),co&&(this.downloadWaitMs+=et()-Xr),this.convertAndCacheOnCPU($e,Mi)},Ge.prototype.read=function($e){return n(this,void 0,void 0,function(){var Ye,Qe,Je,Mt,nn,an,sn,ln,fn,hn,Xr,Mi,co,lo,uo,ho,mo,_d,ep,rp,sp,op;return r(this,function(ip){switch(ip.label){case 0:if(this.pendingRead.has($e))return Ye=this.pendingRead.get($e),[2,new Promise(function(lp){return Ye.push(lp)})];if(Qe=this.texData.get($e),Je=Qe.values,Mt=Qe.shape,nn=Qe.slice,an=Qe.dtype,sn=Qe.complexTensors,ln=Qe.isPacked,nn!=null)return fn=void 0,fn=ln?new Xs(Mt,Gs):new Cs(Mt,Gs),hn=this.runWebGLProgram(fn,[{dataId:$e,shape:Mt,dtype:an}],an),Xr=this.read(hn.dataId),this.disposeData(hn.dataId),[2,Xr];if(Je!=null)return[2,this.convertAndCacheOnCPU($e)];if(!i().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&i().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return Mi=null,an!=="complex64"&&i().get("WEBGL_BUFFER_SUPPORTED")&&(co=this.decode($e),lo=this.texData.get(co.dataId),Mi=(op=this.gpgpu).createBufferFromTexture.apply(op,[lo.texture].concat(Yt(Mt)))),this.pendingRead.set($e,[]),an==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:ip.sent(),ip.label=2;case 2:return an!=="complex64"?[3,4]:[4,Promise.all([sn.real.data(),sn.imag.data()])];case 3:return ho=ip.sent(),mo=ho[0],_d=ho[1],uo=Vo(mo,_d),[3,5];case 4:Mi==null?uo=this.getValuesFromTexture($e):(ep=k(Mt),uo=this.gpgpu.downloadFloat32MatrixFromBuffer(Mi,ep)),ip.label=5;case 5:return co!=null&&this.disposeData(co.dataId),rp=this.convertAndCacheOnCPU($e,uo),sp=this.pendingRead.get($e),this.pendingRead.delete($e),sp.forEach(function(lp){return lp(rp)}),this.pendingDisposal.has($e)&&(this.pendingDisposal.delete($e),this.disposeData($e),this.pendingDeletes--),[2,rp]}})})},Ge.prototype.checkNumericalProblems=function($e){if($e!=null)for(var Ye=0;Ye<$e.length;Ye++){var Qe=$e[Ye];if(!ee(Qe))throw i().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+Qe+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+Qe+" cannot be represented on this device.")}},Ge.prototype.getValuesFromTexture=function($e){var Ye,Qe=this.texData.get($e),Je=Qe.shape,Mt=Qe.dtype,nn=Qe.isPacked,an=k(Je);if(i().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var sn=this.decode($e),ln=this.texData.get(sn.dataId),fn=(Ye=this.gpgpu).downloadMatrixFromPackedTexture.apply(Ye,[ln.texture].concat(Yt(Je))).subarray(0,an);return this.disposeData(sn.dataId),fn}var hn=i().getBool("WEBGL_PACK")&&nn===!0,Xr=hn?Te(Je):Je,Mi=hn?new ci(Xr):new ui(Xr),co=this.runWebGLProgram(Mi,[{shape:Xr,dtype:Mt,dataId:$e}],"float32"),lo=this.texData.get(co.dataId),uo=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(lo.texture,lo.texShape[0],lo.texShape[1]).subarray(0,an);return this.disposeData(co.dataId),uo},Ge.prototype.time=function($e){return n(this,void 0,void 0,function(){var Ye,Qe,Je,Mt,nn,an,sn;return r(this,function(ln){switch(ln.label){case 0:return Ye=this.activeTimers,Qe=[],Je=!1,this.programTimersStack==null?(this.programTimersStack=Qe,Je=!0):this.activeTimers.push(Qe),this.activeTimers=Qe,$e(),Mt=I(this.activeTimers.map(function(fn){return fn.query})).filter(function(fn){return fn!=null}),nn=I(this.activeTimers.map(function(fn){return fn.name})).filter(function(fn){return fn!=null}),this.activeTimers=Ye,Je&&(this.programTimersStack=null),an={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},i().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(Mt)]:[3,2];case 1:return sn=ln.sent(),an.kernelMs=w(sn),an.getExtraProfileInfo=function(){return sn.map(function(fn,hn){return{name:nn[hn],ms:fn}}).map(function(fn){return fn.name+": "+fn.ms}).join(", ")},[3,3];case 2:an.kernelMs={error:"WebGL query timers are not supported in this environment."},ln.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,an]}})})},Ge.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},Ge.prototype.startTimer=function(){return i().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:et(),endMs:null}},Ge.prototype.endTimer=function($e){return i().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),$e):($e.endMs=et(),$e)},Ge.prototype.getQueryTime=function($e){return n(this,void 0,void 0,function(){var Ye;return r(this,function(Qe){return i().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime($e)]:[2,(Ye=$e).endMs-Ye.startMs]})})},Ge.prototype.disposeData=function($e){if(!this.pendingDisposal.has($e)){if(this.pendingRead.has($e))return this.pendingDisposal.add($e),void this.pendingDeletes++;if(this.texData.has($e)){this.releaseGPUData($e);var Ye=this.texData.get($e).complexTensors;Ye!=null&&(Ye.real.dispose(),Ye.imag.dispose()),this.texData.delete($e)}}},Ge.prototype.releaseGPUData=function($e){var Ye=this.texData.get($e),Qe=Ye.texture,Je=Ye.dtype,Mt=Ye.texShape,nn=Ye.usage,an=Ye.isPacked,sn=Ye.slice,ln=sn&&sn.origDataId||$e,fn=this.dataRefCount.get(ln);fn>1?this.dataRefCount.set(ln,fn-1):(this.dataRefCount.delete(ln),Qe!=null&&(this.numBytesInGPU-=this.computeBytes(Mt,Je),this.textureManager.releaseTexture(Qe,Mt,nn,an)));var hn=this.texData.get($e);hn.texture=null,hn.texShape=null,hn.isPacked=!1,hn.slice=null},Ge.prototype.getTexture=function($e){return this.uploadToGPU($e),this.texData.get($e).texture},Ge.prototype.getDataInfo=function($e){return this.texData.get($e)},Ge.prototype.getCPUBackend=function(){return i().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=Lt.findBackend("cpu")),this.cpuBackend):null},Ge.prototype.shouldExecuteOnCPU=function($e,Ye){var Qe=this;return Ye===void 0&&(Ye=128),this.getCPUBackend()!=null&&$e.every(function(Je){return Qe.texData.get(Je.dataId).texture==null&&Je.size<Ye})},Ge.prototype.getGPGPUContext=function(){return this.gpgpu},Ge.prototype.complex=function($e,Ye){var Qe=this.makeOutput($e.shape,"complex64");return this.texData.get(Qe.dataId).complexTensors={real:Lt.keep($e.clone()),imag:Lt.keep(Ye.clone())},Qe},Ge.prototype.real=function($e){return this.texData.get($e.dataId).complexTensors.real.clone()},Ge.prototype.imag=function($e){return this.texData.get($e.dataId).complexTensors.imag.clone()},Ge.prototype.slice=function($e,Ye,Qe){if(this.shouldExecuteOnCPU([$e]))return this.cpuBackend.slice($e,Ye,Qe);if(k(Qe)===0)return Fn([],Qe,$e.dtype);var Je=this.texData.get($e.dataId).isPacked,Mt=io($e.shape,Ye,Qe);if(Je||!Mt){var nn=i().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new fs(Qe):new ls(Qe),an=nn.getCustomSetupFunc(Ye);return this.compileAndRun(nn,[$e],null,an)}return this.uploadToGPU($e.dataId),this.shallowSlice($e,Ye,Qe)},Ge.prototype.shallowSlice=function($e,Ye,Qe){var Je=this.texData.get($e.dataId),Mt=this.makeOutput(Qe,$e.dtype),nn=this.texData.get(Mt.dataId);Object.assign(nn,Je),nn.shape=Qe,nn.dtype=$e.dtype;var an=so(Ye,$e.strides);Je.slice&&(an+=Je.slice.flatOffset),nn.slice={flatOffset:an,origDataId:Je.slice&&Je.slice.origDataId||$e.dataId};var sn=this.dataRefCount.get(nn.slice.origDataId)||1;return this.dataRefCount.set(nn.slice.origDataId,sn+1),Mt},Ge.prototype.stridedSlice=function($e,Ye,Qe,Je){if(this.shouldExecuteOnCPU([$e]))return this.cpuBackend.stridedSlice($e,Ye,Qe,Je);var Mt=ro(Ye,Qe,Je);if(Mt.some(function(an){return an===0}))return Fn([],Mt);var nn=new ds(Ye,Je,Mt);return this.compileAndRun(nn,[$e])},Ge.prototype.reverse=function($e,Ye){var Qe=i().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new is($e.shape,Ye):new as($e.shape,Ye);return this.compileAndRun(Qe,[$e])},Ge.prototype.concat=function($e,Ye){if($e[0].dtype==="complex64"){var Qe=$e.map(function(Xr){return Tn(Xr)}),Je=$e.map(function(Xr){return Nn(Xr)});return Dn(this.concat(Qe,Ye),this.concat(Je,Ye))}if(this.shouldExecuteOnCPU($e))return this.cpuBackend.concat($e,Ye);if($e.length===1)return $e[0];if($e.length>i().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var Mt=Math.floor($e.length/2),nn=this.concat($e.slice(0,Mt),Ye),an=this.concat($e.slice(Mt),Ye);return this.concat([nn,an],Ye)}if(i().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&$e[0].rank>1){var sn=new Ga($e.map(function(Xr){return Xr.shape}),Ye);return this.compileAndRun(sn,$e)}var ln=Sn($e.map(function(Xr){return Xr.shape}),Ye),fn=$e.map(function(Xr){return Xr.as2D(-1,k(Xr.shape.slice(Ye)))}),hn=new za(fn.map(function(Xr){return Xr.shape}));return this.compileAndRun(hn,fn).reshape(ln)},Ge.prototype.neg=function($e){if(this.shouldExecuteOnCPU([$e]))return this.cpuBackend.neg($e);if(i().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp($e,Ts,$e.dtype);var Ye=new Cs($e.shape,Ts);return this.compileAndRun(Ye,[$e])},Ge.prototype.batchMatMul=function($e,Ye,Qe,Je){var Mt=Qe?$e.shape[2]:$e.shape[1],nn=Je?Ye.shape[1]:Ye.shape[2],an=Qe?$e.shape[1]:$e.shape[2],sn=$e.shape[0];if((Mt===1||nn===1)&&an>1e3){Qe&&($e=$e.transpose([0,2,1])),Je&&(Ye=Ye.transpose([0,2,1]));var ln=nn===1?$e:$e.as3D(sn,an,1),fn=nn===1?2:1,hn=nn===1?Ye.as3D(sn,1,an):Ye;return this.multiply(ln,hn).sum(fn,!0)}var Xr=Dt($e.dtype,Ye.dtype),Mi=new Hi($e.shape,[sn,Mt,nn],Qe,Je);return this.compileAndRun(Mi,[$e,Ye],Xr)},Ge.prototype.fusedBatchMatMul=function($e){var Ye=$e.a,Qe=$e.b,Je=$e.transposeA,Mt=$e.transposeB,nn=$e.bias,an=$e.activation,sn=$e.preluActivationWeights,ln=Je?Ye.shape[2]:Ye.shape[1],fn=Mt?Qe.shape[1]:Qe.shape[2],hn=Ye.shape[0],Xr=Dt(Ye.dtype,Qe.dtype),Mi=nn!=null,co=sn!=null,lo=an?Qs(an,!0):null,uo=new Hi(Ye.shape,[hn,ln,fn],Je,Mt,Mi,lo,co),ho=[Ye,Qe];return nn&&ho.push(nn),sn&&ho.push(sn),this.compileAndRun(uo,ho,Xr)},Ge.prototype.multiply=function($e,Ye){if($e.dtype==="complex64"){var Qe=this.texData.get($e.dataId),Je=this.texData.get(Ye.dataId),Mt=new Na(Da,$e.shape,Ye.shape),nn=new Na(Ta,$e.shape,Ye.shape),an=[this.makeComplexComponentTensorInfo($e,Qe.complexTensors.real),this.makeComplexComponentTensorInfo($e,Qe.complexTensors.imag),this.makeComplexComponentTensorInfo(Ye,Je.complexTensors.real),this.makeComplexComponentTensorInfo(Ye,Je.complexTensors.imag)],sn=this.compileAndRun(Mt,an),ln=this.compileAndRun(nn,an),fn=this.complex(sn,ln);return sn.dispose(),ln.dispose(),fn}if(this.shouldExecuteOnCPU([$e,Ye]))return this.cpuBackend.multiply($e,Ye);if(i().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp($e,Ye,Oa,$e.dtype);var hn=new Ba(Oa,$e.shape,Ye.shape);return this.compileAndRun(hn,[$e,Ye],$e.dtype)},Ge.prototype.batchNormalization=function($e,Ye,Qe,Je,Mt,nn){var an=[$e,Ye,Qe],sn=null;nn!=null&&(sn=nn.shape,an.push(nn));var ln=null;if(Mt!=null&&(ln=Mt.shape,an.push(Mt)),i().getBool("WEBGL_PACK_NORMALIZATION")){var fn=new Aa($e.shape,Ye.shape,Qe.shape,sn,ln,Je);return this.compileAndRun(fn,an)}var hn=new Sa($e.shape,Ye.shape,Qe.shape,sn,ln,Je);return this.compileAndRun(hn,an)},Ge.prototype.localResponseNormalization4D=function($e,Ye,Qe,Je,Mt){var nn=i().getBool("WEBGL_PACK_NORMALIZATION")?new Vi($e.shape,Ye,Qe,Je,Mt):new Wi($e.shape,Ye,Qe,Je,Mt);return this.compileAndRun(nn,[$e])},Ge.prototype.LRNGrad=function($e,Ye,Qe,Je,Mt,nn,an){var sn=new Ui(Ye.shape,Je,Mt,nn,an);return this.compileAndRun(sn,[Ye,Qe,$e])},Ge.prototype.tile=function($e,Ye){if($e.dtype==="string"){var Qe=this.readSync($e.dataId).map(function(Mt){return ot(Mt)});return ta(dr($e.shape,$e.dtype,Qe),Ye)}var Je=new gs($e.shape,Ye);return this.compileAndRun(Je,[$e])},Ge.prototype.pad=function($e,Ye,Qe){var Je=i().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Yi($e.shape,Ye,Qe):new Xi($e.shape,Ye,Qe);return this.compileAndRun(Je,[$e])},Ge.prototype.transpose=function($e,Ye){if(this.shouldExecuteOnCPU([$e]))return this.cpuBackend.transpose($e,Ye);var Qe=i().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new xs($e.shape,Ye):new ys($e.shape,Ye);return this.compileAndRun(Qe,[$e])},Ge.prototype.gather=function($e,Ye,Qe){if(this.shouldExecuteOnCPU([$e,Ye]))return this.cpuBackend.gather($e,Ye,Qe);var Je=new mi($e.shape,Ye.size,Qe);return this.compileAndRun(Je,[$e,Ye])},Ge.prototype.batchToSpaceND=function($e,Ye,Qe){C($e.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var Je=Ye.reduce(function(fn,hn){return fn*hn}),Mt=zr($e.shape,Ye,Je),nn=Gr(Mt.length,Ye.length),an=Hr($e.shape,Ye,Je),sn=qr(Qe,Ye.length),ln=Kr(an,Qe,Ye.length);return $e.reshape(Mt).transpose(nn).reshape(an).slice(sn,ln)},Ge.prototype.spaceToBatchND=function($e,Ye,Qe){C($e.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var Je=Ye.reduce(function(hn,Xr){return hn*Xr}),Mt=[[0,0]];Mt.push.apply(Mt,Qe);for(var nn=1+Ye.length;nn<$e.shape.length;++nn)Mt.push([0,0]);var an=$e.pad(Mt),sn=zr(an.shape,Ye,Je,!1),ln=Gr(sn.length,Ye.length,!1),fn=Hr(an.shape,Ye,Je,!1);return an.reshape(sn).transpose(ln).reshape(fn)},Ge.prototype.reduce=function($e,Ye,Qe){var Je=$e.shape[0],Mt=$e.shape[1],nn=$r(Mt),an=new Ji({windowSize:nn,inSize:Mt,batchSize:Je},Ye),sn=this.compileAndRun(an,[$e],Qe);return sn.shape[1]===1?sn:this.reduce(sn,Ye,Qe)},Ge.prototype.argReduce=function($e,Ye,Qe){Qe===void 0&&(Qe=null);var Je=$e.shape[0],Mt=$e.shape[1];Qe!=null&&(Je=Qe.shape[0],Mt=Qe.shape[1]);var nn=$r(Mt),an=new aa({windowSize:nn,inSize:Mt,batchSize:Je},Ye,Qe==null),sn=[$e];Qe!=null&&sn.push(Qe);var ln=this.compileAndRun(an,sn,"int32");return ln.shape[1]===1?ln:this.argReduce($e,Ye,ln)},Ge.prototype.argReducePacked=function($e,Ye,Qe){Qe===void 0&&(Qe=null);var Je=Qe!=null?Qe.shape:$e.shape,Mt=$r(Je[Je.length-1]),nn=new Ra(Je,Mt,Ye,Qe==null),an=Qe==null?[$e]:[$e,Qe],sn=this.compileAndRun(nn,an,"int32");return sn.rank===$e.rank?this.argReducePacked($e,Ye,sn):sn},Ge.prototype.sum=function($e,Ye){Cn("sum",Ye,$e.rank);var Qe=bn($e.shape,Ye),Je=Qe[0],Mt=k(Qe[1]),nn=$e.as2D(-1,Mt),an=Tt($e.dtype);return this.reduce(nn,"sum",an).reshape(Je)},Ge.prototype.prod=function($e,Ye){if(this.shouldExecuteOnCPU([$e]))return this.cpuBackend.prod($e,Ye);var Qe=bn($e.shape,Ye),Je=Qe[0],Mt=k(Qe[1]),nn=$e.as2D(-1,Mt),an=Tt($e.dtype);return this.reduce(nn,"prod",an).reshape(Je)},Ge.prototype.unsortedSegmentSum=function($e,Ye,Qe){var Je=0,Mt=En([Je],$e.rank),nn=$e;Mt!=null&&(nn=$e.transpose(Mt),Je=In(1,$e.rank)[0]);var an=function(Xr,Mi,co){for(var lo=[],uo=Xr.length,ho=0;ho<uo;ho++)ho!==Mi?lo.push(Xr[ho]):lo.push(co);return lo}(nn.shape,Je,Qe),sn=k([nn.shape[Je]]),ln=nn.as2D(-1,sn),fn=Tt($e.dtype),hn=this.segOpCompute(ln,"unsortedSegmentSum",Ye,fn,Qe).reshape(an);return Mt!=null&&(hn=hn.transpose(Rn(Mt))),hn},Ge.prototype.segOpCompute=function($e,Ye,Qe,Je,Mt){var nn=$e.shape[0],an=$e.shape[1],sn=function(hn,Xr){var Mi,co=!1;for(hn<=Yr?(Mi=hn,co=!0):Mi=Y(hn,Math.floor(Math.sqrt(hn)));!co;)Mi>Xr||Mi===hn?co=!0:Mi=Y(hn,Mi+1);return Mi}(an,Mt),ln=new us({windowSize:sn,inSize:an,batchSize:nn,numSegments:Mt}),fn=this.compileAndRun(ln,[$e,Qe],Je);return fn.shape[1]===Mt?fn:(Qe=Kn(0,Mt).tile([an/sn]),this.segOpCompute(fn,Ye,Qe,Je,Mt))},Ge.prototype.argMinMaxReduce=function($e,Ye,Qe){var Je=[Ye];if(Cn("arg"+Qe.charAt(0).toUpperCase()+Qe.slice(1),Je,$e.rank),!i().getBool("WEBGL_PACK_REDUCE")||$e.rank<=2){var Mt=bn($e.shape,Je),nn=Mt[0],an=k(Mt[1]),sn=$e.as2D(-1,an);return this.argReduce(sn,Qe).reshape(nn)}return this.argReducePacked($e,Qe)},Ge.prototype.argMin=function($e,Ye){return this.argMinMaxReduce($e,Ye,"min")},Ge.prototype.argMax=function($e,Ye){return this.argMinMaxReduce($e,Ye,"max")},Ge.prototype.cumsum=function($e,Ye,Qe,Je){if(Ye!==$e.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+($e.rank-1)+" but got axis="+Ye);var Mt=new ni($e.shape,Qe,Je);return this.compileAndRun(Mt,[$e])},Ge.prototype.equal=function($e,Ye){if(i().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp($e,Ye,`
  return vec4(equal(a, b));
`,"bool");var Qe=new Ba("return float(a == b);",$e.shape,Ye.shape);return this.compileAndRun(Qe,[$e,Ye],"bool")},Ge.prototype.notEqual=function($e,Ye){if(i().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp($e,Ye,`
  return vec4(notEqual(a, b));
`,"bool");var Qe=new Ba("return float(a != b);",$e.shape,Ye.shape);return this.compileAndRun(Qe,[$e,Ye],"bool")},Ge.prototype.less=function($e,Ye){if(this.shouldExecuteOnCPU([$e,Ye]))return this.cpuBackend.less($e,Ye);if(i().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp($e,Ye,`
  return vec4(lessThan(a, b));
`,"bool");var Qe=new Ba("return float(a < b);",$e.shape,Ye.shape);return this.compileAndRun(Qe,[$e,Ye],"bool")},Ge.prototype.lessEqual=function($e,Ye){if(i().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp($e,Ye,`
  return vec4(lessThanEqual(a, b));
`,"bool");var Qe=new Ba("return float(a <= b);",$e.shape,Ye.shape);return this.compileAndRun(Qe,[$e,Ye],"bool")},Ge.prototype.greater=function($e,Ye){if(this.shouldExecuteOnCPU([$e,Ye]))return this.cpuBackend.greater($e,Ye);if(i().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp($e,Ye,`
  return vec4(greaterThan(a, b));
`,"bool");var Qe=new Ba("return float(a > b);",$e.shape,Ye.shape);return this.compileAndRun(Qe,[$e,Ye],"bool")},Ge.prototype.greaterEqual=function($e,Ye){if(i().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp($e,Ye,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var Qe=new Ba("return float(a >= b);",$e.shape,Ye.shape);return this.compileAndRun(Qe,[$e,Ye],"bool")},Ge.prototype.logicalNot=function($e){var Ye=new Cs($e.shape,"return float(!(x >= 1.0));");return this.compileAndRun(Ye,[$e])},Ge.prototype.logicalAnd=function($e,Ye){if(i().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp($e,Ye,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var Qe=new Ba("return float(a >= 1.0 && b >= 1.0);",$e.shape,Ye.shape);return this.compileAndRun(Qe,[$e,Ye],"bool")},Ge.prototype.logicalOr=function($e,Ye){if(i().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp($e,Ye,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var Qe=new Ba("return float(a >= 1.0 || b >= 1.0);",$e.shape,Ye.shape);return this.compileAndRun(Qe,[$e,Ye],"bool")},Ge.prototype.select=function($e,Ye,Qe){var Je=new cs($e.rank,Ye.shape,Ye.rank);return this.compileAndRun(Je,[$e,Ye,Qe],Dt(Ye.dtype,Qe.dtype))},Ge.prototype.where=function($e){dn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var Ye=$e.dataSync();return na($e.shape,Ye)},Ge.prototype.topk=function($e,Ye,Qe){return ea($e.dataSync(),$e.shape,$e.dtype,Ye)},Ge.prototype.min=function($e,Ye){Cn("min",Ye,$e.rank);var Qe=bn($e.shape,Ye),Je=Qe[0],Mt=k(Qe[1]),nn=$e.as2D(-1,Mt);return this.reduce(nn,"min",nn.dtype).reshape(Je)},Ge.prototype.minimum=function($e,Ye){if(this.shouldExecuteOnCPU([$e,Ye]))return this.cpuBackend.minimum($e,Ye);var Qe=i().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new La(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,$e.shape,Ye.shape):new Ba(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,$e.shape,Ye.shape);return this.compileAndRun(Qe,[$e,Ye])},Ge.prototype.mod=function($e,Ye){var Qe=i().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new La(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,$e.shape,Ye.shape):new Ba(`if (b == 0.0) return NAN;
  return mod(a, b);`,$e.shape,Ye.shape);return this.compileAndRun(Qe,[$e,Ye])},Ge.prototype.max=function($e,Ye){if(this.shouldExecuteOnCPU([$e]))return this.cpuBackend.max($e,Ye);Cn("max",Ye,$e.rank);var Qe=bn($e.shape,Ye),Je=Qe[0],Mt=k(Qe[1]),nn=$e.as2D(-1,Mt);return this.reduce(nn,"max",nn.dtype).reshape(Je)},Ge.prototype.maximum=function($e,Ye){if(this.shouldExecuteOnCPU([$e,Ye]))return this.cpuBackend.maximum($e,Ye);var Qe=i().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new La(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,$e.shape,Ye.shape):new Ba(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,$e.shape,Ye.shape);return this.compileAndRun(Qe,[$e,Ye])},Ge.prototype.all=function($e,Ye){Cn("all",Ye,$e.rank);var Qe=bn($e.shape,Ye),Je=Qe[0],Mt=k(Qe[1]),nn=$e.as2D(-1,Mt);return this.reduce(nn,"all",nn.dtype).reshape(Je)},Ge.prototype.any=function($e,Ye){Cn("any",Ye,$e.rank);var Qe=bn($e.shape,Ye),Je=Qe[0],Mt=k(Qe[1]),nn=$e.as2D(-1,Mt);return this.reduce(nn,"any",nn.dtype).reshape(Je)},Ge.prototype.realDivide=function($e,Ye){if(i().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp($e,Ye,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var Qe=new Ba(`
if (a == b) {
  return 1.0;
};
return a / b;`,$e.shape,Ye.shape);return this.compileAndRun(Qe,[$e,Ye],"float32")},Ge.prototype.floorDiv=function($e,Ye){if(i().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp($e,Ye,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var Qe=new Ba(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,$e.shape,Ye.shape);return this.compileAndRun(Qe,[$e,Ye],"int32")},Ge.prototype.add=function($e,Ye){if($e.dtype==="complex64"&&Ye.dtype==="complex64")return this.complexSeparableBinaryOp($e,Ye,Fa);if(this.shouldExecuteOnCPU([$e,Ye]))return this.cpuBackend.add($e,Ye);var Qe=Dt($e.dtype,Ye.dtype);if(i().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp($e,Ye,Fa,Qe);var Je=new Ba(Fa,$e.shape,Ye.shape);return this.compileAndRun(Je,[$e,Ye],Qe)},Ge.prototype.packedUnaryOp=function($e,Ye,Qe){var Je=new Xs($e.shape,Ye);return this.compileAndRun(Je,[$e],Qe)},Ge.prototype.packedBinaryOp=function($e,Ye,Qe,Je,Mt){Mt===void 0&&(Mt=!1);var nn=new La(Qe,$e.shape,Ye.shape,Mt);return this.compileAndRun(nn,[$e,Ye],Je)},Ge.prototype.complexSeparableBinaryOp=function($e,Ye,Qe){var Je=this,Mt=this.texData.get($e.dataId),nn=this.texData.get(Ye.dataId),an=[[Mt.complexTensors.real,nn.complexTensors.real],[Mt.complexTensors.imag,nn.complexTensors.imag]].map(function(hn){var Xr=hn[0],Mi=hn[1],co=Je.makeComplexComponentTensorInfo($e,Xr),lo=Je.makeComplexComponentTensorInfo(Ye,Mi),uo=new Ba(Qe,$e.shape,Ye.shape);return Je.compileAndRun(uo,[co,lo],Dt(Xr.dtype,Mi.dtype))}),sn=an[0],ln=an[1],fn=this.complex(sn,ln);return sn.dispose(),ln.dispose(),fn},Ge.prototype.makeComplexComponentTensorInfo=function($e,Ye){return{dataId:Ye.dataId,dtype:Ye.dtype,shape:$e.shape}},Ge.prototype.addN=function($e){if($e.length===1)return $e[0];if($e.length>i().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var Ye=Math.floor($e.length/2),Qe=this.addN($e.slice(0,Ye)),Je=this.addN($e.slice(Ye));return this.addN([Qe,Je])}var Mt=$e.map(function(sn){return sn.dtype}).reduce(function(sn,ln){return Dt(sn,ln)}),nn=$e.map(function(sn){return sn.shape}),an=i().getBool("WEBGL_PACK")?new oa($e[0].shape,nn):new ra($e[0].shape,nn);return this.compileAndRun(an,$e,Mt)},Ge.prototype.subtract=function($e,Ye){if($e.dtype==="complex64"&&Ye.dtype==="complex64")return this.complexSeparableBinaryOp($e,Ye,_a);if(this.shouldExecuteOnCPU([$e,Ye]))return this.cpuBackend.subtract($e,Ye);var Qe=Dt($e.dtype,Ye.dtype);if(i().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp($e,Ye,_a,$e.dtype);var Je=new Ba(_a,$e.shape,Ye.shape);return this.compileAndRun(Je,[$e,Ye],Qe)},Ge.prototype.pow=function($e,Ye){var Qe=i().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new La(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,$e.shape,Ye.shape):new Ba(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,$e.shape,Ye.shape),Je=Dt($e.dtype,Ye.dtype);return this.compileAndRun(Qe,[$e,Ye],Je)},Ge.prototype.ceil=function($e){if(this.shouldExecuteOnCPU([$e]))return this.cpuBackend.ceil($e);if(i().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp($e,Ns,$e.dtype);var Ye=new Cs($e.shape,Ns);return this.compileAndRun(Ye,[$e])},Ge.prototype.floor=function($e){if(this.shouldExecuteOnCPU([$e]))return this.cpuBackend.floor($e);if(i().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp($e,Fs,$e.dtype);var Ye=new Cs($e.shape,Fs);return this.compileAndRun(Ye,[$e])},Ge.prototype.sign=function($e){var Ye=new Cs($e.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(Ye,[$e])},Ge.prototype.isNaN=function($e){var Ye=new Cs($e.shape,"return float(isnan(x));");return this.compileAndRun(Ye,[$e],"bool")},Ge.prototype.isInf=function($e){var Ye=new Cs($e.shape,"return float(isinf(x));");return this.compileAndRun(Ye,[$e],"bool")},Ge.prototype.isFinite=function($e){var Ye=new Cs($e.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(Ye,[$e],"bool")},Ge.prototype.round=function($e){var Ye=new Cs($e.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(Ye,[$e])},Ge.prototype.exp=function($e){if(this.shouldExecuteOnCPU([$e]))return this.cpuBackend.exp($e);if(i().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp($e,_s,$e.dtype);var Ye=new Cs($e.shape,_s);return this.compileAndRun(Ye,[$e])},Ge.prototype.expm1=function($e){if(this.shouldExecuteOnCPU([$e]))return this.cpuBackend.expm1($e);if(i().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp($e,Os,$e.dtype);var Ye=new Cs($e.shape,Os);return this.compileAndRun(Ye,[$e])},Ge.prototype.softmax=function($e,Ye){var Qe=O([Ye],$e.shape),Je=this.max($e,Qe),Mt=wn(Je.shape,Qe),nn=this.subtract($e,Je.reshape(Mt)),an=this.exp(nn),sn=this.sum(an,Qe).reshape(Mt);return this.realDivide(an,sn)},Ge.prototype.log=function($e){if(this.shouldExecuteOnCPU([$e]))return this.cpuBackend.log($e);if(i().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp($e,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,$e.dtype);var Ye=new Cs($e.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(Ye,[$e])},Ge.prototype.log1p=function($e){var Ye=new Cs($e.shape,"return log(1.0 + x);");return this.compileAndRun(Ye,[$e])},Ge.prototype.sqrt=function($e){var Ye=new Cs($e.shape,"return sqrt(x);");return this.compileAndRun(Ye,[$e])},Ge.prototype.rsqrt=function($e){if(this.shouldExecuteOnCPU([$e]))return this.cpuBackend.rsqrt($e);var Ye=new Cs($e.shape,"return inversesqrt(x);");return this.compileAndRun(Ye,[$e])},Ge.prototype.reciprocal=function($e){var Ye=new Cs($e.shape,"return 1.0 / x;");return this.compileAndRun(Ye,[$e])},Ge.prototype.relu=function($e){var Ye;return Ye=i().getBool("WEBGL_PACK")?new Xs($e.shape,qs):new Cs($e.shape,ks),this.compileAndRun(Ye,[$e])},Ge.prototype.relu6=function($e){var Ye;return Ye=i().getBool("WEBGL_PACK")?new Xs($e.shape,Ks):new Cs($e.shape,Ss),this.compileAndRun(Ye,[$e])},Ge.prototype.prelu=function($e,Ye){var Qe=i().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new La(Pa,$e.shape,Ye.shape):new Ba(Ma,$e.shape,Ye.shape);return this.compileAndRun(Qe,[$e,Ye])},Ge.prototype.elu=function($e){if(i().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp($e,js,$e.dtype);var Ye=new Cs($e.shape,As);return this.compileAndRun(Ye,[$e])},Ge.prototype.eluDer=function($e,Ye){var Qe=i().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new La(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,$e.shape,Ye.shape):new Ba("return (b >= 1.0) ? a : a * (b + 1.0);",$e.shape,Ye.shape);return this.compileAndRun(Qe,[$e,Ye])},Ge.prototype.selu=function($e){var Ye=new Cs($e.shape,Ds);return this.compileAndRun(Ye,[$e])},Ge.prototype.int=function($e){var Ye=new Cs($e.shape,"return float(int(x));");return this.compileAndRun(Ye,[$e],"int32")},Ge.prototype.clip=function($e,Ye,Qe){var Je,Mt=(Je=i().getBool("WEBGL_PACK_CLIP")?new Ua($e.shape):new Wa($e.shape)).getCustomSetupFunc(Ye,Qe);return this.compileAndRun(Je,[$e],null,Mt)},Ge.prototype.abs=function($e){if(this.shouldExecuteOnCPU([$e]))return this.cpuBackend.abs($e);if(i().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp($e,Is,$e.dtype);var Ye=new Cs($e.shape,Is);return this.compileAndRun(Ye,[$e])},Ge.prototype.complexAbs=function($e){var Ye=this.texData.get($e.dataId),Qe=new Va($e.shape),Je=[this.makeComplexComponentTensorInfo($e,Ye.complexTensors.real),this.makeComplexComponentTensorInfo($e,Ye.complexTensors.imag)];return this.compileAndRun(Qe,Je)},Ge.prototype.sigmoid=function($e){var Ye=new Cs($e.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(Ye,[$e])},Ge.prototype.softplus=function($e){var Ye=new Cs($e.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(Ye,[$e])},Ge.prototype.sin=function($e){var Ye=new Cs($e.shape,Ms);return this.compileAndRun(Ye,[$e])},Ge.prototype.cos=function($e){var Ye=new Cs($e.shape,Bs);return this.compileAndRun(Ye,[$e])},Ge.prototype.tan=function($e){var Ye=new Cs($e.shape,"return tan(x);");return this.compileAndRun(Ye,[$e])},Ge.prototype.asin=function($e){var Ye=new Cs($e.shape,Ps);return this.compileAndRun(Ye,[$e])},Ge.prototype.acos=function($e){var Ye=new Cs($e.shape,Ls);return this.compileAndRun(Ye,[$e])},Ge.prototype.atan=function($e){var Ye=new Cs($e.shape,Ws);return this.compileAndRun(Ye,[$e])},Ge.prototype.atan2=function($e,Ye){var Qe=i().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new La(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,$e.shape,Ye.shape):new Ba(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,$e.shape,Ye.shape);return this.compileAndRun(Qe,[$e,Ye])},Ge.prototype.sinh=function($e){var Ye=new Cs($e.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(Ye,[$e])},Ge.prototype.cosh=function($e){var Ye=new Cs($e.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(Ye,[$e])},Ge.prototype.tanh=function($e){var Ye=new Cs($e.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(Ye,[$e])},Ge.prototype.asinh=function($e){var Ye=new Cs($e.shape,Us);return this.compileAndRun(Ye,[$e])},Ge.prototype.acosh=function($e){var Ye=new Cs($e.shape,Vs);return this.compileAndRun(Ye,[$e])},Ge.prototype.atanh=function($e){var Ye=new Cs($e.shape,zs);return this.compileAndRun(Ye,[$e])},Ge.prototype.erf=function($e){var Ye=new Cs($e.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(Ye,[$e])},Ge.prototype.step=function($e,Ye){var Qe=new Cs($e.shape,function(Je){return Je===void 0&&(Je=0),Es+`
    return x > 0.0 ? 1.0 : float(`+Je+`);
  `}(Ye));return this.compileAndRun(Qe,[$e])},Ge.prototype.conv2dByMatMul=function($e,Ye,Qe,Je,Mt,nn){var an=$e.shape,sn=this.texData.get($e.dataId),ln=Qe.inChannels,fn=an[0]*an[1]*an[2],hn=Qe.outChannels,Xr=Qe.dataFormat==="channelsLast",Mi=(fn===1||hn===1)&&ln>1e3,co=an[2]%2!=0&&!!sn.isPacked;if(Mi||!i().getBool("WEBGL_LAZILY_UNPACK")||!i().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!co){var lo=Xr?an[0]*an[1]*an[2]:an[0]*an[2]*an[3],uo=this.reshape($e,[1,lo,Qe.inChannels]),ho=this.reshape(Ye,[1,Qe.inChannels,Qe.outChannels]);return this.reshape(this.fusedBatchMatMul({a:uo,b:ho,transposeA:!1,transposeB:!1,bias:Je,activation:Mt,preluActivationWeights:nn}),Qe.outShape)}var mo=Xr?an[0]*an[1]*(an[2]+1):an[0]*an[2]*(an[3]+1),_d={dataId:$e.dataId,shape:[1,mo,Qe.inChannels],dtype:$e.dtype},ep=sn.shape;sn.shape=sn.shape.slice(),sn.shape[sn.shape.length-2]++,C(_e(sn.shape,_d.shape),function(){return"packed reshape "+sn.shape+" to "+_d.shape+" isn't free"});var rp=this.reshape(Ye,[1,Qe.inChannels,Qe.outChannels]),sp=this.fusedBatchMatMul({a:_d,b:rp,transposeA:!1,transposeB:!1,bias:Je,activation:Mt,preluActivationWeights:nn}),op=this.texData.get(sp.dataId);return C(op.isPacked,function(){return"batchMatMul result is expected to be packed"}),sn.shape=ep,op.shape=Qe.outShape,Lt.makeTensorFromDataId(sp.dataId,Qe.outShape,sp.dtype)},Ge.prototype.conv2dWithIm2Row=function($e,Ye,Qe,Je,Mt,nn){var an=Qe.filterWidth,sn=Qe.filterHeight,ln=Qe.inChannels,fn=Qe.outWidth,hn=Qe.outHeight,Xr=Qe.dataFormat==="channelsLast",Mi=an*sn*ln,co=hn*fn,lo=[Mi,co],uo=$e.squeeze([0]),ho=Ye.reshape([1,Mi,-1]),mo=new Li(lo,uo.shape,Qe),_d=this.compileAndRun(mo,[uo]).reshape([1,lo[0],lo[1]]),ep=Je!=null,rp=nn!=null,sp=Mt?Qs(Mt,!0):null,op=new Hi(_d.shape,[1,co,Qe.outChannels],!0,!1,ep,sp,rp),ip=[_d,ho];Je&&ip.push(Je),rp&&ip.push(nn);var lp=this.compileAndRun(op,ip);return Xr?lp.reshape([1,hn,fn,Qe.outChannels]):lp.reshape([1,Qe.outChannels,hn,fn])},Ge.prototype.fusedConv2d=function($e){var Ye=$e.input,Qe=$e.filter,Je=$e.convInfo,Mt=$e.bias,nn=$e.activation,an=$e.preluActivationWeights;if(Je.filterHeight===1&&Je.filterWidth===1&&Je.dilationHeight===1&&Je.dilationWidth===1&&Je.strideHeight===1&&Je.strideWidth===1&&(Je.padInfo.type==="SAME"||Je.padInfo.type==="VALID"))return this.conv2dByMatMul(Ye,Qe,Je,Mt,nn,an);if(i().getBool("WEBGL_CONV_IM2COL")&&Ye.shape[0]===1)return this.conv2dWithIm2Row(Ye,Qe,Je,Mt,nn,an);var sn=Mt!=null,ln=an!=null,fn=nn?Qs(nn,!1):null,hn=new Qa(Je,sn,fn,ln),Xr=[Ye,Qe];return Mt&&Xr.push(Mt),an&&Xr.push(an),this.compileAndRun(hn,Xr)},Ge.prototype.conv2d=function($e,Ye,Qe){if(Qe.filterHeight===1&&Qe.filterWidth===1&&Qe.dilationHeight===1&&Qe.dilationWidth===1&&Qe.strideHeight===1&&Qe.strideWidth===1&&(Qe.padInfo.type==="SAME"||Qe.padInfo.type==="VALID"))return this.conv2dByMatMul($e,Ye,Qe);if(i().getBool("WEBGL_CONV_IM2COL")&&$e.shape[0]===1)return this.conv2dWithIm2Row($e,Ye,Qe);var Je=new Qa(Qe);return this.compileAndRun(Je,[$e,Ye])},Ge.prototype.conv2dDerInput=function($e,Ye,Qe){var Je=new Ka(Qe);return this.compileAndRun(Je,[$e,Ye])},Ge.prototype.conv2dDerFilter=function($e,Ye,Qe){var Je=new qa(Qe);return this.compileAndRun(Je,[$e,Ye])},Ge.prototype.fusedDepthwiseConv2D=function($e){var Ye,Qe=$e.input,Je=$e.filter,Mt=$e.convInfo,nn=$e.bias,an=$e.activation,sn=$e.preluActivationWeights,ln=i().getBool("WEBGL_PACK_DEPTHWISECONV")&&Mt.strideWidth<=2&&Mt.outChannels/Mt.inChannels==1,fn=an?Qs(an,ln):null,hn=[Qe,Je],Xr=nn!=null,Mi=sn!=null;return Xr&&hn.push(nn),Mi&&hn.push(sn),ln?(Ye=new ti(Mt,Xr,fn,Mi),this.compileAndRun(Ye,hn)):(Ye=new Za(Mt,Xr,fn,Mi),this.compileAndRun(Ye,hn))},Ge.prototype.depthwiseConv2D=function($e,Ye,Qe){var Je;return i().getBool("WEBGL_PACK_DEPTHWISECONV")&&Qe.strideWidth<=2&&Qe.outChannels/Qe.inChannels==1?(Je=new ti(Qe),this.compileAndRun(Je,[$e,Ye])):(Je=new Za(Qe),this.compileAndRun(Je,[$e,Ye]))},Ge.prototype.depthwiseConv2DDerInput=function($e,Ye,Qe){var Je=new $a(Qe);return this.compileAndRun(Je,[$e,Ye])},Ge.prototype.depthwiseConv2DDerFilter=function($e,Ye,Qe){var Je=new Ya(Qe);return this.compileAndRun(Je,[$e,Ye])},Ge.prototype.conv3d=function($e,Ye,Qe){var Je=new Ja(Qe);return this.compileAndRun(Je,[$e,Ye])},Ge.prototype.conv3dDerInput=function($e,Ye,Qe){var Je=new Xa(Qe);return this.compileAndRun(Je,[$e,Ye])},Ge.prototype.conv3dDerFilter=function($e,Ye,Qe){var Je=new ja(Qe);return this.compileAndRun(Je,[$e,Ye])},Ge.prototype.maxPool=function($e,Ye){var Qe=new $i(Ye,"max",!1);return this.compileAndRun(Qe,[$e])},Ge.prototype.avgPool=function($e,Ye){var Qe=new $i(Ye,"avg",!1);return this.compileAndRun(Qe,[$e],"float32")},Ge.prototype.maxPoolBackprop=function($e,Ye,Qe,Je){var Mt=new $i(Je,"max",!0),nn=this.compileAndRun(Mt,[Ye]),an=new zi(Je),sn=this.compileAndRun(an,[$e,nn],Ye.dtype);return nn.dispose(),sn},Ge.prototype.avgPoolBackprop=function($e,Ye,Qe){var Je=new Ia(Qe);return this.compileAndRun(Je,[$e],Ye.dtype)},Ge.prototype.cast=function($e,Ye){return Po($e,Ye,this)},Ge.prototype.unstack=function($e,Ye){for(var Qe=$e.shape[Ye],Je=new Array($e.rank-1),Mt=0,nn=0;nn<$e.rank;nn++)nn!==Ye&&(Je[Mt++]=$e.shape[nn]);var an=new Array($e.rank).fill(0),sn=$e.shape.slice();sn[Ye]=1;var ln=new Array(Qe);for(nn=0;nn<ln.length;nn++)an[Ye]=nn,ln[nn]=this.slice($e,an,sn).reshape(Je);return ln},Ge.prototype.avgPool3d=function($e,Ye){var Qe=new Qi(Ye,"avg",!1);return this.compileAndRun(Qe,[$e],"float32")},Ge.prototype.avgPool3dBackprop=function($e,Ye,Qe){var Je=new ka(Qe);return this.compileAndRun(Je,[$e],Ye.dtype)},Ge.prototype.maxPool3d=function($e,Ye){var Qe=new Qi(Ye,"max",!1);return this.compileAndRun(Qe,[$e],"float32")},Ge.prototype.maxPool3dBackprop=function($e,Ye,Qe,Je){var Mt=new Qi(Je,"max",!0),nn=this.compileAndRun(Mt,[Ye]),an=new Gi(Je),sn=this.compileAndRun(an,[$e,nn],Ye.dtype);return nn.dispose(),sn},Ge.prototype.reshape=function($e,Ye){var Qe=this.texData.get($e.dataId);if(Qe.isPacked&&!_e($e.shape,Ye)&&(Qe.texture===null||!_e(Qe.shape,Ye))){var Je=this.packedReshape($e,Ye);return Lt.makeTensorFromDataId(Je.dataId,Je.shape,Je.dtype)}return Lo($e,Ye)},Ge.prototype.resizeBilinear=function($e,Ye,Qe,Je){var Mt=i().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new ns($e.shape,Ye,Qe,Je):new es($e.shape,Ye,Qe,Je);return this.compileAndRun(Mt,[$e],"float32")},Ge.prototype.resizeBilinearBackprop=function($e,Ye,Qe){var Je=new ts($e,Ye,Qe);return this.compileAndRun(Je,[$e])},Ge.prototype.resizeNearestNeighbor=function($e,Ye,Qe,Je){var Mt=new os($e.shape,Ye,Qe,Je);return this.compileAndRun(Mt,[$e])},Ge.prototype.resizeNearestNeighborBackprop=function($e,Ye,Qe){var Je=new rs($e,Ye,Qe);return this.compileAndRun(Je,[$e])},Ge.prototype.multinomial=function($e,Ye,Qe,Je){var Mt=Ye?$e:go($e),nn=Mt.shape[0],an=Mt.shape[1],sn=new qi(nn,an,Qe),ln=sn.getCustomSetupFunc(Je);return this.compileAndRun(sn,[Mt],"int32",ln)},Ge.prototype.oneHot=function($e,Ye,Qe,Je){var Mt=new Ki($e.size,Ye,Qe,Je);return this.compileAndRun(Mt,[$e])},Ge.prototype.diag=function($e){var Ye=new si($e.size);return this.compileAndRun(Ye,[$e])},Ge.prototype.nonMaxSuppression=function($e,Ye,Qe,Je,Mt){return dn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),jo($e.dataSync(),Ye.dataSync(),Qe,Je,Mt)},Ge.prototype.cropAndResize=function($e,Ye,Qe,Je,Mt,nn){var an=new ei($e.shape,Ye.shape,Je,Mt,nn);return this.compileAndRun(an,[$e,Ye,Qe],"float32")},Ge.prototype.depthToSpace=function($e,Ye,Qe){C(Ye>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+Ye});var Je=$e.shape[0],Mt=Qe==="NHWC"?$e.shape[1]:$e.shape[2],nn=Qe==="NHWC"?$e.shape[2]:$e.shape[3],an=Qe==="NHWC"?$e.shape[3]:$e.shape[1],sn=Mt*Ye,ln=nn*Ye,fn=an/(Ye*Ye),hn=new ii(Qe==="NHWC"?[Je,sn,ln,fn]:[Je,fn,sn,ln],Ye,Qe);return this.compileAndRun(hn,[$e])},Ge.prototype.split=function($e,Ye,Qe){return Zo($e,Ye,Qe)},Ge.prototype.scatterND=function($e,Ye,Qe){var Je=Zr(0,$e,Qe),Mt=Je.sliceRank,nn=Je.numUpdates,an=Je.sliceSize,sn=Je.strides,ln=Je.outputSize,fn=[ln/an,an],hn=$e.reshape([nn,Mt]),Xr=Ye.reshape([nn,an]);if(ln===0)return Lo(Fn([]),Qe);var Mi=On(0),co=new ss(nn,Mt,hn.rank,Xr.rank,sn,fn);return this.compileAndRun(co,[Xr,hn,Mi]).reshape(Qe)},Ge.prototype.sparseToDense=function($e,Ye,Qe,Je){var Mt=Zr(0,$e,Qe),nn=Mt.sliceRank,an=Mt.numUpdates,sn=Mt.strides,ln=Mt.outputSize,fn=new ss(an,nn,$e.rank,Ye.rank,sn,[ln,1]);return this.compileAndRun(fn,[Ye,$e,Je]).reshape(Qe)},Ge.prototype.fft=function($e){return this.fftImpl($e,!1)},Ge.prototype.ifft=function($e){return this.fftImpl($e,!0)},Ge.prototype.fftImpl=function($e,Ye){var Qe=this.texData.get($e.dataId),Je=new pi(fi,$e.shape,Ye),Mt=new pi(di,$e.shape,Ye),nn=[this.makeComplexComponentTensorInfo($e,Qe.complexTensors.real),this.makeComplexComponentTensorInfo($e,Qe.complexTensors.imag)],an=this.compileAndRun(Je,nn),sn=this.compileAndRun(Mt,nn),ln=this.complex(an,sn).as2D($e.shape[0],$e.shape[1]);return an.dispose(),sn.dispose(),ln},Ge.prototype.gatherND=function($e,Ye){var Qe=Ye.shape,Je=Qe[Qe.length-1],Mt=jr($e,Ye),nn=Mt[0],an=Mt[1],sn=Mt[2],ln=Mt[3],fn=Ye.reshape([an,Je]),hn=$e.reshape([$e.size/sn,sn]),Xr=new gi(Je,ln,[an,sn]);return this.compileAndRun(Xr,[hn,fn]).reshape(nn)},Ge.prototype.fill=function($e,Ye,Qe){if((Qe=Qe||j(Ye))==="string"){var Je=P(Qe,k($e));return Je.fill(Ye),Lt.makeTensor(Je,$e,Qe,this)}var Mt=new vi($e,Ye),nn=Mt.getCustomSetupFunc(Ye);return this.compileAndRun(Mt,[],Qe,nn)},Ge.prototype.onesLike=function($e){if($e.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill($e.shape,1,$e.dtype)},Ge.prototype.zerosLike=function($e){return this.fill($e.shape,$e.dtype==="string"?"":0,$e.dtype)},Ge.prototype.linspace=function($e,Ye,Qe){return Wo($e,Ye,Qe)},Ge.prototype.makeTensorInfo=function($e,Ye){var Qe=this.write(null,$e,Ye);return this.texData.get(Qe).usage=null,{dataId:Qe,shape:$e,dtype:Ye}},Ge.prototype.makeOutput=function($e,Ye){var Qe=this.makeTensorInfo($e,Ye).dataId;return Lt.makeTensorFromDataId(Qe,$e,Ye,this)},Ge.prototype.unpackTensor=function($e){var Ye=new Ys($e.shape);return this.runWebGLProgram(Ye,[$e],$e.dtype)},Ge.prototype.packTensor=function($e){var Ye=new ji($e.shape);return this.runWebGLProgram(Ye,[$e],$e.dtype,null,!0)},Ge.prototype.packedReshape=function($e,Ye){var Qe=[Ae($e.shape)].concat(De($e.shape)),Je={dtype:$e.dtype,shape:Qe,dataId:$e.dataId},Mt=[Ae(Ye)].concat(De(Ye)),nn=new Zi(Mt,Qe),an=this.runWebGLProgram(nn,[Je],$e.dtype,null,!0);return{dataId:an.dataId,shape:Ye,dtype:an.dtype}},Ge.prototype.decode=function($e){var Ye,Qe=this.texData.get($e),Je=Qe.isPacked,Mt=Qe.shape,nn=Qe.dtype,an=Te(Mt);return Ye=Je?new ai(an):new oi(an),{dtype:nn,shape:Mt,dataId:this.runWebGLProgram(Ye,[{shape:an,dtype:nn,dataId:$e}],nn,null,!0).dataId}},Ge.prototype.runWebGLProgram=function($e,Ye,Qe,Je,Mt){var nn=this;Mt===void 0&&(Mt=!1);var an=this.makeTensorInfo($e.outputShape,Qe),sn=this.texData.get(an.dataId);if($e.packedOutput&&(sn.isPacked=!0),$e.outPackingScheme===Vt.DENSE){var ln=Yt($e.outputShape);sn.texShape=ln.map(function(mo){return 2*mo})}if($e.outTexUsage!=null&&(sn.usage=$e.outTexUsage),k(an.shape)===0)return sn.values=B(an.dtype,0),an;var fn=[],hn=Ye.map(function(mo){if(mo.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var _d=nn.texData.get(mo.dataId);if(_d.texture==null){if(!$e.packedInputs&&k(mo.shape)<=i().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:mo.shape,texData:null,isUniform:!0,uniformValues:_d.values};$e.packedInputs&&(_d.isPacked=!0,_d.shape=mo.shape)}else if(!!_d.isPacked!=!!$e.packedInputs)mo=_d.isPacked?nn.unpackTensor(mo):nn.packTensor(mo),fn.push(mo),_d=nn.texData.get(mo.dataId);else if(_d.isPacked&&!_e(_d.shape,mo.shape)){var ep=mo,rp=mo.shape;mo.shape=_d.shape,mo=nn.packedReshape(mo,rp),fn.push(mo),_d=nn.texData.get(mo.dataId),ep.shape=rp}return nn.uploadToGPU(mo.dataId),{shape:mo.shape,texData:_d,isUniform:!1}});this.uploadToGPU(an.dataId);var Xr,Mi={shape:an.shape,texData:sn,isUniform:!1},co=function(mo,_d,ep){var rp="";_d.concat(ep).forEach(function(ip){var lp=ip.texData!=null&&ip.texData.slice!=null&&ip.texData.slice.flatOffset>0,vp=ip.isUniform?"uniform":ip.texData.texShape;rp+=ip.shape+"_"+vp+"_"+lp});var sp=mo.userCode,op=mo.constructor.name;return op+="_"+rp+"_"+sp}($e,hn,Mi),lo=this.getAndSaveBinary(co,function(){return function(mo,_d,ep,rp){var sp=_d.userCode,op=ep.map(function(Cp,Ip){var cp={logicalShape:Cp.shape,texShape:Cp.isUniform?null:Cp.texData.texShape,isUniform:Cp.isUniform,isPacked:!Cp.isUniform&&Cp.texData.isPacked,flatOffset:null};return Cp.texData!=null&&Cp.texData.slice!=null&&Cp.texData.slice.flatOffset>0&&(cp.flatOffset=Cp.texData.slice.flatOffset),{name:_d.variableNames[Ip],shapeInfo:cp}}),ip=op.map(function(Cp){return Cp.shapeInfo}),lp={logicalShape:rp.shape,texShape:rp.texData.texShape,isUniform:!1,isPacked:rp.texData.isPacked,flatOffset:null},vp=fa(op,lp,sp,_d.packedInputs),gp=mo.createProgram(vp),Op=null,Mp=mo.getUniformLocation(gp,"NAN",!1);i().getNumber("WEBGL_VERSION")===1&&(Op=mo.getUniformLocation(gp,"INFINITY",!1));for(var Np={},wp=0;wp<_d.variableNames.length;wp++){var Sp=_d.variableNames[wp];Np[Sp]=mo.getUniformLocation(gp,Sp,!1),Np["offset"+Sp]=mo.getUniformLocation(gp,"offset"+Sp,!1)}return{program:_d,source:vp,webGLProgram:gp,uniformLocations:Np,inShapeInfos:ip,outShapeInfo:lp,infLoc:Op,nanLoc:Mp}}(nn.gpgpu,$e,hn,Mi)}),uo=this.activeTimers!=null;if(uo&&(Xr=this.startTimer()),function(mo,_d,ep,rp,sp){Pi(_d.inShapeInfos,ep),Pi([_d.outShapeInfo],[rp]);var op=rp.texData.texture,ip=rp.texData.texShape;rp.texData.isPacked?mo.setOutputPackedMatrixTexture(op,ip[0],ip[1]):mo.setOutputMatrixTexture(op,ip[0],ip[1]),mo.setProgram(_d.webGLProgram),i().getNumber("WEBGL_VERSION")===1&&_d.infLoc!==null&&mo.gl.uniform1f(_d.infLoc,1/0),_d.nanLoc!==null&&mo.gl.uniform1f(_d.nanLoc,NaN),ep.forEach(function(lp,vp){var gp=_d.program.variableNames[vp],Op=_d.uniformLocations[gp],Mp=_d.uniformLocations["offset"+gp];if(Op!=null)if(lp.isUniform)if(k(lp.shape)<2)mo.gl.uniform1f(Op,lp.uniformValues[0]);else{var Np=lp.uniformValues;Np instanceof Float32Array||(Np=new Float32Array(Np)),mo.gl.uniform1fv(Op,Np)}else lp.texData.slice!=null&&Mp!=null&&mo.gl.uniform1i(Mp,lp.texData.slice.flatOffset),mo.setInputMatrixTexture(lp.texData.texture,Op,vp)}),sp!=null&&sp(mo,_d.webGLProgram),mo.executeProgram()}(this.gpgpu,lo,hn,Mi,Je),fn.forEach(function(mo){return nn.disposeData(mo.dataId)}),uo&&(Xr=this.endTimer(Xr),this.activeTimers.push({name:$e.constructor.name,query:this.getQueryTime(Xr)})),!i().getBool("WEBGL_LAZILY_UNPACK")&&sn.isPacked&&Mt===!1){var ho=this.unpackTensor(an);return this.disposeData(an.dataId),ho}return an},Ge.prototype.compileAndRun=function($e,Ye,Qe,Je,Mt){Mt===void 0&&(Mt=!1),Qe=Qe||Ye[0].dtype;var nn=this.runWebGLProgram($e,Ye,Qe,Je,Mt);return Lt.makeTensorFromDataId(nn.dataId,nn.shape,nn.dtype)},Ge.prototype.getAndSaveBinary=function($e,Ye){return $e in this.binaryCache||(this.binaryCache[$e]=Ye()),this.binaryCache[$e]},Ge.prototype.getTextureManager=function(){return this.textureManager},Ge.prototype.dispose=function(){var $e=this;this.disposed||(i().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(Ye){$e.gpgpu.deleteProgram($e.binaryCache[Ye].webGLProgram),delete $e.binaryCache[Ye]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},Ge.prototype.floatPrecision=function(){var $e=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=Ze(function(){if(!i().get("WEBGL_RENDER_FLOAT32_ENABLED")){var Ye=i().getBool("DEBUG");i().set("DEBUG",!1);var Qe=$e.abs(On(1e-8)).dataSync()[0];if(i().set("DEBUG",Ye),Qe>0)return 32}return 16})),this.floatPrecisionValue},Ge.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},Ge.prototype.uploadToGPU=function($e){var Ye,Qe=this.texData.get($e),Je=Qe.shape,Mt=Qe.dtype,nn=Qe.values,an=Qe.texture,sn=Qe.usage,ln=Qe.isPacked;if(an==null){var fn,hn=this.activeTimers!=null;hn&&(fn=et());var Xr=Qe.texShape;if(Xr==null&&(Xr=Ne(Je,ln),Qe.texShape=Xr),nn!=null){var Mi=Te(Je),co=void 0,lo=Xr[1],uo=Xr[0],ho=nn instanceof Uint8Array;ln?(lo=(Ye=$t(Xr[0],Xr[1]))[0],uo=Ye[1],co=new hi(Mi,[uo,lo],ho)):co=new li(Mi,[uo,lo],ho);var mo=this.makeTensorInfo([uo,lo],Mt);this.texData.get(mo.dataId).usage=ho?zt.PIXELS:zt.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(mo.dataId),lo,uo,nn);var _d=this.runWebGLProgram(co,[mo],Mt,null,!0),ep=this.texData.get(_d.dataId);Qe.texture=ep.texture,Qe.texShape=ep.texShape,Qe.isPacked=ep.isPacked,Qe.usage=ep.usage,this.disposeData(mo.dataId),this.texData.delete(_d.dataId),Qe.values=null,hn&&(this.uploadWaitMs+=et()-fn)}else{var rp=this.acquireTexture(Xr,sn,Mt,ln);Qe.texture=rp}}},Ge.prototype.convertAndCacheOnCPU=function($e,Ye){var Qe=this.texData.get($e),Je=Qe.dtype;return this.releaseGPUData($e),Ye!=null&&(Qe.values=function(Mt,nn){if(nn==="float32"||nn==="complex64")return Mt;if(nn==="int32"||nn==="bool"){for(var an=nn==="int32"?new Int32Array(Mt.length):new Uint8Array(Mt.length),sn=0;sn<an.length;++sn)an[sn]=Math.round(Mt[sn]);return an}throw new Error("Unknown dtype "+nn)}(Ye,Je)),Qe.values},Ge.prototype.acquireTexture=function($e,Ye,Qe,Je){if(this.numBytesInGPU+=this.computeBytes($e,Qe),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var Mt=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+Mt+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture($e,Ye,Je)},Ge.prototype.computeBytes=function($e,Ye){return $e[0]*$e[1]*z(Ye)},Ge}(bo);Wt()&&Lt.registerBackend("webgl",function(){return new Zs},2);var tu=An({square_:function(Ke){var Ge=mn(Ke,"x","square"),$e=[Ge];return Lt.runKernelFunc(function(Ye,Qe){return Qe([Ge]),Ye.square(Ge)},{x:Ge},null,"Square",{},$e,[])}}),eu="SquaredDifference",nu=An({squaredDifference_:function(Ke,Ge){var $e,Ye=mn(Ke,"a","squaredDifference"),Qe=mn(Ge,"b","squaredDifference");$e=Nt(Ye,Qe),Ye=$e[0],Qe=$e[1],Ro(Ye.shape,Qe.shape);var Je={a:Ye,b:Qe},Mt=[Ye,Qe];return Lt.runKernelFunc(function(nn,an){var sn=nn.squaredDifference(Ye,Qe);return an([Ye,Qe]),sn},Je,function(nn,an){var sn=an[0],ln=an[1],fn=On(2);return{a:function(){return nn.mul(sn.sub(ln).mul(fn))},b:function(){return nn.mul(ln.sub(sn).mul(fn))}}},eu,{},Mt,[])}}),ru=An({abs_:function(Ke){var Ge=mn(Ke,"x","abs");return Ge.dtype==="complex64"?Lt.runKernelFunc(function($e){return $e.complexAbs(Ge)},{$x:Ge}):Lt.runKernelFunc(function($e,Ye){var Qe=$e.abs(Ge);return Ye([Ge]),Qe},{x:Ge},function($e,Ye){var Qe=Ye[0];return{x:function(){return $e.mul(Qe.toFloat().step(-1))}}},"Abs")}}),ou=An({acos_:function(Ke){var Ge=mn(Ke,"x","acos");return Lt.runKernelFunc(function($e,Ye){var Qe=$e.acos(Ge);return Ye([Ge]),Qe},{$x:Ge},function($e,Ye){var Qe=Ye[0];return{$x:function(){return $e.divStrict(On(1).sub(Qe.toFloat().square()).sqrt()).neg()}}})}}),au=An({acosh_:function(Ke){var Ge=mn(Ke,"x","acosh");return Lt.runKernelFunc(function($e,Ye){var Qe=$e.acosh(Ge);return Ye([Ge]),Qe},{$x:Ge},function($e,Ye){var Qe=Ye[0];return{$x:function(){return $e.divStrict(Qe.toFloat().square().sub(1).sqrt())}}})}}),iu=An({asin_:function(Ke){var Ge=mn(Ke,"x","asin");return Lt.runKernelFunc(function($e,Ye){var Qe=$e.asin(Ge);return Ye([Ge]),Qe},{$x:Ge},function($e,Ye){var Qe=Ye[0];return{$x:function(){return $e.divStrict(On(1).sub(Qe.toFloat().square()).sqrt())}}})}}),su=An({asinh_:function(Ke){var Ge=mn(Ke,"x","asinh");return Lt.runKernelFunc(function($e,Ye){var Qe=$e.asinh(Ge);return Ye([Ge]),Qe},{$x:Ge},function($e,Ye){var Qe=Ye[0];return{$x:function(){return $e.divStrict(On(1).add(Qe.toFloat().square()).sqrt())}}})}}),uu=An({atan_:function(Ke){var Ge=mn(Ke,"x","atan");return Lt.runKernelFunc(function($e,Ye){var Qe=$e.atan(Ge);return Ye([Ge]),Qe},{$x:Ge},function($e,Ye){var Qe=Ye[0];return{$x:function(){return $e.div(Qe.toFloat().square().add(1))}}})}}),cu=An({atanh_:function(Ke){var Ge=mn(Ke,"x","atanh");return Lt.runKernelFunc(function($e,Ye){var Qe=$e.atanh(Ge);return Ye([Ge]),Qe},{$x:Ge},function($e,Ye){var Qe=Ye[0];return{$x:function(){return $e.div(On(1).sub(Qe.toFloat().square()))}}})}}),lu=An({ceil_:function(Ke){var Ge=mn(Ke,"x","ceil");return Lt.runKernelFunc(function($e){return $e.ceil(Ge)},{$x:Ge},function($e){return{$x:function(){return Xn($e)}}})}}),hu=An({clipByValue_:function(Ke,Ge,$e){var Ye=mn(Ke,"x","clipByValue");C(Ge<=$e,function(){return"Error in clip: min ("+Ge+") must be less than or equal to max ("+$e+")."});var Qe=[Ye],Je={min:Ge,max:$e};return Lt.runKernelFunc(function(Mt,nn){var an=Mt.clip(Ye,Ge,$e);return nn([Ye]),an},{x:Ye},function(Mt,nn){var an=nn[0];return{x:function(){return Mt.where(an.greaterEqual(Ge).logicalAnd(an.lessEqual($e)),Xn(Mt))}}},"ClipByValue",Je,Qe)}}),fu=An({cos_:function(Ke){var Ge=mn(Ke,"x","cos"),$e=[Ge];return Lt.runKernelFunc(function(Ye,Qe){var Je=Ye.cos(Ge);return Qe([Ge]),Je},{x:Ge},function(Ye,Qe){var Je=Qe[0];return{x:function(){return Je.toFloat().sin().neg().mul(Ye)}}},"Cos",{},$e)}}),du=An({cosh_:function(Ke){var Ge=mn(Ke,"x","cosh");return Lt.runKernelFunc(function($e,Ye){var Qe=$e.cosh(Ge);return Ye([Ge]),Qe},{$x:Ge},function($e,Ye){var Qe=Ye[0];return{$x:function(){return Qe.toFloat().sinh().mulStrict($e)}}})}}),pu=An({erf_:function(Ke){var Ge=mn(Ke,"x","erf");return C(Ge.dtype==="int32"||Ge.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),Ge.dtype==="int32"&&(Ge=Ge.toFloat()),Lt.runKernelFunc(function($e,Ye){var Qe=$e.erf(Ge);return Ye([Ge]),Qe},{$x:Ge},function($e,Ye){var Qe=Ye[0];return{$x:function(){return $e.mul(Qe.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),vu=An({exp_:function(Ke){var Ge=mn(Ke,"x","exp");return Lt.runKernelFunc(function($e,Ye){var Qe=$e.exp(Ge);return Ye([Qe]),Qe},{x:Ge},function($e,Ye){return{x:function(){return $e.mulStrict(Ye[0])}}},"Exp",{},[],[!0])}}),mu=An({expm1_:function(Ke){var Ge=mn(Ke,"x","expm1");return Lt.runKernelFunc(function($e,Ye){var Qe=$e.expm1(Ge);return Ye([Ge]),Qe},{$x:Ge},function($e,Ye){var Qe=Ye[0];return{$x:function(){return $e.mul(Qe.exp())}}})}}),gu=An({floor_:function(Ke){var Ge=mn(Ke,"x","floor");return Lt.runKernelFunc(function($e){return $e.floor(Ge)},{$x:Ge},function($e){return{$x:function(){return Xn($e)}}})}}),yu=An({log_:function(Ke){var Ge=mn(Ke,"x","log"),$e=[Ge];return Lt.runKernelFunc(function(Ye,Qe){var Je=Ye.log(Ge);return Qe([Ge]),Je},{x:Ge},function(Ye,Qe){var Je=Qe[0];return{x:function(){return Ye.div(Je.toFloat())}}},"Log",{},$e)}}),xu=An({log1p_:function(Ke){var Ge=mn(Ke,"x","log1p");return Lt.runKernelFunc(function($e,Ye){var Qe=$e.log1p(Ge);return Ye([Ge]),Qe},{$x:Ge},function($e,Ye){var Qe=Ye[0];return{$x:function(){return $e.div(Qe.add(1))}}})}}),bu=An({logSigmoid_:function(Ke){var Ge=mn(Ke,"x","logSigmoid");return Lt.runKernelFunc(function($e,Ye){var Qe=$e.softplus(Ge.neg()).neg();return Ye([Ge]),Qe},{$x:Ge},function($e,Ye){var Qe=Ye[0];return{$x:function(){return $e.mul(Qe.neg().sigmoid())}}})}}),wu=An({neg_:function(Ke){var Ge=mn(Ke,"x","neg"),$e=[Ge];return Lt.runKernelFunc(function(Ye){return Ye.neg(Ge)},{x:Ge},function(Ye){return{x:function(){return Ye.neg()}}},"Neg",{},$e)}}),Cu=An({reciprocal_:function(Ke){var Ge=mn(Ke,"x","reciprocal");return Lt.runKernelFunc(function($e,Ye){var Qe=$e.reciprocal(Ge);return Ye([Ge]),Qe},{$x:Ge},function($e,Ye){var Qe=Ye[0];return{$x:function(){return $e.div(Qe.square().neg())}}})}}),Eu=An({round_:function(Ke){var Ge=mn(Ke,"x","round");return Lt.runKernelFunc(function($e){return $e.round(Ge)},{$x:Ge},function($e){return{$x:function(){return Xn($e)}}})}}),Ru=An({rsqrt_:function(Ke){var Ge=mn(Ke,"x","rsqrt"),$e=[Ge];return Lt.runKernelFunc(function(Ye,Qe){var Je=Ye.rsqrt(Ge);return Qe([Ge]),Je},{x:Ge},function(Ye,Qe){var Je=Qe[0];return{x:function(){return Ye.div(Je.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},$e)}}),Iu=An({sigmoid_:function(Ke){var Ge=mn(Ke,"x","sigmoid");return Lt.runKernelFunc(function($e,Ye){var Qe=$e.sigmoid(Ge);return Ye([Qe]),Qe},{x:Ge},function($e,Ye){var Qe=Ye[0];return{x:function(){return $e.mul(Qe.mul(On(1).sub(Qe)))}}},"Sigmoid")}}),ku=An({sign_:function(Ke){var Ge=mn(Ke,"x","sign");return Lt.runKernelFunc(function($e){return $e.sign(Ge)},{$x:Ge},function($e){return{$x:function(){return Xn($e)}}})}}),Su=An({isNaN_:function(Ke){var Ge=mn(Ke,"x","isNaN");return Lt.runKernelFunc(function($e){return $e.isNaN(Ge)},{$x:Ge},function($e){return{$x:function(){return Xn($e)}}})}}),Au=An({isInf_:function(Ke){var Ge=mn(Ke,"x","isInf");return Lt.runKernelFunc(function($e){return $e.isInf(Ge)},{$x:Ge},function($e){return{$x:function(){return Xn($e)}}})}}),Du=An({isFinite_:function(Ke){var Ge=mn(Ke,"x","isFinite");return Lt.runKernelFunc(function($e){return $e.isFinite(Ge)},{$x:Ge},function($e){return{$x:function(){return Xn($e)}}})}}),Tu=An({sin_:function(Ke){var Ge=mn(Ke,"x","sin"),$e=[Ge];return Lt.runKernelFunc(function(Ye,Qe){var Je=Ye.sin(Ge);return Qe([Ge]),Je},{x:Ge},function(Ye,Qe){var Je=Qe[0];return{x:function(){return Je.toFloat().cos().mul(Ye)}}},"Sin",{},$e)}}),Nu=An({sinh_:function(Ke){var Ge=mn(Ke,"x","sinh");return Lt.runKernelFunc(function($e,Ye){var Qe=$e.sinh(Ge);return Ye([Ge]),Qe},{$x:Ge},function($e,Ye){var Qe=Ye[0];return{$x:function(){return Qe.toFloat().cosh().mulStrict($e)}}})}}),Fu=An({softplus_:function(Ke){var Ge=mn(Ke,"x","softplus");return Lt.runKernelFunc(function($e,Ye){var Qe=$e.softplus(Ge);return Ye([Ge]),Qe},{$x:Ge},function($e,Ye){var Qe=Ye[0];return{$x:function(){return $e.mul(Qe.sigmoid())}}})}}),_u=An({sqrt_:function(Ke){var Ge=mn(Ke,"x","sqrt");return Lt.runKernelFunc(function($e,Ye){var Qe=$e.sqrt(Ge);return Ye([Ge]),Qe},{$x:Ge},function($e,Ye){var Qe=Ye[0];return{$x:function(){return $e.div(Qe.toFloat().sqrt().mul(2))}}})}}),Ou=An({step_:function(Ke,Ge){Ge===void 0&&(Ge=0);var $e=mn(Ke,"x","step");return Lt.runKernelFunc(function(Ye){return Ye.step($e,Ge)},{$x:$e},function(Ye){return{$x:function(){return Xn(Ye)}}})}}),Mu=An({tan_:function(Ke){var Ge=mn(Ke,"x","tan");return Lt.runKernelFunc(function($e,Ye){var Qe=$e.tan(Ge);return Ye([Ge]),Qe},{$x:Ge},function($e,Ye){var Qe=Ye[0];return{$x:function(){return $e.div(Qe.cos().square())}}})}}),Bu=An({tanh_:function(Ke){var Ge=mn(Ke,"x","tanh");return Lt.runKernelFunc(function($e,Ye){var Qe=$e.tanh(Ge);return Ye([Qe]),Qe},{x:Ge},function($e,Ye){var Qe=Ye[0];return{x:function(){return On(1).sub(Qe.square()).mulStrict($e)}}},"Tanh",{},null,[!0])}});function Pu(Ke,Ge,$e,Ye,Qe,Je){var Mt,nn,an=mn(Ke,"x","batchNorm"),sn=mn(Ge,"mean","batchNorm"),ln=mn($e,"variance","batchNorm");return Qe!=null&&(Mt=mn(Qe,"scale","batchNorm")),Ye!=null&&(nn=mn(Ye,"offset","batchNorm")),C(an.rank===2,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+an.rank+"."}),C(sn.rank===2||sn.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+sn.rank+"."}),C(ln.rank===2||ln.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+ln.rank+"."}),Mt!=null&&C(Mt.rank===2||Mt.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+Mt.rank+"."}),nn!=null&&C(nn.rank===2||nn.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+nn.rank+"."}),Uu(an,sn,ln,nn,Mt,Je)}function Lu(Ke,Ge,$e,Ye,Qe,Je){var Mt,nn,an=mn(Ke,"x","batchNorm"),sn=mn(Ge,"mean","batchNorm"),ln=mn($e,"variance","batchNorm");return Qe!=null&&(Mt=mn(Qe,"scale","batchNorm")),Ye!=null&&(nn=mn(Ye,"offset","batchNorm")),C(an.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+an.rank+"."}),C(sn.rank===3||sn.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+sn.rank+"."}),C(ln.rank===3||ln.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+ln.rank+"."}),Mt!=null&&C(Mt.rank===3||Mt.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+Mt.rank+"."}),nn!=null&&C(nn.rank===3||nn.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+nn.rank+"."}),Uu(an,sn,ln,nn,Mt,Je)}function Wu(Ke,Ge,$e,Ye,Qe,Je){var Mt,nn,an=mn(Ke,"x","batchNorm"),sn=mn(Ge,"mean","batchNorm"),ln=mn($e,"variance","batchNorm");return Qe!=null&&(Mt=mn(Qe,"scale","batchNorm")),Ye!=null&&(nn=mn(Ye,"offset","batchNorm")),C(an.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+an.rank+"."}),C(sn.rank===4||sn.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+sn.rank+"."}),C(ln.rank===4||ln.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+ln.rank+"."}),Mt!=null&&C(Mt.rank===4||Mt.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+Mt.rank+"."}),nn!=null&&C(nn.rank===4||nn.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+nn.rank+"."}),Uu(an,sn,ln,nn,Mt,Je)}function Uu(Ke,Ge,$e,Ye,Qe,Je){Je==null&&(Je=.001);var Mt,nn,an,sn=mn(Ke,"x","batchNorm"),ln=mn(Ge,"mean","batchNorm"),fn=mn($e,"variance","batchNorm");Qe!=null&&(Mt=mn(Qe,"scale","batchNorm")),Ye!=null&&(nn=mn(Ye,"offset","batchNorm")),C(ln.rank===fn.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),C(nn==null||ln.rank===nn.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),C(Mt==null||ln.rank===Mt.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),an=sn.rank===0||sn.rank===1?sn.as4D(1,1,1,sn.size):sn.rank===2?sn.as4D(1,1,sn.shape[0],sn.shape[1]):sn.rank===3?sn.as4D(1,sn.shape[0],sn.shape[1],sn.shape[2]):sn;var hn=[sn,ln,fn,Mt];return Lt.runKernelFunc(function(Xr,Mi){var co=Xr.batchNormalization(an,Vu(ln),Vu(fn),Je,Vu(Mt),Vu(nn));return Mi([sn,ln,fn,Mt]),co},{x:sn,mean:ln,variance:fn,scale:Mt,offset:nn},function(Xr,Mi){var co=Mi,lo=co[0],uo=co[1],ho=co[2],mo=co[3],_d=mo??On(1),ep=Eo(uo.shape,an.shape),rp=[];if(uo.rank===1){for(var sp=0;sp<an.shape.length-1;++sp)rp.push(an.shape[sp]);rp.push(1)}var op=lo.sub(uo),ip=Xr.mul(_d),lp=Ru(ho.add(On(Je))),vp=lp.mul(lp).mul(lp).mul(On(-.5));return{x:function(){return uo.rank===1?Xr.mul(Lr(lp.as4D(1,1,1,uo.shape[0]),rp)).mul(_d).reshape(lo.shape):Xr.mul(lp).mul(_d).reshape(lo.shape)},mean:function(){var gp=lp.mul(On(-1)).mul(ip);return uo.rank===1&&(gp=gp.sum(ep)),gp.reshape(uo.shape)},variance:function(){var gp=vp.mul(op).mul(ip);return uo.rank===1&&(gp=gp.sum(ep)),gp.reshape(uo.shape)},scale:function(){var gp=op.mul(lp),Op=Xr.mul(gp);return uo.rank===1&&(Op=Op.sum(ep)),Op.reshape(uo.shape)},offset:function(){var gp=Xr;return uo.rank===1&&(gp=gp.sum(ep)),gp.reshape(uo.shape)}}},"BatchNormalization",{varianceEpsilon:Je},hn).reshape(sn.shape)}function Vu(Ke){return Ke==null?null:Ke.rank===0?Ke.as1D():Ke.rank===1?Ke:Ke.rank===2?Ke.as4D(1,1,Ke.shape[0],Ke.shape[1]):Ke.rank===3?Ke.as4D(1,Ke.shape[0],Ke.shape[1],Ke.shape[2]):Ke}function zu(){Xe("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var Gu=An({batchNormalization2d_:function(Ke,Ge,$e,Ye,Qe,Je){return Ye===void 0&&(Ye=.001),zu(),Pu(Ke,Ge,$e,Je,Qe,Ye)}}),Hu=An({batchNormalization3d_:function(Ke,Ge,$e,Ye,Qe,Je){return Ye===void 0&&(Ye=.001),zu(),Lu(Ke,Ge,$e,Je,Qe,Ye)}}),qu=An({batchNormalization4d_:function(Ke,Ge,$e,Ye,Qe,Je){return Ye===void 0&&(Ye=.001),zu(),Wu(Ke,Ge,$e,Je,Qe,Ye)}}),Ku=An({batchNormalization_:function(Ke,Ge,$e,Ye,Qe,Je){return Ye===void 0&&(Ye=.001),zu(),Uu(Ke,Ge,$e,Je,Qe,Ye)}}),ju=An({batchNorm_:Uu}),Xu=An({batchNorm2d_:Pu}),Yu=An({batchNorm3d_:Lu}),$u=An({batchNorm4d_:Wu}),Qu=An({logicalAnd_:function(Ke,Ge){var $e=mn(Ke,"a","logicalAnd","bool"),Ye=mn(Ge,"b","logicalAnd","bool");return Ro($e.shape,Ye.shape),Lt.runKernelFunc(function(Qe){return Qe.logicalAnd($e,Ye)},{a:$e,b:Ye},null,"LogicalAnd")}}),Ju=An({logicalNot_:function(Ke){var Ge=mn(Ke,"x","logicalNot","bool");return Lt.runKernelFunc(function($e){return $e.logicalNot(Ge)},{$x:Ge})}}),Zu=An({logicalOr_:function(Ke,Ge){var $e=mn(Ke,"a","logicalOr","bool"),Ye=mn(Ge,"b","logicalOr","bool");return Ro($e.shape,Ye.shape),Lt.runKernelFunc(function(Qe){return Qe.logicalOr($e,Ye)},{$a:$e,$b:Ye})}}),tc=An({logicalXor_:function(Ke,Ge){var $e=mn(Ke,"a","logicalXor","bool"),Ye=mn(Ge,"b","logicalXor","bool");return Ro($e.shape,Ye.shape),Zu(Ke,Ge).logicalAnd(Qu(Ke,Ge).logicalNot())}}),ec=An({where_:function(Ke,Ge,$e){var Ye=mn(Ge,"a","where"),Qe=mn($e,"b","where"),Je=mn(Ke,"condition","where","bool");return E(Ye.shape,Qe.shape,"Error in where: "),Je.rank===1?C(Je.shape[0]===Ye.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):E(Je.shape,Qe.shape,"Error in where: "),Lt.runKernelFunc(function(Mt,nn){var an=Mt.select(Je,Ye,Qe);return nn([Je]),an},{$condition:Je,$a:Ye,$b:Qe},function(Mt,nn){var an=nn[0];return{$condition:function(){return Xn(an).toFloat()},$a:function(){return Mt.mul(an.cast(Mt.dtype))},$b:function(){return Mt.mul(an.logicalNot().cast(Mt.dtype))}}})}}),nc=function(Ke){return n(this,void 0,void 0,function(){var Ge,$e,Ye;return r(this,function(Qe){switch(Qe.label){case 0:return[4,(Ge=mn(Ke,"condition","whereAsync","bool")).data()];case 1:return $e=Qe.sent(),Ye=na(Ge.shape,$e),Ke!==Ge&&Ge.dispose(),[2,Ye]}})})},rc=An({add_:function(Ke,Ge){var $e,Ye=mn(Ke,"a","add"),Qe=mn(Ge,"b","add");$e=Nt(Ye,Qe),Ye=$e[0],Qe=$e[1];var Je=Ro(Ye.shape,Qe.shape);return Lt.runKernelFunc(function(Mt){return Mt.add(Ye,Qe)},{a:Ye,b:Qe},function(Mt){return{a:function(){var nn=Mt,an=Eo(Ye.shape,Je);return an.length>0&&(nn=nn.sum(an)),nn.reshape(Ye.shape)},b:function(){var nn=Mt,an=Eo(Qe.shape,Je);return an.length>0&&(nn=nn.sum(an)),nn.reshape(Qe.shape)}}},"Add")}}),oc=An({addN_:function(Ke){C(Array.isArray(Ke),function(){return"The argument passed to tf.addN() must be a list of tensors"}),C(Ke.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+Ke.length});var Ge=Ke.map(function(Qe,Je){return mn(Qe,"tensors"+Je,"addN")}),$e=Ge[0];Ge.forEach(function(Qe){if(Qe.dtype!==$e.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),Ge.forEach(function(Qe){if(!S(Qe.shape,$e.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var Ye=Ge;return Lt.runKernelFunc(function(Qe){return Qe.addN(Ge)},Ye,function(Qe){var Je={};return Ge.forEach(function(Mt,nn){Je[nn]=function(){return Qe.clone()}}),Je},"AddN")}}),ac=An({addStrict_:function(Ke,Ge){var $e=mn(Ke,"a","addStrict"),Ye=mn(Ge,"b","addStrict");return E($e.shape,Ye.shape,"Error in addStrict: "),$e.add(Ye)}}),ic=An({atan2_:function(Ke,Ge){var $e,Ye=mn(Ke,"a","atan2"),Qe=mn(Ge,"b","atan2");$e=Nt(Ye,Qe),Ye=$e[0],Qe=$e[1];var Je=Ro(Ye.shape,Qe.shape);return Lt.runKernelFunc(function(Mt,nn){var an=Mt.atan2(Ye,Qe);return nn([Ye,Qe]),an},{$a:Ye,$b:Qe},function(Mt,nn){var an=nn[0],sn=nn[1];return{$a:function(){var ln=rc(an.square(),sn.square()),fn=Mt.mul(sn.div(ln)),hn=Eo(an.shape,Je);return hn.length>0&&(fn=fn.sum(hn)),fn.reshape(an.shape)},$b:function(){var ln=rc(an.square(),sn.square()),fn=wu(Mt.mul(an.div(ln))),hn=Eo(sn.shape,Je);return hn.length>0&&(fn=fn.sum(hn)),fn.reshape(sn.shape)}}})}}),sc=An({div_:function(Ke,Ge){var $e,Ye=mn(Ke,"a","div"),Qe=mn(Ge,"b","div");if($e=Nt(Ye,Qe),Ye=$e[0],Qe=$e[1],Ye.dtype==="int32"&&Qe.dtype==="int32")return lc(Ye,Qe);var Je=Ro(Ye.shape,Qe.shape);return Lt.runKernelFunc(function(Mt,nn){var an=Mt.realDivide(Ye,Qe);return nn([Ye,Qe]),an},{a:Ye,b:Qe},function(Mt,nn){var an=nn[0],sn=nn[1];return{a:function(){var ln=Mt.div(sn.toFloat()),fn=Eo(an.shape,Je);return fn.length>0?ln.sum(fn).reshape(an.shape):ln},b:function(){var ln=Mt.mul(an.toFloat()),fn=Eo(sn.shape,Je);fn.length>0&&(ln=ln.sum(fn).reshape(sn.shape));var hn=sn.square();return ln.div(hn.toFloat()).neg()}}},"Div")}}),uc=An({divNoNan_:function(Ke,Ge){var $e,Ye=mn(Ke,"a","div"),Qe=mn(Ge,"b","div");Ye=($e=Nt(Ye,Qe))[0],Qe=$e[1];var Je=sc(Ye,Qe),Mt=Xn(Je),nn=Qe.equal(Mt);return ec(nn,Mt,Je)}}),cc=An({divStrict_:function(Ke,Ge){var $e=mn(Ke,"a","div"),Ye=mn(Ge,"b","div");return E($e.shape,Ye.shape,"Error in divideStrict: "),$e.div(Ye)}}),lc=An({floorDiv_:function(Ke,Ge){var $e,Ye=mn(Ke,"a","floorDiv"),Qe=mn(Ge,"b","floorDiv");$e=Nt(Ye,Qe),Ye=$e[0],Qe=$e[1];var Je=Ro(Ye.shape,Qe.shape);return Lt.runKernelFunc(function(Mt,nn){var an=Mt.floorDiv(Ye,Qe);return nn([Ye,Qe]),an},{a:Ye,b:Qe},function(Mt,nn){var an=nn[0],sn=nn[1];return{a:function(){var ln=Mt.div(sn.toFloat()),fn=Eo(an.shape,Je);return fn.length>0?ln.sum(fn).reshape(an.shape):ln},b:function(){var ln=Mt.mul(an.toFloat()),fn=Eo(sn.shape,Je);fn.length>0&&(ln=ln.sum(fn).reshape(sn.shape));var hn=sn.square();return ln.div(hn.toFloat()).neg()}}},"FloorDiv")}}),hc=An({maximum_:function(Ke,Ge){var $e,Ye=mn(Ke,"a","maximum"),Qe=mn(Ge,"b","maximum");return $e=Nt(Ye,Qe),Ye=$e[0],Qe=$e[1],Ye.dtype==="bool"&&(Ye=Ye.toInt(),Qe=Qe.toInt()),Ro(Ye.shape,Qe.shape),Lt.runKernelFunc(function(Je,Mt){var nn=Je.maximum(Ye,Qe);return Mt([Ye,Qe]),nn},{a:Ye,b:Qe},function(Je,Mt){var nn=Mt[0],an=Mt[1];return{a:function(){return Je.mul(nn.greaterEqual(an).toFloat())},b:function(){return Je.mul(nn.less(an).toFloat())}}},"Maximum")}}),fc=An({maximumStrict_:function(Ke,Ge){var $e=mn(Ke,"a","maximumStrict"),Ye=mn(Ge,"b","maximumStrict");return E($e.shape,Ye.shape,"Error in maximumStrict: "),$e.maximum(Ye)}}),dc=An({minimum_:function(Ke,Ge){var $e,Ye=mn(Ke,"a","minimum"),Qe=mn(Ge,"b","minimum");return $e=Nt(Ye,Qe),Ye=$e[0],Qe=$e[1],Ye.dtype==="bool"&&(Ye=Ye.toInt(),Qe=Qe.toInt()),Ro(Ye.shape,Qe.shape),Lt.runKernelFunc(function(Je,Mt){var nn=Je.minimum(Ye,Qe);return Mt([Ye,Qe]),nn},{a:Ye,b:Qe},function(Je,Mt){var nn=Mt[0],an=Mt[1];return{a:function(){return Je.mul(nn.lessEqual(an).toFloat())},b:function(){return Je.mul(nn.greater(an).toFloat())}}},"Minimum")}}),pc=An({minimumStrict_:function(Ke,Ge){var $e=mn(Ke,"a","minimumStrict"),Ye=mn(Ge,"b","minimumStrict");return E($e.shape,Ye.shape,"Error in minimumStrict: "),$e.minimum(Ye)}}),vc=An({mod_:function(Ke,Ge){var $e,Ye=mn(Ke,"a","mod"),Qe=mn(Ge,"b","mod");$e=Nt(Ye,Qe),Ye=$e[0],Qe=$e[1];var Je=Ro(Ye.shape,Qe.shape);return Lt.runKernelFunc(function(Mt,nn){var an=Mt.mod(Ye,Qe);return nn([Ye,Qe]),an},{$a:Ye,$b:Qe},function(Mt,nn){var an=nn[0],sn=nn[1];return{$a:function(){var ln=Eo(an.shape,Je);return ln.length>0?Mt.sum(ln).reshape(an.shape):Mt},$b:function(){var ln=Mt.mul(an.div(sn).floor().neg()),fn=Eo(sn.shape,Je);return fn.length>0?ln.sum(fn).reshape(sn.shape):ln}}})}}),mc=An({modStrict_:function(Ke,Ge){var $e=mn(Ke,"a","modStrict"),Ye=mn(Ge,"b","modStrict");return E($e.shape,Ye.shape,"Error in modStrict: "),$e.mod(Ye)}}),gc=An({mul_:function(Ke,Ge){var $e,Ye=mn(Ke,"a","mul"),Qe=mn(Ge,"b","mul");$e=Nt(Ye,Qe),Ye=$e[0],Qe=$e[1];var Je=Ro(Ye.shape,Qe.shape);return Lt.runKernelFunc(function(Mt,nn){var an=Mt.multiply(Ye,Qe);return nn([Ye,Qe]),an},{a:Ye,b:Qe},function(Mt,nn){var an=nn[0],sn=nn[1];return{a:function(){var ln=Mt.mul(sn.toFloat()),fn=Eo(an.shape,Je);return fn.length>0?ln.sum(fn).reshape(an.shape):ln},b:function(){var ln=Mt.mul(an.toFloat()),fn=Eo(sn.shape,Je);return fn.length>0?ln.sum(fn).reshape(sn.shape):ln}}},"Mul")}}),yc=An({mulStrict_:function(Ke,Ge){var $e=mn(Ke,"a","mul"),Ye=mn(Ge,"b","mul");return E($e.shape,Ye.shape,"Error in multiplyStrict: "),$e.mul(Ye)}}),xc=An({pow_:function(Ke,Ge){var $e,Ye=mn(Ke,"base","pow"),Qe=mn(Ge,"exp","pow");$e=Nt(Ye,Qe),Ye=$e[0],Qe=$e[1];var Je=Ro(Ye.shape,Qe.shape),Mt=[Ye,Qe];return Lt.runKernelFunc(function(nn,an){var sn=nn.pow(Ye,Qe);return an([Ye,Qe,sn]),sn},{a:Ye,b:Qe},function(nn,an){var sn=an[0],ln=an[1],fn=an[2];return{a:function(){var hn=ln.toFloat(),Xr=nn.mul(hn.mul(sn.pow(hn.sub(On(1))))),Mi=Eo(sn.shape,Je);return Mi.length>0&&(Xr=Xr.sum(Mi)),Xr.reshape(sn.shape)},b:function(){var hn=sn.greater(0),Xr=sn.log().where(hn,Xn(sn)),Mi=nn.mul(fn.mul(Xr)),co=Eo(ln.shape,Je);return co.length>0&&(Mi=Mi.sum(co)),Mi.reshape(ln.shape)}}},"Pow",{},Mt,[!0])}}),bc=An({powStrict_:function(Ke,Ge){return E(Ke.shape,Ge.shape,"Error in powStrict: "),Ke.pow(Ge)}}),wc=An({squaredDifferenceStrict_:function(Ke,Ge){var $e=mn(Ke,"a","squaredDifferenceStrict"),Ye=mn(Ge,"b","squaredDifferenceStrict");return E($e.shape,Ye.shape,"Error in squaredDifferenceStrict: "),$e.squaredDifference(Ye)}}),Cc=An({sub_:function(Ke,Ge){var $e,Ye=mn(Ke,"a","sub"),Qe=mn(Ge,"b","sub");$e=Nt(Ye,Qe),Ye=$e[0],Qe=$e[1];var Je=Ro(Ye.shape,Qe.shape);return Lt.runKernelFunc(function(Mt){return Mt.subtract(Ye,Qe)},{a:Ye,b:Qe},function(Mt){return{a:function(){var nn=Mt,an=Eo(Ye.shape,Je);return an.length>0&&(nn=nn.sum(an)),nn.reshape(Ye.shape)},b:function(){var nn=Mt,an=Eo(Qe.shape,Je);return an.length>0&&(nn=nn.sum(an)),nn.neg().reshape(Qe.shape)}}},"Sub")}}),Ec=An({subStrict_:function(Ke,Ge){var $e=mn(Ke,"a","subStrict"),Ye=mn(Ge,"b","subStrict");return E($e.shape,Ye.shape,"Error in subStrict: "),$e.sub(Ye)}}),Rc=An({equal_:function(Ke,Ge){var $e,Ye=mn(Ke,"a","equal"),Qe=mn(Ge,"b","equal");return $e=Nt(Ye,Qe),Ye=$e[0],Qe=$e[1],Ro(Ye.shape,Qe.shape),Lt.runKernelFunc(function(Je){return Je.equal(Ye,Qe)},{$a:Ye,$b:Qe})}}),Ic=An({equalStrict_:function(Ke,Ge){var $e=mn(Ke,"a","equalStrict"),Ye=mn(Ge,"b","equalStrict");return E($e.shape,Ye.shape,"Error in equalStrict: "),$e.equal(Ye)}}),kc=An({greater_:function(Ke,Ge){var $e,Ye=mn(Ke,"a","greater"),Qe=mn(Ge,"b","greater");return $e=Nt(Ye,Qe),Ye=$e[0],Qe=$e[1],Ro(Ye.shape,Qe.shape),Lt.runKernelFunc(function(Je){return Je.greater(Ye,Qe)},{a:Ye,b:Qe},null,"Greater")}}),Sc=An({greaterEqual_:function(Ke,Ge){var $e,Ye=mn(Ke,"a","greaterEqual"),Qe=mn(Ge,"b","greaterEqual");return $e=Nt(Ye,Qe),Ye=$e[0],Qe=$e[1],Ro(Ye.shape,Qe.shape),Lt.runKernelFunc(function(Je,Mt){var nn=Je.greaterEqual(Ye,Qe);return Mt([Ye,Qe]),nn},{a:Ye,b:Qe},function(Je,Mt){var nn=Mt[0],an=Mt[1];return{a:function(){return Xn(nn)},b:function(){return Xn(an)}}},"GreaterEqual")}}),Ac=An({greaterEqualStrict_:function(Ke,Ge){var $e=mn(Ke,"a","greaterEqualStrict"),Ye=mn(Ge,"b","greaterEqualStrict");return E($e.shape,Ye.shape,"Error in greaterEqualStrict: "),$e.greaterEqual(Ye)}}),Dc=An({greaterStrict_:function(Ke,Ge){var $e=mn(Ke,"a","greaterStrict"),Ye=mn(Ge,"b","greaterStrict");return E($e.shape,Ye.shape,"Error in greaterStrict: "),$e.greater(Ye)}}),Tc=An({less_:function(Ke,Ge){var $e,Ye=mn(Ke,"a","less"),Qe=mn(Ge,"b","less");return $e=Nt(Ye,Qe),Ye=$e[0],Qe=$e[1],Ro(Ye.shape,Qe.shape),Lt.runKernelFunc(function(Je){return Je.less(Ye,Qe)},{a:Ye,b:Qe},null,"Less")}}),Nc=An({lessEqual_:function(Ke,Ge){var $e,Ye=mn(Ke,"a","lessEqual"),Qe=mn(Ge,"b","lessEqual");return $e=Nt(Ye,Qe),Ye=$e[0],Qe=$e[1],Ro(Ye.shape,Qe.shape),Lt.runKernelFunc(function(Je,Mt){var nn=Je.lessEqual(Ye,Qe);return Mt([Ye,Qe]),nn},{a:Ye,b:Qe},null,"LessEqual")}}),Fc=An({lessEqualStrict_:function(Ke,Ge){var $e=mn(Ke,"a","lessEqualStrict"),Ye=mn(Ge,"b","lessEqualStrict");return E($e.shape,Ye.shape,"Error in lessEqualStrict: "),$e.lessEqual(Ye)}}),_c=An({lessStrict_:function(Ke,Ge){var $e=mn(Ke,"a","lessStrict"),Ye=mn(Ge,"b","lessStrict");return E($e.shape,Ye.shape,"Error in lessStrict: "),$e.less(Ye)}}),Oc=An({notEqual_:function(Ke,Ge){var $e,Ye=mn(Ke,"a","notEqual"),Qe=mn(Ge,"b","notEqual");return $e=Nt(Ye,Qe),Ye=$e[0],Qe=$e[1],Ro(Ye.shape,Qe.shape),Lt.runKernelFunc(function(Je){return Je.notEqual(Ye,Qe)},{a:Ye,b:Qe},null,"NotEqual")}}),Mc=An({notEqualStrict_:function(Ke,Ge){var $e=mn(Ke,"a","notEqualStrict"),Ye=mn(Ge,"b","notEqualStrict");return E($e.shape,Ye.shape,"Error in notEqualStrict: "),$e.notEqual(Ye)}});function Bc(Ke,Ge){for(var $e=[],Ye=Ke;Ye<Ge;++Ye)$e.push(Ye);return $e}function Pc(Ke){for(var Ge=[],$e=0;$e<Ke.length;++$e)for(var Ye=0;Ye<Ke[$e].length;++Ye)Ge.push(Ke[$e][Ye]);return Ge}var Lc=An({gather_:function(Ke,Ge,$e){$e===void 0&&($e=0);var Ye=mn(Ke,"x","gather"),Qe=mn(Ge,"indices","gather","int32");$e=O($e,Ye.shape)[0];var Je=function(Mt,nn,an){for(var sn=Mt.shape[an],ln=[],fn=1,hn=1,Xr=0;Xr<an;Xr++)ln.push(Mt.shape[Xr]),fn*=Mt.shape[Xr];for(Xr=0;Xr<nn.rank;Xr++)ln.push(nn.shape[Xr]);for(Xr=an+1;Xr<Mt.rank;Xr++)ln.push(Mt.shape[Xr]),hn*=Mt.shape[Xr];return{batchSize:fn,sliceSize:hn,dimSize:sn,outputShape:ln}}(Ye,Qe,$e);return Lt.runKernelFunc(function(Mt,nn){var an=Mt.gather(Ye,Qe.flatten(),$e);return nn([Qe]),an},{x:Ye,indices:Qe},function(Mt,nn){var an=nn[0];return{x:function(){var sn=Ye.shape,ln=an.size,fn=sn.slice(0,$e),hn=fn.length,Xr=sn.slice($e,sn.length).slice(1),Mi=Xr.length,co=Bc(0,hn),lo=Bc(hn+1,hn+1+Mi),uo=Pc([fn,[ln],Xr]),ho=Mt.reshape(uo),mo=an.reshape([ln]),_d=Pc([[hn],co,lo]),ep=ho.transpose(_d),rp=Wc(ep,mo,Ye.shape[$e]),sp=Rn(_d);return rp=rp.transpose(sp)},indices:function(){return an}}},"Gather",{axis:$e}).reshape(Je.outputShape)}}),Wc=An({unsortedSegmentSum_:function(Ke,Ge,$e){var Ye=mn(Ke,"x","unsortedSegmentSum"),Qe=mn(Ge,"segmentIds","unsortedSegmentSum","int32");return C(A($e),function(){return"numSegments must be of dtype int"}),Lt.runKernelFunc(function(Je,Mt){var nn=Je.unsortedSegmentSum(Ye,Qe,$e);return Mt([Qe]),nn},{$x:Ye},function(Je,Mt){var nn=Mt[0];return{$x:function(){return function(an,sn){for(var ln=hc(sn,Xn(sn)),fn=Lc(an,ln),hn=Sc(sn,On(0,"int32")),Xr=fn.rank-hn.rank,Mi=0;Mi<Xr;++Mi)hn=wr(hn,Mi+1);hn=Qu(hn,zn(fn.shape,"bool"));var co=Xn(fn);return ec(hn,fn,co)}(Je,nn)}}})}}),Uc=function(Ke,Ge,$e){return n(this,void 0,void 0,function(){var Ye,Qe,Je,Mt,nn,an,sn,ln,fn,hn,Xr,Mi,co;return r(this,function(lo){switch(lo.label){case 0:for(Ye=mn(Ke,"tensor","boolMask"),Qe=mn(Ge,"mask","boolMask","bool"),Je=$e??0,Mt=Qe.rank,nn=Ye.shape,C(Mt>0,function(){return"mask cannot be scalar"}),E(nn.slice(Je,Je+Mt),Qe.shape,"mask's shape must match the first K dimensions of tensor's shape,"),an=1,sn=Je;sn<Je+Mt;sn++)an*=nn[sn];return ln=nn.slice(0,Je).concat([an],nn.slice(Je+Mt)),fn=Ye.reshape(ln),hn=Qe.reshape([-1]),[4,nc(hn)];case 1:return Xr=lo.sent(),Mi=Xr.squeeze([1]),co=Lc(fn,Mi,Je),Ke!==Ye&&Ye.dispose(),Ge!==Qe&&Qe.dispose(),Mi.dispose(),fn.dispose(),hn.dispose(),Xr.dispose(),[2,co]}})})};function Vc(Ke,Ge,$e,Ye,Qe,Je,Mt){Je===void 0&&(Je="NHWC"),C(Ke.length===Ge.rank,function(){return"Length of inShape ("+Ke.length+") and rank of dy ("+Ge.rank+") must match"});var nn=Ke,an=Ge,sn=!1;Ge.rank===3&&(sn=!0,an=Ge.as4D(1,Ge.shape[0],Ge.shape[1],Ge.shape[2]),nn=[1,Ke[0],Ke[1],Ke[2]]),C(nn.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+nn.length+"."}),C(an.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+an.rank}),C($e.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+$e.rank});var ln=Je==="NHWC"?nn[3]:nn[1],fn=Je==="NHWC"?an.shape[3]:an.shape[1];C(ln===$e.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+ln+") must match input depth for filter "+$e.shape[2]+"."}),C(fn===$e.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+fn+") must match output depth for filter "+$e.shape[3]+"."}),Mt!=null&&C(A(Qe),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+Mt+" but got pad "+Qe+"."});var hn=Bo(Je),Xr=So(nn,$e.shape,Ye,1,Qe,Mt,!1,hn),Mi=Lt.runKernelFunc(function(co,lo){var uo=co.conv2dDerInput(an,$e,Xr);return lo([$e,an]),uo},{dy4D:an,filter:$e},function(co,lo){var uo=lo[0],ho=lo[1];return{dy4D:function(){return qc(co,uo,Ye,Qe,Je,1,Mt)},filter:function(){return jc(co,ho,uo.shape,Ye,Qe,Je,Mt)}}});return sn?Mi.as3D(Mi.shape[1],Mi.shape[2],Mi.shape[3]):Mi}function zc(Ke){var Ge=function(Je){return typeof Je=="number"?[Je,Je,Je]:Je.length===2?[Je[0],Je[1],1]:Je}(Ke),$e=Ge[0],Ye=Ge[1],Qe=Ge[2];return $e===1&&Ye===1&&Qe===1}function Gc(Ke,Ge,$e,Ye,Qe){C(Ke.length===Ge.rank,function(){return"Length of inShape ("+Ke.length+") and rank of dy ("+Ge.rank+") must match"});var Je=Ke,Mt=Ge,nn=!1;Ge.rank===4&&(nn=!0,Mt=Ge.as5D(1,Ge.shape[0],Ge.shape[1],Ge.shape[2],Ge.shape[3]),Je=[1,Ke[0],Ke[1],Ke[2],Ke[3]]);var an=Je[4],sn=Mt.shape[4];C(Je.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+Je.length+"."}),C(Mt.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+Mt.rank}),C($e.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+$e.rank}),C(an===$e.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+an+") must match input depth for filter "+$e.shape[3]+"."}),C(sn===$e.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+sn+") must match output depth for filter "+$e.shape[4]+"."});var ln=Ao(Je,$e.shape,Ye,1,Qe),fn=Lt.runKernelFunc(function(hn){return hn.conv3dDerInput(Mt,$e,ln)},{dy5D:Mt});return nn?fn.as4D(fn.shape[1],fn.shape[2],fn.shape[3],fn.shape[4]):fn}var Hc=An({conv1d_:function(Ke,Ge,$e,Ye,Qe,Je,Mt){Qe===void 0&&(Qe="NWC"),Je===void 0&&(Je=1);var nn=mn(Ke,"x","conv1d"),an=mn(Ge,"filter","conv1d"),sn=nn,ln=!1;nn.rank===2&&(ln=!0,sn=nn.as3D(1,nn.shape[0],nn.shape[1])),C(sn.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+sn.rank+"."}),C(an.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+an.rank+"."}),Mt!=null&&C(A(Ye),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+Mt+" but got pad "+Ye+"."}),C(sn.shape[2]===an.shape[1],function(){return"Error in conv1d: depth of input ("+sn.shape[2]+") must match input depth for filter "+an.shape[1]+"."}),C(Mo($e,Je),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+$e+" and dilation '"+Je+"'"}),C(Qe==="NWC",function(){return"Error in conv1d: got dataFormat of "+Qe+" but only NWC is currently supported."});var fn=an.as4D(1,an.shape[0],an.shape[1],an.shape[2]),hn=sn.as4D(sn.shape[0],1,sn.shape[1],sn.shape[2]),Xr=qc(hn,fn,[1,$e],Ye,"NHWC",[1,Je],Mt);return ln?Xr.as2D(Xr.shape[2],Xr.shape[3]):Xr.as3D(Xr.shape[0],Xr.shape[2],Xr.shape[3])}}),qc=An({conv2d_:function(Ke,Ge,$e,Ye,Qe,Je,Mt){Qe===void 0&&(Qe="NHWC"),Je===void 0&&(Je=[1,1]);var nn=mn(Ke,"x","conv2d"),an=mn(Ge,"filter","conv2d"),sn=nn,ln=!1;nn.rank===3&&(ln=!0,sn=nn.as4D(1,nn.shape[0],nn.shape[1],nn.shape[2])),C(sn.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+sn.rank+"."}),C(an.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+an.rank+"."}),Mt!=null&&C(A(Ye),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+Mt+" but got pad "+Ye+"."});var fn=Qe==="NHWC"?sn.shape[3]:sn.shape[1];C(fn===an.shape[2],function(){return"Error in conv2d: depth of input ("+fn+") must match input depth for filter "+an.shape[2]+"."}),C(Mo($e,Je),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+$e+" and dilations '"+Je+"'"});var hn=Bo(Qe),Xr=So(sn.shape,an.shape,$e,Je,Ye,Mt,!1,hn),Mi=[an,sn],co=Lt.runKernelFunc(function(lo,uo){var ho=lo.conv2d(sn,an,Xr);return uo([an,sn]),ho},{x:sn,filter:an},function(lo,uo){var ho=uo,mo=ho[0],_d=ho[1];return C(Oo(Je),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+Je+"'"}),{x:function(){return Xc(_d.shape,lo,mo,$e,Ye,Qe)},filter:function(){return jc(_d,lo,mo.shape,$e,Ye,Qe)}}},"Conv2D",Xr,Mi);return ln?co.as3D(co.shape[1],co.shape[2],co.shape[3]):co}}),Kc=An({conv3d_:function(Ke,Ge,$e,Ye,Qe,Je){Qe===void 0&&(Qe="NDHWC"),Je===void 0&&(Je=[1,1,1]);var Mt=mn(Ke,"x","conv3d"),nn=mn(Ge,"filter","conv3d"),an=Mt,sn=!1;Mt.rank===4&&(sn=!0,an=Mt.as5D(1,Mt.shape[0],Mt.shape[1],Mt.shape[2],Mt.shape[3])),C(an.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+an.rank+"."}),C(nn.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+nn.rank+"."}),C(an.shape[4]===nn.shape[3],function(){return"Error in conv3d: depth of input ("+an.shape[4]+") must match input depth for filter "+nn.shape[3]+"."}),C(function(hn,Xr){return zc(hn)||zc(Xr)}($e,Je),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+$e+" and dilations '"+Je+"'"}),C(Qe==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+Qe+" but only NDHWC is currently supported."});var ln=Ao(an.shape,nn.shape,$e,Je,Ye),fn=Lt.runKernelFunc(function(hn,Xr){var Mi=hn.conv3d(an,nn,ln);return Xr([an,nn]),Mi},{x:an,$filter:nn},function(hn,Xr){C(zc(Je),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+Je+"'"});var Mi=Xr[0],co=Xr[1];return{x:function(){return Gc(Mi.shape,hn,co,$e,Ye)},$filter:function(){return function(lo,uo,ho,mo,_d){var ep=lo;lo.rank===4&&(ep=lo.as5D(1,lo.shape[0],lo.shape[1],lo.shape[2],lo.shape[3]));var rp=uo;rp.rank===4&&(rp=uo.as5D(1,uo.shape[0],uo.shape[1],uo.shape[2],uo.shape[3])),C(ep.rank===5,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+ep.shape+"."}),C(rp.rank===5,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+rp.shape+"."}),C(ho.length===5,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+ho+"."}),C(ep.shape[4]===ho[3],function(){return"Error in conv3dDerFilter: depth of input "+ep.shape[4]+") must match input depth in filter ("+ho[3]+"."}),C(rp.shape[4]===ho[4],function(){return"Error in conv3dDerFilter: depth of dy ("+rp.shape[4]+") must match output depth for filter ("+ho[4]+")."});var sp=Ao(ep.shape,ho,mo,1,_d);return Lt.runKernelFunc(function(op){return op.conv3dDerFilter(ep,rp,sp)},{x5D:ep,dy5D:rp})}(Mi,hn,co.shape,$e,Ye)}}});return sn?fn.as4D(fn.shape[1],fn.shape[2],fn.shape[3],fn.shape[4]):fn}}),jc=An({conv2dDerFilter_:function(Ke,Ge,$e,Ye,Qe,Je,Mt){Je===void 0&&(Je="NHWC");var nn=Ke;Ke.rank===3&&(nn=Ke.as4D(1,Ke.shape[0],Ke.shape[1],Ke.shape[2]));var an=Ge;an.rank===3&&(an=Ge.as4D(1,Ge.shape[0],Ge.shape[1],Ge.shape[2])),C(nn.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+nn.shape+"."}),C(an.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+an.shape+"."}),C($e.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+$e+"."});var sn=Je==="NHWC"?nn.shape[3]:nn.shape[1],ln=Je==="NHWC"?an.shape[3]:an.shape[1];C(sn===$e[2],function(){return"Error in conv2dDerFilter: depth of input "+sn+") must match input depth in filter ("+$e[2]+"."}),C(ln===$e[3],function(){return"Error in conv2dDerFilter: depth of dy ("+ln+") must match output depth for filter ("+$e[3]+")."}),Mt!=null&&C(A(Qe),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+Mt+" but got pad "+Qe+"."});var fn=Bo(Je),hn=So(nn.shape,$e,Ye,1,Qe,Mt,!1,fn);return Lt.runKernelFunc(function(Xr){return Xr.conv2dDerFilter(nn,an,hn)},{x4D:nn,dy4D:an})}}),Xc=An({conv2dDerInput_:Vc}),Yc=An({depthwiseConv2d_:function(Ke,Ge,$e,Ye,Qe,Je,Mt){Je===void 0&&(Je=[1,1]);var nn=mn(Ke,"x","depthwiseConv2d"),an=mn(Ge,"filter","depthwiseConv2d"),sn=nn,ln=!1;nn.rank===3&&(ln=!0,sn=nn.as4D(1,nn.shape[0],nn.shape[1],nn.shape[2])),C(sn.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+sn.rank+"."}),C(an.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+an.rank+"."}),C(sn.shape[3]===an.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+sn.shape[3]+") must match the inChannels dimension in filter "+an.shape[2]+"."}),Je==null&&(Je=[1,1]),C(Mo($e,Je),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+$e+" and dilations '"+Je+"'"}),Mt!=null&&C(A(Ye),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+Mt+" but got pad "+Ye+"."});var fn=So(sn.shape,an.shape,$e,Je,Ye,Mt,!0),hn=[sn,an],Xr=Lt.runKernelFunc(function(Mi,co){var lo=Mi.depthwiseConv2D(sn,an,fn);return co([sn,an]),lo},{x:sn,filter:an},function(Mi,co){C(Oo(Je),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+Je+"'"});var lo=co[0],uo=co[1];return{x:function(){return $c(lo.shape,Mi,uo,fn)},filter:function(){return Qc(lo,Mi,uo.shape,fn)}}},"DepthwiseConv2dNative",fn,hn);return ln?Xr.as3D(Xr.shape[1],Xr.shape[2],Xr.shape[3]):Xr}}),$c=An({depthwiseConv2dDerInput_:function(Ke,Ge,$e,Ye){var Qe=Ge,Je=!1;Ge.rank===3&&(Je=!0,Qe=Ge.as4D(1,Ge.shape[0],Ge.shape[1],Ge.shape[2]));var Mt=Lt.runKernelFunc(function(nn){return nn.depthwiseConv2DDerInput(Qe,$e,Ye)},{dy4D:Qe});return Je?Mt.as3D(Mt.shape[1],Mt.shape[2],Mt.shape[3]):Mt}}),Qc=An({depthwiseConv2dDerFilter_:function(Ke,Ge,$e,Ye){var Qe=Ke;Ke.rank===3&&(Qe=Ke.as4D(1,Ke.shape[0],Ke.shape[1],Ke.shape[2]));var Je=Ge;return Je.rank===3&&(Je=Ge.as4D(1,Ge.shape[0],Ge.shape[1],Ge.shape[2])),Lt.runKernelFunc(function(Mt){return Mt.depthwiseConv2DDerFilter(Qe,Je,Ye)},{x4D:Qe,dy4D:Je})}}),Jc=An({separableConv2d_:function(Ke,Ge,$e,Ye,Qe,Je,Mt){Je===void 0&&(Je=[1,1]),Mt===void 0&&(Mt="NHWC");var nn=mn(Ke,"x","separableConv2d"),an=mn(Ge,"depthwiseFilter","separableConv2d"),sn=mn($e,"pointwiseFilter","separableConv2d"),ln=nn,fn=!1;if(nn.rank===3&&(fn=!0,ln=nn.as4D(1,nn.shape[0],nn.shape[1],nn.shape[2])),Mt==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");C(ln.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+ln.rank+"."}),C(an.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+an.rank+"."}),C(sn.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+an.rank+"."}),C(sn.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+sn.shape[0]+"."}),C(sn.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+sn.shape[1]+"."});var hn=an.shape[2],Xr=an.shape[3];C(sn.shape[2]===hn*Xr,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+hn*Xr+", but got "+sn.shape[2]+"."});var Mi=Yc(ln,an,Ye,Qe,Mt,Je),co=qc(Mi,sn,1,"valid",Mt);return fn?co.as3D(co.shape[1],co.shape[2],co.shape[3]):co}}),Zc=An({conv2dTranspose_:function(Ke,Ge,$e,Ye,Qe,Je){return Vc($e,mn(Ke,"x","conv2dTranspose"),mn(Ge,"filter","conv2dTranspose"),Ye,Qe,"NHWC",Je)}}),tl=An({conv3dTranspose_:function(Ke,Ge,$e,Ye,Qe){return Gc($e,mn(Ke,"x","conv3dTranspose"),mn(Ge,"filter","conv3dTranspose"),Ye,Qe)}}),el=An({matMul_:function(Ke,Ge,$e,Ye){var Qe;$e===void 0&&($e=!1),Ye===void 0&&(Ye=!1);var Je=mn(Ke,"a","matMul"),Mt=mn(Ge,"b","matMul");Qe=Nt(Je,Mt),Je=Qe[0],Mt=Qe[1];var nn=$e?Je.shape[Je.rank-2]:Je.shape[Je.rank-1],an=Ye?Mt.shape[Mt.rank-1]:Mt.shape[Mt.rank-2],sn=$e?Je.shape[Je.rank-1]:Je.shape[Je.rank-2],ln=Ye?Mt.shape[Mt.rank-2]:Mt.shape[Mt.rank-1],fn=Je.shape.slice(0,-2),hn=Mt.shape.slice(0,-2),Xr=k(fn),Mi=k(hn);C(Je.rank>=2&&Mt.rank>=2&&Je.rank===Mt.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+Je.rank+" and "+Mt.rank+"."}),C(S(fn,hn),function(){return"Error in matMul: outer dimensions ("+fn+") and ("+hn+") of Tensors with shapes "+Je.shape+" and "+Mt.shape+" must match."}),C(nn===an,function(){return"Error in matMul: inner shapes ("+nn+") and ("+an+") of Tensors with shapes "+Je.shape+" and "+Mt.shape+" and transposeA="+$e+" and transposeB="+Ye+" must match."});var co=Je.shape.slice(0,-2).concat([sn,ln]),lo=$e?Je.as3D(Xr,nn,sn):Je.as3D(Xr,sn,nn),uo=Ye?Mt.as3D(Mi,ln,an):Mt.as3D(Mi,an,ln),ho={transposeA:$e,transposeB:Ye};return Lt.runKernelFunc(function(mo,_d){var ep=mo.batchMatMul(lo,uo,$e,Ye);return _d([lo,uo]),ep},{a:lo,b:uo},function(mo,_d){var ep=_d,rp=ep[0],sp=ep[1];return $e||Ye?!$e&&Ye?{a:function(){return mo.matMul(sp,!1,!1)},b:function(){return mo.matMul(rp,!0,!1)}}:$e&&!Ye?{a:function(){return sp.matMul(mo,!1,!0)},b:function(){return rp.matMul(mo,!1,!1)}}:{a:function(){return sp.matMul(mo,!0,!0)},b:function(){return mo.matMul(rp,!0,!0)}}:{a:function(){return mo.matMul(sp,!1,!0)},b:function(){return rp.matMul(mo,!0,!1)}}},"BatchMatMul",ho).reshape(co)}}),nl=An({dot_:function(Ke,Ge){var $e=mn(Ke,"t1","dot"),Ye=mn(Ge,"t2","dot");C(!($e.rank!==1&&$e.rank!==2||Ye.rank!==1&&Ye.rank!==2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+$e.rank+" and "+Ye.rank+"."});var Qe=$e.rank===1?$e.size:$e.shape[1],Je=Ye.rank===1?Ye.size:Ye.shape[0];return C(Qe===Je,function(){return"Error in dot: inner dimensions of inputs must match, but got "+Qe+" and "+Je+"."}),$e.rank===1&&Ye.rank===1?$e.as2D(1,-1).matMul(Ye.as2D(-1,1)).asScalar():$e.rank===1&&Ye.rank===2?$e.as2D(1,-1).matMul(Ye.as2D(Ye.shape[0],Ye.shape[1])).as1D():$e.rank===2&&Ye.rank===1?$e.matMul(Ye.as2D(-1,1)).as1D():$e.matMul(Ye.as2D(Ye.shape[0],Ye.shape[1]))}}),rl=An({outerProduct_:function(Ke,Ge){var $e=mn(Ke,"v1","outerProduct"),Ye=mn(Ge,"v2","outerProduct");return C($e.rank===1&&Ye.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+$e.rank+" and "+Ye.rank+"."}),$e.as2D(-1,1).matMul(Ye.as2D(1,-1))}}),ol=An({reverse_:function(Ke,Ge){var $e=mn(Ke,"x","reverse");if($e.rank===0)return $e.clone();var Ye=O(Ge,$e.shape);return Lt.runKernelFunc(function(Qe){return Qe.reverse($e,Ye)},{$x:$e},function(Qe){return{$x:function(){return Qe.reverse(Ye)}}}).reshapeAs($e)}}),al=An({reverse1d_:function(Ke){var Ge=mn(Ke,"x","reverse");return C(Ge.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+Ge.rank+"."}),ol(Ge,0)}}),il=An({reverse2d_:function(Ke,Ge){var $e=mn(Ke,"x","reverse");return C($e.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+$e.rank+"."}),ol($e,Ge)}}),sl=An({reverse3d_:function(Ke,Ge){var $e=mn(Ke,"x","reverse");return C($e.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+$e.rank+"."}),ol($e,Ge)}}),ul=An({reverse4d_:function(Ke,Ge){var $e=mn(Ke,"x","reverse");return C($e.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+$e.rank+"."}),ol($e,Ge)}});function cl(Ke,Ge,$e,Ye,Qe,Je){var Mt=mn(Ke,"x","maxPool"),nn=Mt,an=!1;Mt.rank===3&&(an=!0,nn=Mt.as4D(1,Mt.shape[0],Mt.shape[1],Mt.shape[2])),C(nn.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+nn.rank+"."}),C(Mo($e,Ye),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+$e+" and dilations '"+Ye+"'"}),Je!=null&&C(A(Qe),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+Je+" but got pad "+Qe+"."});var sn=Io(nn.shape,Ge,$e,Ye,Qe,Je);if(sn.filterWidth===1&&sn.filterHeight===1&&S(sn.inShape,sn.outShape))return Mt.clone();var ln=[nn],fn=Lt.runKernelFunc(function(hn,Xr){var Mi=hn.maxPool(nn,sn);return Xr([nn,Mi]),Mi},{x:nn},function(hn,Xr){var Mi=Xr[0],co=Xr[1];return{x:function(){return function(lo,uo,ho,mo,_d,ep,rp,sp){var op=mn(lo,"dy","maxPoolBackprop"),ip=mn(uo,"input","maxPoolBackprop"),lp=mn(ho,"output","maxPoolBackprop");C(ip.rank===op.rank,function(){return"Rank of input ("+ip.rank+") does not match rank of dy ("+op.rank+")"}),C(Mo(_d,ep),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+_d+" and dilations '"+ep+"'"}),C(op.rank===4,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+op.rank+"."}),C(ip.rank===4,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+ip.rank+"."});var vp=Io(ip.shape,mo,_d,ep,rp,sp);return Lt.runKernelFunc(function(gp){return gp.maxPoolBackprop(op,ip,lp,vp)},{$dy:op,$input:ip})}(hn,Mi,co,Ge,$e,Ye,Qe)}}},"MaxPool",sn,ln);return an?fn.as3D(fn.shape[1],fn.shape[2],fn.shape[3]):fn}function ll(Ke,Ge,$e,Ye,Qe,Je){var Mt=mn(Ke,"x","avgPool","float32");C(Mo($e,Ye),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+$e+" and dilations '"+Ye+"'"});var nn=Mt,an=!1;Mt.rank===3&&(an=!0,nn=Mt.as4D(1,Mt.shape[0],Mt.shape[1],Mt.shape[2])),C(nn.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+nn.rank+"."}),Je!=null&&C(A(Qe),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+Je+" but got pad "+Qe+"."});var sn=Io(nn.shape,Ge,$e,Ye,Qe,Je);if(sn.filterWidth===1&&sn.filterHeight===1&&S(sn.inShape,sn.outShape))return Mt.clone();var ln=Lt.runKernelFunc(function(fn){return fn.avgPool(nn,sn)},{x:nn},function(fn){return{x:function(){return function(hn,Xr,Mi,co,lo,uo){var ho=mn(hn,"dy","avgPoolBackprop"),mo=mn(Xr,"input","avgPoolBackprop");C(mo.rank===ho.rank,function(){return"Rank of input ("+mo.rank+") does not match rank of dy ("+ho.rank+")"}),C(Mo(co,lo),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+co+" and dilations '"+lo+"'"});var _d=mo,ep=ho,rp=!1;mo.rank===3&&(rp=!0,_d=mo.as4D(1,mo.shape[0],mo.shape[1],mo.shape[2]),ep=ho.as4D(1,ho.shape[0],ho.shape[1],ho.shape[2])),C(ep.rank===4,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+ep.rank+"."}),C(_d.rank===4,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+_d.rank+"."});var sp=Io(_d.shape,Mi,co,lo,uo),op=Lt.runKernelFunc(function(ip){return ip.avgPoolBackprop(ep,_d,sp)},{dy4D:ep,input4D:_d});return rp?op.as3D(op.shape[1],op.shape[2],op.shape[3]):op}(fn,nn,Ge,$e,Ye,Qe)}}},"AvgPool",sn);return ln=ln.cast(Mt.dtype),an?ln.as3D(ln.shape[1],ln.shape[2],ln.shape[3]):ln}var hl=An({maxPool_:function(Ke,Ge,$e,Ye,Qe){return cl(Ke,Ge,$e,1,Ye,Qe)}}),fl=An({avgPool_:function(Ke,Ge,$e,Ye,Qe){return ll(Ke,Ge,$e,1,Ye,Qe)}}),dl=An({pool_:function(Ke,Ge,$e,Ye,Qe,Je){Qe==null&&(Qe=[1,1]),Je==null&&(Je=1),Ye===0&&(Ye="valid");var Mt=mn(Ke,"x","maxPool"),nn=Mt,an=!1;Mt.rank===3&&(an=!0,nn=Mt.as4D(1,Mt.shape[0],Mt.shape[1],Mt.shape[2])),C(Mo(Je,Qe),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+Je+" and dilations '"+Qe+"'"});var sn,ln=Io(nn.shape,Ge,Je,Qe,Ye),fn=[ln.dilationHeight,ln.dilationWidth];sn=Ye==="same"?function(_d,ep){var rp=_d.map(function(ip,lp){return ip+(ip-1)*(ep[lp]-1)}).map(function(ip){return ip-1}),sp=rp.map(function(ip){return Math.floor(ip/2)}),op=rp.map(function(ip,lp){return ip-sp[lp]});return rp.map(function(ip,lp){return[sp[lp],op[lp]]})}([ln.filterHeight,ln.filterWidth],fn):[[0,0],[0,0]];var hn=fn[0]===1&&fn[1]===1,Xr=function(_d,ep,rp){var sp=rp.map(function(Mp){return Mp[0]}),op=rp.map(function(Mp){return Mp[1]}),ip=_d.concat(sp,op),lp=ep.map(function(Mp,Np){return(Mp-ip[Np]%Mp)%Mp}),vp=op.map(function(Mp,Np){return Mp+lp[Np]}),gp=ep.map(function(Mp,Np){return[sp[Np],vp[Np]]}),Op=ep.map(function(Mp,Np){return[0,lp[Np]]});return[gp,Op]}([ln.inHeight,ln.inWidth],fn,sn),Mi=Xr[0],co=Xr[1],lo=hn?Ye:"valid",uo=hn?nn:Mr(nn,fn,Mi),ho=($e==="avg"?function(){return ll(uo,Ge,Je,1,lo)}:function(){return cl(uo,Ge,Je,1,lo)})(),mo=hn?ho:vr(ho,fn,co);return an?mo.as3D(mo.shape[1],mo.shape[2],mo.shape[3]):mo}}),pl=An({maxPool3d_:function(Ke,Ge,$e,Ye,Qe,Je,Mt){Je===void 0&&(Je="NDHWC");var nn=mn(Ke,"x","maxPool3d"),an=nn,sn=!1;nn.rank===4&&(sn=!0,an=nn.as5D(1,nn.shape[0],nn.shape[1],nn.shape[2],nn.shape[3])),Mt==null&&(Mt=[1,1,1]),C(an.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+an.rank+"."}),C(Je==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+Je}),C(Mo($e,Mt),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+$e+" and dilations '"+Mt+"'"}),Qe!=null&&C(A(Ye),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+Qe+" but got pad "+Ye+"."});var ln=ko(an.shape,Ge,$e,Mt,Ye,Qe,Je),fn=Lt.runKernelFunc(function(hn,Xr){var Mi=hn.maxPool3d(an,ln);return Xr([an,Mi]),Mi},{x:an},function(hn,Xr){var Mi=Xr[0],co=Xr[1];return{x:function(){return function(lo,uo,ho,mo,_d,ep,rp,sp){var op=mn(lo,"dy","maxPool3dBackprop"),ip=mn(uo,"input","maxPool3dBackprop"),lp=mn(ho,"output","maxPool3dBackprop"),vp=op,gp=ip,Op=lp,Mp=!1;ip.rank===4&&(Mp=!0,vp=op.as5D(1,op.shape[0],op.shape[1],op.shape[2],op.shape[3]),gp=ip.as5D(1,ip.shape[0],ip.shape[1],ip.shape[2],ip.shape[3]),Op=lp.as5D(1,lp.shape[0],lp.shape[1],lp.shape[2],lp.shape[3])),C(vp.rank===5,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+vp.rank+"."}),C(gp.rank===5,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+gp.rank+"."}),C(Op.rank===5,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+Op.rank+"."}),ep==null&&(ep=[1,1,1]),C(Mo(_d,ep),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+_d+" and dilations '"+ep+"'"}),sp!=null&&C(A(rp),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+sp+" but got pad "+rp+"."});var Np=ko(gp.shape,mo,_d,ep,rp,sp),wp=Lt.runKernelFunc(function(Sp){return Sp.maxPool3dBackprop(vp,gp,Op,Np)},{dy5D:vp,input5D:gp});return Mp?wp.as4D(wp.shape[1],wp.shape[2],wp.shape[3],wp.shape[4]):wp}(hn,Mi,co,Ge,$e,Mt,Ye,Qe)}}});return sn?fn.as4D(fn.shape[1],fn.shape[2],fn.shape[3],fn.shape[4]):fn}}),vl=An({avgPool3d_:function(Ke,Ge,$e,Ye,Qe,Je,Mt){Je===void 0&&(Je="NDHWC");var nn=mn(Ke,"x","avgPool3d","float32"),an=nn,sn=!1;nn.rank===4&&(sn=!0,an=nn.as5D(1,nn.shape[0],nn.shape[1],nn.shape[2],nn.shape[3])),Mt==null&&(Mt=[1,1,1]),C(an.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+an.rank+"."}),C(Je==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+Je}),C(Mo($e,Mt),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+$e+" and dilations '"+Mt+"'"}),Qe!=null&&C(A(Ye),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+Qe+" but got pad "+Ye+"."});var ln=ko(an.shape,Ge,$e,Mt,Ye,Qe,Je),fn=Lt.runKernelFunc(function(hn){return hn.avgPool3d(an,ln)},{x:an},function(hn){return{x:function(){return function(Xr,Mi,co,lo,uo,ho,mo){var _d=mn(Xr,"dy","avgPool3dBackprop"),ep=mn(Mi,"input","avgPool3dBackprop"),rp=_d,sp=ep,op=!1;ep.rank===4&&(op=!0,rp=_d.as5D(1,_d.shape[0],_d.shape[1],_d.shape[2],_d.shape[3]),sp=ep.as5D(1,ep.shape[0],ep.shape[1],ep.shape[2],ep.shape[3])),C(rp.rank===5,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+rp.rank+"."}),C(sp.rank===5,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+sp.rank+"."}),uo==null&&(uo=[1,1,1]),C(Mo(lo,uo),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+lo+" and dilations '"+uo+"'"}),mo!=null&&C(A(ho),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+mo+" but got pad "+ho+"."});var ip=ko(sp.shape,co,lo,uo,ho,mo),lp=Lt.runKernelFunc(function(vp){return vp.avgPool3dBackprop(rp,sp,ip)},{dy5D:rp,input5D:sp});return op?lp.as4D(lp.shape[1],lp.shape[2],lp.shape[3],lp.shape[4]):lp}(hn,an,Ge,$e,Mt,Ye,Qe)}}});return fn=fn.cast(an.dtype),sn?fn.as4D(fn.shape[1],fn.shape[2],fn.shape[3],fn.shape[4]):fn}}),ml=An({slice_:function(Ke,Ge,$e){var Ye,Qe,Je=mn(Ke,"x","slice");if(Je.rank===0)throw new Error("Slicing scalar is not possible");(Ye=typeof Ge=="number"?[Ge].concat(new Array(Je.rank-1).fill(0)):Ge.length<Je.rank?Ge.concat(new Array(Je.rank-Ge.length).fill(0)):Ge.slice()).forEach(function(an){C(an!==-1,function(){return"slice() does not support negative begin indexing."})}),Qe=(Qe=$e==null?new Array(Je.rank).fill(-1):typeof $e=="number"?[$e].concat(new Array(Je.rank-1).fill(-1)):$e.length<Je.rank?$e.concat(new Array(Je.rank-$e.length).fill(-1)):$e).map(function(an,sn){return an>=0?an:(C(an===-1,function(){return"Negative size values should be exactly -1 but got "+an+" for the slice() size at index "+sn+"."}),Je.shape[sn]-Ye[sn])}),eo(Je,Ye,Qe);var Mt=Je.shape,nn={begin:Ye,size:Qe};return Lt.runKernelFunc(function(an){return an.slice(Je,Ye,Qe)},{x:Je},function(an){for(var sn=[],ln=0;ln<an.rank;ln++)sn.push([Ye[ln],Mt[ln]-Ye[ln]-Qe[ln]]);return{x:function(){return an.pad(sn)}}},"Slice",nn)}}),gl=An({slice1d_:function(Ke,Ge,$e){var Ye=mn(Ke,"x","slice1d");return C(Ye.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+Ye.rank+" tensor"}),ml(Ye,[Ge],[$e])}}),yl=An({slice2d_:function(Ke,Ge,$e){var Ye=mn(Ke,"x","slice2d");return C(Ye.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+Ye.rank+" tensor"}),ml(Ye,Ge,$e)}}),xl=An({slice3d_:function(Ke,Ge,$e){var Ye=mn(Ke,"x","slice3d");return C(Ye.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+Ye.rank+" tensor"}),ml(Ye,Ge,$e)}}),bl=An({slice4d_:function(Ke,Ge,$e){var Ye=mn(Ke,"x","slice4d");return C(Ye.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+Ye.rank+" tensor"}),ml(Ye,Ge,$e)}});function wl(Ke,Ge,$e,Ye,Qe){return Ge.rank<$e.rank&&(Ge=Ge.reshape(wn(Ge.shape,Ye))),Ke.rank<$e.rank&&(Ke=Ke.reshape(wn(Ke.shape,Ye))),{x:function(){var Je=Ke.mul($e.equal(Ge).cast(Ke.dtype));return Qe==null?Je:Je.transpose(Qe)}}}var Cl=An({all_:function(Ke,Ge,$e){Ge===void 0&&(Ge=null),$e===void 0&&($e=!1);var Ye=mn(Ke,"x","all","bool"),Qe=O(Ge,Ye.shape),Je=Qe,Mt=En(Je,Ye.rank);Mt!=null&&(Ye=Ye.transpose(Mt),Je=In(Je.length,Ye.rank));var nn=Lt.runKernelFunc(function(sn){return sn.all(Ye,Je)},{$x:Ye});if($e){var an=wn(nn.shape,Qe);return nn.reshape(an)}return nn}}),El=An({any_:function(Ke,Ge,$e){Ge===void 0&&(Ge=null),$e===void 0&&($e=!1);var Ye=mn(Ke,"x","any","bool"),Qe=O(Ge,Ye.shape),Je=Qe,Mt=En(Je,Ye.rank);Mt!=null&&(Ye=Ye.transpose(Mt),Je=In(Je.length,Ye.rank));var nn=Lt.runKernelFunc(function(sn){return sn.any(Ye,Je)},{$x:Ye});if($e){var an=wn(nn.shape,Qe);return nn.reshape(an)}return nn}}),Rl=An({argMax_:function(Ke,Ge){Ge===void 0&&(Ge=0);var $e=mn(Ke,"x","argMax");Ge==null&&(Ge=0);var Ye=O(Ge,$e.shape),Qe=En(Ye,$e.rank);Qe!=null&&($e=$e.transpose(Qe),Ye=In(Ye.length,$e.rank));var Je={axis:Ye[0]},Mt=[$e];return Lt.runKernelFunc(function(nn,an){var sn=nn.argMax($e,Ye[0]);return an([$e]),sn},{x:$e},function(nn,an){var sn=an[0];return{x:function(){return Xn(sn)}}},"ArgMax",Je,Mt)}}),Il=An({argMin_:function(Ke,Ge){Ge===void 0&&(Ge=0);var $e=mn(Ke,"x","argMin");Ge==null&&(Ge=0);var Ye=O(Ge,$e.shape),Qe=En(Ye,$e.rank);return Qe!=null&&($e=$e.transpose(Qe),Ye=In(Ye.length,$e.rank)),Lt.runKernelFunc(function(Je,Mt){var nn=Je.argMin($e,Ye[0]);return Mt([$e]),nn},{$x:$e},function(Je,Mt){var nn=Mt[0];return{$x:function(){return Xn(nn)}}})}}),kl=An({logSumExp_:function(Ke,Ge,$e){Ge===void 0&&(Ge=null),$e===void 0&&($e=!1);var Ye=mn(Ke,"x","logSumExp"),Qe=O(Ge,Ye.shape),Je=Ye.max(Qe,!0),Mt=Ye.sub(Je).exp().sum(Qe).log(),nn=Je.reshape(Mt.shape).add(Mt);if($e){var an=wn(nn.shape,Qe);return nn.reshape(an)}return nn}}),Sl=An({max_:function(Ke,Ge,$e){Ge===void 0&&(Ge=null),$e===void 0&&($e=!1);var Ye=mn(Ke,"x","max"),Qe=Ye,Je=O(Ge,Ye.shape),Mt=Je,nn=En(Mt,Ye.rank);nn!=null&&(Ye=Ye.transpose(nn),Mt=In(Mt.length,Ye.rank));var an=[Ye],sn=Lt.runKernelFunc(function(fn,hn){var Xr=fn.max(Ye,Mt);return hn([Qe,Xr]),Xr},{x:Ye},function(fn,hn){return wl(fn,hn[1],hn[0],Je,nn)},"Max",{axes:Mt},an,[!0]);if($e){var ln=wn(sn.shape,Je);sn=sn.reshape(ln)}return sn}}),Al=An({mean_:function(Ke,Ge,$e){Ge===void 0&&(Ge=null),$e===void 0&&($e=!1);var Ye=mn(Ke,"x","mean"),Qe=O(Ge,Ye.shape),Je=k(bn(Ye.shape,Qe)[1]);return vo(function(Mt){var nn=On(Je);return{value:(nn.dtype===Mt.dtype?Mt:Mt.cast(nn.dtype)).div(nn).sum(Ge,$e),gradFunc:function(an){var sn=Mt.shape.slice();return Qe.forEach(function(ln){sn[ln]=1}),an.reshape(sn).mul(zn(Mt.shape,"float32")).div(Je)}}})(Ye)}}),Dl=An({min_:function(Ke,Ge,$e){Ge===void 0&&(Ge=null),$e===void 0&&($e=!1);var Ye=mn(Ke,"x","min"),Qe=Ye,Je=O(Ge,Ye.shape),Mt=Je,nn=En(Mt,Ye.rank);nn!=null&&(Ye=Ye.transpose(nn),Mt=In(Mt.length,Ye.rank));var an=[Ye],sn=Lt.runKernelFunc(function(fn,hn){var Xr=fn.min(Ye,Mt);return hn([Qe,Xr]),Xr},{x:Ye},function(fn,hn){return wl(fn,hn[1],hn[0],Je,nn)},"Min",{axes:Mt},an,[!0]);if($e){var ln=wn(sn.shape,Je);sn=sn.reshape(ln)}return sn}}),Tl=An({moments_:function(Ke,Ge,$e){Ge===void 0&&(Ge=null),$e===void 0&&($e=!1);var Ye=O(Ge,(Ke=mn(Ke,"x","moments")).shape),Qe=Ke.mean(Ye,$e),Je=Qe.shape;$e||(Je=wn(Qe.shape,Ye));var Mt=Ke.toFloat().sub(Qe.reshape(Je)).square();return{mean:Qe,variance:Mt.mean(Ye,$e)}}}),Nl=An({sum_:function(Ke,Ge,$e){Ge===void 0&&(Ge=null),$e===void 0&&($e=!1);var Ye=mn(Ke,"x","sum");Ye.dtype==="bool"&&(Ye=Ye.toInt());var Qe=O(Ge,Ye.shape);return vo(function(Je){var Mt=En(Qe,Je.rank),nn=Qe,an=Je;Mt!=null&&(an=Je.transpose(Mt),nn=In(nn.length,Je.rank));var sn=function(Xr){var Mi=Je.shape.slice();return Qe.forEach(function(co){Mi[co]=1}),Xr.reshape(Mi).mul(zn(Je.shape,"float32"))},ln={axes:nn},fn=Lt.runKernelFunc(function(Xr){return Xr.sum(an,nn)},{x:an},function(Xr){return{x:function(){return sn(Xr)}}},"Sum",ln);if($e){var hn=wn(fn.shape,Qe);fn=fn.reshape(hn)}return{value:fn,gradFunc:sn}})(Ye)}}),Fl=An({prod_:function(Ke,Ge,$e){Ge===void 0&&(Ge=null),$e===void 0&&($e=!1);var Ye=mn(Ke,"x","prod");Ye.dtype==="bool"&&(Ye=Ye.toInt());var Qe=O(Ge,Ye.shape),Je=En(Qe,Ye.rank),Mt=Qe,nn=Ye;Je!=null&&(nn=Ye.transpose(Je),Mt=In(Mt.length,Ye.rank));var an=Lt.runKernelFunc(function(ln){return ln.prod(nn,Mt)},{permutedX:nn});if($e){var sn=wn(an.shape,Qe);an=an.reshape(sn)}return an}}),_l=An({elu_:function(Ke){var Ge=mn(Ke,"x","elu");return Lt.runKernelFunc(function($e,Ye){var Qe=$e.elu(Ge);return Ye([Qe]),Qe},{$x:Ge},function($e,Ye){var Qe=Ye[0];return{$x:function(){return Lt.runKernelFunc(function(Je){return Je.eluDer($e,Qe)},{dy:$e,y:Qe})}}})}}),Ol=An({leakyRelu_:function(Ke,Ge){Ge===void 0&&(Ge=.2);var $e=mn(Ke,"x","leakyRelu");return hc(On(Ge).mul($e),$e)}}),Ml=An({prelu_:function(Ke,Ge){var $e=mn(Ke,"x","prelu"),Ye=mn(Ge,"alpha","prelu");return Lt.runKernelFunc(function(Qe,Je){var Mt=Qe.prelu($e,Ye);return Je([$e,Ye]),Mt},{x:$e,alpha:Ye},function(Qe,Je){var Mt=Je[0],nn=Je[1],an=Mt.greater(0);return{x:function(){return ec(an,Qe,Qe.mul(nn))},alpha:function(){var sn=ec(an,Xn(Qe),Qe.mul(Mt)),ln=Eo(nn.shape,Qe.shape);return ln.length>0&&(sn=sn.sum(ln)),sn.reshape(nn.shape)}}},"Prelu")}}),Bl=An({relu_:function(Ke){var Ge=mn(Ke,"x","relu");return Ge.dtype==="bool"?Ge.toInt():Lt.runKernelFunc(function($e,Ye){var Qe=$e.relu(Ge);return Ye([Ge]),Qe},{x:Ge},function($e,Ye){var Qe=Ye[0];return{x:function(){return $e.mulStrict(Qe.step().toFloat())}}},"Relu")}}),Pl=An({relu6_:function(Ke){var Ge=mn(Ke,"x","relu6");return Ge.dtype==="bool"?Ge.toInt():Lt.runKernelFunc(function($e,Ye){var Qe=$e.relu6(Ge);return Ye([Ge]),Qe},{x:Ge},function($e,Ye){var Qe=Ye[0],Je=Qe.lessEqual(6).mul(Qe.step());return{x:function(){return $e.mulStrict(Je.toFloat())}}},"Relu6")}}),Ll=An({selu_:function(Ke){var Ge=mn(Ke,"x","selu");return Lt.runKernelFunc(function($e,Ye){var Qe=$e.selu(Ge);return Ye([Ge]),Qe},{$x:Ge},function($e,Ye){var Qe=Ye[0];return{$x:function(){var Je=Qe.greater(On(0)),Mt=On(bs),nn=On(ws),an=$e.mul(nn),sn=$e.mul(Mt).mul(Qe.toFloat().exp());return ec(Je,an,sn)}}})}}),Wl=An({transpose_:function(Ke,Ge){var $e=mn(Ke,"x","transpose");if(Ge==null&&(Ge=$e.shape.map(function(Qe,Je){return Je}).reverse()),C($e.rank===Ge.length,function(){return"Error in transpose: rank of input "+$e.rank+" must match length of perm "+Ge+"."}),Ge.forEach(function(Qe){C(Qe>=0&&Qe<$e.rank,function(){return"All entries in 'perm' must be between 0 and "+($e.rank-1)+" but got "+Ge})}),$e.rank<=1)return $e.clone();var Ye={perm:Ge};return Lt.runKernelFunc(function(Qe){return Qe.transpose($e,Ge)},{x:$e},function(Qe){var Je=Rn(Ge);return{x:function(){return Qe.transpose(Je)}}},"Transpose",Ye)}}),Ul=An({localResponseNormalization_:function(Ke,Ge,$e,Ye,Qe){Ge===void 0&&(Ge=5),$e===void 0&&($e=1),Ye===void 0&&(Ye=1),Qe===void 0&&(Qe=.5);var Je=mn(Ke,"x","localResponseNormalization");C(Je.rank===4||Je.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+Je.rank+"."}),C(A(Ge),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+Ge+"."});var Mt=Je,nn=!1;Je.rank===3&&(nn=!0,Mt=Je.as4D(1,Je.shape[0],Je.shape[1],Je.shape[2]));var an=Lt.runKernelFunc(function(sn,ln){var fn=sn.localResponseNormalization4D(Mt,Ge,$e,Ye,Qe);return ln([Mt,fn]),fn},{x4D:Mt},function(sn,ln){var fn=ln[0],hn=ln[1];return{x4D:function(){return Lt.runKernelFunc(function(Xr){return Xr.LRNGrad(sn,fn,hn,Ge,$e,Ye,Qe)},{})}}});return nn?an.as3D(an.shape[1],an.shape[2],an.shape[3]):an}}),Vl=An({norm_:function(Ke,Ge,$e,Ye){Ge===void 0&&(Ge="euclidean"),$e===void 0&&($e=null),Ye===void 0&&(Ye=!1);var Qe=function nn(an,sn,ln){if(ln===void 0&&(ln=null),an.rank===0)return an.abs();if(an.rank!==1&&ln===null)return nn(an.reshape([-1]),sn,ln);if(an.rank===1||typeof ln=="number"||Array.isArray(ln)&&ln.length===1){if(sn===1)return an.abs().sum(ln);if(sn===1/0)return an.abs().max(ln);if(sn===-1/0)return an.abs().min(ln);if(sn==="euclidean"||sn===2)return an.abs().pow(On(2,"int32")).sum(ln).sqrt();throw new Error("Error in norm: invalid ord value: "+sn)}if(Array.isArray(ln)&&ln.length===2){if(sn===1)return an.abs().sum(ln[0]).max(ln[1]-1);if(sn===1/0)return an.abs().sum(ln[1]).max(ln[0]);if(sn===-1/0)return an.abs().sum(ln[1]).min(ln[0]);if(sn==="fro"||sn==="euclidean")return an.square().sum(ln).sqrt();throw new Error("Error in norm: invalid ord value: "+sn)}throw new Error("Error in norm: invalid axis: "+ln)}(Ke=mn(Ke,"x","norm"),Ge,$e),Je=Qe.shape;if(Ye){var Mt=O($e,Ke.shape);Je=wn(Qe.shape,Mt)}return Qe.reshape(Je)}}),zl=An({basicLSTMCell_:function(Ke,Ge,$e,Ye,Qe,Je){var Mt=mn(Ke,"forgetBias","basicLSTMCell"),nn=mn(Ge,"lstmKernel","basicLSTMCell"),an=mn($e,"lstmBias","basicLSTMCell"),sn=mn(Ye,"data","basicLSTMCell"),ln=mn(Qe,"c","basicLSTMCell"),fn=mn(Je,"h","basicLSTMCell"),hn=sn.concat(fn,1).matMul(nn).add(an),Xr=hn.shape[0],Mi=hn.shape[1]/4,co=[Xr,Mi],lo=hn.slice([0,0],co),uo=hn.slice([0,Mi],co),ho=hn.slice([0,2*Mi],co),mo=hn.slice([0,3*Mi],co),_d=lo.sigmoid().mulStrict(uo.tanh()).addStrict(ln.mulStrict(Mt.add(ho).sigmoid())),ep=_d.tanh().mulStrict(mo.sigmoid());return[_d,ep]}}),Gl=An({multiRNNCell_:function(Ke,Ge,$e,Ye){for(var Qe=mn(Ge,"data","multiRNNCell"),Je=gn($e,"c","multiRNNCell"),Mt=gn(Ye,"h","multiRNNCell"),nn=Qe,an=[],sn=0;sn<Ke.length;sn++){var ln=Ke[sn](nn,Je[sn],Mt[sn]);an.push(ln[0]),an.push(ln[1]),nn=ln[1]}var fn=[],hn=[];for(sn=0;sn<an.length;sn+=2)fn.push(an[sn]),hn.push(an[sn+1]);return[fn,hn]}}),Hl=An({movingAverage_:function(Ke,Ge,$e,Ye,Qe){Qe===void 0&&(Qe=!0);var Je=mn(Ke,"v","movingAverage"),Mt=mn(Ge,"x","movingAverage"),nn=mn($e,"decay","movingAverage");Ft(Je,Mt),C(S(Je.shape,Mt.shape),function(){return"Shape mismatch in v and x"});var an=On(1),sn=an.sub(nn),ln=Mt.sub(Je).mul(sn);if(Qe){C(Ye!=null,function(){return"When using zeroDebias: true, step is required."});var fn=mn(Ye,"step","movingAverage");ln=ln.div(an.sub(xc(nn,fn)))}return Je.add(ln)}}),ql=An({stridedSlice_:function(Ke,Ge,$e,Ye,Qe,Je,Mt,nn,an){if(Qe===void 0&&(Qe=0),Je===void 0&&(Je=0),Mt===void 0&&(Mt=0),nn===void 0&&(nn=0),an===void 0&&(an=0),Ye==null&&(Ye=new Array(Ge.length)),Mt!==0)throw new Error("ellipsis mask is not yet supported");var sn=mn(Ke,"x","stridedSlice"),ln=no(nn),fn=sn.shape.slice();ln.forEach(function(lo){Ge[lo]=0,$e[lo]=1,fn.splice(lo,0,1)}),sn=sn.reshape(fn);for(var hn=0;hn<sn.rank;hn++)Ge[hn]=oo(Qe,Ge,Ye,sn.shape,hn),$e[hn]=ao(Je,$e,Ye,sn.shape,hn),Ye[hn]=Ye[hn]||1;var Xr=no(an);Xr.forEach(function(lo){$e[lo]=Ge[lo]+1,Ye[lo]=1});var Mi=ro(Ge,$e,Ye),co=Mi.filter(function(lo,uo){return Xr.indexOf(uo)===-1});return Ye.every(function(lo){return lo===1})?ml(sn,Ge,Mi).reshape(co):Lt.runKernelFunc(function(lo){return lo.stridedSlice(sn,Ge,$e,Ye)},{$x:sn}).reshape(co)}}),Kl=An({topk_:function(Ke,Ge,$e){Ge===void 0&&(Ge=1),$e===void 0&&($e=!0);var Ye=mn(Ke,"x","topk");if(Ye.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var Qe=Ye.shape[Ye.shape.length-1];if(Ge>Qe)throw new Error("'k' passed to topk() must be <= the last dimension ("+Qe+") but got "+Ge);var Je=Lt.runKernelFunc(function(Mt){return Mt.topk(Ye,Ge,$e)},{$x:Ye});return{values:Je[0],indices:Je[1]}}}),jl=An({scatterND_:function(Ke,Ge,$e){var Ye=mn(Ke,"indices","scatterND","int32"),Qe=mn(Ge,"updates","scatterND");return Jr(Qe,Ye,$e),Lt.runKernelFunc(function(Je){return Je.scatterND(Ye,Qe,$e)},{indices:Ye,updates:Qe},null,"ScatterNd",{shape:$e})}}),Xl=An({fft_:function(Ke){C(Ke.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+Ke.dtype+"."});var Ge=Ke.shape[Ke.shape.length-1],$e=Ke.size/Ge,Ye=Ke.as2D($e,Ge);return Lt.runKernelFunc(function(Qe){return Qe.fft(Ye)},{input:Ke}).reshape(Ke.shape)}}),Yl=An({ifft_:function(Ke){C(Ke.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+Ke.dtype+"."});var Ge=Ke.shape[Ke.shape.length-1],$e=Ke.size/Ge,Ye=Ke.as2D($e,Ge);return Lt.runKernelFunc(function(Qe){return Qe.ifft(Ye)},{input:Ke}).reshape(Ke.shape)}}),$l=An({rfft_:function(Ke,Ge){C(Ke.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+Ke.dtype});var $e,Ye=Ke.shape[Ke.shape.length-1],Qe=Ke.size/Ye;if(Ge!=null&&Ge<Ye){var Je=Ke.shape.map(function(uo){return 0}),Mt=Ke.shape.map(function(uo){return uo});Mt[Ke.shape.length-1]=Ge,$e=Ke.slice(Je,Mt),Ye=Ge}else if(Ge!=null&&Ge>Ye){var nn=Ke.shape.map(function(uo){return uo});nn[Ke.shape.length-1]=Ge-Ye,$e=Ke.concat(Gn(nn),Ke.shape.length-1),Ye=Ge}else $e=Ke;var an=$e.zerosLike(),sn=Dn($e,an).as2D(Qe,Ye),ln=Xl(sn),fn=Math.floor(Ye/2)+1,hn=Tn(ln),Xr=Nn(ln),Mi=hn.split([fn,Ye-fn],hn.shape.length-1),co=Xr.split([fn,Ye-fn],Xr.shape.length-1),lo=$e.shape.slice();return lo[$e.shape.length-1]=fn,Dn(Mi[0],co[0]).reshape(lo)}}),Ql=An({irfft_:function(Ke){var Ge=Ke.shape[Ke.shape.length-1],$e=Ke.size/Ge;if(Ge<=2){var Ye=Ke.as2D($e,Ge),Qe=Yl(Ye);return Tn(Qe)}var Je=[$e,2*(Ge-1)],Mt=Tn(Ke).as2D($e,Ge),nn=Nn(Ke).as2D($e,Ge),an=Mt.slice([0,1],[$e,Ge-2]).reverse(1),sn=nn.slice([0,1],[$e,Ge-2]).reverse(1).mul(On(-1)),ln=Mt.concat(an,1),fn=nn.concat(sn,1);return Ye=Dn(ln,fn).as2D(Je[0],Je[1]),Qe=Yl(Ye),Tn(Qe)}}),Jl=Object.freeze({fft:Xl,ifft:Yl,rfft:$l,irfft:Ql}),Zl=An({sparseToDense_:function(Ke,Ge,$e,Ye){Ye===void 0&&(Ye=0);var Qe=mn(Ke,"sparseIndices","sparseToDense","int32"),Je=mn(Ge,"sparseValues","sparseToDense"),Mt=mn(Ye,"defaultValue","sparseToDense",Je.dtype);return function(nn,an,sn,ln){if(nn.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+nn.dtype+".");if(nn.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+nn.shape+".");var fn=nn.rank>0?nn.shape[0]:1,hn=nn.rank>1?nn.shape[1]:1;if(sn.length!==hn)throw new Error("outputShape has incorrect number of elements:, "+sn.length+", should be: "+hn+".");var Xr=an.size;if(an.rank!==0&&(an.rank!==1||Xr!==fn))throw new Error("sparseValues has incorrect shape "+an.shape+", should be [] or ["+fn+"]");if(an.dtype!==ln.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(Qe,Je,$e,Mt),Lt.runKernelFunc(function(nn){return nn.sparseToDense(Qe,Je,$e,Mt)},{$sparseIndices:Qe,$sparseValues:Je,$defaultValue:Mt})}}),th=An({gatherND_:function(Ke,Ge){var $e=mn(Ge,"indices","gatherND","int32"),Ye=mn(Ke,"x","gatherND");return Lt.runKernelFunc(function(Qe){return Qe.gatherND(Ye,$e)},{x:Ye,indices:$e},null,"GatherNd")}}),eh=An({diag_:function(Ke){var Ge=mn(Ke,"x","diag").flatten(),$e=Ke.shape.concat(Ke.shape);return Lt.runKernelFunc(function(Ye){return Ye.diag(Ge)},{$x:Ge}).reshape($e)}}),nh=An({dropout_:function(Ke,Ge,$e,Ye){var Qe=mn(Ke,"x","dropout");if(C(Qe.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+Qe.dtype+" tensor instead."}),C(Ge>=0&&Ge<1,function(){return"rate must be a float in the range [0, 1), but got "+Ge+"."}),Ge===0)return Ke instanceof wt?Qe.clone():Qe;var Je=function(an,sn){if(sn==null)return an.shape.slice();if(S(an.shape,sn))return sn;if(an.shape.length===sn.length){for(var ln=[],fn=0;fn<an.shape.length;fn++)sn[fn]==null&&an.shape[fn]!=null?ln.push(an.shape[fn]):ln.push(sn[fn]);return ln}return sn}(Qe,$e),Mt=1-Ge,nn=_r(Je,0,1,"float32",Ye).add(Mt).floor().div(Mt);return Qe.mul(nn)}});function rh(Ke,Ge,$e){for(var Ye=1-Ke%2,Qe=new Float32Array(Ke),Je=0;Je<Ke;++Je){var Mt=2*Math.PI*Je/(Ke+Ye-1);Qe[Je]=Ge-$e*Math.cos(Mt)}return Mn(Qe,"float32")}var oh=An({hannWindow_:function(Ke){return rh(Ke,.5,.5)}}),ah=An({hammingWindow_:function(Ke){return rh(Ke,.54,.46)}}),ih=An({frame_:function(Ke,Ge,$e,Ye,Qe){Ye===void 0&&(Ye=!1),Qe===void 0&&(Qe=0);for(var Je=0,Mt=[];Je+Ge<=Ke.size;)Mt.push(ml(Ke,Je,Ge)),Je+=$e;if(Ye)for(;Je<Ke.size;){var nn=Je+Ge-Ke.size,an=Yn([ml(Ke,Je,Ge-nn),Hn([nn],Qe)]);Mt.push(an),Je+=$e}return Mt.length===0?Bn([],[0,Ge]):Yn(Mt).as2D(Mt.length,Ge)}}),sh=An({stft_:function(Ke,Ge,$e,Ye,Qe){var Je;Qe===void 0&&(Qe=oh),Ye==null&&(Je=Ge,Ye=Math.floor(Math.pow(2,Math.ceil(Math.log(Je)/Math.log(2)))));for(var Mt=ih(Ke,Ge,$e),nn=gc(Mt,Qe(Ge)),an=[],sn=0;sn<Mt.shape[0];sn++)an.push($l(nn.slice([sn,0],[1,Ge]),Ye));return Yn(an)}}),uh=Object.freeze({hannWindow:oh,hammingWindow:ah,frame:ih,stft:sh}),ch,lh=function(Ke,Ge,$e){return $e===void 0&&($e=1),n(this,void 0,void 0,function(){var Ye,Qe,Je,Mt,nn,an,sn,ln,fn,hn,Xr,Mi,co,lo;return r(this,function(uo){switch(uo.label){case 0:return Ye=mn(Ke,"predictions","inTopK"),Qe=mn(Ge,"targets","inTopK"),C(Ye.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+Ye.rank}),C(Ye.rank-1===Qe.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+Ye.rank+" and targets rank "+Qe.rank}),E(Ye.shape.slice(0,Ye.shape.length-1),Qe.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),Je=Ye.shape[Ye.shape.length-1],C($e>0&&$e<=Je,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+Je+"), but got "+$e}),[4,Ye.data()];case 1:return Mt=uo.sent(),[4,Qe.data()];case 2:for(nn=uo.sent(),an=[Mt.length/Je,Je],ln=an[1],fn=B("bool",sn=an[0]),hn=0;hn<sn;hn++){for(Xr=hn*ln,Mi=Mt.subarray(Xr,Xr+ln),co=[],lo=0;lo<Mi.length;lo++)co.push({value:Mi[lo],index:lo});for(co.sort(function(ho,mo){return mo.value-ho.value}),fn[hn]=0,lo=0;lo<$e;lo++)if(co[lo].index===nn[hn]){fn[hn]=1;break}}return Ke!==Ye&&Ye.dispose(),Ge!==Qe&&Qe.dispose(),[2,Fn(fn,Qe.shape,"bool")]}})})};(function(Ke){Ke[Ke.NONE=0]="NONE",Ke[Ke.MEAN=1]="MEAN",Ke[Ke.SUM=2]="SUM",Ke[Ke.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(ch||(ch={}));var hh=An({absoluteDifference_:function(Ke,Ge,$e,Ye){Ye===void 0&&(Ye=ch.SUM_BY_NONZERO_WEIGHTS);var Qe=mn(Ke,"labels","absoluteDifference"),Je=mn(Ge,"predictions","absoluteDifference"),Mt=null;$e!=null&&(Mt=mn($e,"weights","absoluteDifference")),E(Qe.shape,Je.shape,"Error in absoluteDifference: ");var nn=Qe.sub(Je).abs();return fh(nn,Mt,Ye)}}),fh=An({computeWeightedLoss_:function(Ke,Ge,$e){$e===void 0&&($e=ch.SUM_BY_NONZERO_WEIGHTS);var Ye=mn(Ke,"losses","computeWeightedLoss"),Qe=null;Ge!=null&&(Qe=mn(Ge,"weights","computeWeightedLoss"));var Je=Qe==null?Ye:Ye.mul(Qe);if($e===ch.NONE)return Je;if($e===ch.SUM)return Je.sum();if($e===ch.MEAN){if(Qe==null)return Je.mean();var Mt=Ye.size/Qe.size,nn=Je.sum().div(Qe.sum());return Mt>1?nn.div(On(Mt)):nn}if($e===ch.SUM_BY_NONZERO_WEIGHTS){if(Qe==null)return Je.sum().div(On(Ye.size));var an=Qe.mul(zn(Ye.shape)).notEqual(On(0)).sum().toFloat();return Je.sum().div(an)}throw Error("Unknown reduction: "+$e)}}),dh=An({cosineDistance_:function(Ke,Ge,$e,Ye,Qe){Qe===void 0&&(Qe=ch.SUM_BY_NONZERO_WEIGHTS);var Je=mn(Ke,"labels","cosineDistance"),Mt=mn(Ge,"predictions","cosineDistance"),nn=null;Ye!=null&&(nn=mn(Ye,"weights","cosineDistance")),E(Je.shape,Mt.shape,"Error in cosineDistance: ");var an=On(1).sub(Je.mul(Mt).sum($e,!0));return fh(an,nn,Qe)}}),ph=An({hingeLoss_:function(Ke,Ge,$e,Ye){Ye===void 0&&(Ye=ch.SUM_BY_NONZERO_WEIGHTS);var Qe=mn(Ke,"labels","hingeLoss"),Je=mn(Ge,"predictions","hingeLoss"),Mt=null;$e!=null&&(Mt=mn($e,"weights","hingeLoss")),E(Qe.shape,Je.shape,"Error in hingeLoss: ");var nn=On(1);Qe=On(2).mul(Qe).sub(nn);var an=nn.sub(Qe.mul(Je)).relu();return fh(an,Mt,Ye)}}),vh=An({huberLoss_:function(Ke,Ge,$e,Ye,Qe){Ye===void 0&&(Ye=1),Qe===void 0&&(Qe=ch.SUM_BY_NONZERO_WEIGHTS);var Je=mn(Ke,"labels","huberLoss"),Mt=mn(Ge,"predictions","huberLoss"),nn=null;$e!=null&&(nn=mn($e,"weights","huberLoss")),E(Je.shape,Mt.shape,"Error in huberLoss: ");var an=On(Ye),sn=Mt.sub(Je).abs(),ln=dc(sn,an),fn=sn.sub(ln),hn=On(.5).mul(ln.square()).add(an.mul(fn));return fh(hn,nn,Qe)}}),mh=An({logLoss_:function(Ke,Ge,$e,Ye,Qe){Ye===void 0&&(Ye=1e-7),Qe===void 0&&(Qe=ch.SUM_BY_NONZERO_WEIGHTS);var Je=mn(Ke,"labels","logLoss"),Mt=mn(Ge,"predictions","logLoss"),nn=null;$e!=null&&(nn=mn($e,"weights","logLoss")),E(Je.shape,Mt.shape,"Error in logLoss: ");var an=On(1),sn=On(Ye),ln=Je.mul(Mt.add(sn).log()).neg().sub(an.sub(Je).mul(an.sub(Mt).add(sn).log()));return fh(ln,nn,Qe)}}),gh=An({meanSquaredError_:function(Ke,Ge,$e,Ye){Ye===void 0&&(Ye=ch.SUM_BY_NONZERO_WEIGHTS);var Qe=mn(Ke,"labels","meanSquaredError"),Je=mn(Ge,"predictions","meanSquaredError"),Mt=null;$e!=null&&(Mt=mn($e,"weights","meanSquaredError")),E(Qe.shape,Je.shape,"Error in meanSquaredError: ");var nn=Qe.squaredDifference(Je);return fh(nn,Mt,Ye)}}),yh=An({sigmoidCrossEntropy_:function(Ke,Ge,$e,Ye,Qe){Ye===void 0&&(Ye=0),Qe===void 0&&(Qe=ch.SUM_BY_NONZERO_WEIGHTS);var Je=mn(Ke,"multiClassLabels","sigmoidCrossEntropy"),Mt=mn(Ge,"logits","sigmoidCrossEntropy"),nn=null;if($e!=null&&(nn=mn($e,"weights","sigmoidCrossEntropy")),E(Je.shape,Mt.shape,"Error in sigmoidCrossEntropy: "),Ye>0){var an=On(Ye),sn=On(1),ln=On(.5);Je=Je.mul(sn.sub(an)).add(ln.mul(an))}var fn=function(hn,Xr){var Mi=mn(hn,"labels","sigmoidCrossEntropyWithLogits"),co=mn(Xr,"logits","sigmoidCrossEntropyWithLogits");E(Mi.shape,co.shape,"Error in sigmoidCrossEntropyWithLogits: ");var lo=co.relu(),uo=co.mul(Mi),ho=co.abs().neg().exp().log1p();return lo.sub(uo).add(ho)}(Je,Mt);return fh(fn,nn,Qe)}}),xh=An({softmaxCrossEntropy_:function(Ke,Ge,$e,Ye,Qe){Ye===void 0&&(Ye=0),Qe===void 0&&(Qe=ch.SUM_BY_NONZERO_WEIGHTS);var Je=mn(Ke,"onehotLabels","softmaxCrossEntropy"),Mt=mn(Ge,"logits","softmaxCrossEntropy"),nn=null;if($e!=null&&(nn=mn($e,"weights","softmaxCrossEntropy")),E(Je.shape,Mt.shape,"Error in softmaxCrossEntropy: "),Ye>0){var an=On(Ye),sn=On(1),ln=On(Je.shape[1]);Je=Je.mul(sn.sub(an)).add(an.div(ln))}var fn=function(hn,Xr,Mi){if(Mi===void 0&&(Mi=-1),Mi===-1&&(Mi=Xr.rank-1),Mi!==Xr.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+Xr.rank+" and dim was "+Mi);return vo(function(co,lo,uo){var ho=lo.logSumExp([Mi],!0),mo=lo.toFloat().sub(ho);return uo([co,mo]),{value:mo.mul(co).neg().sum([Mi]),gradFunc:function(_d,ep){var rp=ep[0],sp=ep[1],op=wn(_d.shape,[Mi]);return[_d.reshape(op).mul(rp.toFloat().sub(sp.exp())),_d.reshape(op).mul(sp.exp().sub(rp.toFloat()))]}}})(hn,Xr)}(Je,Mt);return fh(fn,nn,Qe)}}),bh=Object.freeze({get Reduction(){return ch},absoluteDifference:hh,computeWeightedLoss:fh,cosineDistance:dh,hingeLoss:ph,huberLoss:vh,logLoss:mh,meanSquaredError:gh,sigmoidCrossEntropy:yh,softmaxCrossEntropy:xh});function wh(Ke,Ge){return Ge===void 0&&(Ge=!1),Lt.tidy(function(){if(Ke.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+Ke.shape.length+"D Tensor.");for(var $e=Ke.shape[0],Ye=Ke.shape[1],Qe=Cr($e),Je=Ke.clone(),Mt=Bn([[1]],[1,1]),nn=Mt.clone(),an=$e>=Ye?Ye:$e,sn=function(fn){var hn,Xr=Je,Mi=nn,co=Qe;hn=Lt.tidy(function(){var lo=Je.slice([fn,fn],[$e-fn,1]),uo=lo.norm(),ho=Je.slice([fn,fn],[1,1]),mo=Bn([[-1]]).where(ho.greater(0),Bn([[1]])),_d=ho.sub(mo.mul(uo)),ep=lo.div(_d);nn=ep.shape[0]===1?Mt.clone():Mt.concat(ep.slice([1,0],[ep.shape[0]-1,ep.shape[1]]),0);var rp=mo.matMul(_d).div(uo).neg(),sp=Je.slice([fn,0],[$e-fn,Ye]),op=rp.mul(nn);if(fn===0)Je=sp.sub(op.matMul(nn.transpose().matMul(sp)));else{var ip=sp.sub(op.matMul(nn.transpose().matMul(sp)));Je=Je.slice([0,0],[fn,Ye]).concat(ip,0)}var lp=Qe.slice([0,fn],[$e,Qe.shape[1]-fn]);if(fn===0)Qe=lp.sub(lp.matMul(nn).matMul(op.transpose()));else{var vp=lp.sub(lp.matMul(nn).matMul(op.transpose()));Qe=Qe.slice([0,0],[$e,fn]).concat(vp,1)}return[nn,Je,Qe]}),nn=hn[0],Je=hn[1],Qe=hn[2],tn([Xr,Mi,co])},ln=0;ln<an;++ln)sn(ln);return!Ge&&$e>Ye&&(Qe=Qe.slice([0,0],[$e,Ye]),Je=Je.slice([0,0],[Ye,Ye])),[Qe,Je]})}var Ch=An({bandPart_:function(Ke,Ge,$e){if(Ge%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+Ge+".");if($e%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+$e+".");var Ye=mn(Ke,"a","bandPart");if(Ye.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+Ye.rank+".");var Qe=Ye.shape,Je=Ye.shape.slice(-2),Mt=Je[0],nn=Je[1];if(!(Ge<=Mt))throw new Error("bandPart(): numLower ("+Ge+") must not be greater than the number of rows ("+Mt+").");if(!($e<=nn))throw new Error("bandPart(): numUpper ("+$e+") must not be greater than the number of columns ("+nn+").");Ge<0&&(Ge=Mt),$e<0&&($e=nn);var an=Kn(0,Mt,1,"int32").reshape([-1,1]),sn=Kn(0,nn,1,"int32"),ln=Cc(an,sn),fn=Qu(ln.lessEqual(On(+Ge,"int32")),ln.greaterEqual(On(-$e,"int32"))),hn=Gn([Mt,nn],Ye.dtype);return Pr(Ur(Ye.reshape([-1,Mt,nn])).map(function(Xr){return ec(fn,Xr,hn)})).reshape(Qe)}}),Eh=An({gramSchmidt_:function(Ke){var Ge;if(Array.isArray(Ke)){Ge=!1,C(Ke!=null&&Ke.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var $e=Ke[0].shape[0],Ye=function(an){C(Ke[an].shape[0]===$e,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+Ke[an].shape[0]+" vs. "+$e+")"})},Qe=1;Qe<Ke.length;++Qe)Ye(Qe)}else Ge=!0,Ke=tr(Ke,Ke.shape[0],0).map(function(an){return Br(an,[0])});C(Ke.length<=Ke[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+Ke.length+") exceeds number of dimensions ("+Ke[0].shape[0]+")."});var Je=[],Mt=Ke,nn=function(an){Je.push(Lt.tidy(function(){var sn=Mt[an];if(an>0)for(var ln=0;ln<an;++ln){var fn=Nl(Je[ln].mulStrict(sn)).mul(Je[ln]);sn=sn.sub(fn)}return sn.div(Vl(sn,"euclidean"))}))};for(Qe=0;Qe<Ke.length;++Qe)nn(Qe);return Ge?Pr(Je,0):Je}}),Rh=An({qr_:function(Ke,Ge){if(Ge===void 0&&(Ge=!1),Ke.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+Ke.rank);if(Ke.rank===2)return wh(Ke,Ge);var $e=Ke.shape.slice(0,Ke.shape.length-2).reduce(function(Mt,nn){return Mt*nn}),Ye=Ur(Ke.reshape([$e,Ke.shape[Ke.shape.length-2],Ke.shape[Ke.shape.length-1]]),0),Qe=[],Je=[];return Ye.forEach(function(Mt){var nn=wh(Mt,Ge),an=nn[0],sn=nn[1];Qe.push(an),Je.push(sn)}),[Pr(Qe,0).reshape(Ke.shape),Pr(Je,0).reshape(Ke.shape)]}}),Ih=Object.freeze({bandPart:Ch,gramSchmidt:Eh,qr:Rh});function kh(Ke,Ge,$e,Ye,Qe,Je){Ye==null&&(Ye=.5),Qe==null&&(Qe=Number.NEGATIVE_INFINITY),Je==null&&(Je=0);var Mt=Ke.shape[0];return $e=Math.min($e,Mt),C(0<=Ye&&Ye<=1,function(){return"iouThreshold must be in [0, 1], but was '"+Ye+"'"}),C(Ke.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+Ke.rank+"'"}),C(Ke.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+Ke.shape[1]}),C(Ge.rank===1,function(){return"scores must be a 1D tensor"}),C(Ge.shape[0]===Mt,function(){return"scores has incompatible shape with boxes. Expected "+Mt+", but was "+Ge.shape[0]}),C(0<=Je&&Je<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+Je+"'"}),{maxOutputSize:$e,iouThreshold:Ye,scoreThreshold:Qe,softNmsSigma:Je}}var Sh=An({resizeBilinear_:function(Ke,Ge,$e){$e===void 0&&($e=!1);var Ye=mn(Ke,"images","resizeBilinear");C(Ye.rank===3||Ye.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+Ye.rank+"."}),C(Ge.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+Ge+"."});var Qe=Ye,Je=!1;Ye.rank===3&&(Je=!0,Qe=Ye.as4D(1,Ye.shape[0],Ye.shape[1],Ye.shape[2]));var Mt=Ge[0],nn=Ge[1],an=Lt.runKernelFunc(function(sn,ln){return ln([Qe]),sn.resizeBilinear(Qe,Mt,nn,$e)},{x:Qe},function(sn,ln){return{x:function(){return Lt.runKernelFunc(function(fn){return fn.resizeBilinearBackprop(sn,ln[0],$e)},{})}}},"ResizeBilinear",{alignCorners:$e,newHeight:Mt,newWidth:nn});return Je?an.as3D(an.shape[1],an.shape[2],an.shape[3]):an}}),Ah=An({resizeNearestNeighbor_:function(Ke,Ge,$e){$e===void 0&&($e=!1);var Ye=mn(Ke,"images","resizeNearestNeighbor");C(Ye.rank===3||Ye.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+Ye.rank+"."}),C(Ge.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+Ge+"."}),C(Ye.dtype==="float32"||Ye.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"});var Qe=Ye,Je=!1;Ye.rank===3&&(Je=!0,Qe=Ye.as4D(1,Ye.shape[0],Ye.shape[1],Ye.shape[2]));var Mt=Ge[0],nn=Ge[1],an=Lt.runKernelFunc(function(sn,ln){return ln([Qe]),sn.resizeNearestNeighbor(Qe,Mt,nn,$e)},{batchImages:Qe},function(sn,ln){return{batchImages:function(){return Lt.runKernelFunc(function(fn){return fn.resizeNearestNeighborBackprop(sn,ln[0],$e)},{})}}});return Je?an.as3D(an.shape[1],an.shape[2],an.shape[3]):an}}),Dh=An({nonMaxSuppression_:function(Ke,Ge,$e,Ye,Qe){Ye===void 0&&(Ye=.5),Qe===void 0&&(Qe=Number.NEGATIVE_INFINITY);var Je=mn(Ke,"boxes","nonMaxSuppression"),Mt=mn(Ge,"scores","nonMaxSuppression"),nn=kh(Je,Mt,$e,Ye,Qe);$e=nn.maxOutputSize,Ye=nn.iouThreshold,Qe=nn.scoreThreshold;var an={maxOutputSize:$e,iouThreshold:Ye,scoreThreshold:Qe};return Lt.runKernelFunc(function(sn){return sn.nonMaxSuppression(Je,Mt,$e,Ye,Qe)},{boxes:Je,scores:Mt},null,"NonMaxSuppressionV3",an)}}),Th=function(Ke,Ge,$e,Ye,Qe){return Ye===void 0&&(Ye=.5),Qe===void 0&&(Qe=Number.NEGATIVE_INFINITY),n(this,void 0,void 0,function(){var Je,Mt,nn,an,sn,ln,fn;return r(this,function(hn){switch(hn.label){case 0:return Je=mn(Ke,"boxes","nonMaxSuppressionAsync"),Mt=mn(Ge,"scores","nonMaxSuppressionAsync"),nn=kh(Je,Mt,$e,Ye,Qe),$e=nn.maxOutputSize,Ye=nn.iouThreshold,Qe=nn.scoreThreshold,[4,Promise.all([Je.data(),Mt.data()])];case 1:return an=hn.sent(),sn=an[0],ln=an[1],fn=jo(sn,ln,$e,Ye,Qe),Je!==Ke&&Je.dispose(),Mt!==Ge&&Mt.dispose(),[2,fn]}})})},Nh=An({nonMaxSuppressionWithScore_:function(Ke,Ge,$e,Ye,Qe,Je){Ye===void 0&&(Ye=.5),Qe===void 0&&(Qe=Number.NEGATIVE_INFINITY),Je===void 0&&(Je=0);var Mt=mn(Ke,"boxes","nonMaxSuppression"),nn=mn(Ge,"scores","nonMaxSuppression"),an=kh(Mt,nn,$e,Ye,Qe,Je),sn={maxOutputSize:$e=an.maxOutputSize,iouThreshold:Ye=an.iouThreshold,scoreThreshold:Qe=an.scoreThreshold,softNmsSigma:Je=an.softNmsSigma},ln=Lt.runKernel("NonMaxSuppressionV5",{boxes:Mt,scores:nn},sn);return{selectedIndices:ln[0],selectedScores:ln[1]}}}),Fh=function(Ke,Ge,$e,Ye,Qe,Je){return Ye===void 0&&(Ye=.5),Qe===void 0&&(Qe=Number.NEGATIVE_INFINITY),Je===void 0&&(Je=0),n(this,void 0,void 0,function(){var Mt,nn,an,sn,ln,fn,hn;return r(this,function(Xr){switch(Xr.label){case 0:return Mt=mn(Ke,"boxes","nonMaxSuppressionAsync"),nn=mn(Ge,"scores","nonMaxSuppressionAsync"),an=kh(Mt,nn,$e,Ye,Qe,Je),$e=an.maxOutputSize,Ye=an.iouThreshold,Qe=an.scoreThreshold,Je=an.softNmsSigma,[4,Promise.all([Mt.data(),nn.data()])];case 1:return sn=Xr.sent(),ln=sn[0],fn=sn[1],hn=Xo(ln,fn,$e,Ye,Qe,Je),Mt!==Ke&&Mt.dispose(),nn!==Ge&&nn.dispose(),[2,hn]}})})},_h=An({cropAndResize_:function(Ke,Ge,$e,Ye,Qe,Je){var Mt=mn(Ke,"image","cropAndResize"),nn=mn(Ge,"boxes","cropAndResize","float32"),an=mn($e,"boxInd","cropAndResize","int32");Qe=Qe||"bilinear",Je=Je||0;var sn=nn.shape[0];return C(Mt.rank===4,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+Mt.rank+"."}),C(nn.rank===2&&nn.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+sn+",4] but had shape "+nn.shape+"."}),C(an.rank===1&&an.shape[0]===sn,function(){return"Error in cropAndResize: boxInd must be have size ["+sn+"] but had shape "+nn.shape+"."}),C(Ye.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+Ye.length+"."}),C(Ye[0]>=1&&Ye[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+Ye}),C(Qe==="bilinear"||Qe==="nearest",function(){return"method must be bilinear or nearest, but was "+Qe}),Lt.runKernelFunc(function(ln,fn){return ln.cropAndResize(Mt,nn,an,Ye,Qe,Je)},{images:Mt,boxes:nn,boxInd:an},null,"CropAndResize",{method:Qe,extrapolationValue:Je,cropSize:Ye})}}),Oh=Object.freeze({resizeBilinear:Sh,resizeNearestNeighbor:Ah,nonMaxSuppression:Dh,nonMaxSuppressionAsync:Th,nonMaxSuppressionWithScore:Nh,nonMaxSuppressionWithScoreAsync:Fh,cropAndResize:_h}),Mh=function(Ke,Ge){return!(Ke>0)||Ge==="linear"},Bh=function(Ke,Ge,$e){if($e==null||$e==="linear")return Ke;if($e==="relu")return Ke.mul(Ge.step());throw new Error("Gradient for activation "+$e+" has not been implemented yet.")},Ph=function(Ke,Ge){var $e=Ge,Ye=Eo(Ke.shape,Ge.shape);return Ye.length>0&&($e=$e.sum(Ye)),$e.reshape(Ke.shape)},Lh=function(Ke,Ge,$e){if(Ge==="linear")return Ke;if(Ge==="relu")return Bl(Ke);if(Ge==="elu")return _l(Ke);if(Ge==="relu6")return Pl(Ke);if(Ge==="prelu")return Ml(Ke,$e);throw new Error("Unknown fused activation "+Ge+".")},Wh=An({fusedMatMul_:function(Ke){var Ge,$e=Ke.a,Ye=Ke.b,Qe=Ke.transposeA,Je=Qe!==void 0&&Qe,Mt=Ke.transposeB,nn=Mt!==void 0&&Mt,an=Ke.bias,sn=Ke.activation,ln=sn===void 0?"linear":sn,fn=Ke.preluActivationWeights;if(Mh(Lt.state.gradientDepth,ln)===!1){var hn=el($e,Ye,Je,nn);return an!=null&&(hn=rc(hn,an)),Lh(hn,ln,fn)}var Xr=mn($e,"a","fused matMul"),Mi=mn(Ye,"b","fused matMul");Ge=Nt(Xr,Mi),Xr=Ge[0],Mi=Ge[1];var co=Je?Xr.shape[Xr.rank-2]:Xr.shape[Xr.rank-1],lo=nn?Mi.shape[Mi.rank-1]:Mi.shape[Mi.rank-2],uo=Je?Xr.shape[Xr.rank-1]:Xr.shape[Xr.rank-2],ho=nn?Mi.shape[Mi.rank-2]:Mi.shape[Mi.rank-1],mo=Xr.shape.slice(0,-2),_d=Mi.shape.slice(0,-2),ep=k(mo),rp=k(_d);C(Xr.rank>=2&&Mi.rank>=2&&Xr.rank===Mi.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+Xr.rank+" and "+Mi.rank+"."}),C(S(mo,_d),function(){return"Error in fused matMul: outer dimensions ("+mo+") and ("+_d+") of Tensors with shapes "+Xr.shape+" and "+Mi.shape+" must match."}),C(co===lo,function(){return"Error in fused matMul: inner shapes ("+co+") and ("+lo+") of Tensors with shapes "+Xr.shape+" and "+Mi.shape+" and transposeA="+Je+" and transposeB="+nn+" must match."});var sp,op,ip=Xr.shape.slice(0,-2).concat([uo,ho]),lp=Je?Xr.as3D(ep,co,uo):Xr.as3D(ep,uo,co),vp=nn?Mi.as3D(rp,ho,lo):Mi.as3D(rp,lo,ho);an!=null&&Ro(ip,(sp=Nt(sp=mn(an,"bias","fused matMul"),Xr)[0]).shape),fn!=null&&(op=mn(fn,"prelu weights","fused matMul"));var gp={a:lp,b:vp};an!=null&&(gp.bias=sp),fn!=null&&(gp.preluActivationWeights=op);var Op=[lp,vp];return Lt.runKernelFunc(function(Mp,Np){var wp=Mp.fusedBatchMatMul({a:lp,b:vp,transposeA:Je,transposeB:nn,bias:sp,activation:ln,preluActivationWeights:op});return Np([lp,vp,wp]),wp},gp,function(Mp,Np){var wp=Np[0],Sp=Np[1],Cp=Np[2],Ip=Bh(Mp,Cp,ln),cp={};return an!=null&&(cp={bias:function(){return Ph(sp,Ip)}}),Object.assign(Je||nn?!Je&&nn?{a:function(){return Ip.matMul(Sp,!1,!1)},b:function(){return Ip.matMul(wp,!0,!1)}}:Je&&!nn?{a:function(){return Sp.matMul(Ip,!1,!0)},b:function(){return wp.matMul(Ip,!1,!1)}}:{a:function(){return Sp.matMul(Ip,!0,!0)},b:function(){return Ip.matMul(wp,!0,!0)}}:{a:function(){return Ip.matMul(Sp,!1,!0)},b:function(){return wp.matMul(Ip,!0,!1)}},cp)},"_FusedMatMul",{transposeA:Je,transposeB:nn,activation:ln},Op,[!0]).reshape(ip)}}),Uh=An({fusedConv2d_:function(Ke){var Ge=Ke.x,$e=Ke.filter,Ye=Ke.strides,Qe=Ke.pad,Je=Ke.dataFormat,Mt=Je===void 0?"NHWC":Je,nn=Ke.dilations,an=nn===void 0?[1,1]:nn,sn=Ke.dimRoundingMode,ln=Ke.bias,fn=Ke.activation,hn=fn===void 0?"linear":fn,Xr=Ke.preluActivationWeights;if(hn=hn||"linear",Mh(Lt.state.gradientDepth,hn)===!1){var Mi=qc(Ge,$e,Ye,Qe,Mt,an,sn);return ln!=null&&(Mi=rc(Mi,ln)),Lh(Mi,hn,Xr)}var co=mn(Ge,"x","conv2d"),lo=mn($e,"filter","conv2d"),uo=co,ho=!1;co.rank===3&&(ho=!0,uo=co.as4D(1,co.shape[0],co.shape[1],co.shape[2])),C(uo.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+uo.rank+"."}),C(lo.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+lo.rank+"."}),sn!=null&&C(A(Qe),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+sn+" but got pad "+Qe+"."}),C(uo.shape[3]===lo.shape[2],function(){return"Error in conv2d: depth of input ("+uo.shape[3]+") must match input depth for filter "+lo.shape[2]+"."}),C(Mo(Ye,an),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+Ye+" and dilations '"+an+"'"}),C(Mt==="NHWC",function(){return"Error in conv2d: got dataFormat of "+Mt+" but only NHWC is currently supported."});var mo,_d,ep=So(uo.shape,lo.shape,Ye,an,Qe,sn);ln!=null&&(mo=Nt(mo=mn(ln,"bias","fused conv2d"),co)[0],Ro(ep.outShape,mo.shape)),Xr!=null&&(_d=mn(Xr,"prelu weights","fused conv2d"));var rp={x:uo,filter:lo};ln!=null&&(rp.bias=mo),Xr!=null&&(rp.preluActivationWeights=_d);var sp=[lo,uo],op=Lt.runKernelFunc(function(ip,lp){var vp=ip.fusedConv2d({input:uo,filter:lo,convInfo:ep,bias:mo,activation:hn,preluActivationWeights:_d});return lp([lo,uo,vp]),vp},rp,function(ip,lp){var vp=lp,gp=vp[0],Op=vp[1],Mp=vp[2],Np=Bh(ip,Mp,hn);C(Oo(an),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+an+"'"});var wp={};return ln!=null&&(wp={bias:function(){return Ph(mo,Np)}}),Object.assign({x:function(){return Xc(Op.shape,Np,gp,Ye,Qe)},filter:function(){return jc(Op,Np,gp.shape,Ye,Qe)}},wp)},"FusedConv2D",{convInfo:ep,activation:hn},sp,[!0]);return ho?op.as3D(op.shape[1],op.shape[2],op.shape[3]):op}}),Vh=An({fusedDepthwiseConv2d_:function(Ke){var Ge=Ke.x,$e=Ke.filter,Ye=Ke.strides,Qe=Ke.pad,Je=Ke.dataFormat,Mt=Je===void 0?"NHWC":Je,nn=Ke.dilations,an=nn===void 0?[1,1]:nn,sn=Ke.dimRoundingMode,ln=Ke.bias,fn=Ke.activation,hn=fn===void 0?"linear":fn,Xr=Ke.preluActivationWeights;if(Mh(Lt.state.gradientDepth,hn)===!1){var Mi=Yc(Ge,$e,Ye,Qe,Mt,an,sn);return ln!=null&&(Mi=rc(Mi,ln)),Lh(Mi,hn,Xr)}var co=mn(Ge,"x","depthwiseConv2d"),lo=mn($e,"filter","depthwiseConv2d"),uo=co,ho=!1;co.rank===3&&(ho=!0,uo=co.as4D(1,co.shape[0],co.shape[1],co.shape[2])),C(uo.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+uo.rank+"."}),C(lo.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+lo.rank+"."}),C(uo.shape[3]===lo.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+uo.shape[3]+") must match the inChannels dimension in filter "+lo.shape[2]+"."}),an==null&&(an=[1,1]),C(Mo(Ye,an),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+Ye+" and dilations '"+an+"'"}),sn!=null&&C(A(Qe),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+sn+" but got pad "+Qe+"."});var mo,_d,ep=So(uo.shape,lo.shape,Ye,an,Qe,sn,!0);ln!=null&&(mo=Nt(mo=mn(ln,"bias","fused conv2d"),co)[0],Ro(ep.outShape,mo.shape)),Xr!=null&&(_d=mn(Xr,"prelu weights","fused depthwiseConv2d"));var rp={x:uo,filter:lo};ln!=null&&(rp.bias=mo),Xr!=null&&(rp.preluActivationWeights=_d);var sp=[lo,uo],op=Lt.runKernelFunc(function(ip,lp){var vp=ip.fusedDepthwiseConv2D({input:uo,filter:lo,convInfo:ep,bias:mo,activation:hn,preluActivationWeights:_d});return lp([lo,uo,vp]),vp},rp,function(ip,lp){C(Oo(an),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+an+"'"});var vp=lp[0],gp=lp[1],Op=lp[2],Mp=Bh(ip,Op,hn),Np={};return ln!=null&&(Np={bias:function(){return Ph(mo,Mp)}}),Object.assign({x:function(){return $c(gp.shape,Mp,vp,ep)},filter:function(){return Qc(gp,Mp,vp.shape,ep)}},Np)},"FusedDepthwiseConv2D",{convInfo:ep,activation:hn},sp,[!0]);return ho?op.as3D(op.shape[1],op.shape[2],op.shape[3]):op}}),zh=Object.freeze({matMul:Wh,conv2d:Uh,depthwiseConv2d:Vh}),Gh=Object.freeze({image:Oh,linalg:Ih,losses:bh,spectral:Jl,fused:zh,signal:uh,square:tu,squaredDifference:nu,conv1d:Hc,conv2d:qc,conv3d:Kc,depthwiseConv2d:Yc,separableConv2d:Jc,conv2dTranspose:Zc,conv3dTranspose:tl,op:An,batchNormalization2d:Gu,batchNormalization3d:Hu,batchNormalization4d:qu,batchNormalization:Ku,batchNorm:ju,batchNorm2d:Xu,batchNorm3d:Yu,batchNorm4d:$u,booleanMaskAsync:Uc,complex:Dn,real:Tn,imag:Nn,concat:Yn,concat1d:$n,concat2d:Qn,concat3d:Jn,concat4d:Zn,split:tr,matMul:el,dot:nl,outerProduct:rl,reverse:ol,reverse1d:al,reverse2d:il,reverse3d:sl,reverse4d:ul,maxPool:hl,avgPool:fl,pool:dl,maxPool3d:pl,avgPool3d:vl,slice:ml,slice1d:gl,slice2d:yl,slice3d:xl,slice4d:bl,abs:ru,acos:ou,acosh:au,asin:iu,asinh:su,atan:uu,atanh:cu,ceil:lu,clipByValue:hu,cos:fu,cosh:du,erf:pu,exp:vu,expm1:mu,floor:gu,log:yu,log1p:xu,logSigmoid:bu,neg:wu,reciprocal:Cu,round:Eu,rsqrt:Ru,sigmoid:Iu,sign:ku,isNaN:Su,isInf:Au,isFinite:Du,sin:Tu,sinh:Nu,softplus:Fu,sqrt:_u,step:Ou,tan:Mu,tanh:Bu,all:Cl,any:El,argMax:Rl,argMin:Il,logSumExp:kl,max:Sl,mean:Al,min:Dl,moments:Tl,sum:Nl,prod:Fl,equal:Rc,equalStrict:Ic,greater:kc,greaterEqual:Sc,greaterEqualStrict:Ac,greaterStrict:Dc,less:Tc,lessEqual:Nc,lessEqualStrict:Fc,lessStrict:_c,notEqual:Oc,notEqualStrict:Mc,add:rc,addN:oc,addStrict:ac,atan2:ic,div:sc,divNoNan:uc,divStrict:cc,floorDiv:lc,maximum:hc,maximumStrict:fc,minimum:dc,minimumStrict:pc,mod:vc,modStrict:mc,mul:gc,mulStrict:yc,pow:xc,powStrict:bc,squaredDifferenceStrict:wc,sub:Cc,subStrict:Ec,elu:_l,leakyRelu:Ol,prelu:Ml,relu:Bl,relu6:Pl,selu:Ll,logicalAnd:Qu,logicalNot:Ju,logicalOr:Zu,logicalXor:tc,where:ec,whereAsync:nc,buffer:dr,print:pr,batchToSpaceND:vr,broadcastTo:mr,cast:gr,clone:yr,cumsum:xr,depthToSpace:br,expandDims:wr,eye:Cr,multinomial:Er,oneHot:Rr,pad:Ir,pad1d:kr,pad2d:Sr,pad3d:Ar,pad4d:Dr,rand:Tr,randomNormal:Nr,randomGamma:Fr,randomUniform:_r,reshape:Or,spaceToBatchND:Mr,squeeze:Br,stack:Pr,tile:Lr,truncatedNormal:Wr,unstack:Ur,setdiff1dAsync:Vr,fill:Hn,linspace:qn,ones:zn,range:Kn,scalar:On,tensor:Fn,tensor1d:Mn,tensor2d:Bn,tensor3d:Pn,tensor4d:Ln,tensor5d:Wn,tensor6d:Un,variable:Vn,zeros:Gn,onesLike:jn,zerosLike:Xn,transpose:Wl,softmax:go,logSoftmax:yo,localResponseNormalization:Ul,norm:Vl,gather:Lc,unsortedSegmentSum:Wc,basicLSTMCell:zl,multiRNNCell:Gl,movingAverage:Hl,stridedSlice:ql,topk:Kl,scatterND:jl,fft:Xl,ifft:Yl,rfft:$l,irfft:Ql,sparseToDense:Zl,gatherND:th,diag:eh,dropout:nh,hannWindow:oh,hammingWindow:ah,frame:ih,stft:sh,inTopKAsync:lh});function Hh(Ke,Ge){Array.isArray(Ke)||(Ke=[Ke]),Ke.forEach(function($e){$e!=null&&C($e.dtype!=="complex64",function(){return Ge+" does not support complex64 tensors."})})}function qh(Ke,Ge,$e,Ye){if($e==="linear")return Ke.linear(Ge);if($e==="relu")return Ke.relu(Ge);if($e==="elu")return Ke.elu(Ge);if($e==="relu6")return Ke.relu6(Ge);if($e==="prelu")return Ke.prelu(Ge,Ye);throw new Error("Activation "+$e+" has not been implemented for the CPU backend.")}var Kh=function(Ke){function Ge(){var $e=Ke.call(this)||this;return $e.blockSize=48,$e.firstUse=!0,$e.data=new xo($e,Lt),$e}return e(Ge,Ke),Ge.prototype.write=function($e,Ye,Qe){this.firstUse&&(this.firstUse=!1,i().get("IS_NODE")&&dn(`
============================
Hi there . Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var Je={};return this.data.set(Je,{values:$e,dtype:Qe}),Je},Ge.prototype.move=function($e,Ye,Qe,Je){this.data.set($e,{values:Ye,dtype:Je})},Ge.prototype.numDataIds=function(){return this.data.numDataIds()},Ge.prototype.read=function($e){return n(this,void 0,void 0,function(){return r(this,function(Ye){return[2,this.readSync($e)]})})},Ge.prototype.readSync=function($e){var Ye=this.data.get($e),Qe=Ye.dtype,Je=Ye.complexTensors;return Qe==="complex64"?Vo(this.readSync(Je.real.dataId),this.readSync(Je.imag.dataId)):this.data.get($e).values},Ge.prototype.bufferSync=function($e){var Ye=this.readSync($e.dataId),Qe=Ye;if($e.dtype==="string")try{Qe=Ye.map(function(Je){return ot(Je)})}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return dr($e.shape,$e.dtype,Qe)},Ge.prototype.makeOutput=function($e,Ye,Qe){var Je=this.write($e,Ye,Qe);return Lt.makeTensorFromDataId(Je,Ye,Qe,this)},Ge.prototype.disposeData=function($e){if(this.data.has($e)){var Ye=this.data.get($e).complexTensors;Ye!=null&&(Ye.real.dispose(),Ye.imag.dispose()),this.data.delete($e)}},Ge.prototype.time=function($e){return n(this,void 0,void 0,function(){var Ye;return r(this,function(Qe){return Ye=et(),$e(),[2,{kernelMs:et()-Ye}]})})},Ge.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},Ge.prototype.complex=function($e,Ye){var Qe=this.makeOutput(null,$e.shape,"complex64");return this.data.get(Qe.dataId).complexTensors={real:Lt.keep($e.clone()),imag:Lt.keep(Ye.clone())},Qe},Ge.prototype.real=function($e){return this.data.get($e.dataId).complexTensors.real.clone()},Ge.prototype.imag=function($e){return this.data.get($e.dataId).complexTensors.imag.clone()},Ge.prototype.slice=function($e,Ye,Qe){if(Hh($e,"slice"),io($e.shape,Ye,Qe)){var Je=so(Ye,$e.strides),Mt=k(Qe);return Fn(this.readSync($e.dataId).subarray(Je,Je+Mt),Qe,$e.dtype)}for(var nn=dr(Qe,$e.dtype),an=this.bufferSync($e),sn=0;sn<nn.size;++sn){var ln=nn.indexToLoc(sn).map(function(fn,hn){return fn+Ye[hn]});nn.values[sn]=an.get.apply(an,ln)}return nn.toTensor()},Ge.prototype.stridedSlice=function($e,Ye,Qe,Je){Hh($e,"stridedSlice");var Mt=ro(Ye,Qe,Je);if(Mt.some(function(Xr){return Xr===0}))return Fn([],Mt);for(var nn=dr(Mt,$e.dtype),an=this.bufferSync($e),sn=0;sn<nn.size;sn++){for(var ln=nn.indexToLoc(sn),fn=new Array(ln.length),hn=0;hn<fn.length;hn++)fn[hn]=ln[hn]*Je[hn]+Ye[hn];nn.set.apply(nn,[an.get.apply(an,fn)].concat(ln))}return nn.toTensor()},Ge.prototype.diag=function($e){for(var Ye=this.readSync($e.dataId),Qe=dr([$e.size,$e.size],$e.dtype),Je=Qe.values,Mt=0;Mt<Ye.length;Mt++)Je[Mt*$e.size+Mt]=Ye[Mt];return Qe.toTensor()},Ge.prototype.unstack=function($e,Ye){for(var Qe=$e.shape[Ye],Je=new Array($e.rank-1),Mt=0,nn=0;nn<$e.rank;nn++)nn!==Ye&&(Je[Mt++]=$e.shape[nn]);var an=new Array($e.rank).fill(0),sn=$e.shape.slice();sn[Ye]=1;var ln=new Array(Qe);for(nn=0;nn<ln.length;nn++)an[Ye]=nn,ln[nn]=this.slice($e,an,sn).reshape(Je);return ln},Ge.prototype.reverse=function($e,Ye){Hh($e,"reverse");for(var Qe=dr($e.shape,$e.dtype),Je=this.bufferSync($e),Mt=function(an){var sn=Qe.indexToLoc(an),ln=sn.slice();Ye.forEach(function(fn){return ln[fn]=$e.shape[fn]-1-ln[fn]}),Qe.set.apply(Qe,[Je.get.apply(Je,ln)].concat(sn))},nn=0;nn<Qe.size;nn++)Mt(nn);return Qe.toTensor()},Ge.prototype.concat=function($e,Ye){var Qe=this;if($e[0].dtype==="complex64"){var Je=$e.map(function(Xr){return Tn(Xr)}),Mt=$e.map(function(Xr){return Nn(Xr)});return Dn(this.concat(Je,Ye),this.concat(Mt,Ye))}var nn=$e.map(function(Xr){var Mi=k(Xr.shape.slice(Ye));return Xr.as2D(-1,Mi)}),an=Sn(nn.map(function(Xr){return Xr.shape}),1),sn=dr(an,$e[0].dtype).values;if(nn[0].shape[0]===1){var ln=0;nn.forEach(function(Xr){sn.set(Qe.readSync(Xr.dataId),ln),ln+=Xr.size})}else{var fn=0;nn.forEach(function(Xr){for(var Mi=Qe.readSync(Xr.dataId),co=0,lo=0;lo<Xr.shape[0];++lo)for(var uo=lo*an[1]+fn,ho=0;ho<Xr.shape[1];++ho)sn[uo+ho]=Mi[co++];fn+=Xr.shape[1]})}var hn=Sn($e.map(function(Xr){return Xr.shape}),Ye);return Fn(sn,hn,$e[0].dtype)},Ge.prototype.neg=function($e){return Hh($e,"neg"),this.multiply(On(-1),$e)},Ge.prototype.add=function($e,Ye){return $e.dtype==="complex64"||Ye.dtype==="complex64"?this.broadcastedBinaryComplexOp($e.cast("complex64"),Ye.cast("complex64"),function(Qe,Je,Mt,nn){return{real:Qe+Mt,imag:Je+nn}}):this.broadcastedBinaryOp($e,Ye,Dt($e.dtype,Ye.dtype),function(Qe,Je){return Qe+Je})},Ge.prototype.addN=function($e){var Ye=this;Hh($e,"addN");for(var Qe=$e.map(function(ln){return Ye.readSync(ln.dataId)}),Je=dr($e[0].shape,$e[0].dtype),Mt=Je.values,nn=0;nn<$e.length;nn++)for(var an=Qe[nn],sn=0;sn<Mt.length;sn++)Mt[sn]+=an[sn];return Je.toTensor()},Ge.prototype.softmax=function($e,Ye){var Qe=O([Ye],$e.shape),Je=this.max($e,Qe),Mt=wn(Je.shape,Qe),nn=this.subtract($e,Je.reshape(Mt)),an=this.exp(nn),sn=this.sum(an,Qe).reshape(Mt);return this.realDivide(an,sn)},Ge.prototype.subtract=function($e,Ye){return $e.dtype==="complex64"||Ye.dtype==="complex64"?this.broadcastedBinaryComplexOp($e.cast("complex64"),Ye.cast("complex64"),function(Qe,Je,Mt,nn){return{real:Qe-Mt,imag:Je-nn}}):this.broadcastedBinaryOp($e,Ye,Dt($e.dtype,Ye.dtype),function(Qe,Je){return Qe-Je})},Ge.prototype.pow=function($e,Ye){return Hh([$e,Ye],"pow"),this.broadcastedBinaryOp($e,Ye,$e.dtype,function(Qe,Je){return Math.pow(Qe,Je)})},Ge.prototype.batchMatMul=function($e,Ye,Qe,Je){Hh([$e,Ye],"matMul");for(var Mt=Qe?$e.shape[1]:$e.shape[2],nn=Qe?$e.shape[2]:$e.shape[1],an=Je?Ye.shape[1]:Ye.shape[2],sn=$e.shape[0],ln=this.readSync($e.dataId),fn=this.readSync(Ye.dataId),hn=Qe?[$e.strides[0],1,$e.strides[1]]:[$e.strides[0],$e.strides[1],1],Xr=hn[0],Mi=hn[1],co=hn[2],lo=Je?[1,Ye.strides[1],Ye.strides[0]]:[Ye.strides[1],1,Ye.strides[0]],uo=lo[0],ho=lo[1],mo=lo[2],_d=nn*an,ep=dr([sn,nn,an],$e.dtype),rp=ep.values,sp=this.blockSize,op=0;op<sn;op++)for(var ip=0;ip<nn;ip+=sp)for(var lp=0;lp<an;lp+=sp)for(var vp=0;vp<Mt;vp+=sp)for(var gp=Math.min(ip+sp,nn),Op=Math.min(lp+sp,an),Mp=Math.min(vp+sp,Mt),Np=ip;Np<gp;Np++)for(var wp=lp;wp<Op;wp++){for(var Sp=0,Cp=vp;Cp<Mp;Cp++)Sp+=ln[op*Xr+Np*Mi+Cp*co]*fn[Cp*uo+wp*ho+op*mo];rp[op*_d+(Np*an+wp)]+=Sp}return ep.toTensor()},Ge.prototype.fusedBatchMatMul=function($e){var Ye=$e.a,Qe=$e.b,Je=$e.transposeA,Mt=$e.transposeB,nn=$e.bias,an=$e.activation,sn=$e.preluActivationWeights,ln=this.batchMatMul(Ye,Qe,Je,Mt);return nn&&(ln=this.add(ln,nn)),an&&(ln=qh(this,ln,an,sn)),ln},Ge.prototype.multiply=function($e,Ye){return $e.dtype==="complex64"||Ye.dtype==="complex64"?this.broadcastedBinaryComplexOp($e.cast("complex64"),Ye.cast("complex64"),function(Qe,Je,Mt,nn){return{real:Qe*Mt-Je*nn,imag:Qe*nn+Je*Mt}}):this.broadcastedBinaryOp($e,Ye,Dt($e.dtype,Ye.dtype),function(Qe,Je){return Qe*Je})},Ge.prototype.realDivide=function($e,Ye){return Hh([$e,Ye],"realDivide"),this.broadcastedBinaryOp($e,Ye,"float32",function(Qe,Je){return Qe/Je})},Ge.prototype.floorDiv=function($e,Ye){return Hh([$e,Ye],"floorDiv"),this.broadcastedBinaryOp($e,Ye,"int32",function(Qe,Je){return Math.floor(Qe/Je)})},Ge.prototype.sum=function($e,Ye){Hh($e,"sum"),Cn("sum",Ye,$e.rank);for(var Qe=bn($e.shape,Ye),Je=Qe[0],Mt=Qe[1],nn=Gn(Je,Dt($e.dtype,"int32")),an=k(Mt),sn=this.readSync(nn.dataId),ln=this.readSync($e.dataId),fn=0;fn<sn.length;++fn){for(var hn=fn*an,Xr=0,Mi=0;Mi<an;++Mi)Xr+=ln[hn+Mi];sn[fn]=Xr}return nn},Ge.prototype.prod=function($e,Ye){Hh($e,"sum");for(var Qe=bn($e.shape,Ye),Je=Qe[0],Mt=Qe[1],nn=Gn(Je,Dt($e.dtype,"int32")),an=k(Mt),sn=this.readSync(nn.dataId),ln=this.readSync($e.dataId),fn=0;fn<sn.length;++fn){for(var hn=fn*an,Xr=1,Mi=0;Mi<an;++Mi)Xr*=ln[hn+Mi];sn[fn]=Xr}return nn},Ge.prototype.unsortedSegmentSum=function($e,Ye,Qe){Hh($e,"unsortedSegmentSum");for(var Je=[],Mt=$e.rank-Ye.rank,nn=0;nn<Mt;++nn)Ye=Ye.expandDims(nn+1);for(nn=0;nn<Qe;++nn){var an=On(nn,"int32"),sn=Rc(an,Ye).asType("float32").mul($e).sum(0);Je.push(sn)}return Pr(Je)},Ge.prototype.argMin=function($e,Ye){Hh($e,"argMin");var Qe=[Ye];Cn("argMin",Qe,$e.rank);for(var Je=bn($e.shape,Qe),Mt=Je[0],nn=Je[1],an=Gn(Mt,"int32"),sn=k(nn),ln=this.readSync(an.dataId),fn=this.readSync($e.dataId),hn=0;hn<ln.length;++hn){for(var Xr=hn*sn,Mi=fn[Xr],co=0,lo=0;lo<sn;++lo){var uo=fn[Xr+lo];uo<Mi&&(Mi=uo,co=lo)}ln[hn]=co}return an},Ge.prototype.argMax=function($e,Ye){Hh($e,"argMax");var Qe=[Ye];Cn("argMax",Qe,$e.rank);for(var Je=bn($e.shape,Qe),Mt=Je[0],nn=Je[1],an=Gn(Mt,"int32"),sn=k(nn),ln=this.readSync(an.dataId),fn=this.readSync($e.dataId),hn=0;hn<ln.length;++hn){for(var Xr=hn*sn,Mi=fn[Xr],co=0,lo=0;lo<sn;++lo){var uo=fn[Xr+lo];uo>Mi&&(Mi=uo,co=lo)}ln[hn]=co}return an},Ge.prototype.cumsum=function($e,Ye,Qe,Je){if(Hh($e,"cumsum"),Ye!==$e.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+($e.rank-1)+" but got axis="+Ye);for(var Mt=Dt($e.dtype,"int32"),nn=Gn($e.shape,Mt),an=this.readSync(nn.dataId),sn=this.readSync($e.dataId),ln=$e.shape[$e.rank-1],fn=Je?function(lo,uo){return lo+ln-uo-1}:function(lo,uo){return lo+uo},hn=0;hn<sn.length;hn+=ln)for(var Xr=0;Xr<ln;Xr++){var Mi=fn(hn,Xr);if(Xr===0)an[Mi]=Qe?0:sn[Mi];else{var co=fn(hn,Xr-1);an[Mi]=Qe?sn[co]+an[co]:sn[Mi]+an[co]}}return nn},Ge.prototype.equal=function($e,Ye){return Hh([$e,Ye],"equal"),this.broadcastedBinaryOp($e,Ye,"bool",function(Qe,Je){return Qe===Je?1:0})},Ge.prototype.notEqual=function($e,Ye){return Hh([$e,Ye],"notEqual"),this.broadcastedBinaryOp($e,Ye,"bool",function(Qe,Je){return Qe!==Je?1:0})},Ge.prototype.less=function($e,Ye){return Hh([$e,Ye],"less"),this.broadcastedBinaryOp($e,Ye,"bool",function(Qe,Je){return Qe<Je?1:0})},Ge.prototype.lessEqual=function($e,Ye){return Hh([$e,Ye],"lessEqual"),this.broadcastedBinaryOp($e,Ye,"bool",function(Qe,Je){return Qe<=Je?1:0})},Ge.prototype.greater=function($e,Ye){return Hh([$e,Ye],"greater"),this.broadcastedBinaryOp($e,Ye,"bool",function(Qe,Je){return Qe>Je?1:0})},Ge.prototype.greaterEqual=function($e,Ye){return Hh([$e,Ye],"greaterEqual"),this.broadcastedBinaryOp($e,Ye,"bool",function(Qe,Je){return Qe>=Je?1:0})},Ge.prototype.logicalNot=function($e){Hh($e,"logicalNot");for(var Ye=this.readSync($e.dataId),Qe=new Uint8Array(Ye.length),Je=0;Je<Ye.length;++Je)Qe[Je]=Ye[Je]?0:1;return this.makeOutput(Qe,$e.shape,"bool")},Ge.prototype.logicalAnd=function($e,Ye){return Hh([$e,Ye],"logicalAnd"),this.broadcastedBinaryOp($e,Ye,"bool",function(Qe,Je){return Qe&&Je})},Ge.prototype.logicalOr=function($e,Ye){return Hh([$e,Ye],"logicalOr"),this.broadcastedBinaryOp($e,Ye,"bool",function(Qe,Je){return Qe||Je})},Ge.prototype.select=function($e,Ye,Qe){Hh([$e,Ye,Qe],"select");for(var Je=this.readSync($e.dataId),Mt=this.readSync(Ye.dataId),nn=this.readSync(Qe.dataId),an=Gn(Ye.shape,Dt(Ye.dtype,Qe.dtype)),sn=this.readSync(an.dataId),ln=0,fn=$e.rank===0||$e.rank>1||Ye.rank===1?1:k(Ye.shape.slice(1)),hn=0;hn<Je.length;hn++)for(var Xr=0;Xr<fn;Xr++)Je[hn]===1?sn[ln++]=Mt[hn]:sn[ln++]=nn[hn];return an},Ge.prototype.where=function($e){Hh([$e],"where");var Ye=this.readSync($e.dataId);return na($e.shape,Ye)},Ge.prototype.topk=function($e,Ye,Qe){return Hh($e,"topk"),ea(this.readSync($e.dataId),$e.shape,$e.dtype,Ye)},Ge.prototype.min=function($e,Ye){Hh($e,"min"),Cn("min",Ye,$e.rank);for(var Qe=bn($e.shape,Ye),Je=Qe[0],Mt=Qe[1],nn=Gn(Je,$e.dtype),an=k(Mt),sn=this.readSync(nn.dataId),ln=this.readSync($e.dataId),fn=0;fn<sn.length;++fn){for(var hn=fn*an,Xr=ln[hn],Mi=0;Mi<an;++Mi){var co=ln[hn+Mi];co<Xr&&(Xr=co)}sn[fn]=Xr}return nn},Ge.prototype.minimum=function($e,Ye){return Hh([$e,Ye],"minimum"),this.broadcastedBinaryOp($e,Ye,$e.dtype,function(Qe,Je){return Math.min(Qe,Je)})},Ge.prototype.mod=function($e,Ye){return Hh([$e,Ye],"mod"),this.broadcastedBinaryOp($e,Ye,$e.dtype,function(Qe,Je){var Mt=Qe%Je;return Qe<0&&Je<0||Qe>=0&&Je>=0?Mt:(Mt+Je)%Je})},Ge.prototype.max=function($e,Ye){Hh($e,"max"),Cn("max",Ye,$e.rank);for(var Qe=bn($e.shape,Ye),Je=Qe[0],Mt=Qe[1],nn=Gn(Je,$e.dtype),an=k(Mt),sn=this.readSync(nn.dataId),ln=this.readSync($e.dataId),fn=0;fn<sn.length;++fn){for(var hn=fn*an,Xr=ln[hn],Mi=0;Mi<an;++Mi){var co=ln[hn+Mi];co>Xr&&(Xr=co)}sn[fn]=Xr}return nn},Ge.prototype.maximum=function($e,Ye){return Hh([$e,Ye],"maximum"),this.broadcastedBinaryOp($e,Ye,$e.dtype,function(Qe,Je){return Math.max(Qe,Je)})},Ge.prototype.all=function($e,Ye){Hh($e,"all"),Cn("all",Ye,$e.rank);for(var Qe=bn($e.shape,Ye),Je=Qe[0],Mt=Qe[1],nn=Gn(Je,$e.dtype),an=k(Mt),sn=this.readSync(nn.dataId),ln=this.readSync($e.dataId),fn=0;fn<sn.length;++fn){for(var hn=fn*an,Xr=ln[hn],Mi=0;Mi<an;++Mi){var co=ln[hn+Mi];Xr=Xr&&co}sn[fn]=Xr}return nn},Ge.prototype.any=function($e,Ye){Hh($e,"any"),Cn("any",Ye,$e.rank);for(var Qe=bn($e.shape,Ye),Je=Qe[0],Mt=Qe[1],nn=Gn(Je,$e.dtype),an=k(Mt),sn=this.readSync(nn.dataId),ln=this.readSync($e.dataId),fn=0;fn<sn.length;++fn){for(var hn=fn*an,Xr=ln[hn],Mi=0;Mi<an;++Mi){var co=ln[hn+Mi];Xr=Xr||co}sn[fn]=Xr}return nn},Ge.prototype.squaredDifference=function($e,Ye){return Hh([$e,Ye],"squaredDifference"),this.broadcastedBinaryOp($e,Ye,$e.dtype,function(Qe,Je){var Mt=Qe-Je;return Mt*Mt})},Ge.prototype.ceil=function($e){Hh($e,"ceil");for(var Ye=this.readSync($e.dataId),Qe=new Float32Array(Ye.length),Je=0;Je<Ye.length;++Je)Qe[Je]=Math.ceil(Ye[Je]);return this.makeOutput(Qe,$e.shape,"float32")},Ge.prototype.floor=function($e){Hh($e,"floor");for(var Ye=this.readSync($e.dataId),Qe=new Float32Array(Ye.length),Je=0;Je<Ye.length;++Je)Qe[Je]=Math.floor(Ye[Je]);return this.makeOutput(Qe,$e.shape,"float32")},Ge.prototype.sign=function($e){Hh($e,"x");for(var Ye=this.readSync($e.dataId),Qe=new Float32Array(Ye.length),Je=0;Je<Ye.length;++Je)Ye[Je]<0?Qe[Je]=-1:Ye[Je]>0?Qe[Je]=1:Qe[Je]=0;return this.makeOutput(Qe,$e.shape,"float32")},Ge.prototype.isNaN=function($e){Hh($e,"x");for(var Ye=this.readSync($e.dataId),Qe=new Uint8Array(Ye.length),Je=0;Je<Ye.length;++Je)Number.isNaN(Ye[Je])&&(Qe[Je]=1);return this.makeOutput(Qe,$e.shape,"bool")},Ge.prototype.isInf=function($e){Hh($e,"x");for(var Ye=this.readSync($e.dataId),Qe=new Uint8Array(Ye.length),Je=0;Je<Ye.length;++Je)Math.abs(Ye[Je])===1/0&&(Qe[Je]=1);return this.makeOutput(Qe,$e.shape,"bool")},Ge.prototype.isFinite=function($e){Hh($e,"x");for(var Ye=this.readSync($e.dataId),Qe=new Uint8Array(Ye.length),Je=0;Je<Ye.length;++Je)Number.isFinite(Ye[Je])&&(Qe[Je]=1);return this.makeOutput(Qe,$e.shape,"bool")},Ge.prototype.round=function($e){Hh($e,"round");for(var Ye=this.readSync($e.dataId),Qe=new Float32Array(Ye.length),Je=0;Je<Ye.length;++Je){var Mt=Math.floor(Ye[Je]);Ye[Je]-Mt<.5?Qe[Je]=Math.floor(Ye[Je]):Ye[Je]-Mt>.5?Qe[Je]=Math.ceil(Ye[Je]):Qe[Je]=Mt%2==0?Mt:Mt+1}return this.makeOutput(Qe,$e.shape,"float32")},Ge.prototype.exp=function($e){Hh($e,"exp");for(var Ye=this.readSync($e.dataId),Qe=new Float32Array(Ye.length),Je=0;Je<Ye.length;++Je)Qe[Je]=Math.exp(Ye[Je]);return this.makeOutput(Qe,$e.shape,"float32")},Ge.prototype.expm1=function($e){Hh($e,"expm1");for(var Ye=this.readSync($e.dataId),Qe=new Float32Array(Ye.length),Je=0;Je<Ye.length;++Je)Qe[Je]=Math.expm1(Ye[Je]);return this.makeOutput(Qe,$e.shape,"float32")},Ge.prototype.log=function($e){Hh($e,"log");for(var Ye=this.readSync($e.dataId),Qe=new Float32Array(Ye.length),Je=0;Je<Ye.length;++Je){var Mt=Ye[Je];Qe[Je]=Math.log(Mt)}return this.makeOutput(Qe,$e.shape,"float32")},Ge.prototype.log1p=function($e){Hh($e,"log1p");for(var Ye=this.readSync($e.dataId),Qe=new Float32Array(Ye.length),Je=0;Je<Ye.length;++Je){var Mt=Ye[Je];Qe[Je]=Math.log1p(Mt)}return this.makeOutput(Qe,$e.shape,"float32")},Ge.prototype.sqrt=function($e){Hh($e,"sqrt");for(var Ye=this.readSync($e.dataId),Qe=new Float32Array(Ye.length),Je=0;Je<Ye.length;++Je){var Mt=Ye[Je];Qe[Je]=Math.sqrt(Mt)}return this.makeOutput(Qe,$e.shape,"float32")},Ge.prototype.rsqrt=function($e){Hh($e,"rsqrt");for(var Ye=this.readSync($e.dataId),Qe=new Float32Array(Ye.length),Je=0;Je<Ye.length;++Je){var Mt=Ye[Je];Qe[Je]=1/Math.sqrt(Mt)}return this.makeOutput(Qe,$e.shape,"float32")},Ge.prototype.reciprocal=function($e){Hh($e,"reciprocal");for(var Ye=this.readSync($e.dataId),Qe=new Float32Array(Ye.length),Je=0;Je<Ye.length;++Je)Qe[Je]=1/Ye[Je];return this.makeOutput(Qe,$e.shape,"float32")},Ge.prototype.linear=function($e){return $e},Ge.prototype.relu=function($e){Hh($e,"relu");for(var Ye=Gn($e.shape,$e.dtype),Qe=this.readSync(Ye.dataId),Je=this.readSync($e.dataId),Mt=0;Mt<Je.length;++Mt)Qe[Mt]=Math.max(0,Je[Mt]);return Ye},Ge.prototype.relu6=function($e){Hh($e,"relu");for(var Ye=Gn($e.shape,$e.dtype),Qe=this.readSync(Ye.dataId),Je=this.readSync($e.dataId),Mt=0;Mt<Je.length;++Mt)Qe[Mt]=Math.min(Math.max(0,Je[Mt]),6);return Ye},Ge.prototype.prelu=function($e,Ye){return Hh([$e,Ye],"prelu"),this.broadcastedBinaryOp($e,Ye,$e.dtype,function(Qe,Je){return Qe<0?Je*Qe:Qe})},Ge.prototype.elu=function($e){Hh($e,"elu");for(var Ye=new Float32Array($e.size),Qe=this.readSync($e.dataId),Je=0;Je<Qe.length;++Je){var Mt=Qe[Je];Ye[Je]=Mt>=0?Mt:Math.exp(Mt)-1}return this.makeOutput(Ye,$e.shape,"float32")},Ge.prototype.eluDer=function($e,Ye){Hh([$e,Ye],"eluDer");for(var Qe=new Float32Array(Ye.size),Je=this.readSync(Ye.dataId),Mt=this.readSync($e.dataId),nn=0;nn<Je.length;++nn){var an=Je[nn];Qe[nn]=an>=1?Mt[nn]:Mt[nn]*(an+1)}return this.makeOutput(Qe,Ye.shape,"float32")},Ge.prototype.selu=function($e){Hh($e,"selu");for(var Ye=bs,Qe=ws,Je=new Float32Array($e.size),Mt=this.readSync($e.dataId),nn=0;nn<Mt.length;++nn){var an=Mt[nn];Je[nn]=an>=0?Qe*an:Ye*(Math.exp(an)-1)}return this.makeOutput(Je,$e.shape,"float32")},Ge.prototype.clip=function($e,Ye,Qe){Hh($e,"clip");for(var Je=new Float32Array($e.size),Mt=this.readSync($e.dataId),nn=0;nn<Mt.length;++nn){var an=Mt[nn];Je[nn]=an>Qe?Qe:an<Ye?Ye:an}return this.makeOutput(Je,$e.shape,"float32")},Ge.prototype.abs=function($e){for(var Ye=new Float32Array($e.size),Qe=this.readSync($e.dataId),Je=0;Je<Qe.length;++Je)Ye[Je]=Math.abs(Qe[Je]);return this.makeOutput(Ye,$e.shape,"float32")},Ge.prototype.complexAbs=function($e){for(var Ye=new Float32Array($e.size),Qe=this.readSync($e.dataId),Je=0;Je<$e.size;++Je){var Mt=Qe[2*Je],nn=Qe[2*Je+1];Ye[Je]=Math.hypot(Mt,nn)}return this.makeOutput(Ye,$e.shape,"float32")},Ge.prototype.int=function($e){Hh($e,"int");for(var Ye=new Int32Array($e.size),Qe=this.readSync($e.dataId),Je=0;Je<Qe.length;++Je)Ye[Je]=Qe[Je];return this.makeOutput(Ye,$e.shape,"int32")},Ge.prototype.sigmoid=function($e){Hh($e,"sigmoid");for(var Ye=new Float32Array($e.size),Qe=this.readSync($e.dataId),Je=0;Je<Qe.length;++Je)Ye[Je]=1/(1+Math.exp(-Qe[Je]));return this.makeOutput(Ye,$e.shape,"float32")},Ge.prototype.softplus=function($e){Hh($e,"softplus");for(var Ye=Math.log(11920928955078125e-23)+2,Qe=new Float32Array($e.size),Je=this.readSync($e.dataId),Mt=0;Mt<Je.length;++Mt){var nn=Je[Mt]>-Ye,an=Je[Mt]<Ye,sn=Math.exp(Je[Mt]),ln=void 0;ln=an?sn:nn?Je[Mt]:Math.log(1+sn),Qe[Mt]=ln}return this.makeOutput(Qe,$e.shape,"float32")},Ge.prototype.sin=function($e){Hh($e,"sin");for(var Ye=new Float32Array($e.size),Qe=this.readSync($e.dataId),Je=0;Je<Qe.length;++Je)Ye[Je]=Math.sin(Qe[Je]);return this.makeOutput(Ye,$e.shape,"float32")},Ge.prototype.cos=function($e){Hh($e,"cos");for(var Ye=new Float32Array($e.size),Qe=this.readSync($e.dataId),Je=0;Je<Qe.length;++Je)Ye[Je]=Math.cos(Qe[Je]);return this.makeOutput(Ye,$e.shape,"float32")},Ge.prototype.tan=function($e){Hh($e,"tan");for(var Ye=new Float32Array($e.size),Qe=this.readSync($e.dataId),Je=0;Je<Qe.length;++Je)Ye[Je]=Math.tan(Qe[Je]);return this.makeOutput(Ye,$e.shape,"float32")},Ge.prototype.asin=function($e){Hh($e,"asin");for(var Ye=new Float32Array($e.size),Qe=this.readSync($e.dataId),Je=0;Je<Qe.length;++Je)Ye[Je]=Math.asin(Qe[Je]);return this.makeOutput(Ye,$e.shape,"float32")},Ge.prototype.acos=function($e){Hh($e,"acos");for(var Ye=new Float32Array($e.size),Qe=this.readSync($e.dataId),Je=0;Je<Qe.length;++Je)Ye[Je]=Math.acos(Qe[Je]);return this.makeOutput(Ye,$e.shape,"float32")},Ge.prototype.atan=function($e){Hh($e,"atan");for(var Ye=new Float32Array($e.size),Qe=this.readSync($e.dataId),Je=0;Je<Qe.length;++Je)Ye[Je]=Math.atan(Qe[Je]);return this.makeOutput(Ye,$e.shape,"float32")},Ge.prototype.atan2=function($e,Ye){return Hh([$e,Ye],"atan2"),this.broadcastedBinaryOp($e,Ye,$e.dtype,function(Qe,Je){return Math.atan2(Qe,Je)})},Ge.prototype.sinh=function($e){Hh($e,"sinh");for(var Ye=new Float32Array($e.size),Qe=this.readSync($e.dataId),Je=0;Je<Qe.length;++Je)Ye[Je]=Math.sinh(Qe[Je]);return this.makeOutput(Ye,$e.shape,"float32")},Ge.prototype.cosh=function($e){Hh($e,"cosh");for(var Ye=new Float32Array($e.size),Qe=this.readSync($e.dataId),Je=0;Je<Qe.length;++Je)Ye[Je]=Math.cosh(Qe[Je]);return this.makeOutput(Ye,$e.shape,"float32")},Ge.prototype.tanh=function($e){Hh($e,"tanh");for(var Ye=new Float32Array($e.size),Qe=this.readSync($e.dataId),Je=0;Je<Qe.length;++Je)Ye[Je]=D(Qe[Je]);return this.makeOutput(Ye,$e.shape,"float32")},Ge.prototype.asinh=function($e){Hh($e,"asinh");for(var Ye=new Float32Array($e.size),Qe=this.readSync($e.dataId),Je=0;Je<Qe.length;++Je)Ye[Je]=Math.asinh(Qe[Je]);return this.makeOutput(Ye,$e.shape,"float32")},Ge.prototype.acosh=function($e){Hh($e,"acosh");for(var Ye=new Float32Array($e.size),Qe=this.readSync($e.dataId),Je=0;Je<Qe.length;++Je)Ye[Je]=Math.acosh(Qe[Je]);return this.makeOutput(Ye,$e.shape,"float32")},Ge.prototype.atanh=function($e){Hh($e,"atanh");for(var Ye=new Float32Array($e.size),Qe=this.readSync($e.dataId),Je=0;Je<Qe.length;++Je)Ye[Je]=Math.atanh(Qe[Je]);return this.makeOutput(Ye,$e.shape,"float32")},Ge.prototype.erf=function($e){Hh($e,"erf");for(var Ye=new Float32Array($e.size),Qe=this.readSync($e.dataId),Je=0;Je<Qe.length;++Je){var Mt=Math.sign(Qe[Je]),nn=Math.abs(Qe[Je]),an=1/(1+.3275911*nn);Ye[Je]=Mt*(1-((((1.061405429*an-1.453152027)*an+1.421413741)*an-.284496736)*an+.254829592)*an*Math.exp(-nn*nn))}return this.makeOutput(Ye,$e.shape,"float32")},Ge.prototype.step=function($e,Ye){Ye===void 0&&(Ye=0),Hh($e,"step");for(var Qe=new Float32Array($e.size),Je=this.readSync($e.dataId),Mt=0;Mt<Je.length;++Mt){var nn=Je[Mt];isNaN(nn)?Qe[Mt]=NaN:Qe[Mt]=nn>0?1:Ye}return this.makeOutput(Qe,$e.shape,"float32")},Ge.prototype.fusedConv2d=function($e){var Ye=$e.input,Qe=$e.filter,Je=$e.convInfo,Mt=$e.bias,nn=$e.activation,an=$e.preluActivationWeights,sn=this.conv2d(Ye,Qe,Je);return Mt&&(sn=this.add(sn,Mt)),nn&&(sn=qh(this,sn,nn,an)),sn},Ge.prototype.conv2d=function($e,Ye,Qe){Hh([$e,Ye],"conv2d");for(var Je=Qe.filterHeight,Mt=Qe.filterWidth,nn=Qe.dilationHeight,an=Qe.dilationWidth,sn=Qe.padInfo.left,ln=Qe.padInfo.top,fn=Qe.dataFormat==="channelsLast",hn=dr(Qe.outShape,$e.dtype),Xr=$e.strides[0],Mi=fn?$e.strides[1]:$e.strides[2],co=fn?$e.strides[2]:1,lo=fn?1:$e.strides[1],uo=hn.strides[0],ho=fn?hn.strides[1]:hn.strides[2],mo=fn?hn.strides[2]:1,_d=fn?1:hn.strides[1],ep=this.readSync($e.dataId),rp=this.readSync(Ye.dataId),sp=hn.values,op=0;op<Qe.batchSize;++op)for(var ip=op*Xr,lp=op*uo,vp=0;vp<Qe.outHeight;++vp)for(var gp=lp+vp*ho,Op=vp*Qe.strideHeight-ln,Mp=0;Mp<Je;Mp++){var Np=Op+Mp*nn;if(!(Np<0||Np>=Qe.inHeight))for(var wp=Mp*Ye.strides[0],Sp=ip+Np*Mi,Cp=0;Cp<Qe.outWidth;++Cp)for(var Ip=gp+Cp*mo,cp=Cp*Qe.strideWidth-sn,Ep=0;Ep<Mt;Ep++){var Fp=cp+Ep*an;if(!(Fp<0||Fp>=Qe.inWidth))for(var Hp=Sp+Fp*co,zp=wp+Ep*Ye.strides[1],Gp=0;Gp<Qe.inChannels;++Gp){for(var mp=ep[Hp+Gp*lo],yp=0;yp<Qe.outChannels;++yp)sp[Ip+yp*_d]+=mp*rp[zp+yp];zp+=Qe.outChannels}}}return hn.toTensor()},Ge.prototype.conv3d=function($e,Ye,Qe){for(var Je=Qe.filterDepth,Mt=Qe.filterHeight,nn=Qe.filterWidth,an=Qe.dilationDepth,sn=Qe.dilationHeight,ln=Qe.dilationWidth,fn=Qe.padInfo.front,hn=Qe.padInfo.left,Xr=Qe.padInfo.top,Mi=dr(Qe.outShape,$e.dtype),co=this.readSync($e.dataId),lo=this.readSync(Ye.dataId),uo=Mi.values,ho=0;ho<Qe.batchSize;++ho)for(var mo=ho*$e.strides[0],_d=ho*Mi.strides[0],ep=0;ep<Qe.outDepth;++ep)for(var rp=_d+ep*Mi.strides[1],sp=ep*Qe.strideDepth-fn,op=0;op<Je;op++){var ip=sp+op*an;if(!(ip<0||ip>=Qe.inDepth))for(var lp=op*Ye.strides[0],vp=mo+ip*$e.strides[1],gp=0;gp<Qe.outHeight;++gp)for(var Op=rp+gp*Mi.strides[2],Mp=gp*Qe.strideHeight-Xr,Np=0;Np<Mt;Np++){var wp=Mp+Np*sn;if(!(wp<0||wp>=Qe.inHeight))for(var Sp=lp+Np*Ye.strides[1],Cp=vp+wp*$e.strides[2],Ip=0;Ip<Qe.outWidth;++Ip)for(var cp=Op+Ip*Qe.outChannels,Ep=Ip*Qe.strideWidth-hn,Fp=0;Fp<nn;Fp++){var Hp=Ep+Fp*ln;if(!(Hp<0||Hp>=Qe.inWidth))for(var zp=Sp+Fp*Ye.strides[2],Gp=Cp+Hp*Qe.inChannels,mp=zp,yp=0;yp<Qe.inChannels;++yp){for(var Tp=co[Gp+yp],qp=0;qp<Qe.outChannels;++qp)uo[cp+qp]+=Tp*lo[mp+qp];mp+=Qe.outChannels}}}}return Mi.toTensor()},Ge.prototype.conv2dDerInput=function($e,Ye,Qe){Hh([$e,Ye],"conv2dDerInput");for(var Je=dr(Qe.inShape,"float32"),Mt=Je.values,nn=this.readSync($e.dataId),an=this.readSync(Ye.dataId),sn=Ye.strides,ln=sn[0],fn=sn[1],hn=sn[2],Xr=Qe.batchSize,Mi=Qe.filterHeight,co=Qe.filterWidth,lo=Qe.inChannels,uo=Qe.inHeight,ho=Qe.inWidth,mo=Qe.outChannels,_d=Qe.outHeight,ep=Qe.outWidth,rp=Qe.strideHeight,sp=Qe.strideWidth,op=Qe.dataFormat,ip=Mi-1-Qe.padInfo.top,lp=co-1-Qe.padInfo.left,vp=op==="channelsLast",gp=Je.strides[0],Op=vp?Je.strides[1]:Je.strides[2],Mp=vp?Je.strides[2]:1,Np=vp?1:Je.strides[1],wp=$e.strides[0],Sp=vp?$e.strides[1]:$e.strides[2],Cp=vp?$e.strides[2]:1,Ip=vp?1:$e.strides[1],cp=0;cp<Xr;++cp)for(var Ep=0;Ep<lo;++Ep)for(var Fp=0;Fp<uo;++Fp)for(var Hp=Fp-ip,zp=Math.max(0,Math.ceil(Hp/rp)),Gp=Math.min(_d,(Mi+Hp)/rp),mp=0;mp<ho;++mp){for(var yp=mp-lp,Tp=Math.max(0,Math.ceil(yp/sp)),qp=Math.min(ep,(co+yp)/sp),$p=0,fp=zp;fp<Gp;++fp)for(var hp=fp*rp-Hp,Bp=Tp;Bp<qp;++Bp)for(var Vp=wp*cp+Sp*fp+Cp*Bp,Jp=ln*(Mi-1-hp)+fn*(co-1-(Bp*sp-yp))+hn*Ep,Xp=0;Xp<mo;++Xp)$p+=nn[Vp+Ip*Xp]*an[Jp+Xp];Mt[gp*cp+Op*Fp+Mp*mp+Np*Ep]=$p}return Je.toTensor()},Ge.prototype.conv3dDerInput=function($e,Ye,Qe){for(var Je=dr(Qe.inShape,"float32"),Mt=Je.values,nn=Je.strides,an=nn[0],sn=nn[1],ln=nn[2],fn=nn[3],hn=this.readSync($e.dataId),Xr=$e.strides,Mi=Xr[0],co=Xr[1],lo=Xr[2],uo=Xr[3],ho=this.readSync(Ye.dataId),mo=Ye.strides,_d=mo[0],ep=mo[1],rp=mo[2],sp=mo[3],op=Qe.batchSize,ip=Qe.filterDepth,lp=Qe.filterHeight,vp=Qe.filterWidth,gp=Qe.inChannels,Op=Qe.inDepth,Mp=Qe.inHeight,Np=Qe.inWidth,wp=Qe.outChannels,Sp=Qe.outDepth,Cp=Qe.outHeight,Ip=Qe.outWidth,cp=Qe.strideDepth,Ep=Qe.strideHeight,Fp=Qe.strideWidth,Hp=ip-1-Qe.padInfo.front,zp=lp-1-Qe.padInfo.top,Gp=vp-1-Qe.padInfo.left,mp=0;mp<op;++mp)for(var yp=0;yp<gp;++yp)for(var Tp=0;Tp<Op;++Tp)for(var qp=Tp-Hp,$p=Math.max(0,Math.ceil(qp/cp)),fp=Math.min(Sp,(ip+qp)/cp),hp=0;hp<Mp;++hp)for(var Bp=hp-zp,Vp=Math.max(0,Math.ceil(Bp/Ep)),Jp=Math.min(Cp,(lp+Bp)/Ep),Xp=0;Xp<Np;++Xp){for(var tm=Xp-Gp,bm=Math.max(0,Math.ceil(tm/Fp)),xm=Math.min(Ip,(vp+tm)/Fp),Wm=0,Nm=$p;Nm<fp;++Nm)for(var wm=Nm*cp-qp,Mm=Vp;Mm<Jp;++Mm)for(var Em=Mm*Ep-Bp,_m=bm;_m<xm;++_m)for(var Km=Mi*mp+co*Nm+lo*Mm+uo*_m,ap=_d*(ip-1-wm)+ep*(lp-1-Em)+rp*(vp-1-(_m*Fp-tm))+sp*yp,Uo=0;Uo<wp;++Uo)Wm+=hn[Km+Uo]*ho[ap+Uo];Mt[an*mp+sn*Tp+ln*hp+fn*Xp+yp]=Wm}return Je.toTensor()},Ge.prototype.conv2dDerFilter=function($e,Ye,Qe){Hh([$e,Ye],"conv2dDerFilter");for(var Je=Qe.strideHeight,Mt=Qe.strideWidth,nn=Qe.filterHeight,an=Qe.filterWidth,sn=Qe.dataFormat==="channelsLast",ln=dr(Qe.filterShape,"float32"),fn=Qe.padInfo.left,hn=Qe.padInfo.top,Xr=this.bufferSync($e),Mi=this.bufferSync(Ye),co=0;co<nn;++co)for(var lo=Math.max(0,Math.ceil((hn-co)/Je)),uo=Math.min(Qe.outHeight,(Qe.inHeight+hn-co)/Je),ho=0;ho<an;++ho)for(var mo=Math.max(0,Math.ceil((fn-ho)/Mt)),_d=Math.min(Qe.outWidth,(Qe.inWidth+fn-ho)/Mt),ep=0;ep<Qe.inChannels;++ep)for(var rp=0;rp<Qe.outChannels;++rp){for(var sp=0,op=0;op<Qe.batchSize;++op)for(var ip=lo;ip<uo;++ip)for(var lp=co+ip*Je-hn,vp=mo;vp<_d;++vp){var gp=ho+vp*Mt-fn;sp+=sn?Xr.get(op,lp,gp,ep)*Mi.get(op,ip,vp,rp):Xr.get(op,ep,lp,gp)*Mi.get(op,rp,ip,vp)}ln.set(sp,co,ho,ep,rp)}return ln.toTensor()},Ge.prototype.conv3dDerFilter=function($e,Ye,Qe){for(var Je=Qe.strideDepth,Mt=Qe.strideHeight,nn=Qe.strideWidth,an=Qe.filterDepth,sn=Qe.filterHeight,ln=Qe.filterWidth,fn=dr(Qe.filterShape,"float32"),hn=fn.values,Xr=fn.strides,Mi=Xr[0],co=Xr[1],lo=Xr[2],uo=Xr[3],ho=this.readSync(Ye.dataId),mo=Ye.strides,_d=mo[0],ep=mo[1],rp=mo[2],sp=mo[3],op=this.readSync($e.dataId),ip=$e.strides,lp=ip[0],vp=ip[1],gp=ip[2],Op=ip[3],Mp=Qe.padInfo.front,Np=Qe.padInfo.left,wp=Qe.padInfo.top,Sp=0;Sp<an;++Sp)for(var Cp=Math.max(0,Math.ceil((Mp-Sp)/Je)),Ip=Math.min(Qe.outDepth,(Qe.inDepth+Mp-Sp)/Je),cp=Sp*Mi,Ep=0;Ep<sn;++Ep)for(var Fp=Math.max(0,Math.ceil((wp-Ep)/Mt)),Hp=Math.min(Qe.outHeight,(Qe.inHeight+wp-Ep)/Mt),zp=Ep*co+cp,Gp=0;Gp<ln;++Gp)for(var mp=Math.max(0,Math.ceil((Np-Gp)/nn)),yp=Math.min(Qe.outWidth,(Qe.inWidth+Np-Gp)/nn),Tp=Gp*lo+zp,qp=0;qp<Qe.inChannels;++qp)for(var $p=qp*uo+Tp,fp=0;fp<Qe.outChannels;++fp){for(var hp=0,Bp=0;Bp<Qe.batchSize;++Bp)for(var Vp=Bp*lp,Jp=Bp*_d,Xp=Cp;Xp<Ip;++Xp)for(var tm=(Sp+Xp*Je-Mp)*vp+Vp,bm=Xp*ep+Jp,xm=Fp;xm<Hp;++xm)for(var Wm=(Ep+xm*Mt-wp)*gp+tm,Nm=xm*rp+bm,wm=mp;wm<yp;++wm){var Mm=wm*sp+Nm;hp+=op[(Gp+wm*nn-Np)*Op+Wm+qp]*ho[Mm+fp]}hn[$p+fp]=hp}return fn.toTensor()},Ge.prototype.fusedDepthwiseConv2D=function($e){var Ye=$e.input,Qe=$e.filter,Je=$e.convInfo,Mt=$e.bias,nn=$e.activation,an=$e.preluActivationWeights,sn=this.depthwiseConv2D(Ye,Qe,Je);return Mt&&(sn=this.add(sn,Mt)),nn&&(sn=qh(this,sn,nn,an)),sn},Ge.prototype.depthwiseConv2D=function($e,Ye,Qe){Hh([$e,Ye],"depthwiseConv2D");for(var Je=Qe.filterHeight,Mt=Qe.filterWidth,nn=Qe.dilationHeight,an=Qe.dilationWidth,sn=Qe.padInfo.left,ln=Qe.padInfo.top,fn=Qe.outChannels/Qe.inChannels,hn=dr(Qe.outShape,$e.dtype),Xr=this.readSync($e.dataId),Mi=this.readSync(Ye.dataId),co=hn.values,lo=0;lo<Qe.batchSize;++lo)for(var uo=lo*$e.strides[0],ho=lo*hn.strides[0],mo=0;mo<Qe.outHeight;++mo)for(var _d=ho+mo*hn.strides[1],ep=mo*Qe.strideHeight-sn,rp=0;rp<Je;++rp){var sp=ep+rp*nn;if(!(sp<0||sp>=Qe.inHeight))for(var op=rp*Ye.strides[0],ip=uo+sp*$e.strides[1],lp=0;lp<Qe.outWidth;++lp)for(var vp=_d+lp*hn.strides[2],gp=lp*Qe.strideWidth-ln,Op=0;Op<Mt;++Op){var Mp=gp+Op*an;if(!(Mp<0||Mp>=Qe.inWidth))for(var Np=op+Op*Ye.strides[1],wp=ip+Mp*Qe.inChannels,Sp=vp,Cp=Np,Ip=0;Ip<Qe.inChannels;++Ip){for(var cp=Xr[wp+Ip],Ep=0;Ep<fn;++Ep)co[Sp+Ep]+=cp*Mi[Cp+Ep];Sp+=fn,Cp+=fn}}}return hn.toTensor()},Ge.prototype.depthwiseConv2DDerInput=function($e,Ye,Qe){Hh([$e,Ye],"depthwiseConv2DDerInput");for(var Je=dr(Qe.inShape,"float32"),Mt=Je.values,nn=Je.strides,an=nn[0],sn=nn[1],ln=nn[2],fn=this.readSync($e.dataId),hn=$e.strides,Xr=hn[0],Mi=hn[1],co=hn[2],lo=this.readSync(Ye.dataId),uo=Ye.strides,ho=uo[0],mo=uo[1],_d=uo[2],ep=Qe.batchSize,rp=Qe.filterHeight,sp=Qe.filterWidth,op=Qe.inChannels,ip=Qe.inHeight,lp=Qe.inWidth,vp=Qe.outChannels,gp=Qe.outHeight,Op=Qe.outWidth,Mp=Qe.strideHeight,Np=Qe.strideWidth,wp=rp-1-Qe.padInfo.top,Sp=sp-1-Qe.padInfo.left,Cp=vp/op,Ip=0;Ip<ep;++Ip)for(var cp=0;cp<op;++cp)for(var Ep=0;Ep<ip;++Ep)for(var Fp=Ep-wp,Hp=Math.max(0,Math.ceil(Fp/Mp)),zp=Math.min(gp,(rp+Fp)/Mp),Gp=0;Gp<lp;++Gp){for(var mp=Gp-Sp,yp=Math.max(0,Math.ceil(mp/Np)),Tp=Math.min(Op,(sp+mp)/Np),qp=0,$p=Hp;$p<zp;++$p)for(var fp=$p*Mp-Fp,hp=yp;hp<Tp;++hp)for(var Bp=Xr*Ip+Mi*$p+co*hp,Vp=ho*(rp-1-fp)+mo*(sp-1-(hp*Np-mp))+_d*cp,Jp=0;Jp<Cp;++Jp)qp+=fn[Bp+(cp*Cp+Jp)]*lo[Vp+Jp];Mt[an*Ip+sn*Ep+ln*Gp+cp]=qp}return Je.toTensor()},Ge.prototype.depthwiseConv2DDerFilter=function($e,Ye,Qe){Hh([$e,Ye],"depthwiseConv2DDerFilter");for(var Je=Qe.strideHeight,Mt=Qe.strideWidth,nn=Qe.filterHeight,an=Qe.filterWidth,sn=dr(Qe.filterShape,"float32"),ln=Qe.padInfo.left,fn=Qe.padInfo.top,hn=Qe.outChannels/Qe.inChannels,Xr=this.bufferSync($e),Mi=this.bufferSync(Ye),co=0;co<nn;++co)for(var lo=Math.max(0,Math.ceil((fn-co)/Je)),uo=Math.min(Qe.outHeight,(Qe.inHeight+fn-co)/Je),ho=0;ho<an;++ho)for(var mo=Math.max(0,Math.ceil((ln-ho)/Mt)),_d=Math.min(Qe.outWidth,(Qe.inWidth+ln-ho)/Mt),ep=0;ep<Qe.outChannels;++ep){for(var rp=Math.trunc(ep/hn),sp=ep%hn,op=0,ip=0;ip<Qe.batchSize;++ip)for(var lp=lo;lp<uo;++lp)for(var vp=co+lp*Je-fn,gp=mo;gp<_d;++gp){var Op=ho+gp*Mt-ln;op+=Xr.get(ip,vp,Op,rp)*Mi.get(ip,lp,gp,ep)}sn.set(op,co,ho,rp,sp)}return sn.toTensor()},Ge.prototype.tile=function($e,Ye){return Hh($e,"tile"),ta(this.bufferSync($e),Ye)},Ge.prototype.pad=function($e,Ye,Qe){Hh($e,"pad");var Je=Ye.map(function(hn,Xr){return hn[0]+$e.shape[Xr]+hn[1]}),Mt=Ye.map(function(hn){return hn[0]}),nn=this.bufferSync($e),an=dr(Je,$e.dtype);Qe!==0&&an.values.fill(Qe);for(var sn=0;sn<$e.size;sn++){var ln=nn.indexToLoc(sn),fn=ln.map(function(hn,Xr){return hn+Mt[Xr]});an.set.apply(an,[nn.get.apply(nn,ln)].concat(fn))}return an.toTensor()},Ge.prototype.transpose=function($e,Ye){Hh($e,"transpose");for(var Qe=new Array($e.rank),Je=0;Je<Qe.length;Je++)Qe[Je]=$e.shape[Ye[Je]];var Mt=this.readSync($e.dataId),nn=dr(Qe,$e.dtype),an=this.bufferSync($e);for(Je=0;Je<$e.size;++Je){for(var sn=an.indexToLoc(Je),ln=new Array(sn.length),fn=0;fn<ln.length;fn++)ln[fn]=sn[Ye[fn]];var hn=nn.locToIndex(ln);nn.values[hn]=Mt[Je]}return nn.toTensor()},Ge.prototype.gather=function($e,Ye,Qe){Hh([$e,Ye],"gather");var Je=$e.shape.slice(),Mt=this.readSync(Ye.dataId);Je[Qe]=Mt.length;for(var nn=dr(Je,$e.dtype),an=this.bufferSync($e),sn=0;sn<nn.size;++sn){var ln=nn.indexToLoc(sn),fn=ln.slice();fn[Qe]=Mt[ln[Qe]];var hn=an.locToIndex(fn);nn.values[sn]=an.values[hn]}return nn.toTensor()},Ge.prototype.batchToSpaceND=function($e,Ye,Qe){Hh([$e],"batchToSpaceND");var Je=Ye.reduce(function(fn,hn){return fn*hn}),Mt=zr($e.shape,Ye,Je),nn=Gr(Mt.length,Ye.length),an=Hr($e.shape,Ye,Je),sn=qr(Qe,Ye.length),ln=Kr(an,Qe,Ye.length);return $e.reshape(Mt).transpose(nn).reshape(an).slice(sn,ln)},Ge.prototype.spaceToBatchND=function($e,Ye,Qe){Hh([$e],"spaceToBatchND");var Je=Ye.reduce(function(hn,Xr){return hn*Xr}),Mt=[[0,0]];Mt.push.apply(Mt,Qe);for(var nn=1+Ye.length;nn<$e.shape.length;++nn)Mt.push([0,0]);var an=$e.pad(Mt),sn=zr(an.shape,Ye,Je,!1),ln=Gr(sn.length,Ye.length,!1),fn=Hr(an.shape,Ye,Je,!1);return an.reshape(sn).transpose(ln).reshape(fn)},Ge.prototype.pool=function($e,Ye,Qe){Hh($e,"pool");for(var Je=Ye.strideHeight,Mt=Ye.strideWidth,nn=Ye.dilationHeight,an=Ye.dilationWidth,sn=Ye.effectiveFilterHeight,ln=Ye.effectiveFilterWidth,fn=Ye.padInfo.top,hn=Ye.padInfo.left,Xr=Qe==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,Mi=this.readSync($e.dataId),co=dr(Ye.outShape,$e.dtype),lo=co.values,uo=Ye.outShape[1]*Ye.outShape[2]*Ye.outShape[3],ho=Ye.outShape[2]*Ye.outShape[3],mo=Ye.outShape[3],_d=0;_d<Ye.batchSize;++_d)for(var ep=_d*uo,rp=_d*$e.strides[0],sp=0;sp<Ye.inChannels;++sp)for(var op=0;op<Ye.outHeight;++op)for(var ip=op*Je-fn,lp=Math.max(0,ip),vp=Math.min(Ye.inHeight,sn+ip),gp=ep+op*ho,Op=0;Op<Ye.outWidth;++Op){for(var Mp=Op*Mt-hn,Np=Math.max(0,Mp),wp=Math.min(Ye.inWidth,ln+Mp),Sp=Xr,Cp=0,Ip=0,cp=lp;cp<vp;cp+=nn){for(var Ep=rp+cp*$e.strides[1],Fp=Np;Fp<wp;Fp+=an){var Hp=Mi[Ep+Fp*$e.strides[2]+sp];Qe==="max"&&Hp>Sp?Sp=Hp:Qe==="avg"&&(Cp+=Hp,Ip++)}if(isNaN(Sp))break}lo[gp+Op*mo+sp]=Qe==="avg"?Cp/Ip:Sp}return co.toTensor()},Ge.prototype.maxPool=function($e,Ye){return this.pool($e,Ye,"max")},Ge.prototype.maxPoolPositions=function($e,Ye){for(var Qe=dr(Ye.outShape,"int32"),Je=Ye.strideHeight,Mt=Ye.strideWidth,nn=Ye.dilationHeight,an=Ye.dilationWidth,sn=Ye.effectiveFilterHeight,ln=Ye.effectiveFilterWidth,fn=Ye.padInfo.top,hn=Ye.padInfo.left,Xr=this.bufferSync($e),Mi=0;Mi<Ye.batchSize;++Mi)for(var co=0;co<Ye.inChannels;++co)for(var lo=0;lo<Ye.outHeight;++lo){for(var uo=lo*Je-fn,ho=uo;ho<0;)ho+=nn;for(var mo=Math.min(Ye.inHeight,sn+uo),_d=0;_d<Ye.outWidth;++_d){for(var ep=_d*Mt-hn,rp=ep;rp<0;)rp+=an;for(var sp=Math.min(Ye.inWidth,ln+ep),op=Number.NEGATIVE_INFINITY,ip=-1,lp=ho;lp<mo;lp+=nn)for(var vp=lp-uo,gp=rp;gp<sp;gp+=an){var Op=gp-ep,Mp=Xr.get(Mi,lp,gp,co);Mp>op&&(op=Mp,ip=vp*ln+Op)}Qe.set(ip,Mi,lo,_d,co)}}return Qe.toTensor()},Ge.prototype.maxPoolBackprop=function($e,Ye,Qe,Je){Hh([Ye,Qe],"maxPoolBackprop");for(var Mt=this.maxPoolPositions(Ye,Je),nn=Je.strideHeight,an=Je.strideWidth,sn=Je.dilationHeight,ln=Je.dilationWidth,fn=Je.effectiveFilterHeight,hn=Je.effectiveFilterWidth,Xr=hn-1-Je.padInfo.left,Mi=fn-1-Je.padInfo.top,co=dr(Ye.shape,"float32"),lo=this.bufferSync(Mt),uo=this.bufferSync($e),ho=0;ho<Je.batchSize;++ho)for(var mo=0;mo<Je.inChannels;++mo)for(var _d=0;_d<Je.inHeight;++_d)for(var ep=0;ep<Je.inWidth;++ep){for(var rp=_d-Mi,sp=ep-Xr,op=0,ip=0;ip<fn;ip+=sn){var lp=(rp+ip)/nn;if(!(lp<0||lp>=Je.outHeight||Math.floor(lp)!==lp))for(var vp=0;vp<hn;vp+=ln){var gp=(sp+vp)/an;if(!(gp<0||gp>=Je.outWidth||Math.floor(gp)!==gp)){var Op=fn*hn-1-lo.get(ho,lp,gp,mo)===ip*hn+vp?1:0;Op!==0&&(op+=uo.get(ho,lp,gp,mo)*Op)}}}co.set(op,ho,_d,ep,mo)}return co.toTensor()},Ge.prototype.avgPoolBackprop=function($e,Ye,Qe){Hh([$e,Ye],"avgPoolBackprop");for(var Je=Qe.strideHeight,Mt=Qe.strideWidth,nn=Qe.filterHeight,an=Qe.filterWidth,sn=Qe.dilationHeight,ln=Qe.dilationWidth,fn=Qe.effectiveFilterHeight,hn=Qe.effectiveFilterWidth,Xr=hn-1-Qe.padInfo.left,Mi=fn-1-Qe.padInfo.top,co=dr(Ye.shape,"float32"),lo=1/(nn*an),uo=this.bufferSync($e),ho=0;ho<Qe.batchSize;++ho)for(var mo=0;mo<Qe.inChannels;++mo)for(var _d=0;_d<Qe.inHeight;++_d)for(var ep=0;ep<Qe.inWidth;++ep){for(var rp=_d-Mi,sp=ep-Xr,op=0,ip=0;ip<fn;ip+=sn){var lp=(rp+ip)/Je;if(!(lp<0||lp>=Qe.outHeight||Math.floor(lp)!==lp))for(var vp=0;vp<hn;vp+=ln){var gp=(sp+vp)/Mt;gp<0||gp>=Qe.outWidth||Math.floor(gp)!==gp||(op+=uo.get(ho,lp,gp,mo))}}co.set(op*lo,ho,_d,ep,mo)}return co.toTensor()},Ge.prototype.pool3d=function($e,Ye,Qe){Hh($e,"pool3d");for(var Je=Ye.strideDepth,Mt=Ye.strideHeight,nn=Ye.strideWidth,an=Ye.dilationDepth,sn=Ye.dilationHeight,ln=Ye.dilationWidth,fn=Ye.effectiveFilterDepth,hn=Ye.effectiveFilterHeight,Xr=Ye.effectiveFilterWidth,Mi=Ye.padInfo.front,co=Ye.padInfo.top,lo=Ye.padInfo.left,uo=Qe==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,ho=this.readSync($e.dataId),mo=dr(Ye.outShape,$e.dtype),_d=mo.values,ep=Ye.outShape[1]*Ye.outShape[2]*Ye.outShape[3]*Ye.outShape[4],rp=Ye.outShape[2]*Ye.outShape[3]*Ye.outShape[4],sp=Ye.outShape[3]*Ye.outShape[4],op=Ye.outShape[4],ip=0;ip<Ye.batchSize;++ip)for(var lp=ip*ep,vp=ip*$e.strides[0],gp=0;gp<Ye.inChannels;++gp)for(var Op=0;Op<Ye.outDepth;++Op){for(var Mp=Op*Je-Mi,Np=Mp;Np<0;)Np+=an;for(var wp=Math.min(Ye.inDepth,fn+Mp),Sp=lp+Op*rp,Cp=0;Cp<Ye.outHeight;++Cp){for(var Ip=Cp*Mt-co,cp=Ip;cp<0;)cp+=sn;for(var Ep=Math.min(Ye.inHeight,hn+Ip),Fp=Sp+Cp*sp,Hp=0;Hp<Ye.outWidth;++Hp){for(var zp=Hp*nn-lo,Gp=zp;Gp<0;)Gp+=ln;for(var mp=Math.min(Ye.inWidth,Xr+zp),yp=Fp+Hp*op,Tp=uo,qp=0,$p=0,fp=Np;fp<wp;fp+=an){for(var hp=vp+fp*$e.strides[1],Bp=cp;Bp<Ep;Bp+=sn){for(var Vp=hp+Bp*$e.strides[2],Jp=Gp;Jp<mp;Jp+=ln){var Xp=ho[Vp+Jp*$e.strides[3]+gp];if(Qe==="max"&&Xp>Tp?Tp=Xp:Qe==="avg"&&(qp+=Xp,$p++),isNaN(Tp))break}if(isNaN(Tp))break}if(isNaN(Tp))break}_d[yp+gp]=Qe==="avg"?qp/$p:Tp}}}return mo.toTensor()},Ge.prototype.avgPool3d=function($e,Ye){return Hh($e,"avgPool3d"),this.pool3d($e,Ye,"avg").toFloat()},Ge.prototype.avgPool3dBackprop=function($e,Ye,Qe){Hh([$e,Ye],"avgPool3dBackprop");for(var Je=Qe.strideDepth,Mt=Qe.strideHeight,nn=Qe.strideWidth,an=Qe.filterDepth,sn=Qe.filterHeight,ln=Qe.filterWidth,fn=Qe.dilationDepth,hn=Qe.dilationHeight,Xr=Qe.dilationWidth,Mi=Qe.effectiveFilterDepth,co=Qe.effectiveFilterHeight,lo=Qe.effectiveFilterWidth,uo=Mi-1-Qe.padInfo.front,ho=lo-1-Qe.padInfo.left,mo=co-1-Qe.padInfo.top,_d=dr(Ye.shape,"float32"),ep=1/(an*sn*ln),rp=this.bufferSync($e),sp=0;sp<Qe.batchSize;++sp)for(var op=0;op<Qe.inChannels;++op)for(var ip=0;ip<Qe.inDepth;++ip)for(var lp=0;lp<Qe.inHeight;++lp)for(var vp=0;vp<Qe.inWidth;++vp){for(var gp=ip-uo,Op=lp-mo,Mp=vp-ho,Np=0,wp=0;wp<Mi;wp+=fn){var Sp=(gp+wp)/Je;if(!(Sp<0||Sp>=Qe.outDepth||Math.floor(Sp)!==Sp))for(var Cp=0;Cp<co;Cp+=hn){var Ip=(Op+Cp)/Mt;if(!(Ip<0||Ip>=Qe.outHeight||Math.floor(Ip)!==Ip))for(var cp=0;cp<lo;cp+=Xr){var Ep=(Mp+cp)/nn;Ep<0||Ep>=Qe.outWidth||Math.floor(Ep)!==Ep||(Np+=rp.get(sp,Sp,Ip,Ep,op))}}}_d.set(Np*ep,sp,ip,lp,vp,op)}return _d.toTensor()},Ge.prototype.maxPool3d=function($e,Ye){return Hh($e,"maxPool3d"),this.pool3d($e,Ye,"max").toFloat()},Ge.prototype.maxPool3dPositions=function($e,Ye){for(var Qe=dr(Ye.outShape,"int32"),Je=Ye.strideDepth,Mt=Ye.strideHeight,nn=Ye.strideWidth,an=Ye.dilationDepth,sn=Ye.dilationHeight,ln=Ye.dilationWidth,fn=Ye.effectiveFilterDepth,hn=Ye.effectiveFilterHeight,Xr=Ye.effectiveFilterWidth,Mi=Ye.padInfo.front,co=Ye.padInfo.top,lo=Ye.padInfo.left,uo=this.bufferSync($e),ho=0;ho<Ye.batchSize;++ho)for(var mo=0;mo<Ye.inChannels;++mo)for(var _d=0;_d<Ye.outDepth;++_d){for(var ep=_d*Je-Mi,rp=ep;rp<0;)rp+=an;for(var sp=Math.min(Ye.inDepth,fn+ep),op=0;op<Ye.outHeight;++op){for(var ip=op*Mt-co,lp=ip;lp<0;)lp+=sn;for(var vp=Math.min(Ye.inHeight,hn+ip),gp=0;gp<Ye.outWidth;++gp){for(var Op=gp*nn-lo,Mp=Op;Mp<0;)Mp+=ln;for(var Np=Math.min(Ye.inWidth,Xr+Op),wp=Number.NEGATIVE_INFINITY,Sp=-1,Cp=rp;Cp<sp;Cp+=an)for(var Ip=Cp-ep,cp=lp;cp<vp;cp+=sn)for(var Ep=cp-ip,Fp=Mp;Fp<Np;Fp+=ln){var Hp=Fp-Op,zp=uo.get(ho,Cp,cp,Fp,mo);zp>=wp&&(wp=zp,Sp=Ip*hn*Xr+Ep*hn+Hp)}Qe.set(Sp,ho,_d,op,gp,mo)}}}return Qe.toTensor()},Ge.prototype.maxPool3dBackprop=function($e,Ye,Qe,Je){Hh([Ye,Qe],"maxPool3dBackprop");for(var Mt=this.maxPool3dPositions(Ye,Je),nn=Je.strideDepth,an=Je.strideHeight,sn=Je.strideWidth,ln=Je.dilationDepth,fn=Je.dilationHeight,hn=Je.dilationWidth,Xr=Je.effectiveFilterDepth,Mi=Je.effectiveFilterHeight,co=Je.effectiveFilterWidth,lo=Xr-1-Je.padInfo.front,uo=co-1-Je.padInfo.left,ho=Mi-1-Je.padInfo.top,mo=dr(Ye.shape,"float32"),_d=this.bufferSync(Mt),ep=this.bufferSync($e),rp=0;rp<Je.batchSize;++rp)for(var sp=0;sp<Je.inChannels;++sp)for(var op=0;op<Je.inDepth;++op)for(var ip=0;ip<Je.inHeight;++ip)for(var lp=0;lp<Je.inWidth;++lp){for(var vp=op-lo,gp=ip-ho,Op=lp-uo,Mp=0,Np=0;Np<Xr;Np+=ln){var wp=(vp+Np)/nn;if(!(wp<0||wp>=Je.outDepth||Math.floor(wp)!==wp))for(var Sp=0;Sp<Mi;Sp+=fn){var Cp=(gp+Sp)/an;if(!(Cp<0||Cp>=Je.outHeight||Math.floor(Cp)!==Cp))for(var Ip=0;Ip<co;Ip+=hn){var cp=(Op+Ip)/sn;if(!(cp<0||cp>=Je.outWidth||Math.floor(cp)!==cp)){var Ep=Xr*Mi*co-1-_d.get(rp,wp,Cp,cp,sp)===Np*Mi*co+Sp*co+Ip?1:0;Ep!==0&&(Mp+=ep.get(rp,wp,Cp,cp,sp)*Ep)}}}}mo.set(Mp,rp,op,ip,lp,sp)}return mo.toTensor()},Ge.prototype.cast=function($e,Ye){return Po($e,Ye,this)},Ge.prototype.reshape=function($e,Ye){return Lo($e,Ye)},Ge.prototype.avgPool=function($e,Ye){return Hh($e,"avgPool"),this.pool($e,Ye,"avg").toFloat()},Ge.prototype.resizeBilinear=function($e,Ye,Qe,Je){Hh($e,"resizeBilinear");for(var Mt=$e.shape,nn=Mt[0],an=Mt[1],sn=Mt[2],ln=Mt[3],fn=this.readSync($e.dataId),hn=new Float32Array(k([nn,Ye,Qe,ln])),Xr=[Je&&Ye>1?an-1:an,Je&&Qe>1?sn-1:sn],Mi=[Je&&Ye>1?Ye-1:Ye,Je&&Qe>1?Qe-1:Qe],co=0,lo=Xr[0]/Mi[0],uo=Xr[1]/Mi[1],ho=0;ho<nn;ho++)for(var mo=0;mo<Ye;mo++)for(var _d=lo*mo,ep=Math.floor(_d),rp=_d-ep,sp=Math.min(an-1,Math.ceil(_d)),op=ho*$e.strides[0]+ep*$e.strides[1],ip=ho*$e.strides[0]+sp*$e.strides[1],lp=0;lp<Qe;lp++)for(var vp=uo*lp,gp=Math.floor(vp),Op=vp-gp,Mp=Math.min(sn-1,Math.ceil(vp)),Np=op+gp*$e.strides[2],wp=ip+gp*$e.strides[2],Sp=op+Mp*$e.strides[2],Cp=ip+Mp*$e.strides[2],Ip=0;Ip<ln;Ip++){var cp=fn[Np+Ip],Ep=fn[wp+Ip],Fp=cp+(fn[Sp+Ip]-cp)*Op,Hp=Fp+(Ep+(fn[Cp+Ip]-Ep)*Op-Fp)*rp;hn[co++]=Hp}return Fn(hn,[nn,Ye,Qe,ln])},Ge.prototype.resizeBilinearBackprop=function($e,Ye,Qe){Hh([$e,Ye],"resizeBilinearBackprop");for(var Je=Ye.shape,Mt=Je[0],nn=Je[1],an=Je[2],sn=Je[3],ln=$e.shape,fn=ln[1],hn=ln[2],Xr=new Float32Array(Mt*nn*an*sn),Mi=[Qe&&fn>1?nn-1:nn,Qe&&hn>1?an-1:an],co=[Qe&&fn>1?fn-1:fn,Qe&&hn>1?hn-1:hn],lo=Mi[0]/co[0],uo=Mi[1]/co[1],ho=this.readSync($e.dataId),mo=0,_d=0;_d<Mt;_d++)for(var ep=_d*Ye.strides[0],rp=0;rp<fn;rp++)for(var sp=rp*lo,op=Math.floor(sp),ip=Math.min(Math.ceil(sp),nn-1),lp=ep+op*Ye.strides[1],vp=ep+ip*Ye.strides[1],gp=sp-op,Op=1-gp,Mp=0;Mp<hn;Mp++)for(var Np=Mp*uo,wp=Math.floor(Np),Sp=Math.min(Math.ceil(Np),an-1),Cp=Np-wp,Ip=1-Cp,cp=lp+wp*Ye.strides[2],Ep=lp+Sp*Ye.strides[2],Fp=vp+wp*Ye.strides[2],Hp=vp+Sp*Ye.strides[2],zp=Op*Ip,Gp=Op*Cp,mp=gp*Ip,yp=gp*Cp,Tp=0;Tp<sn;Tp++){var qp=ho[mo++];Xr[cp+Tp]+=qp*zp,Xr[Ep+Tp]+=qp*Gp,Xr[Fp+Tp]+=qp*mp,Xr[Hp+Tp]+=qp*yp}return Ln(Xr,[Mt,an,nn,sn],Ye.dtype)},Ge.prototype.resizeNearestNeighbor=function($e,Ye,Qe,Je){Hh($e,"resizeNearestNeighbor");for(var Mt=$e.shape,nn=Mt[0],an=Mt[1],sn=Mt[2],ln=Mt[3],fn=this.readSync($e.dataId),hn=new Float32Array(nn*Ye*Qe*ln),Xr=[Je&&Ye>1?an-1:an,Je&&Qe>1?sn-1:sn],Mi=[Je&&Ye>1?Ye-1:Ye,Je&&Qe>1?Qe-1:Qe],co=Xr[0]/Mi[0],lo=Xr[1]/Mi[1],uo=0,ho=0;ho<nn;ho++)for(var mo=ho*$e.strides[0],_d=0;_d<Ye;_d++)for(var ep=co*_d,rp=mo+Math.min(an-1,Je?Math.round(ep):Math.floor(ep))*$e.strides[1],sp=0;sp<Qe;sp++)for(var op=lo*sp,ip=rp+Math.min(sn-1,Je?Math.round(op):Math.floor(op))*$e.strides[2],lp=0;lp<ln;lp++){var vp=fn[ip+lp];hn[uo++]=vp}return Fn(hn,[nn,Ye,Qe,ln],$e.dtype)},Ge.prototype.resizeNearestNeighborBackprop=function($e,Ye,Qe){Hh([$e,Ye],"resizeNearestNeighborBackprop");for(var Je=Ye.shape,Mt=Je[0],nn=Je[1],an=Je[2],sn=Je[3],ln=$e.shape,fn=ln[1],hn=ln[2],Xr=new Float32Array(Mt*nn*an*sn),Mi=this.readSync($e.dataId),co=[Qe&&fn>1?nn-1:nn,Qe&&hn>1?an-1:an],lo=[Qe&&fn>1?fn-1:fn,Qe&&hn>1?hn-1:hn],uo=co[0]/lo[0],ho=co[1]/lo[1],mo=1/uo,_d=1/ho,ep=2*Math.ceil(mo)+2,rp=2*Math.ceil(_d)+2,sp=0;sp<Mt;sp++)for(var op=sp*Ye.strides[0],ip=0;ip<nn;ip++)for(var lp=op+ip*Ye.strides[1],vp=Math.floor(ip*mo),gp=Math.floor(vp-ep/2),Op=0;Op<an;Op++)for(var Mp=lp+Op*Ye.strides[2],Np=Math.floor(Op*_d),wp=Math.floor(Np-rp/2),Sp=0;Sp<sn;Sp++){for(var Cp=0,Ip=0;Ip<ep;Ip++){var cp=Ip+gp;if(!(cp<0||cp>=fn)){var Ep=op+cp*$e.strides[1],Fp=cp*uo;if(ip===Math.min(nn-1,Qe?Math.round(Fp):Math.floor(Fp)))for(var Hp=0;Hp<rp;Hp++){var zp=Hp+wp;if(!(zp<0||zp>=hn)){var Gp=Ep+zp*$e.strides[2],mp=zp*ho;Op===Math.min(an-1,Qe?Math.round(mp):Math.floor(mp))&&(Cp+=Mi[Gp+Sp])}}}}Xr[Mp+Sp]=Cp}return Ln(Xr,Ye.shape,Ye.dtype)},Ge.prototype.batchNormalization=function($e,Ye,Qe,Je,Mt,nn){Hh([$e,Ye,Qe,Mt,nn],"batchNorm");for(var an=this.readSync($e.dataId),sn=this.readSync(Ye.dataId),ln=this.readSync(Qe.dataId),fn=Mt?this.readSync(Mt.dataId):new Float32Array([1]),hn=nn?this.readSync(nn.dataId):new Float32Array([0]),Xr=new Float32Array(an.length),Mi=hn.length,co=fn.length,lo=ln.length,uo=sn.length,ho=0,mo=0,_d=0,ep=0,rp=0;rp<an.length;++rp)Xr[rp]=hn[ho++]+(an[rp]-sn[mo++])*fn[_d++]/Math.sqrt(ln[ep++]+Je),ho>=Mi&&(ho=0),mo>=uo&&(mo=0),_d>=co&&(_d=0),ep>=lo&&(ep=0);return Ln(Xr,$e.shape)},Ge.prototype.localResponseNormalization4D=function($e,Ye,Qe,Je,Mt){Hh($e,"localResponseNormalization4D");var nn=$e.shape[3],an=nn-1,sn=this.readSync($e.dataId),ln=$e.size,fn=new Float32Array(ln);function hn(lo){for(var uo=lo%nn,ho=lo-uo+Math.max(0,uo-Ye),mo=lo-uo+Math.min(uo+Ye,an),_d=0;ho<=mo;ho++){var ep=sn[ho];_d+=ep*ep}return _d}for(var Xr=0;Xr<ln;Xr++){var Mi=hn(Xr),co=sn[Xr]*Math.pow(Qe+Je*Mi,-Mt);fn[Xr]=co}return Ln(fn,$e.shape)},Ge.prototype.LRNGrad=function($e,Ye,Qe,Je,Mt,nn,an){Hh($e,"LRNGrad");for(var sn=$e.shape[3],ln=this.readSync($e.dataId),fn=this.readSync(Ye.dataId),hn=this.readSync(Qe.dataId),Xr=new Float32Array($e.size),Mi=$e.size,co=0;co<Mi;co++){for(var lo=co%sn,uo=co-lo+Math.max(0,lo-Je),ho=co-lo+Math.min(sn,lo+Je+1),mo=0,_d=uo;_d<ho;_d++)mo+=Math.pow(fn[_d],2);for(mo=nn*mo+Mt,_d=uo;_d<ho;_d++){var ep=-2*nn*an*fn[_d]*hn[co]/mo;co===_d&&(ep+=Math.pow(mo,-an)),ep*=ln[co],Xr[_d]+=ep}}return Ln(Xr,$e.shape)},Ge.prototype.multinomial=function($e,Ye,Qe,Je){Hh($e,"multinomial");for(var Mt=Ye?$e:go($e),nn=Mt.shape[0],an=Mt.shape[1],sn=Gn([nn,Qe],"int32"),ln=this.readSync(sn.dataId),fn=this.readSync(Mt.dataId),hn=0;hn<nn;++hn){var Xr=hn*an,Mi=new Float32Array(an-1);Mi[0]=fn[Xr];for(var co=1;co<Mi.length;++co)Mi[co]=Mi[co-1]+fn[Xr+co];for(var lo=cr(Je.toString()),uo=hn*Qe,ho=0;ho<Qe;++ho){var mo=lo();ln[uo+ho]=Mi.length;for(var _d=0;_d<Mi.length;_d++)if(mo<Mi[_d]){ln[uo+ho]=_d;break}}}return sn},Ge.prototype.oneHot=function($e,Ye,Qe,Je){Hh($e,"oneHot");var Mt=new Float32Array($e.size*Ye);Mt.fill(Je);for(var nn=this.readSync($e.dataId),an=0;an<$e.size;++an)nn[an]>=0&&nn[an]<Ye&&(Mt[an*Ye+nn[an]]=Qe);return Bn(Mt,[$e.size,Ye],"int32")},Ge.prototype.nonMaxSuppression=function($e,Ye,Qe,Je,Mt){return Hh($e,"nonMaxSuppression"),jo(this.readSync($e.dataId),this.readSync(Ye.dataId),Qe,Je,Mt)},Ge.prototype.fft=function($e){return this.fftBatch($e,!1)},Ge.prototype.ifft=function($e){return this.fftBatch($e,!0)},Ge.prototype.fftBatch=function($e,Ye){for(var Qe=$e.shape[0],Je=$e.shape[1],Mt=dr($e.shape,"float32"),nn=dr($e.shape,"float32"),an=Tn($e).as2D(Qe,Je),sn=Nn($e).as2D(Qe,Je),ln=0;ln<Qe;ln++)for(var fn=an.slice([ln,0],[1,Je]),hn=sn.slice([ln,0],[1,Je]),Xr=Dn(fn,hn),Mi=this.readSync(this.fftImpl(Xr,Ye).dataId),co=0;co<Je;co++){var lo=zo(Mi,co);Mt.values[ln*Je+co]=lo.real,nn.values[ln*Je+co]=lo.imag}return Dn(Mt.toTensor(),nn.toTensor()).as2D(Qe,Je)},Ge.prototype.fftImpl=function($e,Ye){var Qe=$e.as1D(),Je=Qe.size;if(this.isExponentOf2(Je)){var Mt=this.fftRadix2(Qe,Je,Ye).as2D($e.shape[0],$e.shape[1]);return Ye&&(Mt=Dn(Tn(Mt).div(On(Je)),Nn(Mt).div(On(Je)))),Mt}var nn=this.readSync($e.dataId),an=function(sn){for(var ln=new Float32Array(sn.length/2),fn=new Float32Array(sn.length/2),hn=0;hn<sn.length;hn+=2)ln[hn/2]=sn[hn],fn[hn/2]=sn[hn+1];return{real:ln,imag:fn}}(this.fourierTransformByMatmul(nn,Je,Ye));return Dn(an.real,an.imag).as2D($e.shape[0],$e.shape[1])},Ge.prototype.isExponentOf2=function($e){return($e&$e-1)==0},Ge.prototype.fftRadix2=function($e,Ye,Qe){if(Ye===1)return $e;var Je=this.readSync($e.dataId),Mt=Ye/2,nn=function(uo){for(var ho=Math.ceil(uo.length/4),mo=new Float32Array(ho),_d=new Float32Array(ho),ep=0;ep<uo.length;ep+=4)mo[Math.floor(ep/4)]=uo[ep],_d[Math.floor(ep/4)]=uo[ep+1];return{real:mo,imag:_d}}(Je),an=Dn(nn.real,nn.imag).as1D(),sn=function(uo){for(var ho=Math.floor(uo.length/4),mo=new Float32Array(ho),_d=new Float32Array(ho),ep=2;ep<uo.length;ep+=4)mo[Math.floor(ep/4)]=uo[ep],_d[Math.floor(ep/4)]=uo[ep+1];return{real:mo,imag:_d}}(Je),ln=Dn(sn.real,sn.imag).as1D();an=this.fftRadix2(an,Mt,Qe),ln=this.fftRadix2(ln,Mt,Qe);var fn=function(uo,ho){for(var mo=new Float32Array(uo/2),_d=new Float32Array(uo/2),ep=0;ep<Math.ceil(uo/2);ep++){var rp=(ho?2:-2)*Math.PI*(ep/uo);mo[ep]=Math.cos(rp),_d[ep]=Math.sin(rp)}return{real:mo,imag:_d}}(Ye,Qe),hn=Dn(fn.real,fn.imag).mul(ln),Xr=an.add(hn),Mi=an.sub(hn),co=Tn(Xr).concat(Tn(Mi)),lo=Nn(Xr).concat(Nn(Mi));return Dn(co,lo).as1D()},Ge.prototype.fourierTransformByMatmul=function($e,Ye,Qe){for(var Je=new Float32Array(2*Ye),Mt=0;Mt<Ye;Mt++){for(var nn=0,an=0,sn=0;sn<Ye;sn++){var ln=Ho(Mt*sn,Ye,Qe),fn=zo($e,sn);nn+=fn.real*ln.real-fn.imag*ln.imag,an+=fn.real*ln.imag+fn.imag*ln.real}Qe&&(nn/=Ye,an/=Ye),Go(Je,nn,an,Mt)}return Je},Ge.prototype.depthToSpace=function($e,Ye,Qe){C(Qe==="NHWC",function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+Qe}),C(Ye>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+Ye});for(var Je=$e.shape[0],Mt=$e.shape[1],nn=$e.shape[2],an=$e.shape[3],sn=Mt*Ye,ln=nn*Ye,fn=an/(Ye*Ye),hn=this.readSync($e.dataId),Xr=new Float32Array(Je*sn*ln*fn),Mi=0,co=0;co<Je;++co)for(var lo=0;lo<sn;++lo)for(var uo=Math.floor(lo/Ye),ho=lo%Ye,mo=0;mo<ln;++mo)for(var _d=Math.floor(mo/Ye),ep=(ho*Ye+mo%Ye)*fn,rp=0;rp<fn;++rp){var sp=rp+ep+an*(_d+nn*(uo+Mt*co));Xr[Mi++]=hn[sp]}return Ln(Xr,[Je,sn,ln,fn])},Ge.prototype.broadcastedBinaryOp=function($e,Ye,Qe,Je){var Mt=Ro($e.shape,Ye.shape),nn=dr(Mt,Qe),an=this.readSync($e.dataId),sn=this.readSync(Ye.dataId),ln=Co($e.shape,Mt),fn=Co(Ye.shape,Mt),hn=nn.values;if(ln.length+fn.length===0)for(var Xr=0;Xr<hn.length;++Xr)hn[Xr]=Je(an[Xr%an.length],sn[Xr%sn.length]);else{var Mi=this.bufferSync($e),co=this.bufferSync(Ye),lo=function(uo){var ho=nn.indexToLoc(uo),mo=ho.slice(-$e.rank);ln.forEach(function(sp){return mo[sp]=0});var _d=Mi.locToIndex(mo),ep=ho.slice(-Ye.rank);fn.forEach(function(sp){return ep[sp]=0});var rp=co.locToIndex(ep);hn[uo]=Je(an[_d],sn[rp])};for(Xr=0;Xr<hn.length;++Xr)lo(Xr)}return nn.toTensor()},Ge.prototype.broadcastedBinaryComplexOp=function($e,Ye,Qe){var Je=Ro($e.shape,Ye.shape),Mt=dr(Je,"float32"),nn=dr(Je,"float32"),an=this.readSync($e.dataId),sn=this.readSync(Ye.dataId),ln=Co($e.shape,Je),fn=Co(Ye.shape,Je),hn=Mt.values,Xr=nn.values;if(ln.length+fn.length===0)for(var Mi=0;Mi<hn.length;Mi++){var co=Mi%an.length,lo=Mi%sn.length,uo=Qe(an[2*co],an[2*co+1],sn[2*lo],sn[2*lo+1]);hn[Mi]=uo.real,Xr[Mi]=uo.imag}else{var ho=this.bufferSync(this.data.get($e.dataId).complexTensors.real),mo=this.bufferSync(this.data.get(Ye.dataId).complexTensors.real),_d=function(ep){var rp=Mt.indexToLoc(ep),sp=rp.slice(-$e.rank);ln.forEach(function(gp){return sp[gp]=0});var op=ho.locToIndex(sp),ip=rp.slice(-Ye.rank);fn.forEach(function(gp){return ip[gp]=0});var lp=mo.locToIndex(ip),vp=Qe(an[2*op],an[2*op+1],sn[2*lp],sn[2*lp+1]);hn[ep]=vp.real,Xr[ep]=vp.imag};for(Mi=0;Mi<hn.length;Mi++)_d(Mi)}return this.complex(Mt.toTensor(),nn.toTensor())},Ge.prototype.split=function($e,Ye,Qe){return Zo($e,Ye,Qe)},Ge.prototype.dispose=function(){},Ge.prototype.floatPrecision=function(){return 32},Ge.prototype.epsilon=function(){return 1e-7},Ge.prototype.cropAndResize=function($e,Ye,Qe,Je,Mt,nn){for(var an=$e.shape,sn=an[0],ln=an[1],fn=an[2],hn=an[3],Xr=Ye.shape[0],Mi=Je[0],co=Je[1],lo=dr([Xr,Mi,co,hn],"float32"),uo=this.readSync(Ye.dataId),ho=this.readSync(Qe.dataId),mo=this.readSync($e.dataId),_d=$e.strides,ep=lo.strides,rp=0;rp<Xr;rp++){var sp=4*rp,op=uo[sp],ip=uo[sp+1],lp=uo[sp+2],vp=uo[sp+3],gp=ho[rp];if(!(gp>=sn))for(var Op=Mi>1?(lp-op)*(ln-1)/(Mi-1):0,Mp=co>1?(vp-ip)*(fn-1)/(co-1):0,Np=0;Np<Mi;Np++){var wp=Mi>1?op*(ln-1)+Np*Op:.5*(op+lp)*(ln-1);if(wp<0||wp>ln-1)for(var Sp=0;Sp<co;Sp++)for(var Cp=0;Cp<hn;Cp++){var Ip=Cp+Sp*ep[2]+Np*ep[1]+rp*ep[0];lo.values[Ip]=nn}else if(Mt==="bilinear"){var cp=Math.floor(wp),Ep=Math.ceil(wp),Fp=wp-cp;for(Sp=0;Sp<co;Sp++)if((fp=co>1?ip*(fn-1)+Sp*Mp:.5*(ip+vp)*(fn-1))<0||fp>fn-1)for(Cp=0;Cp<hn;Cp++)Ip=Cp+Sp*ep[2]+Np*ep[1]+rp*ep[0],lo.values[Ip]=nn;else{var Hp=Math.floor(fp),zp=Math.ceil(fp),Gp=fp-Hp;for(Cp=0;Cp<hn;Cp++){var mp=mo[Ip=Cp+Hp*_d[2]+cp*_d[1]+gp*_d[0]],yp=mo[Ip=Cp+zp*_d[2]+cp*_d[1]+gp*_d[0]],Tp=mo[Ip=Cp+Hp*_d[2]+Ep*_d[1]+gp*_d[0]],qp=mp+(yp-mp)*Gp,$p=Tp+(mo[Ip=Cp+zp*_d[2]+Ep*_d[1]+gp*_d[0]]-Tp)*Gp;Ip=Cp+Sp*ep[2]+Np*ep[1]+rp*ep[0],lo.values[Ip]=qp+($p-qp)*Fp}}}else for(Sp=0;Sp<co;++Sp){var fp;if((fp=co>1?ip*(fn-1)+Sp*Mp:.5*(ip+vp)*(fn-1))<0||fp>fn-1)for(Cp=0;Cp<hn;Cp++)Ip=Cp+Sp*ep[2]+Np*ep[1]+rp*ep[0],lo.values[Ip]=nn;else{var hp=Math.round(fp),Bp=Math.round(wp);for(Cp=0;Cp<hn;Cp++){var Vp=Cp+hp*_d[2]+Bp*_d[1]+gp*_d[0],Jp=Cp+Sp*ep[2]+Np*ep[1]+rp*ep[0];lo.values[Jp]=mo[Vp]}}}}}return lo.toTensor()},Ge.prototype.sparseToDense=function($e,Ye,Qe,Je){var Mt=Zr(0,$e,Qe),nn=Mt.sliceRank,an=Mt.numUpdates,sn=Mt.sliceSize,ln=Mt.strides,fn=Mt.outputSize;return this.scatter($e,Ye,Qe,fn,sn,an,nn,ln,Je,!1)},Ge.prototype.gatherND=function($e,Ye){var Qe=Ye.shape,Je=Qe[Qe.length-1],Mt=jr($e,Ye),nn=Mt[0],an=Mt[1],sn=Mt[2],ln=Mt[3];if(an===0)return Fn([],nn,$e.dtype);for(var fn=new gt([an,sn],$e.dtype),hn=this.readSync(Ye.dataId),Xr=this.readSync($e.dataId),Mi=0;Mi<an;Mi++){for(var co=[],lo=0,uo=0;uo<Je;uo++){var ho=hn[Mi*Je+uo];lo+=ho*ln[uo],co.push(ho)}if(lo<0||lo>=$e.size/sn)throw new Error("Invalid indices: "+co+" does not index into "+$e.shape);for(var mo=0;mo<sn;mo++)fn.values[Mi*sn+mo]=Xr[lo*sn+mo]}return fn.toTensor().reshape(nn)},Ge.prototype.scatterND=function($e,Ye,Qe){var Je=Zr(0,$e,Qe),Mt=Je.sliceRank,nn=Je.numUpdates,an=Je.sliceSize,sn=Je.strides,ln=Je.outputSize,fn=On(0);return this.scatter($e,Ye,Qe,ln,an,nn,Mt,sn,fn,!0)},Ge.prototype.fill=function($e,Ye,Qe){var Je=P(Qe=Qe||j(Ye),k($e));return Je.fill(Ye),Lt.makeTensor(Je,$e,Qe,this)},Ge.prototype.onesLike=function($e){if($e.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill($e.shape,1,$e.dtype)},Ge.prototype.zerosLike=function($e){var Ye=P($e.dtype,k($e.shape));return this.makeOutput(Ye,$e.shape,$e.dtype)},Ge.prototype.linspace=function($e,Ye,Qe){return Wo($e,Ye,Qe)},Ge.prototype.scatter=function($e,Ye,Qe,Je,Mt,nn,an,sn,ln,fn){var hn=[Je/Mt,Mt],Xr=this.readSync($e.dataId),Mi=this.readSync(Ye.dataId);if(Je===0)return Fn([],Qe,Ye.dtype);var co=new gt(hn,Ye.dtype);co.values.fill(this.readSync(ln.dataId)[0]);for(var lo=0;lo<nn;lo++){for(var uo=[],ho=0,mo=0;mo<an;mo++){var _d=Xr[lo*an+mo];uo.push(_d),ho+=_d*sn[mo]}if(ho<0||ho>=Je/Mt)throw new Error("Invalid indices: "+uo+" does not index into "+Qe);for(var ep=0;ep<Mt;ep++)fn?co.values[ho*Mt+ep]+=Mi[lo*Mt+ep]:co.values[ho*Mt+ep]=Ye.rank===0?Mi[0]:Mi[lo*Mt+ep]}return co.toTensor().reshape(Qe)},Ge}(bo);Lt.registerBackend("cpu",function(){return new Kh},1);for(var jh=0,Xh=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(Ke){var Ge=Ke.inputs,$e=Ke.backend,Ye=Ke.attrs,Qe=Ge,Je=Qe.boxes,Mt=Qe.scores,nn=Ye,an=nn.maxOutputSize,sn=nn.iouThreshold,ln=nn.scoreThreshold,fn=nn.softNmsSigma,hn=$e;Hh(Je,"NonMaxSuppressionWithScore");var Xr=Xo(hn.data.get(Je.dataId).values,hn.data.get(Mt.dataId).values,an,sn,ln,fn);return[Xr.selectedIndices,Xr.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(Ke){var Ge=Ke.inputs,$e=Ke.backend,Ye=Ge.x,Qe=$e;Hh(Ye,"square");for(var Je=Qe.data.get(Ye.dataId).values,Mt=new Float32Array(Je.length),nn=0;nn<Je.length;++nn){var an=Je[nn];Mt[nn]=an*an}return{dataId:Qe.write(Mt,Ye.shape,Ye.dtype),shape:Ye.shape,dtype:Ye.dtype}}},{kernelName:eu,backendName:"cpu",kernelFunc:function(Ke){var Ge=Ke.inputs,$e=Ke.backend,Ye=Ge,Qe=Ye.a,Je=Ye.b,Mt=$e;Hh([Qe,Je],eu);var nn=Mt.data.get(Qe.dataId).values,an=Mt.data.get(Je.dataId).values,sn=function(hn,Xr,Mi,co,lo,uo){var ho=Ro(hn,Xr),mo=ho.length,_d=$(ho),ep=B(lo,k(ho)),rp=hn.length,sp=Xr.length,op=$(hn),ip=$(Xr),lp=Co(hn,ho),vp=Co(Xr,ho);if(lp.length+vp.length===0)for(var gp=0;gp<ep.length;++gp)ep[gp]=uo(Mi[gp%Mi.length],co[gp%co.length]);else{var Op=function(Mp){var Np=it(Mp,mo,_d),wp=Np.slice(-rp);lp.forEach(function(cp){return wp[cp]=0});var Sp=at(wp,rp,op),Cp=Np.slice(-sp);vp.forEach(function(cp){return Cp[cp]=0});var Ip=at(Cp,sp,ip);ep[Mp]=uo(Mi[Sp],co[Ip])};for(gp=0;gp<ep.length;++gp)Op(gp)}return[ep,ho]}(Qe.shape,Je.shape,nn,an,Qe.dtype,function(hn,Xr){var Mi=hn-Xr;return Mi*Mi}),ln=sn[0],fn=sn[1];return{dataId:Mt.write(ln,fn,Qe.dtype),shape:fn,dtype:Qe.dtype}}}];jh<Xh.length;jh++)d(Xh[jh]);var Yh,$h=function(Ke){this.variableNames=["A"];var Ge=ua(),$e=Ke[0],Ye=Ke[1];this.outputShape=Ke,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+Ye+".0, "+$e+`.0);

        vec4 values = `+Ge.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},Qh=function(Ke){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var Ge=ua(),$e=Ke[0],Ye=Ke[1];this.outputShape=Ke,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+Ye+".0, "+$e+`.0);
            vec4 values = `+Ge.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+Ge.output+` = result;
      }
    `};for(var Jh=0,Zh=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(Ke){var Ge=Ke.inputs,$e=Ke.backend,Ye=Ke.attrs,Qe=Ge.pixels,Je=Ye.numChannels,Mt=typeof HTMLVideoElement<"u"&&Qe instanceof HTMLVideoElement,nn=typeof HTMLImageElement<"u"&&Qe instanceof HTMLImageElement,an=Mt?[Qe.videoWidth,Qe.videoHeight]:[Qe.width,Qe.height],sn=an[0],ln=an[1],fn=[ln,sn],hn=[ln,sn,Je];(nn||Mt)&&(Yh==null&&(Yh=document.createElement("canvas").getContext("2d")),Yh.canvas.width=sn,Yh.canvas.height=ln,Yh.drawImage(Qe,0,0,sn,ln),Qe=Yh.canvas);var Xr=$e.makeTensorInfo(fn,"int32");$e.texData.get(Xr.dataId).usage=zt.PIXELS,$e.gpgpu.uploadPixelDataToTexture($e.getTexture(Xr.dataId),Qe);var Mi=i().getBool("WEBGL_PACK")?new Qh(hn):new $h(hn),co=$e.runWebGLProgram(Mi,[Xr],"int32");return $e.disposeData(Xr.dataId),co}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(Ke){var Ge=Ke.inputs,$e=Ke.backend,Ye=Ke.attrs;dn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var Qe=Ge,Je=Qe.boxes,Mt=Qe.scores,nn=Ye,an=nn.maxOutputSize,sn=nn.iouThreshold,ln=nn.scoreThreshold,fn=nn.softNmsSigma,hn=$e,Xr=Xo(hn.readSync(Je.dataId),hn.readSync(Mt.dataId),an,sn,ln,fn);return[Xr.selectedIndices,Xr.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(Ke){var Ge=Ke.inputs,$e=Ke.backend,Ye=Ge.x,Qe=$e,Je=new Cs(Ye.shape,"return x * x;");return Qe.runWebGLProgram(Je,[Ye],Ye.dtype)}},{kernelName:eu,backendName:"webgl",kernelFunc:function(Ke){var Ge=Ke.inputs,$e=Ke.backend,Ye=Ge,Qe=Ye.a,Je=Ye.b,Mt=$e,nn=i().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new La("return (a - b) * (a - b);",Qe.shape,Je.shape):new Ba("return (a - b) * (a - b);",Qe.shape,Je.shape);return Mt.compileAndRun(nn,[Qe,Je])}}];Jh<Zh.length;Jh++)d(Zh[Jh]);for(var tf=0,ef=[{kernelName:"Square",gradFunc:function(Ke,Ge){var $e=Ge[0];return{x:function(){return Ke.mul($e.toFloat().mul(2))}}}},{kernelName:eu,gradFunc:function(Ke,Ge){var $e=Ge[0],Ye=Ge[1],Qe=On(2);return{a:function(){return gc(Ke,gc(Qe,Cc($e,Ye)))},b:function(){return gc(Ke,gc(Qe,Cc(Ye,$e)))}}}}];tf<ef.length;tf++)p(ef[tf]);var nf=function(){function Ke(){}return Ke.prototype.fetch=function(Ge,$e){return fetch(Ge,$e)},Ke.prototype.now=function(){return performance.now()},Ke.prototype.encode=function(Ge,$e){if($e!=="utf-8"&&$e!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+$e);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(Ge)},Ke.prototype.decode=function(Ge,$e){return new TextDecoder($e).decode(Ge)},Ke}();i().get("IS_BROWSER")&&i().setPlatform("browser",new nf);var rf,of=function(){return require("node-fetch")},af=function(){function Ke(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return Ke.prototype.fetch=function(Ge,$e){return i().global.fetch!=null?i().global.fetch(Ge,$e):(rf==null&&(rf=of()),rf(Ge,$e))},Ke.prototype.now=function(){var Ge=process.hrtime();return 1e3*Ge[0]+Ge[1]/1e6},Ke.prototype.encode=function(Ge,$e){if($e!=="utf-8"&&$e!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+$e);return this.textEncoder.encode(Ge)},Ke.prototype.decode=function(Ge,$e){return Ge.length===0?"":new this.util.TextDecoder($e).decode(Ge)},Ke}();i().get("IS_NODE")&&i().setPlatform("node",new af);var sf={float32:4,int32:4,uint16:2,uint8:1,bool:1},uf=4;function cf(Ke,Ge){for(var $e={},Ye=0,Qe=function(nn){var an=nn.name,sn=nn.dtype,ln=nn.shape,fn=k(ln),hn=void 0;if("quantization"in nn){var Xr=nn.quantization;if(Xr.dtype!=="uint8"&&Xr.dtype!=="uint16")throw new Error("Weight "+nn.name+" has unknown quantization dtype "+Xr.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var Mi=sf[Xr.dtype],co=Ke.slice(Ye,Ye+fn*Mi),lo=Xr.dtype==="uint8"?new Uint8Array(co):new Uint16Array(co);if(sn==="float32")hn=Float32Array.from(lo,function(rp){return rp*Xr.scale+Xr.min});else{if(sn!=="int32")throw new Error("Unsupported dtype in weight '"+an+"': "+sn);hn=Int32Array.from(lo,function(rp){return Math.round(rp*Xr.scale+Xr.min)})}Ye+=fn*Mi}else if(sn==="string"){var uo=k(nn.shape);hn=[];for(var ho=0;ho<uo;ho++){var mo=new Uint32Array(Ke.slice(Ye,Ye+uf))[0];Ye+=uf;var _d=new Uint8Array(Ke.slice(Ye,Ye+mo));hn.push(_d),Ye+=mo}}else{var ep=sf[sn];if(co=Ke.slice(Ye,Ye+fn*ep),sn==="float32")hn=new Float32Array(co);else if(sn==="int32")hn=new Int32Array(co);else{if(sn!=="bool")throw new Error("Unsupported dtype in weight '"+an+"': "+sn);hn=new Uint8Array(co)}Ye+=fn*ep}$e[an]=Fn(hn,ln,sn)},Je=0,Mt=Ge;Je<Mt.length;Je++)Qe(Mt[Je]);return $e}function lf(Ke){if(Ke===null)throw new Error("Invalid input value: "+JSON.stringify(Ke));var Ge=0,$e=[];Ke.forEach(function(Je){if(Ge+=Je.byteLength,$e.push(Je.byteLength===Je.buffer.byteLength?Je:new Je.constructor(Je)),!(Je instanceof Float32Array||Je instanceof Int32Array||Je instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+Je.constructor.name)});var Ye=new Uint8Array(Ge),Qe=0;return $e.forEach(function(Je){Ye.set(new Uint8Array(Je.buffer),Qe),Qe+=Je.byteLength}),Ye.buffer}var hf=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function ff(Ke){return hf?Buffer.byteLength(Ke):new Blob([Ke]).size}function df(Ke){var Ge=0;Ke.forEach(function(Qe){Ge+=Qe.byteLength});var $e=new Uint8Array(Ge),Ye=0;return Ke.forEach(function(Qe){$e.set(new Uint8Array(Qe),Ye),Ye+=Qe.byteLength}),$e.buffer}function pf(Ke){for(Ke=Ke.trim();Ke.endsWith("/");)Ke=Ke.slice(0,Ke.length-1);var Ge=Ke.split("/");return Ge[Ge.length-1]}function vf(Ke){if(Ke.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:Ke.modelTopology==null?0:ff(JSON.stringify(Ke.modelTopology)),weightSpecsBytes:Ke.weightSpecs==null?0:ff(JSON.stringify(Ke.weightSpecs)),weightDataBytes:Ke.weightData==null?0:Ke.weightData.byteLength}}var mf=function(){function Ke(){this.saveRouters=[],this.loadRouters=[]}return Ke.getInstance=function(){return Ke.instance==null&&(Ke.instance=new Ke),Ke.instance},Ke.registerSaveRouter=function(Ge){Ke.getInstance().saveRouters.push(Ge)},Ke.registerLoadRouter=function(Ge){Ke.getInstance().loadRouters.push(Ge)},Ke.getSaveHandlers=function(Ge){return Ke.getHandlers(Ge,"save")},Ke.getLoadHandlers=function(Ge,$e){return Ke.getHandlers(Ge,"load",$e)},Ke.getHandlers=function(Ge,$e,Ye){var Qe=[];return($e==="load"?Ke.getInstance().loadRouters:Ke.getInstance().saveRouters).forEach(function(Je){var Mt=Je(Ge,Ye);Mt!==null&&Qe.push(Mt)}),Qe},Ke}(),gf="://",yf=function(){function Ke(){this.managers={}}return Ke.getInstance=function(){return Ke.instance==null&&(Ke.instance=new Ke),Ke.instance},Ke.registerManager=function(Ge,$e){C(Ge!=null,function(){return"scheme must not be undefined or null."}),Ge.endsWith(gf)&&(Ge=Ge.slice(0,Ge.indexOf(gf))),C(Ge.length>0,function(){return"scheme must not be an empty string."});var Ye=Ke.getInstance();C(Ye.managers[Ge]==null,function(){return"A model store manager is already registered for scheme '"+Ge+"'."}),Ye.managers[Ge]=$e},Ke.getManager=function(Ge){var $e=this.getInstance().managers[Ge];if($e==null)throw new Error("Cannot find model manager for scheme '"+Ge+"'");return $e},Ke.getSchemes=function(){return Object.keys(this.getInstance().managers)},Ke}();function xf(Ke){if(Ke.indexOf(gf)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+yf.getSchemes().join(","));return{scheme:Ke.split(gf)[0],path:Ke.split(gf)[1]}}function bf(Ke,Ge,$e){return $e===void 0&&($e=!1),n(this,void 0,void 0,function(){var Ye,Qe,Je,Mt,nn,an,sn,ln,fn;return r(this,function(hn){switch(hn.label){case 0:return C(Ke!==Ge,function(){return"Old path and new path are the same: '"+Ke+"'"}),C((Ye=mf.getLoadHandlers(Ke)).length>0,function(){return"Copying failed because no load handler is found for source URL "+Ke+"."}),C(Ye.length<2,function(){return"Copying failed because more than one ("+Ye.length+") load handlers for source URL "+Ke+"."}),Qe=Ye[0],C((Je=mf.getSaveHandlers(Ge)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+Ge+"."}),C(Je.length<2,function(){return"Copying failed because more than one ("+Ye.length+") save handlers for destination URL "+Ge+"."}),Mt=Je[0],nn=xf(Ke).scheme,an=xf(Ke).path,sn=nn===xf(Ke).scheme,[4,Qe.load()];case 1:return ln=hn.sent(),$e&&sn?[4,yf.getManager(nn).removeModel(an)]:[3,3];case 2:hn.sent(),hn.label=3;case 3:return[4,Mt.save(ln)];case 4:return fn=hn.sent(),!$e||sn?[3,6]:[4,yf.getManager(nn).removeModel(an)];case 5:hn.sent(),hn.label=6;case 6:return[2,fn.modelArtifactsInfo]}})})}var wf="models_store",Cf="model_info_store";function Ef(){if(!i().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var Ke=window||self,Ge=Ke.indexedDB||Ke.mozIndexedDB||Ke.webkitIndexedDB||Ke.msIndexedDB||Ke.shimIndexedDB;if(Ge==null)throw new Error("The current browser does not appear to support IndexedDB.");return Ge}function Rf(Ke){var Ge=Ke.result;Ge.createObjectStore(wf,{keyPath:"modelPath"}),Ge.createObjectStore(Cf,{keyPath:"modelPath"})}var If=function(){function Ke(Ge){if(this.indexedDB=Ef(),Ge==null||!Ge)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=Ge}return Ke.prototype.save=function(Ge){return n(this,void 0,void 0,function(){return r(this,function($e){if(Ge.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,Ge)]})})},Ke.prototype.load=function(){return n(this,void 0,void 0,function(){return r(this,function(Ge){return[2,this.databaseAction(this.modelPath)]})})},Ke.prototype.databaseAction=function(Ge,$e){var Ye=this;return new Promise(function(Qe,Je){var Mt=Ye.indexedDB.open("tensorflowjs",1);Mt.onupgradeneeded=function(){return Rf(Mt)},Mt.onsuccess=function(){var nn=Mt.result;if($e==null){var an=nn.transaction(wf,"readonly"),sn=an.objectStore(wf).get(Ye.modelPath);sn.onsuccess=function(){if(sn.result==null)return nn.close(),Je(new Error("Cannot find model with path '"+Ye.modelPath+"' in IndexedDB."));Qe(sn.result.modelArtifacts)},sn.onerror=function(co){return nn.close(),Je(sn.error)},an.oncomplete=function(){return nn.close()}}else{var ln,fn=vf($e),hn=nn.transaction(Cf,"readwrite"),Xr=hn.objectStore(Cf),Mi=Xr.put({modelPath:Ye.modelPath,modelArtifactsInfo:fn});Mi.onsuccess=function(){var co=(ln=nn.transaction(wf,"readwrite")).objectStore(wf).put({modelPath:Ye.modelPath,modelArtifacts:$e,modelArtifactsInfo:fn});co.onsuccess=function(){return Qe({modelArtifactsInfo:fn})},co.onerror=function(lo){var uo=(Xr=hn.objectStore(Cf)).delete(Ye.modelPath);uo.onsuccess=function(){return nn.close(),Je(co.error)},uo.onerror=function(ho){return nn.close(),Je(co.error)}}},Mi.onerror=function(co){return nn.close(),Je(Mi.error)},hn.oncomplete=function(){ln==null?nn.close():ln.oncomplete=function(){return nn.close()}}}},Mt.onerror=function(nn){return Je(Mt.error)}})},Ke.URL_SCHEME="indexeddb://",Ke}(),kf=function(Ke){return i().getBool("IS_BROWSER")&&!Array.isArray(Ke)&&Ke.startsWith(If.URL_SCHEME)?(Ge=Ke.slice(If.URL_SCHEME.length),new If(Ge)):null;var Ge};mf.registerSaveRouter(kf),mf.registerLoadRouter(kf);var Sf=function(){function Ke(){this.indexedDB=Ef()}return Ke.prototype.listModels=function(){return n(this,void 0,void 0,function(){var Ge=this;return r(this,function($e){return[2,new Promise(function(Ye,Qe){var Je=Ge.indexedDB.open("tensorflowjs",1);Je.onupgradeneeded=function(){return Rf(Je)},Je.onsuccess=function(){var Mt=Je.result,nn=Mt.transaction(Cf,"readonly"),an=nn.objectStore(Cf).getAll();an.onsuccess=function(){for(var sn={},ln=0,fn=an.result;ln<fn.length;ln++){var hn=fn[ln];sn[hn.modelPath]=hn.modelArtifactsInfo}Ye(sn)},an.onerror=function(sn){return Mt.close(),Qe(an.error)},nn.oncomplete=function(){return Mt.close()}},Je.onerror=function(Mt){return Qe(Je.error)}})]})})},Ke.prototype.removeModel=function(Ge){return n(this,void 0,void 0,function(){var $e=this;return r(this,function(Ye){var Qe;return Ge=(Qe=Ge).startsWith(If.URL_SCHEME)?Qe.slice(If.URL_SCHEME.length):Qe,[2,new Promise(function(Je,Mt){var nn=$e.indexedDB.open("tensorflowjs",1);nn.onupgradeneeded=function(){return Rf(nn)},nn.onsuccess=function(){var an,sn=nn.result,ln=sn.transaction(Cf,"readwrite"),fn=ln.objectStore(Cf),hn=fn.get(Ge);hn.onsuccess=function(){if(hn.result==null)return sn.close(),Mt(new Error("Cannot find model with path '"+Ge+"' in IndexedDB."));var Xr=fn.delete(Ge),Mi=function(){var co=(an=sn.transaction(wf,"readwrite")).objectStore(wf).delete(Ge);co.onsuccess=function(){return Je(hn.result.modelArtifactsInfo)},co.onerror=function(lo){return Mt(hn.error)}};Xr.onsuccess=Mi,Xr.onerror=function(co){return Mi(),sn.close(),Mt(hn.error)}},hn.onerror=function(Xr){return sn.close(),Mt(hn.error)},ln.oncomplete=function(){an==null?sn.close():an.oncomplete=function(){return sn.close()}}},nn.onerror=function(an){return Mt(nn.error)}})]})})},Ke}();if(i().getBool("IS_BROWSER"))try{yf.registerManager(If.URL_SCHEME,new Sf)}catch{}var Af="/",Df="tensorflowjs_models",Tf="info",Nf="model_topology",Ff="weight_specs",_f="weight_data",Of="model_metadata";function Mf(Ke){return{info:[Df,Ke,Tf].join(Af),topology:[Df,Ke,Nf].join(Af),weightSpecs:[Df,Ke,Ff].join(Af),weightData:[Df,Ke,_f].join(Af),modelMetadata:[Df,Ke,Of].join(Af)}}function Bf(Ke){var Ge=Ke.split(Af);if(Ge.length<3)throw new Error("Invalid key format: "+Ke);return Ge.slice(1,Ge.length-1).join(Af)}var Pf=function(){function Ke(Ge){if(!i().getBool("IS_BROWSER")||typeof window>"u"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,Ge==null||!Ge)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=Ge,this.keys=Mf(this.modelPath)}return Ke.prototype.save=function(Ge){return n(this,void 0,void 0,function(){var $e,Ye,Qe;return r(this,function(Je){if(Ge.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");$e=JSON.stringify(Ge.modelTopology),Ye=JSON.stringify(Ge.weightSpecs),Qe=vf(Ge);try{return this.LS.setItem(this.keys.info,JSON.stringify(Qe)),this.LS.setItem(this.keys.topology,$e),this.LS.setItem(this.keys.weightSpecs,Ye),this.LS.setItem(this.keys.weightData,function(Mt){if(hf)return Buffer.from(Mt).toString("base64");for(var nn=new Uint8Array(Mt),an="",sn=0,ln=nn.length;sn<ln;sn++)an+=String.fromCharCode(nn[sn]);return btoa(an)}(Ge.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:Ge.format,generatedBy:Ge.generatedBy,convertedBy:Ge.convertedBy,userDefinedMetadata:Ge.userDefinedMetadata})),[2,{modelArtifactsInfo:Qe}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+Qe.modelTopologyBytes+", weightSpecsBytes="+Qe.weightSpecsBytes+", weightDataBytes="+Qe.weightDataBytes+".")}return[2]})})},Ke.prototype.load=function(){return n(this,void 0,void 0,function(){var Ge,$e,Ye,Qe,Je,Mt,nn;return r(this,function(an){if((Ge=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(Ge.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if($e={},(Ye=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if($e.modelTopology=Ye,(Qe=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if($e.weightSpecs=Qe,(Je=this.LS.getItem(this.keys.modelMetadata))!=null&&(Mt=JSON.parse(Je),$e.format=Mt.format,$e.generatedBy=Mt.generatedBy,$e.convertedBy=Mt.convertedBy,$e.userDefinedMetadata=Mt.userDefinedMetadata),(nn=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return $e.weightData=function(sn){if(hf){var ln=Buffer.from(sn,"base64");return ln.buffer.slice(ln.byteOffset,ln.byteOffset+ln.byteLength)}for(var fn=atob(sn),hn=new Uint8Array(fn.length),Xr=0;Xr<fn.length;++Xr)hn.set([fn.charCodeAt(Xr)],Xr);return hn.buffer}(nn),[2,$e]})})},Ke.URL_SCHEME="localstorage://",Ke}(),Lf=function(Ke){return i().getBool("IS_BROWSER")&&!Array.isArray(Ke)&&Ke.startsWith(Pf.URL_SCHEME)?(Ge=Ke.slice(Pf.URL_SCHEME.length),new Pf(Ge)):null;var Ge};mf.registerSaveRouter(Lf),mf.registerLoadRouter(Lf);var Wf=function(){function Ke(){C(i().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),C(typeof window>"u"||window.localStorage!==void 0,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return Ke.prototype.listModels=function(){return n(this,void 0,void 0,function(){var Ge,$e,Ye,Qe,Je,Mt;return r(this,function(nn){for(Ge={},$e=Df+Af,Ye=Af+Tf,Qe=0;Qe<this.LS.length;++Qe)(Je=this.LS.key(Qe)).startsWith($e)&&Je.endsWith(Ye)&&(Mt=Bf(Je),Ge[Mt]=JSON.parse(this.LS.getItem(Je)));return[2,Ge]})})},Ke.prototype.removeModel=function(Ge){return n(this,void 0,void 0,function(){var $e,Ye;return r(this,function(Qe){var Je;if(Ge=(Je=Ge).startsWith(Pf.URL_SCHEME)?Je.slice(Pf.URL_SCHEME.length):Je,$e=Mf(Ge),this.LS.getItem($e.info)==null)throw new Error("Cannot find model at path '"+Ge+"'");return Ye=JSON.parse(this.LS.getItem($e.info)),this.LS.removeItem($e.info),this.LS.removeItem($e.topology),this.LS.removeItem($e.weightSpecs),this.LS.removeItem($e.weightData),[2,Ye]})})},Ke}();if(i().getBool("IS_BROWSER"))try{yf.registerManager(Pf.URL_SCHEME,new Wf)}catch{}var Uf="model",Vf=".json",zf=".weights.bin";function Gf(Ke){return new Promise(function(Ge){return setTimeout(Ge)}).then(Ke)}var Hf=function(){function Ke(Ge){if(!i().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");Ge.startsWith(Ke.URL_SCHEME)&&(Ge=Ge.slice(Ke.URL_SCHEME.length)),Ge!=null&&Ge.length!==0||(Ge=Uf),this.modelTopologyFileName=Ge+Vf,this.weightDataFileName=Ge+zf}return Ke.prototype.save=function(Ge){return n(this,void 0,void 0,function(){var $e,Ye,Qe,Je,Mt,nn;return r(this,function(an){switch(an.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if($e=window.URL.createObjectURL(new Blob([Ge.weightData],{type:"application/octet-stream"})),!(Ge.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return Ye=[{paths:["./"+this.weightDataFileName],weights:Ge.weightSpecs}],Qe={modelTopology:Ge.modelTopology,format:Ge.format,generatedBy:Ge.generatedBy,convertedBy:Ge.convertedBy,weightsManifest:Ye},Je=window.URL.createObjectURL(new Blob([JSON.stringify(Qe)],{type:"application/json"})),(Mt=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,Mt.href=Je,[4,Gf(function(){return Mt.dispatchEvent(new MouseEvent("click"))})];case 2:return an.sent(),Ge.weightData==null?[3,4]:((nn=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,nn.href=$e,[4,Gf(function(){return nn.dispatchEvent(new MouseEvent("click"))})]);case 3:an.sent(),an.label=4;case 4:return[2,{modelArtifactsInfo:vf(Ge)}]}})})},Ke.URL_SCHEME="downloads://",Ke}(),qf=function(){function Ke(Ge){if(Ge==null||Ge.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+Ge);this.files=Ge}return Ke.prototype.load=function(){return n(this,void 0,void 0,function(){var Ge,$e,Ye=this;return r(this,function(Qe){return Ge=this.files[0],$e=this.files.slice(1),[2,new Promise(function(Je,Mt){var nn=new FileReader;nn.onload=function(an){var sn=JSON.parse(an.target.result),ln=sn.modelTopology;if(ln!=null){$e.length===0&&Je({modelTopology:ln});var fn=sn.weightsManifest;if(fn!=null){var hn;try{hn=Ye.checkManifestAndWeightFiles(fn,$e)}catch(lo){return void Mt(lo)}var Xr=[],Mi=[],co=[];fn.forEach(function(lo){lo.paths.forEach(function(uo){Mi.push(uo),co.push(null)}),Xr.push.apply(Xr,lo.weights)}),fn.forEach(function(lo){lo.paths.forEach(function(uo){var ho=new FileReader;ho.onload=function(mo){var _d=mo.target.result,ep=Mi.indexOf(uo);co[ep]=_d,co.indexOf(null)===-1&&Je({modelTopology:ln,weightSpecs:Xr,weightData:df(co),format:sn.format,generatedBy:sn.generatedBy,convertedBy:sn.convertedBy,userDefinedMetadata:sn.userDefinedMetadata})},ho.onerror=function(mo){return Mt("Failed to weights data from file of path '"+uo+"'.")},ho.readAsArrayBuffer(hn[uo])})})}else Mt(new Error("weightManifest field is missing from file "+Ge.name))}else Mt(new Error("modelTopology field is missing from file "+Ge.name))},nn.onerror=function(an){return Mt("Failed to read model topology and weights manifest JSON from file '"+Ge.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},nn.readAsText(Ge)})]})})},Ke.prototype.checkManifestAndWeightFiles=function(Ge,$e){for(var Ye=[],Qe=$e.map(function(an){return pf(an.name)}),Je={},Mt=0,nn=Ge;Mt<nn.length;Mt++)nn[Mt].paths.forEach(function(an){var sn=pf(an);if(Ye.indexOf(sn)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+sn+"'");if(Ye.push(sn),Qe.indexOf(sn)===-1)throw new Error("Weight file with basename '"+sn+"' is not provided.");Je[an]=$e[Qe.indexOf(sn)]});if(Ye.length!==$e.length)throw new Error("Mismatch in the number of files in weights manifest ("+Ye.length+") and the number of weight files provided ("+$e.length+").");return Je},Ke}();function Kf(Ke,Ge,$e,Ye){(function(Je){C(Je!=null&&Array.isArray(Je)&&Je.length>0,function(){return"promises must be a none empty array"})})(Ke),function(Je,Mt){C(Je>=0&&Je<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+Je}),C(Mt>=0&&Mt<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+Mt}),C(Mt>=Je,function(){return"startFraction must be no more than endFraction, but got startFraction "+Je+" and endFraction "+Mt})}($e=$e??0,Ye=Ye??1);var Qe=0;return Promise.all(Ke.map(function(Je){return Je.then(function(Mt){var nn=$e+ ++Qe/Ke.length*(Ye-$e);return Ge(nn),Mt}),Je}))}function jf(Ke,Ge){return n(this,void 0,void 0,function(){var $e,Ye,Qe,Je,Mt,nn,an,sn,ln;return r(this,function(fn){switch(fn.label){case 0:return Ge==null&&(Ge={}),$e=Ge.fetchFunc==null?i().platform.fetch:Ge.fetchFunc,Ye=Ke.map(function(hn){return $e(hn,Ge.requestInit,{isBinary:!0})}),Qe=0,Je=.5,Ge.onProgress!=null?[3,2]:[4,Promise.all(Ye)];case 1:return Mt=fn.sent(),[3,4];case 2:return[4,Kf(Ye,Ge.onProgress,Qe,Je)];case 3:Mt=fn.sent(),fn.label=4;case 4:return nn=Mt.map(function(hn){return hn.arrayBuffer()}),an=.5,sn=1,Ge.onProgress!=null?[3,6]:[4,Promise.all(nn)];case 5:return ln=fn.sent(),[3,8];case 6:return[4,Kf(nn,Ge.onProgress,an,sn)];case 7:ln=fn.sent(),fn.label=8;case 8:return[2,ln]}})})}function Xf(Ke){var Ge=this;return function($e,Ye,Qe){return Ye===void 0&&(Ye=""),n(Ge,void 0,void 0,function(){var Je,Mt,nn,an,sn,ln,fn,hn,Xr,Mi;return r(this,function(co){switch(co.label){case 0:if(Je=$e.map(function(){return!1}),Mt={},nn=Qe!=null?Qe.map(function(){return!1}):[],an=[],$e.forEach(function(lo,uo){var ho=0;lo.weights.forEach(function(mo){var _d="quantization"in mo?mo.quantization.dtype:mo.dtype,ep=sf[_d]*k(mo.shape),rp=function(){Je[uo]=!0,Mt[uo]==null&&(Mt[uo]=[]),Mt[uo].push({manifestEntry:mo,groupOffset:ho,sizeBytes:ep})};Qe!=null?Qe.forEach(function(sp,op){sp===mo.name&&(rp(),nn[op]=!0)}):rp(),an.push(mo.name),ho+=ep})}),!nn.every(function(lo){return lo}))throw sn=Qe.filter(function(lo,uo){return!nn[uo]}),new Error("Could not find weights in manifest with names: "+sn.join(", ")+`. 
Manifest JSON has weights with names: `+an.join(", ")+".");return ln=Je.reduce(function(lo,uo,ho){return uo&&lo.push(ho),lo},[]),fn=[],ln.forEach(function(lo){$e[lo].paths.forEach(function(uo){var ho=Ye+(Ye.endsWith("/")?"":"/")+uo;fn.push(ho)})}),[4,Ke(fn)];case 1:return hn=co.sent(),Xr={},Mi=0,ln.forEach(function(lo){for(var uo=$e[lo].paths.length,ho=0,mo=0;mo<uo;mo++)ho+=hn[Mi+mo].byteLength;for(var _d=new ArrayBuffer(ho),ep=new Uint8Array(_d),rp=0,sp=0;sp<uo;sp++){var op=new Uint8Array(hn[Mi+sp]);ep.set(op,rp),rp+=op.byteLength}Mt[lo].forEach(function(ip){var lp=cf(_d.slice(ip.groupOffset,ip.groupOffset+ip.sizeBytes),[ip.manifestEntry]);for(var vp in lp)Xr[vp]=lp[vp]}),Mi+=uo}),[2,Xr]}})})}}mf.registerSaveRouter(function(Ke){return i().getBool("IS_BROWSER")&&!Array.isArray(Ke)&&Ke.startsWith(Hf.URL_SCHEME)?function(Ge){return Ge===void 0&&(Ge="model"),new Hf(Ge)}(Ke.slice(Hf.URL_SCHEME.length)):null});var Yf=function(){function Ke(Ge,$e){if(this.DEFAULT_METHOD="POST",$e==null&&($e={}),this.weightPathPrefix=$e.weightPathPrefix,this.onProgress=$e.onProgress,$e.fetchFunc!=null?(C(typeof $e.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=$e.fetchFunc):this.fetch=i().platform.fetch,C(Ge!=null&&Ge.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(Ge)&&C(Ge.length===2,function(){return"URL paths for http must have a length of 2, (actual length is "+Ge.length+")."}),this.path=Ge,$e.requestInit!=null&&$e.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=$e.requestInit||{}}return Ke.prototype.save=function(Ge){return n(this,void 0,void 0,function(){var $e,Ye,Qe,Je;return r(this,function(Mt){switch(Mt.label){case 0:if(Ge.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return($e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,Ye=[{paths:["./model.weights.bin"],weights:Ge.weightSpecs}],Qe={modelTopology:Ge.modelTopology,format:Ge.format,generatedBy:Ge.generatedBy,convertedBy:Ge.convertedBy,userDefinedMetadata:Ge.userDefinedMetadata,weightsManifest:Ye},$e.body.append("model.json",new Blob([JSON.stringify(Qe)],{type:"application/json"}),"model.json"),Ge.weightData!=null&&$e.body.append("model.weights.bin",new Blob([Ge.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,$e)];case 1:if((Je=Mt.sent()).ok)return[2,{modelArtifactsInfo:vf(Ge),responses:[Je]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+Je.status+".")}})})},Ke.prototype.load=function(){return n(this,void 0,void 0,function(){var Ge,$e,Ye,Qe,Je,Mt,nn,an,sn,ln,fn,hn;return r(this,function(Xr){switch(Xr.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(Ge=Xr.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+Ge.status+". Please verify this URL points to the model JSON of the model to load.");Xr.label=2;case 2:return Xr.trys.push([2,4,,5]),[4,Ge.json()];case 3:return $e=Xr.sent(),[3,5];case 4:throw Xr.sent(),Ye="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?Ye+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":Ye+=" Please make sure the server is serving valid JSON for this request.",new Error(Ye);case 5:if(Qe=$e.modelTopology,Je=$e.weightsManifest,Mt=$e.generatedBy,nn=$e.convertedBy,an=$e.format,sn=$e.userDefinedMetadata,Qe==null&&Je==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return Je==null?[3,7]:[4,this.loadWeights(Je)];case 6:hn=Xr.sent(),ln=hn[0],fn=hn[1],Xr.label=7;case 7:return[2,{modelTopology:Qe,weightSpecs:ln,weightData:fn,userDefinedMetadata:sn,generatedBy:Mt,convertedBy:nn,format:an}]}})})},Ke.prototype.loadWeights=function(Ge){return n(this,void 0,void 0,function(){var $e,Ye,Qe,Je,Mt,nn,an,sn,ln,fn,hn;return r(this,function(Xr){switch(Xr.label){case 0:for($e=Array.isArray(this.path)?this.path[1]:this.path,Ye=function(Mi){var co=Mi.lastIndexOf("/"),lo=Mi.lastIndexOf("?"),uo=Mi.substring(0,co),ho=lo>co?Mi.substring(lo):"";return[uo+"/",ho]}($e),Qe=Ye[0],Je=Ye[1],Mt=this.weightPathPrefix||Qe,nn=[],an=0,sn=Ge;an<sn.length;an++)ln=sn[an],nn.push.apply(nn,ln.weights);return fn=[],Ge.forEach(function(Mi){Mi.paths.forEach(function(co){fn.push(Mt+co+Je)})}),[4,jf(fn,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return hn=Xr.sent(),[2,[nn,df(hn)]]}})})},Ke.URL_SCHEME_REGEX=/^https?:\/\//,Ke}();function $f(Ke){return Ke.match(Yf.URL_SCHEME_REGEX)!=null}var Qf=function(Ke,Ge){return typeof fetch>"u"?null:(Array.isArray(Ke)?Ke.every(function($e){return $f($e)}):$f(Ke))?Jf(Ke,{onProgress:Ge}):null};function Jf(Ke,Ge){return new Yf(Ke,Ge)}mf.registerSaveRouter(Qf),mf.registerLoadRouter(Qf);var Zf=function(){function Ke(Ge){this.modelArtifacts=Ge}return Ke.prototype.load=function(){return n(this,void 0,void 0,function(){return r(this,function(Ge){return[2,this.modelArtifacts]})})},Ke}(),td=function(){function Ke(Ge){this.saveHandler=Ge}return Ke.prototype.save=function(Ge){return n(this,void 0,void 0,function(){return r(this,function($e){return[2,this.saveHandler(Ge)]})})},Ke}(),ed=Object.freeze({browserFiles:function(Ke){return new qf(Ke)},browserHTTPRequest:function(Ke,Ge){return Jf(Ke,Ge)},concatenateArrayBuffers:df,decodeWeights:cf,encodeWeights:function(Ke,Ge){return n(this,void 0,void 0,function(){var $e,Ye,Qe,Je,Mt,nn=this;return r(this,function(an){switch(an.label){case 0:for($e=[],Ye=[],Qe=Array.isArray(Ke)?Ke.map(function(sn){return sn.name}):Object.keys(Ke),Je=function(sn){var ln=Qe[sn],fn=Array.isArray(Ke)?Ke[sn].tensor:Ke[ln];if(fn.dtype!=="float32"&&fn.dtype!=="int32"&&fn.dtype!=="bool"&&fn.dtype!=="string")throw new Error("Unsupported dtype in weight '"+ln+"': "+fn.dtype);var hn={name:ln,shape:fn.shape,dtype:fn.dtype};if(fn.dtype==="string"){var Xr=new Promise(function(Mi){return n(nn,void 0,void 0,function(){var co,lo,uo,ho,mo,_d,ep;return r(this,function(rp){switch(rp.label){case 0:return[4,fn.bytes()];case 1:for(co=rp.sent(),lo=co.reduce(function(sp,op){return sp+op.length},0)+uf*co.length,uo=new Uint8Array(lo),ho=0,mo=0;mo<co.length;mo++)_d=co[mo],ep=new Uint8Array(new Uint32Array([_d.length]).buffer),uo.set(ep,ho),ho+=uf,uo.set(_d,ho),ho+=_d.length;return Mi(uo),[2]}})})});Ye.push(Xr)}else Ye.push(fn.data());Ge!=null&&(hn.group=Ge),$e.push(hn)},Mt=0;Mt<Qe.length;++Mt)Je(Mt);return[4,Promise.all(Ye)];case 1:return[2,{data:lf(an.sent()),specs:$e}]}})})},fromMemory:function(Ke,Ge,$e,Ye){return arguments.length===1?Ke.modelTopology!=null||Ke.weightSpecs!=null?new Zf(Ke):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Zf({modelTopology:Ke})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Zf({modelTopology:Ke,weightSpecs:Ge,weightData:$e,trainingConfig:Ye}))},getLoadHandlers:function(Ke,Ge){return mf.getLoadHandlers(Ke,Ge)},getModelArtifactsInfoForJSON:vf,getSaveHandlers:function(Ke){return mf.getSaveHandlers(Ke)},http:Jf,isHTTPScheme:$f,loadWeights:function(Ke,Ge,$e,Ye){return Ge===void 0&&(Ge=""),n(this,void 0,void 0,function(){return r(this,function(Qe){return[2,Xf(function(Je){return jf(Je,{requestInit:Ye})})(Ke,Ge,$e)]})})},registerLoadRouter:function(Ke){return mf.registerLoadRouter(Ke)},registerSaveRouter:function(Ke){return mf.registerSaveRouter(Ke)},weightsLoaderFactory:Xf,withSaveHandler:function(Ke){return new td(Ke)},copyModel:function(Ke,Ge){return n(this,void 0,void 0,function(){return r(this,function($e){return[2,bf(Ke,Ge,!1)]})})},listModels:function(){return n(this,void 0,void 0,function(){var Ke,Ge,$e,Ye,Qe,Je,Mt;return r(this,function(nn){switch(nn.label){case 0:Ke=yf.getSchemes(),Ge={},$e=0,Ye=Ke,nn.label=1;case 1:return $e<Ye.length?(Qe=Ye[$e],[4,yf.getManager(Qe).listModels()]):[3,4];case 2:for(Mt in Je=nn.sent())Ge[Qe+gf+Mt]=Je[Mt];nn.label=3;case 3:return $e++,[3,1];case 4:return[2,Ge]}})})},moveModel:function(Ke,Ge){return n(this,void 0,void 0,function(){return r(this,function($e){return[2,bf(Ke,Ge,!0)]})})},removeModel:function(Ke){return n(this,void 0,void 0,function(){var Ge;return r(this,function($e){return Ge=xf(Ke),[2,yf.getManager(Ge.scheme).removeModel(Ge.path)]})})}}),nd;An({confusionMatrix_:function(Ke,Ge,$e){var Ye=mn(Ke,"labels","confusionMatrix"),Qe=mn(Ge,"predictions","confusionMatrix");C($e==null||$e>0&&Number.isInteger($e),function(){return"If provided, numClasses must be a positive integer, but got "+$e}),C(Ye.rank===1,function(){return"Expected the rank of labels to be 1, but got "+Ye.rank}),C(Qe.rank===1,function(){return"Expected the rank of predictions to be 1, but got "+Qe.rank}),C(Ye.shape[0]===Qe.shape[0],function(){return"Mismatch in the number of examples: "+Ye.shape[0]+" vs. "+Qe.shape[0]+". Labels and predictions should have the same number of elements."}),C($e>0&&Number.isInteger($e),function(){return"numClasses is required to be a positive integer, but got "+$e});var Je=Rr(Ye.asType("int32"),$e),Mt=Rr(Qe.asType("int32"),$e);return Je.transpose().matMul(Mt).asType("int32")}});var ad=An({fromPixels_:function(Ke,Ge){if(Ge===void 0&&(Ge=3),Ge>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(Ke==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var $e=!1,Ye=!1,Qe=!1,Je=!1,Mt=!1;if(Ke.data instanceof Uint8Array)$e=!0;else if(typeof ImageData<"u"&&Ke instanceof ImageData)Ye=!0;else if(typeof HTMLVideoElement<"u"&&Ke instanceof HTMLVideoElement)Qe=!0;else if(typeof HTMLImageElement<"u"&&Ke instanceof HTMLImageElement)Je=!0;else{if(Ke.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+Ke.constructor.name);Mt=!0}if(Qe&&Qe&&Ke.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(l("FromPixels",Lt.backendName)!=null)return Lt.runKernel("FromPixels",{pixels:Ke},{numChannels:Ge});var nn,an,sn=Qe?[Ke.videoWidth,Ke.videoHeight]:[Ke.width,Ke.height],ln=sn[0],fn=sn[1];if(Mt?nn=Ke.getContext("2d").getImageData(0,0,ln,fn).data:Ye||$e?nn=Ke.data:(Je||Qe)&&(nd==null&&(nd=document.createElement("canvas").getContext("2d")),nd.canvas.width=ln,nd.canvas.height=fn,nd.drawImage(Ke,0,0,ln,fn),nn=nd.getImageData(0,0,ln,fn).data),Ge===4)an=new Int32Array(nn);else{var hn=ln*fn;an=new Int32Array(hn*Ge);for(var Xr=0;Xr<hn;Xr++)for(var Mi=0;Mi<Ge;++Mi)an[Xr*Ge+Mi]=nn[4*Xr+Mi]}return Pn(an,[fn,ln,Ge],"int32")}}),id=Object.freeze({toPixels:function(Ke,Ge){return n(this,void 0,void 0,function(){var $e,Ye,Qe,Je,Mt,nn,an,sn,ln,fn,hn,Xr,Mi,co,lo,uo,ho,mo,_d,ep,rp,sp,op;return r(this,function(ip){switch(ip.label){case 0:if($e=mn(Ke,"img","toPixels"),Ke instanceof wt||($e=$e.toInt()),$e.rank!==2&&$e.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+$e.rank+".");if(Ye=$e.shape.slice(0,2),Qe=Ye[0],Je=Ye[1],(Mt=$e.rank===2?1:$e.shape[2])>4||Mt===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+Mt);return[4,$e.data()];case 1:return nn=ip.sent(),an=$e.min(),sn=$e.max(),[4,Promise.all([an.data(),sn.data()])];case 2:if(ln=ip.sent(),fn=ln[0],hn=ln[1],Xr=fn[0],Mi=hn[0],an.dispose(),sn.dispose(),$e.dtype==="float32"){if(Xr<0||Mi>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+Xr+" - "+Mi+"].")}else{if($e.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+$e.dtype+". Please use float32 or int32 tensors.");if(Xr<0||Mi>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+Xr+" - "+Mi+"].")}for(co=$e.dtype==="float32"?255:1,lo=new Uint8ClampedArray(Je*Qe*4),uo=0;uo<Qe*Je;++uo)ho=void 0,mo=void 0,_d=void 0,ep=void 0,Mt===1?(ho=nn[uo]*co,mo=nn[uo]*co,_d=nn[uo]*co,ep=255):Mt===3?(ho=nn[3*uo]*co,mo=nn[3*uo+1]*co,_d=nn[3*uo+2]*co,ep=255):Mt===4&&(ho=nn[4*uo]*co,mo=nn[4*uo+1]*co,_d=nn[4*uo+2]*co,ep=nn[4*uo+3]*co),lo[(rp=4*uo)+0]=Math.round(ho),lo[rp+1]=Math.round(mo),lo[rp+2]=Math.round(_d),lo[rp+3]=Math.round(ep);return Ge!=null&&(Ge.width=Je,Ge.height=Qe,sp=Ge.getContext("2d"),op=new ImageData(lo,Je,Qe),sp.putImageData(op,0,0)),$e!==Ke&&$e.dispose(),[2,lo]}})})},fromPixels:ad}),sd=function(){function Ke(){}return Ke.prototype.getClassName=function(){return this.constructor.className},Ke.fromConfig=function(Ge,$e){return new Ge($e)},Ke}(),ud=function(){function Ke(){this.classNameMap={}}return Ke.getMap=function(){return Ke.instance==null&&(Ke.instance=new Ke),Ke.instance},Ke.register=function(Ge){Ke.getMap().classNameMap[Ge.className]=[Ge,Ge.fromConfig]},Ke}();function cd(Ke){C(Ke.className!=null,function(){return"Class being registered does not have the static className property defined."}),C(typeof Ke.className=="string",function(){return"className is required to be a string, but got type "+typeof Ke.className}),C(Ke.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),ud.register(Ke)}var xd=function(Ke){function Ge(){return Ke!==null&&Ke.apply(this,arguments)||this}return e(Ge,Ke),Ge.prototype.minimize=function($e,Ye,Qe){Ye===void 0&&(Ye=!1);var Je=this.computeGradients($e,Qe),Mt=Je.value,nn=Je.grads;if(Qe!=null){var an=Qe.map(function(sn){return{name:sn.name,tensor:nn[sn.name]}});this.applyGradients(an)}else this.applyGradients(nn);return tn(nn),Ye?Mt:(Mt.dispose(),null)},Object.defineProperty(Ge.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),Ge.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},Ge.prototype.computeGradients=function($e,Ye){return po($e,Ye)},Ge.prototype.dispose=function(){this.iterations_!=null&&tn(this.iterations_)},Ge.prototype.saveIterations=function(){return n(this,void 0,void 0,function(){return r(this,function($e){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:On(this.iterations_,"int32")}]})})},Ge.prototype.getWeights=function(){return n(this,void 0,void 0,function(){return r(this,function($e){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},Ge.prototype.setWeights=function($e){return n(this,void 0,void 0,function(){return r(this,function(Ye){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},Ge.prototype.extractIterations=function($e){return n(this,void 0,void 0,function(){var Ye;return r(this,function(Qe){switch(Qe.label){case 0:return Ye=this,[4,$e[0].tensor.data()];case 1:return Ye.iterations_=Qe.sent()[0],[2,$e.slice(1)]}})})},Ge}(sd);Object.defineProperty(xd,Symbol.hasInstance,{value:function(Ke){return Ke.minimize!=null&&Ke.computeGradients!=null&&Ke.applyGradients!=null}});var bd=function(Ke){function Ge($e,Ye,Qe){Qe===void 0&&(Qe=null);var Je=Ke.call(this)||this;return Je.learningRate=$e,Je.rho=Ye,Je.epsilon=Qe,Je.accumulatedGrads=[],Je.accumulatedUpdates=[],Qe==null&&(Je.epsilon=Lt.backend.epsilon()),Je}return e(Ge,Ke),Ge.prototype.applyGradients=function($e){var Ye=this;(Array.isArray($e)?$e.map(function(Qe){return Qe.name}):Object.keys($e)).forEach(function(Qe,Je){var Mt=Lt.registeredVariables[Qe];Ye.accumulatedGrads[Je]==null&&(Ye.accumulatedGrads[Je]={originalName:Qe+"/accum_grad",variable:Ze(function(){return Xn(Mt).variable(!1)})}),Ye.accumulatedUpdates[Je]==null&&(Ye.accumulatedUpdates[Je]={originalName:Qe+"/accum_var",variable:Ze(function(){return Xn(Mt).variable(!1)})});var nn=Array.isArray($e)?$e[Je].tensor:$e[Qe];if(nn!=null){var an=Ye.accumulatedGrads[Je].variable,sn=Ye.accumulatedUpdates[Je].variable;Ze(function(){var ln=an.mul(Ye.rho).add(nn.square().mul(1-Ye.rho)),fn=sn.add(Ye.epsilon).sqrt().div(an.add(Ye.epsilon).sqrt()).mul(nn),hn=sn.mul(Ye.rho).add(fn.square().mul(1-Ye.rho));an.assign(ln),sn.assign(hn);var Xr=fn.mul(-Ye.learningRate).add(Mt);Mt.assign(Xr)})}}),this.incrementIterations()},Ge.prototype.dispose=function(){this.accumulatedUpdates!=null&&(tn(this.accumulatedGrads.map(function($e){return $e.variable})),tn(this.accumulatedUpdates.map(function($e){return $e.variable})))},Ge.prototype.getWeights=function(){return n(this,void 0,void 0,function(){var $e;return r(this,function(Ye){switch(Ye.label){case 0:return $e=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[Ye.sent()].concat($e.map(function(Qe){return{name:Qe.originalName,tensor:Qe.variable}}))]}})})},Ge.prototype.setWeights=function($e){return n(this,void 0,void 0,function(){var Ye;return r(this,function(Qe){switch(Qe.label){case 0:return[4,this.extractIterations($e)];case 1:return $e=Qe.sent(),Ye=$e.length/2,this.accumulatedGrads=$e.slice(0,Ye).map(function(Je){return{originalName:Je.name,variable:Je.tensor.variable(!1)}}),this.accumulatedUpdates=$e.slice(Ye,2*Ye).map(function(Je){return{originalName:Je.name,variable:Je.tensor.variable(!1)}}),[2]}})})},Ge.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},Ge.fromConfig=function($e,Ye){return new $e(Ye.learningRate,Ye.rho,Ye.epsilon)},Ge.className="Adadelta",Ge}(xd);cd(bd);var wd=function(Ke){function Ge($e,Ye){Ye===void 0&&(Ye=.1);var Qe=Ke.call(this)||this;return Qe.learningRate=$e,Qe.initialAccumulatorValue=Ye,Qe.accumulatedGrads=[],Qe}return e(Ge,Ke),Ge.prototype.applyGradients=function($e){var Ye=this;(Array.isArray($e)?$e.map(function(Qe){return Qe.name}):Object.keys($e)).forEach(function(Qe,Je){var Mt=Lt.registeredVariables[Qe];Ye.accumulatedGrads[Je]==null&&(Ye.accumulatedGrads[Je]={originalName:Qe+"/accumulator",variable:Ze(function(){return Hn(Mt.shape,Ye.initialAccumulatorValue).variable(!1)})});var nn=Array.isArray($e)?$e[Je].tensor:$e[Qe];if(nn!=null){var an=Ye.accumulatedGrads[Je].variable;Ze(function(){var sn=an.add(nn.square());an.assign(sn);var ln=nn.div(sn.add(Lt.backend.epsilon()).sqrt()).mul(-Ye.learningRate).add(Mt);Mt.assign(ln)})}}),this.incrementIterations()},Ge.prototype.dispose=function(){this.accumulatedGrads!=null&&tn(this.accumulatedGrads.map(function($e){return $e.variable}))},Ge.prototype.getWeights=function(){return n(this,void 0,void 0,function(){return r(this,function($e){switch($e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[$e.sent()].concat(this.accumulatedGrads.map(function(Ye){return{name:Ye.originalName,tensor:Ye.variable}}))]}})})},Ge.prototype.setWeights=function($e){return n(this,void 0,void 0,function(){return r(this,function(Ye){switch(Ye.label){case 0:return[4,this.extractIterations($e)];case 1:return $e=Ye.sent(),this.accumulatedGrads=$e.map(function(Qe){return{originalName:Qe.name,variable:Qe.tensor.variable(!1)}}),[2]}})})},Ge.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},Ge.fromConfig=function($e,Ye){return new $e(Ye.learningRate,Ye.initialAccumulatorValue)},Ge.className="Adagrad",Ge}(xd);cd(wd);var Cd=function(Ke){function Ge($e,Ye,Qe,Je){Je===void 0&&(Je=null);var Mt=Ke.call(this)||this;return Mt.learningRate=$e,Mt.beta1=Ye,Mt.beta2=Qe,Mt.epsilon=Je,Mt.accumulatedFirstMoment=[],Mt.accumulatedSecondMoment=[],Ze(function(){Mt.accBeta1=On(Ye).variable(),Mt.accBeta2=On(Qe).variable()}),Je==null&&(Mt.epsilon=Lt.backend.epsilon()),Mt}return e(Ge,Ke),Ge.prototype.applyGradients=function($e){var Ye=this,Qe=Array.isArray($e)?$e.map(function(Je){return Je.name}):Object.keys($e);Ze(function(){var Je=Cc(1,Ye.accBeta1),Mt=Cc(1,Ye.accBeta2);Qe.forEach(function(nn,an){var sn=Lt.registeredVariables[nn];Ye.accumulatedFirstMoment[an]==null&&(Ye.accumulatedFirstMoment[an]={originalName:nn+"/m",variable:Ze(function(){return Xn(sn).variable(!1)})}),Ye.accumulatedSecondMoment[an]==null&&(Ye.accumulatedSecondMoment[an]={originalName:nn+"/v",variable:Ze(function(){return Xn(sn).variable(!1)})});var ln=Array.isArray($e)?$e[an].tensor:$e[nn];if(ln!=null){var fn=Ye.accumulatedFirstMoment[an].variable,hn=Ye.accumulatedSecondMoment[an].variable,Xr=fn.mul(Ye.beta1).add(ln.mul(1-Ye.beta1)),Mi=hn.mul(Ye.beta2).add(ln.square().mul(1-Ye.beta2)),co=Xr.div(Je),lo=Mi.div(Mt);fn.assign(Xr),hn.assign(Mi);var uo=co.div(lo.sqrt().add(Ye.epsilon)).mul(-Ye.learningRate).add(sn);sn.assign(uo)}}),Ye.accBeta1.assign(Ye.accBeta1.mul(Ye.beta1)),Ye.accBeta2.assign(Ye.accBeta2.mul(Ye.beta2))}),this.incrementIterations()},Ge.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&tn(this.accumulatedFirstMoment.map(function($e){return $e.variable})),this.accumulatedSecondMoment!=null&&tn(this.accumulatedSecondMoment.map(function($e){return $e.variable}))},Ge.prototype.getWeights=function(){return n(this,void 0,void 0,function(){var $e;return r(this,function(Ye){switch(Ye.label){case 0:return $e=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[Ye.sent()].concat($e.map(function(Qe){return{name:Qe.originalName,tensor:Qe.variable}}))]}})})},Ge.prototype.setWeights=function($e){return n(this,void 0,void 0,function(){var Ye,Qe=this;return r(this,function(Je){switch(Je.label){case 0:return[4,this.extractIterations($e)];case 1:return $e=Je.sent(),Ze(function(){Qe.accBeta1.assign(xc(Qe.beta1,Qe.iterations_+1)),Qe.accBeta2.assign(xc(Qe.beta2,Qe.iterations_+1))}),Ye=$e.length/2,this.accumulatedFirstMoment=$e.slice(0,Ye).map(function(Mt){return{originalName:Mt.name,variable:Mt.tensor.variable(!1)}}),this.accumulatedSecondMoment=$e.slice(Ye,2*Ye).map(function(Mt){return{originalName:Mt.name,variable:Mt.tensor.variable(!1)}}),[2]}})})},Ge.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},Ge.fromConfig=function($e,Ye){return new $e(Ye.learningRate,Ye.beta1,Ye.beta2,Ye.epsilon)},Ge.className="Adam",Ge}(xd);cd(Cd);var Ed=function(Ke){function Ge($e,Ye,Qe,Je,Mt){Je===void 0&&(Je=null),Mt===void 0&&(Mt=0);var nn=Ke.call(this)||this;return nn.learningRate=$e,nn.beta1=Ye,nn.beta2=Qe,nn.epsilon=Je,nn.decay=Mt,nn.accumulatedFirstMoment=[],nn.accumulatedWeightedInfNorm=[],Ze(function(){nn.iteration=On(0).variable(),nn.accBeta1=On(Ye).variable()}),Je==null&&(nn.epsilon=Lt.backend.epsilon()),nn}return e(Ge,Ke),Ge.prototype.applyGradients=function($e){var Ye=this,Qe=Array.isArray($e)?$e.map(function(Je){return Je.name}):Object.keys($e);Ze(function(){var Je=Cc(1,Ye.accBeta1),Mt=sc(-Ye.learningRate,Ye.iteration.mul(Ye.decay).add(1));Qe.forEach(function(nn,an){var sn=Lt.registeredVariables[nn];Ye.accumulatedFirstMoment[an]==null&&(Ye.accumulatedFirstMoment[an]={originalName:nn+"/m",variable:Xn(sn).variable(!1)}),Ye.accumulatedWeightedInfNorm[an]==null&&(Ye.accumulatedWeightedInfNorm[an]={originalName:nn+"/v",variable:Xn(sn).variable(!1)});var ln=Array.isArray($e)?$e[an].tensor:$e[nn];if(ln!=null){var fn=Ye.accumulatedFirstMoment[an].variable,hn=Ye.accumulatedWeightedInfNorm[an].variable,Xr=fn.mul(Ye.beta1).add(ln.mul(1-Ye.beta1)),Mi=hn.mul(Ye.beta2),co=ln.abs(),lo=Mi.maximum(co);fn.assign(Xr),hn.assign(lo);var uo=Mt.div(Je).mul(Xr.div(lo.add(Ye.epsilon))).add(sn);sn.assign(uo)}}),Ye.iteration.assign(Ye.iteration.add(1)),Ye.accBeta1.assign(Ye.accBeta1.mul(Ye.beta1))}),this.incrementIterations()},Ge.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&tn(this.accumulatedFirstMoment.map(function($e){return $e.variable})),this.accumulatedWeightedInfNorm!=null&&tn(this.accumulatedWeightedInfNorm.map(function($e){return $e.variable}))},Ge.prototype.getWeights=function(){return n(this,void 0,void 0,function(){return r(this,function($e){throw new Error("getWeights() is not implemented for Adamax yet.")})})},Ge.prototype.setWeights=function($e){return n(this,void 0,void 0,function(){return r(this,function(Ye){throw new Error("setWeights() is not implemented for Adamax yet.")})})},Ge.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},Ge.fromConfig=function($e,Ye){return new $e(Ye.learningRate,Ye.beta1,Ye.beta2,Ye.epsilon,Ye.decay)},Ge.className="Adamax",Ge}(xd);cd(Ed);var Rd=function(Ke){function Ge($e){var Ye=Ke.call(this)||this;return Ye.learningRate=$e,Ye.setLearningRate($e),Ye}return e(Ge,Ke),Ge.prototype.applyGradients=function($e){var Ye=this;(Array.isArray($e)?$e.map(function(Qe){return Qe.name}):Object.keys($e)).forEach(function(Qe,Je){var Mt=Array.isArray($e)?$e[Je].tensor:$e[Qe];if(Mt!=null){var nn=Lt.registeredVariables[Qe];Ze(function(){var an=Ye.c.mul(Mt).add(nn);nn.assign(an)})}}),this.incrementIterations()},Ge.prototype.setLearningRate=function($e){this.learningRate=$e,this.c!=null&&this.c.dispose(),this.c=en(On(-$e))},Ge.prototype.dispose=function(){this.c.dispose()},Ge.prototype.getWeights=function(){return n(this,void 0,void 0,function(){return r(this,function($e){switch($e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[$e.sent()]]}})})},Ge.prototype.setWeights=function($e){return n(this,void 0,void 0,function(){return r(this,function(Ye){switch(Ye.label){case 0:return[4,this.extractIterations($e)];case 1:if(($e=Ye.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},Ge.prototype.getConfig=function(){return{learningRate:this.learningRate}},Ge.fromConfig=function($e,Ye){return new $e(Ye.learningRate)},Ge.className="SGD",Ge}(xd);cd(Rd);var Id=function(Ke){function Ge($e,Ye,Qe){Qe===void 0&&(Qe=!1);var Je=Ke.call(this,$e)||this;return Je.learningRate=$e,Je.momentum=Ye,Je.useNesterov=Qe,Je.accumulations=[],Je.m=On(Je.momentum),Je}return e(Ge,Ke),Ge.prototype.applyGradients=function($e){var Ye=this;(Array.isArray($e)?$e.map(function(Qe){return Qe.name}):Object.keys($e)).forEach(function(Qe,Je){var Mt=Lt.registeredVariables[Qe];Ye.accumulations[Je]==null&&(Ye.accumulations[Je]={originalName:Qe+"/momentum",variable:Ze(function(){return Xn(Mt).variable(!1)})});var nn=Ye.accumulations[Je].variable,an=Array.isArray($e)?$e[Je].tensor:$e[Qe];an!=null&&Ze(function(){var sn,ln=Ye.m.mul(nn).add(an);sn=Ye.useNesterov?Ye.c.mul(an.add(ln.mul(Ye.m))).add(Mt):Ye.c.mul(ln).add(Mt),nn.assign(ln),Mt.assign(sn)})}),this.incrementIterations()},Ge.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&tn(this.accumulations.map(function($e){return $e.variable}))},Ge.prototype.setMomentum=function($e){this.momentum=$e},Ge.prototype.getWeights=function(){return n(this,void 0,void 0,function(){return r(this,function($e){switch($e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[$e.sent()].concat(this.accumulations.map(function(Ye){return{name:Ye.originalName,tensor:Ye.variable}}))]}})})},Ge.prototype.setWeights=function($e){return n(this,void 0,void 0,function(){return r(this,function(Ye){switch(Ye.label){case 0:return[4,this.extractIterations($e)];case 1:return $e=Ye.sent(),this.accumulations=$e.map(function(Qe){return{originalName:Qe.name,variable:Qe.tensor.variable(!1)}}),[2]}})})},Ge.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},Ge.fromConfig=function($e,Ye){return new $e(Ye.learningRate,Ye.momentum,Ye.useNesterov)},Ge.className="Momentum",Ge}(Rd);cd(Id);var kd=function(Ke){function Ge($e,Ye,Qe,Je,Mt){Ye===void 0&&(Ye=.9),Qe===void 0&&(Qe=0),Je===void 0&&(Je=null),Mt===void 0&&(Mt=!1);var nn=Ke.call(this)||this;if(nn.learningRate=$e,nn.decay=Ye,nn.momentum=Qe,nn.epsilon=Je,nn.accumulatedMeanSquares=[],nn.accumulatedMoments=[],nn.accumulatedMeanGrads=[],nn.centered=Mt,Je==null&&(nn.epsilon=Lt.backend.epsilon()),$e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return nn}return e(Ge,Ke),Ge.prototype.applyGradients=function($e){var Ye=this;(Array.isArray($e)?$e.map(function(Qe){return Qe.name}):Object.keys($e)).forEach(function(Qe,Je){var Mt=Lt.registeredVariables[Qe];Ye.accumulatedMeanSquares[Je]==null&&(Ye.accumulatedMeanSquares[Je]={originalName:Qe+"/rms",variable:Ze(function(){return Xn(Mt).variable(!1)})}),Ye.accumulatedMoments[Je]==null&&(Ye.accumulatedMoments[Je]={originalName:Qe+"/momentum",variable:Ze(function(){return Xn(Mt).variable(!1)})}),Ye.accumulatedMeanGrads[Je]==null&&Ye.centered&&(Ye.accumulatedMeanGrads[Je]={originalName:Qe+"/mg",variable:Ze(function(){return Xn(Mt).variable(!1)})});var nn=Array.isArray($e)?$e[Je].tensor:$e[Qe];if(nn!=null){var an=Ye.accumulatedMeanSquares[Je].variable,sn=Ye.accumulatedMoments[Je].variable;Ze(function(){var ln=an.mul(Ye.decay).add(nn.square().mul(1-Ye.decay));if(Ye.centered){var fn=Ye.accumulatedMeanGrads[Je].variable,hn=fn.mul(Ye.decay).add(nn.mul(1-Ye.decay)),Xr=sn.mul(Ye.momentum).add(nn.mul(Ye.learningRate).div(ln.sub(hn.square().add(Ye.epsilon)).sqrt()));an.assign(ln),fn.assign(hn),sn.assign(Xr);var Mi=Mt.sub(Xr);Mt.assign(Mi)}else{var co=an.mul(Ye.decay).add(nn.square().mul(1-Ye.decay));Xr=sn.mul(Ye.momentum).add(nn.mul(Ye.learningRate).div(co.add(Ye.epsilon).sqrt())),an.assign(co),sn.assign(Xr),Mi=Mt.sub(Xr),Mt.assign(Mi)}})}}),this.incrementIterations()},Ge.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&tn(this.accumulatedMeanSquares.map(function($e){return $e.variable})),this.accumulatedMeanGrads!=null&&this.centered&&tn(this.accumulatedMeanGrads.map(function($e){return $e.variable})),this.accumulatedMoments!=null&&tn(this.accumulatedMoments.map(function($e){return $e.variable}))},Ge.prototype.getWeights=function(){return n(this,void 0,void 0,function(){var $e;return r(this,function(Ye){switch(Ye.label){case 0:return $e=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&$e.push.apply($e,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[Ye.sent()].concat($e.map(function(Qe){return{name:Qe.originalName,tensor:Qe.variable}}))]}})})},Ge.prototype.setWeights=function($e){return n(this,void 0,void 0,function(){var Ye;return r(this,function(Qe){switch(Qe.label){case 0:return[4,this.extractIterations($e)];case 1:return $e=Qe.sent(),Ye=this.centered?$e.length/3:$e.length/2,this.accumulatedMeanSquares=$e.slice(0,Ye).map(function(Je){return{originalName:Je.name,variable:Je.tensor.variable(!1)}}),this.accumulatedMoments=$e.slice(Ye,2*Ye).map(function(Je){return{originalName:Je.name,variable:Je.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=$e.slice(2*Ye,3*Ye).map(function(Je){return{originalName:Je.name,variable:Je.tensor.variable(!1)}})),[2]}})})},Ge.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},Ge.fromConfig=function($e,Ye){return new $e(Ye.learningRate,Ye.decay,Ye.momentum,Ye.epsilon,Ye.centered)},Ge.className="RMSProp",Ge}(xd);cd(kd);typeof requestAnimationFrame<"u"||typeof setImmediate<"u"&&setImmediate;wt.prototype.squaredDifference=function(Ke){return nu(this,Ke)},xt=Gh;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var extendStatics=function(Ke,Ge){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function($e,Ye){$e.__proto__=Ye}||function($e,Ye){for(var Qe in Ye)Ye.hasOwnProperty(Qe)&&($e[Qe]=Ye[Qe])},extendStatics(Ke,Ge)};function __extends(Ke,Ge){extendStatics(Ke,Ge);function $e(){this.constructor=Ke}Ke.prototype=Ge===null?Object.create(Ge):($e.prototype=Ge.prototype,new $e)}var __assign=function(){return __assign=Object.assign||function(Ge){for(var $e,Ye=1,Qe=arguments.length;Ye<Qe;Ye++){$e=arguments[Ye];for(var Je in $e)Object.prototype.hasOwnProperty.call($e,Je)&&(Ge[Je]=$e[Je])}return Ge},__assign.apply(this,arguments)};function __awaiter(Ke,Ge,$e,Ye){function Qe(Je){return Je instanceof $e?Je:new $e(function(Mt){Mt(Je)})}return new($e||($e=Promise))(function(Je,Mt){function nn(ln){try{sn(Ye.next(ln))}catch(fn){Mt(fn)}}function an(ln){try{sn(Ye.throw(ln))}catch(fn){Mt(fn)}}function sn(ln){ln.done?Je(ln.value):Qe(ln.value).then(nn,an)}sn((Ye=Ye.apply(Ke,[])).next())})}function __generator(Ke,Ge){var $e={label:0,sent:function(){if(Je[0]&1)throw Je[1];return Je[1]},trys:[],ops:[]},Ye,Qe,Je,Mt;return Mt={next:nn(0),throw:nn(1),return:nn(2)},typeof Symbol=="function"&&(Mt[Symbol.iterator]=function(){return this}),Mt;function nn(sn){return function(ln){return an([sn,ln])}}function an(sn){if(Ye)throw new TypeError("Generator is already executing.");for(;$e;)try{if(Ye=1,Qe&&(Je=sn[0]&2?Qe.return:sn[0]?Qe.throw||((Je=Qe.return)&&Je.call(Qe),0):Qe.next)&&!(Je=Je.call(Qe,sn[1])).done)return Je;switch(Qe=0,Je&&(sn=[sn[0]&2,Je.value]),sn[0]){case 0:case 1:Je=sn;break;case 4:return $e.label++,{value:sn[1],done:!1};case 5:$e.label++,Qe=sn[1],sn=[0];continue;case 7:sn=$e.ops.pop(),$e.trys.pop();continue;default:if(Je=$e.trys,!(Je=Je.length>0&&Je[Je.length-1])&&(sn[0]===6||sn[0]===2)){$e=0;continue}if(sn[0]===3&&(!Je||sn[1]>Je[0]&&sn[1]<Je[3])){$e.label=sn[1];break}if(sn[0]===6&&$e.label<Je[1]){$e.label=Je[1],Je=sn;break}if(Je&&$e.label<Je[2]){$e.label=Je[2],$e.ops.push(sn);break}Je[2]&&$e.ops.pop(),$e.trys.pop();continue}sn=Ge.call(Ke,$e)}catch(ln){sn=[6,ln],Qe=0}finally{Ye=Je=0}if(sn[0]&5)throw sn[1];return{value:sn[0]?sn[1]:void 0,done:!0}}}function __spreadArrays(){for(var Ke=0,Ge=0,$e=arguments.length;Ge<$e;Ge++)Ke+=arguments[Ge].length;for(var Ye=Array(Ke),Qe=0,Ge=0;Ge<$e;Ge++)for(var Je=arguments[Ge],Mt=0,nn=Je.length;Mt<nn;Mt++,Qe++)Ye[Qe]=Je[Mt];return Ye}var Dimensions=function(){function Ke(Ge,$e){if(!isValidNumber(Ge)||!isValidNumber($e))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:Ge,height:$e}));this._width=Ge,this._height=$e}return Object.defineProperty(Ke.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Ke.prototype.reverse=function(){return new Ke(1/this.width,1/this.height)},Ke}();function isTensor(Ke,Ge){return Ke instanceof wt&&Ke.shape.length===Ge}function isTensor2D(Ke){return isTensor(Ke,2)}function isTensor3D(Ke){return isTensor(Ke,3)}function isTensor4D(Ke){return isTensor(Ke,4)}function isFloat(Ke){return Ke%1!==0}function isEven(Ke){return Ke%2===0}function round(Ke,Ge){Ge===void 0&&(Ge=2);var $e=Math.pow(10,Ge);return Math.floor(Ke*$e)/$e}function isDimensions(Ke){return Ke&&Ke.width&&Ke.height}function computeReshapedDimensions(Ke,Ge){var $e=Ke.width,Ye=Ke.height,Qe=Ge/Math.max(Ye,$e);return new Dimensions(Math.round($e*Qe),Math.round(Ye*Qe))}function getCenterPoint(Ke){return Ke.reduce(function(Ge,$e){return Ge.add($e)},new Point(0,0)).div(new Point(Ke.length,Ke.length))}function range(Ke,Ge,$e){return Array(Ke).fill(0).map(function(Ye,Qe){return Ge+Qe*$e})}function isValidNumber(Ke){return!!Ke&&Ke!==1/0&&Ke!==-1/0&&!isNaN(Ke)||Ke===0}function isValidProbablitiy(Ke){return isValidNumber(Ke)&&0<=Ke&&Ke<=1}var Point=function(){function Ke(Ge,$e){this._x=Ge,this._y=$e}return Object.defineProperty(Ke.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Ke.prototype.add=function(Ge){return new Ke(this.x+Ge.x,this.y+Ge.y)},Ke.prototype.sub=function(Ge){return new Ke(this.x-Ge.x,this.y-Ge.y)},Ke.prototype.mul=function(Ge){return new Ke(this.x*Ge.x,this.y*Ge.y)},Ke.prototype.div=function(Ge){return new Ke(this.x/Ge.x,this.y/Ge.y)},Ke.prototype.abs=function(){return new Ke(Math.abs(this.x),Math.abs(this.y))},Ke.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},Ke.prototype.floor=function(){return new Ke(Math.floor(this.x),Math.floor(this.y))},Ke}(),Box=function(){function Ke(Ge,$e){$e===void 0&&($e=!0);var Ye=Ge||{},Qe=[Ye.left,Ye.top,Ye.right,Ye.bottom].every(isValidNumber),Je=[Ye.x,Ye.y,Ye.width,Ye.height].every(isValidNumber);if(!Je&&!Qe)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(Ye));var Mt=Je?[Ye.x,Ye.y,Ye.width,Ye.height]:[Ye.left,Ye.top,Ye.right-Ye.left,Ye.bottom-Ye.top],nn=Mt[0],an=Mt[1],sn=Mt[2],ln=Mt[3];Ke.assertIsValidBox({x:nn,y:an,width:sn,height:ln},"Box.constructor",$e),this._x=nn,this._y=an,this._width=sn,this._height=ln}return Ke.isRect=function(Ge){return!!Ge&&[Ge.x,Ge.y,Ge.width,Ge.height].every(isValidNumber)},Ke.assertIsValidBox=function(Ge,$e,Ye){if(Ye===void 0&&(Ye=!1),!Ke.isRect(Ge))throw new Error($e+" - invalid box: "+JSON.stringify(Ge)+", expected object with properties x, y, width, height");if(!Ye&&(Ge.width<0||Ge.height<0))throw new Error($e+" - width ("+Ge.width+") and height ("+Ge.height+") must be positive numbers")},Object.defineProperty(Ke.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"topLeft",{get:function(){return new Point(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"topRight",{get:function(){return new Point(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"bottomLeft",{get:function(){return new Point(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"bottomRight",{get:function(){return new Point(this.right,this.bottom)},enumerable:!0,configurable:!0}),Ke.prototype.round=function(){var Ge=[this.x,this.y,this.width,this.height].map(function(Mt){return Math.round(Mt)}),$e=Ge[0],Ye=Ge[1],Qe=Ge[2],Je=Ge[3];return new Ke({x:$e,y:Ye,width:Qe,height:Je})},Ke.prototype.floor=function(){var Ge=[this.x,this.y,this.width,this.height].map(function(Mt){return Math.floor(Mt)}),$e=Ge[0],Ye=Ge[1],Qe=Ge[2],Je=Ge[3];return new Ke({x:$e,y:Ye,width:Qe,height:Je})},Ke.prototype.toSquare=function(){var Ge=this,$e=Ge.x,Ye=Ge.y,Qe=Ge.width,Je=Ge.height,Mt=Math.abs(Qe-Je);return Qe<Je&&($e-=Mt/2,Qe+=Mt),Je<Qe&&(Ye-=Mt/2,Je+=Mt),new Ke({x:$e,y:Ye,width:Qe,height:Je})},Ke.prototype.rescale=function(Ge){var $e=isDimensions(Ge)?Ge.width:Ge,Ye=isDimensions(Ge)?Ge.height:Ge;return new Ke({x:this.x*$e,y:this.y*Ye,width:this.width*$e,height:this.height*Ye})},Ke.prototype.pad=function(Ge,$e){var Ye=[this.x-Ge/2,this.y-$e/2,this.width+Ge,this.height+$e],Qe=Ye[0],Je=Ye[1],Mt=Ye[2],nn=Ye[3];return new Ke({x:Qe,y:Je,width:Mt,height:nn})},Ke.prototype.clipAtImageBorders=function(Ge,$e){var Ye=this,Qe=Ye.x,Je=Ye.y,Mt=Ye.right,nn=Ye.bottom,an=Math.max(Qe,0),sn=Math.max(Je,0),ln=Mt-an,fn=nn-sn,hn=Math.min(ln,Ge-an),Xr=Math.min(fn,$e-sn);return new Ke({x:an,y:sn,width:hn,height:Xr}).floor()},Ke.prototype.shift=function(Ge,$e){var Ye=this,Qe=Ye.width,Je=Ye.height,Mt=this.x+Ge,nn=this.y+$e;return new Ke({x:Mt,y:nn,width:Qe,height:Je})},Ke.prototype.padAtBorders=function(Ge,$e){var Ye=this.width+1,Qe=this.height+1,Je=1,Mt=1,nn=Ye,an=Qe,sn=this.left,ln=this.top,fn=this.right,hn=this.bottom;return fn>$e&&(nn=-fn+$e+Ye,fn=$e),hn>Ge&&(an=-hn+Ge+Qe,hn=Ge),sn<1&&(an=2-sn,sn=1),ln<1&&(an=2-ln,ln=1),{dy:Mt,edy:an,dx:Je,edx:nn,y:ln,ey:hn,x:sn,ex:fn,w:Ye,h:Qe}},Ke.prototype.calibrate=function(Ge){return new Ke({left:this.left+Ge.left*this.width,top:this.top+Ge.top*this.height,right:this.right+Ge.right*this.width,bottom:this.bottom+Ge.bottom*this.height}).toSquare().round()},Ke}(),BoundingBox=function(Ke){__extends(Ge,Ke);function Ge($e,Ye,Qe,Je,Mt){return Mt===void 0&&(Mt=!1),Ke.call(this,{left:$e,top:Ye,right:Qe,bottom:Je},Mt)||this}return Ge}(Box),ObjectDetection=function(){function Ke(Ge,$e,Ye,Qe,Je){this._imageDims=new Dimensions(Je.width,Je.height),this._score=Ge,this._classScore=$e,this._className=Ye,this._box=new Box(Qe).rescale(this._imageDims)}return Object.defineProperty(Ke.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"relativeBox",{get:function(){return new Box(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),Ke.prototype.forSize=function(Ge,$e){return new Ke(this.score,this.classScore,this.className,this.relativeBox,{width:Ge,height:$e})},Ke}(),FaceDetection=function(Ke){__extends(Ge,Ke);function Ge($e,Ye,Qe){return Ke.call(this,$e,$e,"",Ye,Qe)||this}return Ge.prototype.forSize=function($e,Ye){var Qe=Ke.prototype.forSize.call(this,$e,Ye),Je=Qe.score,Mt=Qe.relativeBox,nn=Qe.imageDims;return new Ge(Je,Mt,nn)},Ge}(ObjectDetection);function iou(Ke,Ge,$e){$e===void 0&&($e=!0);var Ye=Math.max(0,Math.min(Ke.right,Ge.right)-Math.max(Ke.left,Ge.left)),Qe=Math.max(0,Math.min(Ke.bottom,Ge.bottom)-Math.max(Ke.top,Ge.top)),Je=Ye*Qe;return $e?Je/(Ke.area+Ge.area-Je):Je/Math.min(Ke.area,Ge.area)}function minBbox(Ke){var Ge=Ke.map(function(nn){return nn.x}),$e=Ke.map(function(nn){return nn.y}),Ye=Ge.reduce(function(nn,an){return an<nn?an:nn},1/0),Qe=$e.reduce(function(nn,an){return an<nn?an:nn},1/0),Je=Ge.reduce(function(nn,an){return nn<an?an:nn},0),Mt=$e.reduce(function(nn,an){return nn<an?an:nn},0);return new BoundingBox(Ye,Qe,Je,Mt)}function nonMaxSuppression$1(Ke,Ge,$e,Ye){Ye===void 0&&(Ye=!0);for(var Qe=Ge.map(function(nn,an){return{score:nn,boxIndex:an}}).sort(function(nn,an){return nn.score-an.score}).map(function(nn){return nn.boxIndex}),Je=[],Mt=function(){var nn=Qe.pop();Je.push(nn);for(var an=Qe,sn=[],ln=0;ln<an.length;ln++){var fn=an[ln],hn=Ke[nn],Xr=Ke[fn];sn.push(iou(hn,Xr,Ye))}Qe=Qe.filter(function(Mi,co){return sn[co]<=$e})};Qe.length>0;)Mt();return Je}function normalize$1(Ke,Ge){return Ze(function(){var $e=Ge[0],Ye=Ge[1],Qe=Ge[2],Je=Hn(__spreadArrays(Ke.shape.slice(0,3),[1]),$e),Mt=Hn(__spreadArrays(Ke.shape.slice(0,3),[1]),Ye),nn=Hn(__spreadArrays(Ke.shape.slice(0,3),[1]),Qe),an=Yn([Je,Mt,nn],3);return Cc(Ke,an)})}function padToSquare(Ke,Ge){return Ge===void 0&&(Ge=!1),Ze(function(){var $e=Ke.shape.slice(1),Ye=$e[0],Qe=$e[1];if(Ye===Qe)return Ke;var Je=Math.abs(Ye-Qe),Mt=Math.round(Je*(Ge?.5:1)),nn=Ye>Qe?2:1,an=function(Xr){var Mi=Ke.shape.slice();return Mi[nn]=Xr,Hn(Mi,0)},sn=an(Mt),ln=Je-sn.shape[nn],fn=Ge&&ln?an(ln):null,hn=[fn,Ke,sn].filter(function(Xr){return!!Xr}).map(function(Xr){return Xr.toFloat()});return Yn(hn,nn)})}function sigmoid(Ke){return 1/(1+Math.exp(-Ke))}var Rect=function(Ke){__extends(Ge,Ke);function Ge($e,Ye,Qe,Je,Mt){return Mt===void 0&&(Mt=!1),Ke.call(this,{x:$e,y:Ye,width:Qe,height:Je},Mt)||this}return Ge}(Box),relX=.5,relY=.43,relScale=.45,FaceLandmarks=function(){function Ke(Ge,$e,Ye){Ye===void 0&&(Ye=new Point(0,0));var Qe=$e.width,Je=$e.height;this._imgDims=new Dimensions(Qe,Je),this._shift=Ye,this._positions=Ge.map(function(Mt){return Mt.mul(new Point(Qe,Je)).add(Ye)})}return Object.defineProperty(Ke.prototype,"shift",{get:function(){return new Point(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"relativePositions",{get:function(){var Ge=this;return this._positions.map(function($e){return $e.sub(Ge._shift).div(new Point(Ge.imageWidth,Ge.imageHeight))})},enumerable:!0,configurable:!0}),Ke.prototype.forSize=function(Ge,$e){return new this.constructor(this.relativePositions,{width:Ge,height:$e})},Ke.prototype.shiftBy=function(Ge,$e){return new this.constructor(this.relativePositions,this._imgDims,new Point(Ge,$e))},Ke.prototype.shiftByPoint=function(Ge){return this.shiftBy(Ge.x,Ge.y)},Ke.prototype.align=function(Ge,$e){if($e===void 0&&($e={}),Ge){var Ye=Ge instanceof FaceDetection?Ge.box.floor():new Box(Ge);return this.shiftBy(Ye.x,Ye.y).align(null,$e)}var Qe=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},$e),Je=Qe.useDlibAlignment,Mt=Qe.minBoxPadding;return Je?this.alignDlib():this.alignMinBbox(Mt)},Ke.prototype.alignDlib=function(){var Ge=this.getRefPointsForAlignment(),$e=Ge[0],Ye=Ge[1],Qe=Ge[2],Je=function(fn){return Qe.sub(fn).magnitude()},Mt=(Je($e)+Je(Ye))/2,nn=Math.floor(Mt/relScale),an=getCenterPoint(Ge),sn=Math.floor(Math.max(0,an.x-relX*nn)),ln=Math.floor(Math.max(0,an.y-relY*nn));return new Rect(sn,ln,Math.min(nn,this.imageWidth+sn),Math.min(nn,this.imageHeight+ln))},Ke.prototype.alignMinBbox=function(Ge){var $e=minBbox(this.positions);return $e.pad($e.width*Ge,$e.height*Ge)},Ke.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},Ke}(),FaceLandmarks5=function(Ke){__extends(Ge,Ke);function Ge(){return Ke!==null&&Ke.apply(this,arguments)||this}return Ge.prototype.getRefPointsForAlignment=function(){var $e=this.positions;return[$e[0],$e[1],getCenterPoint([$e[3],$e[4]])]},Ge}(FaceLandmarks),FaceLandmarks68=function(Ke){__extends(Ge,Ke);function Ge(){return Ke!==null&&Ke.apply(this,arguments)||this}return Ge.prototype.getJawOutline=function(){return this.positions.slice(0,17)},Ge.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},Ge.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},Ge.prototype.getNose=function(){return this.positions.slice(27,36)},Ge.prototype.getLeftEye=function(){return this.positions.slice(36,42)},Ge.prototype.getRightEye=function(){return this.positions.slice(42,48)},Ge.prototype.getMouth=function(){return this.positions.slice(48,68)},Ge.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(getCenterPoint)},Ge}(FaceLandmarks),FaceMatch=function(){function Ke(Ge,$e){this._label=Ge,this._distance=$e}return Object.defineProperty(Ke.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),Ke.prototype.toString=function(Ge){return Ge===void 0&&(Ge=!0),""+this.label+(Ge?" ("+round(this.distance)+")":"")},Ke}(),LabeledBox=function(Ke){__extends(Ge,Ke);function Ge($e,Ye){var Qe=Ke.call(this,$e)||this;return Qe._label=Ye,Qe}return Ge.assertIsValidLabeledBox=function($e,Ye){if(Box.assertIsValidBox($e,Ye),!isValidNumber($e.label))throw new Error(Ye+" - expected property label ("+$e.label+") to be a number")},Object.defineProperty(Ge.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Ge}(Box),LabeledFaceDescriptors=function(){function Ke(Ge,$e){if(typeof Ge!="string")throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray($e)||$e.some(function(Ye){return!(Ye instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=Ge,this._descriptors=$e}return Object.defineProperty(Ke.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),Ke.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(Ge){return Array.from(Ge)})}},Ke.fromJSON=function(Ge){var $e=Ge.descriptors.map(function(Ye){return new Float32Array(Ye)});return new Ke(Ge.label,$e)},Ke}();(function(Ke){__extends(Ge,Ke);function Ge($e,Ye,Qe,Je){var Mt=Ke.call(this,$e,Ye)||this;return Mt._score=Qe,Mt._classScore=Je,Mt}return Ge.assertIsValidPredictedBox=function($e,Ye){if(LabeledBox.assertIsValidLabeledBox($e,Ye),!isValidProbablitiy($e.score)||!isValidProbablitiy($e.classScore))throw new Error(Ye+" - expected properties score ("+$e.score+") and ("+$e.classScore+") to be a number between [0, 1]")},Object.defineProperty(Ge.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(Ge.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Ge})(LabeledBox);function isWithFaceDetection(Ke){return Ke.detection instanceof FaceDetection}function extendWithFaceDetection(Ke,Ge){var $e={detection:Ge};return Object.assign({},Ke,$e)}function createBrowserEnv(){var Ke=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")},Ge=function(){throw new Error("readFile - filesystem not available for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:Ke,readFile:Ge}}function createFileSystem(Ke){var Ge="";if(!Ke)try{Ke=require("fs")}catch(Ye){Ge=Ye.toString()}var $e=Ke?function(Ye){return new Promise(function(Qe,Je){Ke.readFile(Ye,function(Mt,nn){return Mt?Je(Mt):Qe(nn)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+Ge)};return{readFile:$e}}function createNodejsEnv(){var Ke=global.Canvas||global.HTMLCanvasElement,Ge=global.Image||global.HTMLImageElement,$e=function(){if(Ke)return new Ke;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},Ye=function(){if(Ge)return new Ge;throw new Error("createImageElement - missing Image implementation for nodejs environment")},Qe=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},Je=createFileSystem();return __assign({Canvas:Ke||function(){function Mt(){}return Mt}(),CanvasRenderingContext2D:global.CanvasRenderingContext2D||function(){function Mt(){}return Mt}(),Image:Ge||function(){function Mt(){}return Mt}(),ImageData:global.ImageData||function(){function Mt(){}return Mt}(),Video:global.HTMLVideoElement||function(){function Mt(){}return Mt}(),createCanvasElement:$e,createImageElement:Ye,fetch:Qe},Je)}function isBrowser(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}function isNodejs(){return typeof global=="object"&&typeof require=="function"&&typeof module<"u"&&typeof process<"u"&&!!process.version}var environment;function getEnv(){if(!environment)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return environment}function setEnv(Ke){environment=Ke}function initialize(){isBrowser()&&setEnv(createBrowserEnv()),isNodejs()&&setEnv(createNodejsEnv())}function monkeyPatch(Ke){if(environment||initialize(),!environment)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var Ge=Ke.Canvas,$e=Ge===void 0?environment.Canvas:Ge,Ye=Ke.Image,Qe=Ye===void 0?environment.Image:Ye;environment.Canvas=$e,environment.Image=Qe,environment.createCanvasElement=Ke.createCanvasElement||function(){return new $e},environment.createImageElement=Ke.createImageElement||function(){return new Qe},environment.ImageData=Ke.ImageData||environment.ImageData,environment.Video=Ke.Video||environment.Video,environment.fetch=Ke.fetch||environment.fetch,environment.readFile=Ke.readFile||environment.readFile}var env={getEnv,setEnv,initialize,createBrowserEnv,createFileSystem,createNodejsEnv,monkeyPatch,isBrowser,isNodejs};initialize();function resolveInput(Ke){return!env.isNodejs()&&typeof Ke=="string"?document.getElementById(Ke):Ke}function getContext2dOrThrow(Ke){var Ge=env.getEnv(),$e=Ge.Canvas,Ye=Ge.CanvasRenderingContext2D;if(Ke instanceof Ye)return Ke;var Qe=resolveInput(Ke);if(!(Qe instanceof $e))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var Je=Qe.getContext("2d");if(!Je)throw new Error("resolveContext2d - canvas 2d context is null");return Je}var AnchorPosition;(function(Ke){Ke.TOP_LEFT="TOP_LEFT",Ke.TOP_RIGHT="TOP_RIGHT",Ke.BOTTOM_LEFT="BOTTOM_LEFT",Ke.BOTTOM_RIGHT="BOTTOM_RIGHT"})(AnchorPosition||(AnchorPosition={}));function isMediaLoaded(Ke){var Ge=env.getEnv(),$e=Ge.Image,Ye=Ge.Video;return Ke instanceof $e&&Ke.complete||Ke instanceof Ye&&Ke.readyState>=3}function awaitMediaLoaded(Ke){return new Promise(function(Ge,$e){if(Ke instanceof env.getEnv().Canvas||isMediaLoaded(Ke))return Ge();function Ye(Je){Je.currentTarget&&(Je.currentTarget.removeEventListener("load",Ye),Je.currentTarget.removeEventListener("error",Qe),Ge(Je))}function Qe(Je){Je.currentTarget&&(Je.currentTarget.removeEventListener("load",Ye),Je.currentTarget.removeEventListener("error",Qe),$e(Je))}Ke.addEventListener("load",Ye),Ke.addEventListener("error",Qe)})}function getMediaDimensions(Ke){var Ge=env.getEnv(),$e=Ge.Image,Ye=Ge.Video;return Ke instanceof $e?new Dimensions(Ke.naturalWidth,Ke.naturalHeight):Ke instanceof Ye?new Dimensions(Ke.videoWidth,Ke.videoHeight):new Dimensions(Ke.width,Ke.height)}function createCanvas(Ke){var Ge=Ke.width,$e=Ke.height,Ye=env.getEnv().createCanvasElement,Qe=Ye();return Qe.width=Ge,Qe.height=$e,Qe}function createCanvasFromMedia(Ke,Ge){var $e=env.getEnv().ImageData;if(!(Ke instanceof $e)&&!isMediaLoaded(Ke))throw new Error("createCanvasFromMedia - media has not finished loading yet");var Ye=getMediaDimensions(Ke),Qe=Ye.width,Je=Ye.height,Mt=createCanvas({width:Qe,height:Je});return Ke instanceof $e?getContext2dOrThrow(Mt).putImageData(Ke,0,0):getContext2dOrThrow(Mt).drawImage(Ke,0,0,Qe,Je),Mt}function imageTensorToCanvas(Ke,Ge){return __awaiter(this,void 0,void 0,function(){var $e,Ye,Qe,Je,Mt,nn;return __generator(this,function(an){switch(an.label){case 0:return $e=env.getEnv().createCanvasElement(),Ye=Ke.shape.slice(isTensor4D(Ke)?1:0),Qe=Ye[0],Je=Ye[1],Mt=Ye[2],nn=Ze(function(){return Ke.as3D(Qe,Je,Mt).toInt()}),[4,id.toPixels(nn,$e)];case 1:return an.sent(),nn.dispose(),[2,$e]}})})}function isMediaElement(Ke){var Ge=env.getEnv(),$e=Ge.Image,Ye=Ge.Canvas,Qe=Ge.Video;return Ke instanceof $e||Ke instanceof Ye||Ke instanceof Qe}function imageToSquare(Ke,Ge,$e){$e===void 0&&($e=!1);var Ye=env.getEnv(),Qe=Ye.Image,Je=Ye.Canvas;if(!(Ke instanceof Qe||Ke instanceof Je))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var Mt=getMediaDimensions(Ke),nn=Ge/Math.max(Mt.height,Mt.width),an=nn*Mt.width,sn=nn*Mt.height,ln=createCanvas({width:Ge,height:Ge}),fn=Ke instanceof Je?Ke:createCanvasFromMedia(Ke),hn=Math.abs(an-sn)/2,Xr=$e&&an<sn?hn:0,Mi=$e&&sn<an?hn:0;return getContext2dOrThrow(ln).drawImage(fn,Xr,Mi,an,sn),ln}var NetInput=function(){function Ke(Ge,$e){var Ye=this;if($e===void 0&&($e=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(Ge))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+Ge);this._treatAsBatchInput=$e,this._batchSize=Ge.length,Ge.forEach(function(Qe,Je){if(isTensor3D(Qe)){Ye._imageTensors[Je]=Qe,Ye._inputDimensions[Je]=Qe.shape;return}if(isTensor4D(Qe)){var Mt=Qe.shape[0];if(Mt!==1)throw new Error("NetInput - tf.Tensor4D with batchSize "+Mt+" passed, but not supported in input array");Ye._imageTensors[Je]=Qe,Ye._inputDimensions[Je]=Qe.shape.slice(1);return}var nn=Qe instanceof env.getEnv().Canvas?Qe:createCanvasFromMedia(Qe);Ye._canvases[Je]=nn,Ye._inputDimensions[Je]=[nn.height,nn.width,3]})}return Object.defineProperty(Ke.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"reshapedInputDimensions",{get:function(){var Ge=this;return range(this.batchSize,0,1).map(function($e,Ye){return Ge.getReshapedInputDimensions(Ye)})},enumerable:!0,configurable:!0}),Ke.prototype.getInput=function(Ge){return this.canvases[Ge]||this.imageTensors[Ge]},Ke.prototype.getInputDimensions=function(Ge){return this._inputDimensions[Ge]},Ke.prototype.getInputHeight=function(Ge){return this._inputDimensions[Ge][0]},Ke.prototype.getInputWidth=function(Ge){return this._inputDimensions[Ge][1]},Ke.prototype.getReshapedInputDimensions=function(Ge){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");var $e=this.getInputWidth(Ge),Ye=this.getInputHeight(Ge);return computeReshapedDimensions({width:$e,height:Ye},this.inputSize)},Ke.prototype.toBatchTensor=function(Ge,$e){var Ye=this;return $e===void 0&&($e=!0),this._inputSize=Ge,Ze(function(){var Qe=range(Ye.batchSize,0,1).map(function(Mt){var nn=Ye.getInput(Mt);if(nn instanceof wt){var an=isTensor4D(nn)?nn:nn.expandDims();return an=padToSquare(an,$e),(an.shape[1]!==Ge||an.shape[2]!==Ge)&&(an=Oh.resizeBilinear(an,[Ge,Ge])),an.as3D(Ge,Ge,3)}if(nn instanceof env.getEnv().Canvas)return id.fromPixels(imageToSquare(nn,Ge,$e));throw new Error("toBatchTensor - at batchIdx "+Mt+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+nn)}),Je=Pr(Qe.map(function(Mt){return Mt.toFloat()})).as4D(Ye.batchSize,Ge,Ge,3);return Je})},Ke}();function toNetInput(Ke){return __awaiter(this,void 0,void 0,function(){var Ge,$e,Ye;return __generator(this,function(Qe){switch(Qe.label){case 0:if(Ke instanceof NetInput)return[2,Ke];if(Ge=Array.isArray(Ke)?Ke:[Ke],!Ge.length)throw new Error("toNetInput - empty array passed as input");return $e=function(Je){return Array.isArray(Ke)?" at input index "+Je+":":""},Ye=Ge.map(resolveInput),Ye.forEach(function(Je,Mt){if(!isMediaElement(Je)&&!isTensor3D(Je)&&!isTensor4D(Je))throw typeof Ge[Mt]=="string"?new Error("toNetInput -"+$e(Mt)+" string passed, but could not resolve HTMLElement for element id "+Ge[Mt]):new Error("toNetInput -"+$e(Mt)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id");if(isTensor4D(Je)){var nn=Je.shape[0];if(nn!==1)throw new Error("toNetInput -"+$e(Mt)+" tf.Tensor4D with batchSize "+nn+" passed, but not supported in input array")}}),[4,Promise.all(Ye.map(function(Je){return isMediaElement(Je)&&awaitMediaLoaded(Je)}))];case 1:return Qe.sent(),[2,new NetInput(Ye,Array.isArray(Ke))]}})})}function extractFaces(Ke,Ge){return __awaiter(this,void 0,void 0,function(){var $e,Ye,Qe,Je,Mt,nn,an;return __generator(this,function(sn){switch(sn.label){case 0:return $e=env.getEnv().Canvas,Ye=Ke,Ke instanceof $e?[3,5]:[4,toNetInput(Ke)];case 1:if(Qe=sn.sent(),Qe.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return Je=Qe.getInput(0),Je instanceof $e?(Mt=Je,[3,4]):[3,2];case 2:return[4,imageTensorToCanvas(Je)];case 3:Mt=sn.sent(),sn.label=4;case 4:Ye=Mt,sn.label=5;case 5:return nn=getContext2dOrThrow(Ye),an=Ge.map(function(ln){return ln instanceof FaceDetection?ln.forSize(Ye.width,Ye.height).box.floor():ln}).map(function(ln){return ln.clipAtImageBorders(Ye.width,Ye.height)}),[2,an.map(function(ln){var fn=ln.x,hn=ln.y,Xr=ln.width,Mi=ln.height,co=createCanvas({width:Xr,height:Mi});return getContext2dOrThrow(co).putImageData(nn.getImageData(fn,hn,Xr,Mi),0,0),co})]}})})}function extractFaceTensors(Ke,Ge){return __awaiter(this,void 0,void 0,function(){return __generator(this,function($e){if(!isTensor3D(Ke)&&!isTensor4D(Ke))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(isTensor4D(Ke)&&Ke.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,Ze(function(){var Ye=Ke.shape.slice(isTensor4D(Ke)?1:0),Qe=Ye[0],Je=Ye[1],Mt=Ye[2],nn=Ge.map(function(sn){return sn instanceof FaceDetection?sn.forSize(Je,Qe).box:sn}).map(function(sn){return sn.clipAtImageBorders(Je,Qe)}),an=nn.map(function(sn){var ln=sn.x,fn=sn.y,hn=sn.width,Xr=sn.height;return xl(Ke.as3D(Qe,Je,Mt),[fn,ln,0],[Xr,hn,Mt])});return an})]})})}function fetchOrThrow(Ke,Ge){return __awaiter(this,void 0,void 0,function(){var $e,Ye;return __generator(this,function(Qe){switch(Qe.label){case 0:return $e=env.getEnv().fetch,[4,$e(Ke,Ge)];case 1:if(Ye=Qe.sent(),!(Ye.status<400))throw new Error("failed to fetch: ("+Ye.status+") "+Ye.statusText+", from url: "+Ye.url);return[2,Ye]}})})}function fetchJson(Ke){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(Ge){switch(Ge.label){case 0:return[4,fetchOrThrow(Ke)];case 1:return[2,Ge.sent().json()]}})})}function getModelUris(Ke,Ge){var $e=Ge+"-weights_manifest.json";if(!Ke)return{modelBaseUri:"",manifestUri:$e};if(Ke==="/")return{modelBaseUri:"/",manifestUri:"/"+$e};var Ye=Ke.startsWith("http://")?"http://":Ke.startsWith("https://")?"https://":"";Ke=Ke.replace(Ye,"");var Qe=Ke.split("/").filter(function(nn){return nn}),Je=Ke.endsWith(".json")?Qe[Qe.length-1]:$e,Mt=Ye+(Ke.endsWith(".json")?Qe.slice(0,Qe.length-1):Qe).join("/");return Mt=Ke.startsWith("/")?"/"+Mt:Mt,{modelBaseUri:Mt,manifestUri:Mt==="/"?"/"+Je:Mt+"/"+Je}}function loadWeightMap(Ke,Ge){return __awaiter(this,void 0,void 0,function(){var $e,Ye,Qe,Je;return __generator(this,function(Mt){switch(Mt.label){case 0:return $e=getModelUris(Ke,Ge),Ye=$e.manifestUri,Qe=$e.modelBaseUri,[4,fetchJson(Ye)];case 1:return Je=Mt.sent(),[2,ed.loadWeights(Je,Qe)]}})})}var NeuralNetwork=function(){function Ke(Ge){this._name=Ge,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(Ke.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),Ke.prototype.getParamFromPath=function(Ge){var $e=this.traversePropertyPath(Ge),Ye=$e.obj,Qe=$e.objProp;return Ye[Qe]},Ke.prototype.reassignParamFromPath=function(Ge,$e){var Ye=this.traversePropertyPath(Ge),Qe=Ye.obj,Je=Ye.objProp;Qe[Je].dispose(),Qe[Je]=$e},Ke.prototype.getParamList=function(){var Ge=this;return this._paramMappings.map(function($e){var Ye=$e.paramPath;return{path:Ye,tensor:Ge.getParamFromPath(Ye)}})},Ke.prototype.getTrainableParams=function(){return this.getParamList().filter(function(Ge){return Ge.tensor instanceof St})},Ke.prototype.getFrozenParams=function(){return this.getParamList().filter(function(Ge){return!(Ge.tensor instanceof St)})},Ke.prototype.variable=function(){var Ge=this;this.getFrozenParams().forEach(function($e){var Ye=$e.path,Qe=$e.tensor;Ge.reassignParamFromPath(Ye,Qe.variable())})},Ke.prototype.freeze=function(){var Ge=this;this.getTrainableParams().forEach(function($e){var Ye=$e.path,Qe=$e.tensor,Je=Fn(Qe.dataSync());Qe.dispose(),Ge.reassignParamFromPath(Ye,Je)})},Ke.prototype.dispose=function(Ge){Ge===void 0&&(Ge=!0),this.getParamList().forEach(function($e){if(Ge&&$e.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+$e.path);$e.tensor.dispose()}),this._params=void 0},Ke.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(Ge){var $e=Ge.tensor;return Array.from($e.dataSync())}).reduce(function(Ge,$e){return Ge.concat($e)}))},Ke.prototype.load=function(Ge){return __awaiter(this,void 0,void 0,function(){return __generator(this,function($e){switch($e.label){case 0:return Ge instanceof Float32Array?(this.extractWeights(Ge),[2]):[4,this.loadFromUri(Ge)];case 1:return $e.sent(),[2]}})})},Ke.prototype.loadFromUri=function(Ge){return __awaiter(this,void 0,void 0,function(){var $e;return __generator(this,function(Ye){switch(Ye.label){case 0:if(Ge&&typeof Ge!="string")throw new Error(this._name+".loadFromUri - expected model uri");return[4,loadWeightMap(Ge,this.getDefaultModelName())];case 1:return $e=Ye.sent(),this.loadFromWeightMap($e),[2]}})})},Ke.prototype.loadFromDisk=function(Ge){return __awaiter(this,void 0,void 0,function(){var $e,Ye,Qe,Je,Mt,nn,an,sn,ln,fn;return __generator(this,function(hn){switch(hn.label){case 0:if(Ge&&typeof Ge!="string")throw new Error(this._name+".loadFromDisk - expected model file path");return $e=env.getEnv().readFile,Ye=getModelUris(Ge,this.getDefaultModelName()),Qe=Ye.manifestUri,Je=Ye.modelBaseUri,Mt=function(Xr){return Promise.all(Xr.map(function(Mi){return $e(Mi).then(function(co){return co.buffer})}))},nn=ed.weightsLoaderFactory(Mt),ln=(sn=JSON).parse,[4,$e(Qe)];case 1:return an=ln.apply(sn,[hn.sent().toString()]),[4,nn(an,Je)];case 2:return fn=hn.sent(),this.loadFromWeightMap(fn),[2]}})})},Ke.prototype.loadFromWeightMap=function(Ge){var $e=this.extractParamsFromWeigthMap(Ge),Ye=$e.paramMappings,Qe=$e.params;this._paramMappings=Ye,this._params=Qe},Ke.prototype.extractWeights=function(Ge){var $e=this.extractParams(Ge),Ye=$e.paramMappings,Qe=$e.params;this._paramMappings=Ye,this._params=Qe},Ke.prototype.traversePropertyPath=function(Ge){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var $e=Ge.split("/").reduce(function(Je,Mt){if(!Je.nextObj.hasOwnProperty(Mt))throw new Error("traversePropertyPath - object does not have property "+Mt+", for path "+Ge);return{obj:Je.nextObj,objProp:Mt,nextObj:Je.nextObj[Mt]}},{nextObj:this.params}),Ye=$e.obj,Qe=$e.objProp;if(!Ye||!Qe||!(Ye[Qe]instanceof wt))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+Ge);return{obj:Ye,objProp:Qe}},Ke}();function depthwiseSeparableConv$1(Ke,Ge,$e){return Ze(function(){var Ye=Jc(Ke,Ge.depthwise_filter,Ge.pointwise_filter,$e,"same");return Ye=rc(Ye,Ge.bias),Ye})}function denseBlock3(Ke,Ge,$e){return $e===void 0&&($e=!1),Ze(function(){var Ye=Bl($e?rc(qc(Ke,Ge.conv0.filters,[2,2],"same"),Ge.conv0.bias):depthwiseSeparableConv$1(Ke,Ge.conv0,[2,2])),Qe=depthwiseSeparableConv$1(Ye,Ge.conv1,[1,1]),Je=Bl(rc(Ye,Qe)),Mt=depthwiseSeparableConv$1(Je,Ge.conv2,[1,1]);return Bl(rc(Ye,rc(Qe,Mt)))})}function denseBlock4(Ke,Ge,$e,Ye){return $e===void 0&&($e=!1),Ye===void 0&&(Ye=!0),Ze(function(){var Qe=Bl($e?rc(qc(Ke,Ge.conv0.filters,Ye?[2,2]:[1,1],"same"),Ge.conv0.bias):depthwiseSeparableConv$1(Ke,Ge.conv0,Ye?[2,2]:[1,1])),Je=depthwiseSeparableConv$1(Qe,Ge.conv1,[1,1]),Mt=Bl(rc(Qe,Je)),nn=depthwiseSeparableConv$1(Mt,Ge.conv2,[1,1]),an=Bl(rc(Qe,rc(Je,nn))),sn=depthwiseSeparableConv$1(an,Ge.conv3,[1,1]);return Bl(rc(Qe,rc(Je,rc(nn,sn))))})}function convLayer$1(Ke,Ge,$e,Ye){return $e===void 0&&($e="same"),Ye===void 0&&(Ye=!1),Ze(function(){var Qe=rc(qc(Ke,Ge.filters,[1,1],$e),Ge.bias);return Ye?Bl(Qe):Qe})}function disposeUnusedWeightTensors(Ke,Ge){Object.keys(Ke).forEach(function($e){Ge.some(function(Ye){return Ye.originalPath===$e})||Ke[$e].dispose()})}function extractConvParamsFactory(Ke,Ge){return function($e,Ye,Qe,Je){var Mt=Ln(Ke($e*Ye*Qe*Qe),[Qe,Qe,$e,Ye]),nn=Mn(Ke(Ye));return Ge.push({paramPath:Je+"/filters"},{paramPath:Je+"/bias"}),{filters:Mt,bias:nn}}}function extractFCParamsFactory(Ke,Ge){return function($e,Ye,Qe){var Je=Bn(Ke($e*Ye),[$e,Ye]),Mt=Mn(Ke(Ye));return Ge.push({paramPath:Qe+"/weights"},{paramPath:Qe+"/bias"}),{weights:Je,bias:Mt}}}var SeparableConvParams=function(){function Ke(Ge,$e,Ye){this.depthwise_filter=Ge,this.pointwise_filter=$e,this.bias=Ye}return Ke}();function extractSeparableConvParamsFactory(Ke,Ge){return function($e,Ye,Qe){var Je=Ln(Ke(9*$e),[3,3,$e,1]),Mt=Ln(Ke($e*Ye),[1,1,$e,Ye]),nn=Mn(Ke(Ye));return Ge.push({paramPath:Qe+"/depthwise_filter"},{paramPath:Qe+"/pointwise_filter"},{paramPath:Qe+"/bias"}),new SeparableConvParams(Je,Mt,nn)}}function loadSeparableConvParamsFactory(Ke){return function(Ge){var $e=Ke(Ge+"/depthwise_filter",4),Ye=Ke(Ge+"/pointwise_filter",4),Qe=Ke(Ge+"/bias",1);return new SeparableConvParams($e,Ye,Qe)}}function extractWeightEntryFactory(Ke,Ge){return function($e,Ye,Qe){var Je=Ke[$e];if(!isTensor(Je,Ye))throw new Error("expected weightMap["+$e+"] to be a Tensor"+Ye+"D, instead have "+Je);return Ge.push({originalPath:$e,paramPath:Qe||$e}),Je}}function extractWeightsFactory(Ke){var Ge=Ke;function $e(Qe){var Je=Ge.slice(0,Qe);return Ge=Ge.slice(Qe),Je}function Ye(){return Ge}return{extractWeights:$e,getRemainingWeights:Ye}}function extractorsFactory$9(Ke,Ge){var $e=extractConvParamsFactory(Ke,Ge),Ye=extractSeparableConvParamsFactory(Ke,Ge);function Qe(Mt,nn,an,sn){sn===void 0&&(sn=!1);var ln=sn?$e(Mt,nn,3,an+"/conv0"):Ye(Mt,nn,an+"/conv0"),fn=Ye(nn,nn,an+"/conv1"),hn=Ye(nn,nn,an+"/conv2");return{conv0:ln,conv1:fn,conv2:hn}}function Je(Mt,nn,an,sn){sn===void 0&&(sn=!1);var ln=Qe(Mt,nn,an,sn),fn=ln.conv0,hn=ln.conv1,Xr=ln.conv2,Mi=Ye(nn,nn,an+"/conv3");return{conv0:fn,conv1:hn,conv2:Xr,conv3:Mi}}return{extractDenseBlock3Params:Qe,extractDenseBlock4Params:Je}}function extractParams$7(Ke){var Ge=[],$e=extractWeightsFactory(Ke),Ye=$e.extractWeights,Qe=$e.getRemainingWeights,Je=extractorsFactory$9(Ye,Ge).extractDenseBlock4Params,Mt=Je(3,32,"dense0",!0),nn=Je(32,64,"dense1"),an=Je(64,128,"dense2"),sn=Je(128,256,"dense3");if(Qe().length!==0)throw new Error("weights remaing after extract: "+Qe().length);return{paramMappings:Ge,params:{dense0:Mt,dense1:nn,dense2:an,dense3:sn}}}function loadConvParamsFactory(Ke){return function(Ge){var $e=Ke(Ge+"/filters",4),Ye=Ke(Ge+"/bias",1);return{filters:$e,bias:Ye}}}function loadParamsFactory$1(Ke,Ge){var $e=extractWeightEntryFactory(Ke,Ge),Ye=loadConvParamsFactory($e),Qe=loadSeparableConvParamsFactory($e);function Je(nn,an){an===void 0&&(an=!1);var sn=an?Ye(nn+"/conv0"):Qe(nn+"/conv0"),ln=Qe(nn+"/conv1"),fn=Qe(nn+"/conv2");return{conv0:sn,conv1:ln,conv2:fn}}function Mt(nn,an){an===void 0&&(an=!1);var sn=an?Ye(nn+"/conv0"):Qe(nn+"/conv0"),ln=Qe(nn+"/conv1"),fn=Qe(nn+"/conv2"),hn=Qe(nn+"/conv3");return{conv0:sn,conv1:ln,conv2:fn,conv3:hn}}return{extractDenseBlock3Params:Je,extractDenseBlock4Params:Mt}}function extractParamsFromWeigthMap$7(Ke){var Ge=[],$e=loadParamsFactory$1(Ke,Ge).extractDenseBlock4Params,Ye={dense0:$e("dense0",!0),dense1:$e("dense1"),dense2:$e("dense2"),dense3:$e("dense3")};return disposeUnusedWeightTensors(Ke,Ge),{params:Ye,paramMappings:Ge}}var FaceFeatureExtractor=function(Ke){__extends(Ge,Ke);function Ge(){return Ke.call(this,"FaceFeatureExtractor")||this}return Ge.prototype.forwardInput=function($e){var Ye=this.params;if(!Ye)throw new Error("FaceFeatureExtractor - load model before inference");return Ze(function(){var Qe=$e.toBatchTensor(112,!0),Je=[122.782,117.001,104.298],Mt=normalize$1(Qe,Je).div(On(255)),nn=denseBlock4(Mt,Ye.dense0,!0);return nn=denseBlock4(nn,Ye.dense1),nn=denseBlock4(nn,Ye.dense2),nn=denseBlock4(nn,Ye.dense3),nn=fl(nn,[7,7],[2,2],"valid"),nn})},Ge.prototype.forward=function($e){return __awaiter(this,void 0,void 0,function(){var Ye;return __generator(this,function(Qe){switch(Qe.label){case 0:return Ye=this.forwardInput,[4,toNetInput($e)];case 1:return[2,Ye.apply(this,[Qe.sent()])]}})})},Ge.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},Ge.prototype.extractParamsFromWeigthMap=function($e){return extractParamsFromWeigthMap$7($e)},Ge.prototype.extractParams=function($e){return extractParams$7($e)},Ge}(NeuralNetwork);function fullyConnectedLayer(Ke,Ge){return Ze(function(){return rc(el(Ke,Ge.weights),Ge.bias)})}function extractParams$6(Ke,Ge,$e){var Ye=[],Qe=extractWeightsFactory(Ke),Je=Qe.extractWeights,Mt=Qe.getRemainingWeights,nn=extractFCParamsFactory(Je,Ye),an=nn(Ge,$e,"fc");if(Mt().length!==0)throw new Error("weights remaing after extract: "+Mt().length);return{paramMappings:Ye,params:{fc:an}}}function extractParamsFromWeigthMap$6(Ke){var Ge=[],$e=extractWeightEntryFactory(Ke,Ge);function Ye(Je){var Mt=$e(Je+"/weights",2),nn=$e(Je+"/bias",1);return{weights:Mt,bias:nn}}var Qe={fc:Ye("fc")};return disposeUnusedWeightTensors(Ke,Ge),{params:Qe,paramMappings:Ge}}function seperateWeightMaps(Ke){var Ge={},$e={};return Object.keys(Ke).forEach(function(Ye){var Qe=Ye.startsWith("fc")?$e:Ge;Qe[Ye]=Ke[Ye]}),{featureExtractorMap:Ge,classifierMap:$e}}var FaceProcessor=function(Ke){__extends(Ge,Ke);function Ge($e,Ye){var Qe=Ke.call(this,$e)||this;return Qe._faceFeatureExtractor=Ye,Qe}return Object.defineProperty(Ge.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),Ge.prototype.runNet=function($e){var Ye=this,Qe=this.params;if(!Qe)throw new Error(this._name+" - load model before inference");return Ze(function(){var Je=$e instanceof NetInput?Ye.faceFeatureExtractor.forwardInput($e):$e;return fullyConnectedLayer(Je.as2D(Je.shape[0],-1),Qe.fc)})},Ge.prototype.dispose=function($e){$e===void 0&&($e=!0),this.faceFeatureExtractor.dispose($e),Ke.prototype.dispose.call(this,$e)},Ge.prototype.loadClassifierParams=function($e){var Ye=this.extractClassifierParams($e),Qe=Ye.params,Je=Ye.paramMappings;this._params=Qe,this._paramMappings=Je},Ge.prototype.extractClassifierParams=function($e){return extractParams$6($e,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},Ge.prototype.extractParamsFromWeigthMap=function($e){var Ye=seperateWeightMaps($e),Qe=Ye.featureExtractorMap,Je=Ye.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(Qe),extractParamsFromWeigthMap$6(Je)},Ge.prototype.extractParams=function($e){var Ye=this.getClassifierChannelsIn(),Qe=this.getClassifierChannelsOut(),Je=Qe*Ye+Qe,Mt=$e.slice(0,$e.length-Je),nn=$e.slice($e.length-Je);return this.faceFeatureExtractor.extractWeights(Mt),this.extractClassifierParams(nn)},Ge}(NeuralNetwork),FACE_EXPRESSION_LABELS=["neutral","happy","sad","angry","fearful","disgusted","surprised"],FaceExpressions=function(){function Ke(Ge){var $e=this;if(Ge.length!==7)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+Ge.length);FACE_EXPRESSION_LABELS.forEach(function(Ye,Qe){$e[Ye]=Ge[Qe]})}return Ke.prototype.asSortedArray=function(){var Ge=this;return FACE_EXPRESSION_LABELS.map(function($e){return{expression:$e,probability:Ge[$e]}}).sort(function($e,Ye){return Ye.probability-$e.probability})},Ke}(),FaceExpressionNet=function(Ke){__extends(Ge,Ke);function Ge($e){return $e===void 0&&($e=new FaceFeatureExtractor),Ke.call(this,"FaceExpressionNet",$e)||this}return Ge.prototype.forwardInput=function($e){var Ye=this;return Ze(function(){return go(Ye.runNet($e))})},Ge.prototype.forward=function($e){return __awaiter(this,void 0,void 0,function(){var Ye;return __generator(this,function(Qe){switch(Qe.label){case 0:return Ye=this.forwardInput,[4,toNetInput($e)];case 1:return[2,Ye.apply(this,[Qe.sent()])]}})})},Ge.prototype.predictExpressions=function($e){return __awaiter(this,void 0,void 0,function(){var Ye,Qe,Je,Mt,nn=this;return __generator(this,function(an){switch(an.label){case 0:return[4,toNetInput($e)];case 1:return Ye=an.sent(),[4,this.forwardInput(Ye)];case 2:return Qe=an.sent(),[4,Promise.all(Ur(Qe).map(function(sn){return __awaiter(nn,void 0,void 0,function(){var ln;return __generator(this,function(fn){switch(fn.label){case 0:return[4,sn.data()];case 1:return ln=fn.sent(),sn.dispose(),[2,ln]}})})}))];case 3:return Je=an.sent(),Qe.dispose(),Mt=Je.map(function(sn){return new FaceExpressions(sn)}),[2,Ye.isBatchInput?Mt:Mt[0]]}})})},Ge.prototype.getDefaultModelName=function(){return"face_expression_model"},Ge.prototype.getClassifierChannelsIn=function(){return 256},Ge.prototype.getClassifierChannelsOut=function(){return 7},Ge}(FaceProcessor);function extendWithFaceExpressions(Ke,Ge){var $e={expressions:Ge};return Object.assign({},Ke,$e)}function isWithFaceLandmarks(Ke){return isWithFaceDetection(Ke)&&Ke.landmarks instanceof FaceLandmarks&&Ke.unshiftedLandmarks instanceof FaceLandmarks&&Ke.alignedRect instanceof FaceDetection}function extendWithFaceLandmarks(Ke,Ge){var $e=Ke.detection.box,Ye=Ge.shiftBy($e.x,$e.y),Qe=Ye.align(),Je=Ke.detection.imageDims,Mt=new FaceDetection(Ke.detection.score,Qe.rescale(Je.reverse()),Je),nn={landmarks:Ye,unshiftedLandmarks:Ge,alignedRect:Mt};return Object.assign({},Ke,nn)}function extractorsFactory$8(Ke,Ge){var $e=extractConvParamsFactory(Ke,Ge),Ye=extractSeparableConvParamsFactory(Ke,Ge);function Qe(Mt,nn,an){var sn=Ye(Mt,nn,an+"/separable_conv0"),ln=Ye(nn,nn,an+"/separable_conv1"),fn=$e(Mt,nn,1,an+"/expansion_conv");return{separable_conv0:sn,separable_conv1:ln,expansion_conv:fn}}function Je(Mt,nn){var an=Ye(Mt,Mt,nn+"/separable_conv0"),sn=Ye(Mt,Mt,nn+"/separable_conv1"),ln=Ye(Mt,Mt,nn+"/separable_conv2");return{separable_conv0:an,separable_conv1:sn,separable_conv2:ln}}return{extractConvParams:$e,extractSeparableConvParams:Ye,extractReductionBlockParams:Qe,extractMainBlockParams:Je}}function extractParams$5(Ke,Ge){var $e=[],Ye=extractWeightsFactory(Ke),Qe=Ye.extractWeights,Je=Ye.getRemainingWeights,Mt=extractorsFactory$8(Qe,$e),nn=Mt.extractConvParams,an=Mt.extractSeparableConvParams,sn=Mt.extractReductionBlockParams,ln=Mt.extractMainBlockParams,fn=nn(3,32,3,"entry_flow/conv_in"),hn=sn(32,64,"entry_flow/reduction_block_0"),Xr=sn(64,128,"entry_flow/reduction_block_1"),Mi={conv_in:fn,reduction_block_0:hn,reduction_block_1:Xr},co={};range(Ge,0,1).forEach(function(mo){co["main_block_"+mo]=ln(128,"middle_flow/main_block_"+mo)});var lo=sn(128,256,"exit_flow/reduction_block"),uo=an(256,512,"exit_flow/separable_conv"),ho={reduction_block:lo,separable_conv:uo};if(Je().length!==0)throw new Error("weights remaing after extract: "+Je().length);return{paramMappings:$e,params:{entry_flow:Mi,middle_flow:co,exit_flow:ho}}}function loadParamsFactory(Ke,Ge){var $e=extractWeightEntryFactory(Ke,Ge),Ye=loadConvParamsFactory($e),Qe=loadSeparableConvParamsFactory($e);function Je(nn){var an=Qe(nn+"/separable_conv0"),sn=Qe(nn+"/separable_conv1"),ln=Ye(nn+"/expansion_conv");return{separable_conv0:an,separable_conv1:sn,expansion_conv:ln}}function Mt(nn){var an=Qe(nn+"/separable_conv0"),sn=Qe(nn+"/separable_conv1"),ln=Qe(nn+"/separable_conv2");return{separable_conv0:an,separable_conv1:sn,separable_conv2:ln}}return{extractConvParams:Ye,extractSeparableConvParams:Qe,extractReductionBlockParams:Je,extractMainBlockParams:Mt}}function extractParamsFromWeigthMap$5(Ke,Ge){var $e=[],Ye=loadParamsFactory(Ke,$e),Qe=Ye.extractConvParams,Je=Ye.extractSeparableConvParams,Mt=Ye.extractReductionBlockParams,nn=Ye.extractMainBlockParams,an=Qe("entry_flow/conv_in"),sn=Mt("entry_flow/reduction_block_0"),ln=Mt("entry_flow/reduction_block_1"),fn={conv_in:an,reduction_block_0:sn,reduction_block_1:ln},hn={};range(Ge,0,1).forEach(function(lo){hn["main_block_"+lo]=nn("middle_flow/main_block_"+lo)});var Xr=Mt("exit_flow/reduction_block"),Mi=Je("exit_flow/separable_conv"),co={reduction_block:Xr,separable_conv:Mi};return disposeUnusedWeightTensors(Ke,$e),{params:{entry_flow:fn,middle_flow:hn,exit_flow:co},paramMappings:$e}}function conv$1(Ke,Ge,$e){return rc(qc(Ke,Ge.filters,$e,"same"),Ge.bias)}function reductionBlock(Ke,Ge,$e){$e===void 0&&($e=!0);var Ye=$e?Bl(Ke):Ke;return Ye=depthwiseSeparableConv$1(Ye,Ge.separable_conv0,[1,1]),Ye=depthwiseSeparableConv$1(Bl(Ye),Ge.separable_conv1,[1,1]),Ye=hl(Ye,[3,3],[2,2],"same"),Ye=rc(Ye,conv$1(Ke,Ge.expansion_conv,[2,2])),Ye}function mainBlock(Ke,Ge){var $e=depthwiseSeparableConv$1(Bl(Ke),Ge.separable_conv0,[1,1]);return $e=depthwiseSeparableConv$1(Bl($e),Ge.separable_conv1,[1,1]),$e=depthwiseSeparableConv$1(Bl($e),Ge.separable_conv2,[1,1]),$e=rc($e,Ke),$e}var TinyXception=function(Ke){__extends(Ge,Ke);function Ge($e){var Ye=Ke.call(this,"TinyXception")||this;return Ye._numMainBlocks=$e,Ye}return Ge.prototype.forwardInput=function($e){var Ye=this,Qe=this.params;if(!Qe)throw new Error("TinyXception - load model before inference");return Ze(function(){var Je=$e.toBatchTensor(112,!0),Mt=[122.782,117.001,104.298],nn=normalize$1(Je,Mt).div(On(256)),an=Bl(conv$1(nn,Qe.entry_flow.conv_in,[2,2]));return an=reductionBlock(an,Qe.entry_flow.reduction_block_0,!1),an=reductionBlock(an,Qe.entry_flow.reduction_block_1),range(Ye._numMainBlocks,0,1).forEach(function(sn){an=mainBlock(an,Qe.middle_flow["main_block_"+sn])}),an=reductionBlock(an,Qe.exit_flow.reduction_block),an=Bl(depthwiseSeparableConv$1(an,Qe.exit_flow.separable_conv,[1,1])),an})},Ge.prototype.forward=function($e){return __awaiter(this,void 0,void 0,function(){var Ye;return __generator(this,function(Qe){switch(Qe.label){case 0:return Ye=this.forwardInput,[4,toNetInput($e)];case 1:return[2,Ye.apply(this,[Qe.sent()])]}})})},Ge.prototype.getDefaultModelName=function(){return"tiny_xception_model"},Ge.prototype.extractParamsFromWeigthMap=function($e){return extractParamsFromWeigthMap$5($e,this._numMainBlocks)},Ge.prototype.extractParams=function($e){return extractParams$5($e,this._numMainBlocks)},Ge}(NeuralNetwork);function extractParams$4(Ke){var Ge=[],$e=extractWeightsFactory(Ke),Ye=$e.extractWeights,Qe=$e.getRemainingWeights,Je=extractFCParamsFactory(Ye,Ge),Mt=Je(512,1,"fc/age"),nn=Je(512,2,"fc/gender");if(Qe().length!==0)throw new Error("weights remaing after extract: "+Qe().length);return{paramMappings:Ge,params:{fc:{age:Mt,gender:nn}}}}function extractParamsFromWeigthMap$4(Ke){var Ge=[],$e=extractWeightEntryFactory(Ke,Ge);function Ye(Je){var Mt=$e(Je+"/weights",2),nn=$e(Je+"/bias",1);return{weights:Mt,bias:nn}}var Qe={fc:{age:Ye("fc/age"),gender:Ye("fc/gender")}};return disposeUnusedWeightTensors(Ke,Ge),{params:Qe,paramMappings:Ge}}var Gender;(function(Ke){Ke.FEMALE="female",Ke.MALE="male"})(Gender||(Gender={}));var AgeGenderNet=function(Ke){__extends(Ge,Ke);function Ge($e){$e===void 0&&($e=new TinyXception(2));var Ye=Ke.call(this,"AgeGenderNet")||this;return Ye._faceFeatureExtractor=$e,Ye}return Object.defineProperty(Ge.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),Ge.prototype.runNet=function($e){var Ye=this,Qe=this.params;if(!Qe)throw new Error(this._name+" - load model before inference");return Ze(function(){var Je=$e instanceof NetInput?Ye.faceFeatureExtractor.forwardInput($e):$e,Mt=fl(Je,[7,7],[2,2],"valid").as2D(Je.shape[0],-1),nn=fullyConnectedLayer(Mt,Qe.fc.age).as1D(),an=fullyConnectedLayer(Mt,Qe.fc.gender);return{age:nn,gender:an}})},Ge.prototype.forwardInput=function($e){var Ye=this;return Ze(function(){var Qe=Ye.runNet($e),Je=Qe.age,Mt=Qe.gender;return{age:Je,gender:go(Mt)}})},Ge.prototype.forward=function($e){return __awaiter(this,void 0,void 0,function(){var Ye;return __generator(this,function(Qe){switch(Qe.label){case 0:return Ye=this.forwardInput,[4,toNetInput($e)];case 1:return[2,Ye.apply(this,[Qe.sent()])]}})})},Ge.prototype.predictAgeAndGender=function($e){return __awaiter(this,void 0,void 0,function(){var Ye,Qe,Je,Mt,nn,an,sn=this;return __generator(this,function(ln){switch(ln.label){case 0:return[4,toNetInput($e)];case 1:return Ye=ln.sent(),[4,this.forwardInput(Ye)];case 2:return Qe=ln.sent(),Je=Ur(Qe.age),Mt=Ur(Qe.gender),nn=Je.map(function(fn,hn){return{ageTensor:fn,genderTensor:Mt[hn]}}),[4,Promise.all(nn.map(function(fn){var hn=fn.ageTensor,Xr=fn.genderTensor;return __awaiter(sn,void 0,void 0,function(){var Mi,co,lo,uo,ho;return __generator(this,function(mo){switch(mo.label){case 0:return[4,hn.data()];case 1:return Mi=mo.sent()[0],[4,Xr.data()];case 2:return co=mo.sent()[0],lo=co>.5,uo=lo?Gender.MALE:Gender.FEMALE,ho=lo?co:1-co,hn.dispose(),Xr.dispose(),[2,{age:Mi,gender:uo,genderProbability:ho}]}})})}))];case 3:return an=ln.sent(),Qe.age.dispose(),Qe.gender.dispose(),[2,Ye.isBatchInput?an:an[0]]}})})},Ge.prototype.getDefaultModelName=function(){return"age_gender_model"},Ge.prototype.dispose=function($e){$e===void 0&&($e=!0),this.faceFeatureExtractor.dispose($e),Ke.prototype.dispose.call(this,$e)},Ge.prototype.loadClassifierParams=function($e){var Ye=this.extractClassifierParams($e),Qe=Ye.params,Je=Ye.paramMappings;this._params=Qe,this._paramMappings=Je},Ge.prototype.extractClassifierParams=function($e){return extractParams$4($e)},Ge.prototype.extractParamsFromWeigthMap=function($e){var Ye=seperateWeightMaps($e),Qe=Ye.featureExtractorMap,Je=Ye.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(Qe),extractParamsFromWeigthMap$4(Je)},Ge.prototype.extractParams=function($e){var Ye=1539,Qe=$e.slice(0,$e.length-Ye),Je=$e.slice($e.length-Ye);return this.faceFeatureExtractor.extractWeights(Qe),this.extractClassifierParams(Je)},Ge}(NeuralNetwork),FaceLandmark68NetBase=function(Ke){__extends(Ge,Ke);function Ge(){return Ke!==null&&Ke.apply(this,arguments)||this}return Ge.prototype.postProcess=function($e,Ye,Qe){var Je=Qe.map(function(nn){var an=nn.width,sn=nn.height,ln=Ye/Math.max(sn,an);return{width:an*ln,height:sn*ln}}),Mt=Je.length;return Ze(function(){var nn=function(hn,Xr){return Pr([Hn([68],hn),Hn([68],Xr)],1).as2D(1,136).as1D()},an=function(hn,Xr){var Mi=Je[hn],co=Mi.width,lo=Mi.height;return Xr(co,lo)?Math.abs(co-lo)/2:0},sn=function(hn){return an(hn,function(Xr,Mi){return Xr<Mi})},ln=function(hn){return an(hn,function(Xr,Mi){return Mi<Xr})},fn=$e.mul(Hn([Mt,136],Ye)).sub(Pr(Array.from(Array(Mt),function(hn,Xr){return nn(sn(Xr),ln(Xr))}))).div(Pr(Array.from(Array(Mt),function(hn,Xr){return nn(Je[Xr].width,Je[Xr].height)})));return fn})},Ge.prototype.forwardInput=function($e){var Ye=this;return Ze(function(){var Qe=Ye.runNet($e);return Ye.postProcess(Qe,$e.inputSize,$e.inputDimensions.map(function(Je){var Mt=Je[0],nn=Je[1];return{height:Mt,width:nn}}))})},Ge.prototype.forward=function($e){return __awaiter(this,void 0,void 0,function(){var Ye;return __generator(this,function(Qe){switch(Qe.label){case 0:return Ye=this.forwardInput,[4,toNetInput($e)];case 1:return[2,Ye.apply(this,[Qe.sent()])]}})})},Ge.prototype.detectLandmarks=function($e){return __awaiter(this,void 0,void 0,function(){var Ye,Qe,Je,Mt=this;return __generator(this,function(nn){switch(nn.label){case 0:return[4,toNetInput($e)];case 1:return Ye=nn.sent(),Qe=Ze(function(){return Ur(Mt.forwardInput(Ye))}),[4,Promise.all(Qe.map(function(an,sn){return __awaiter(Mt,void 0,void 0,function(){var ln,fn,hn,Xr,Mi;return __generator(this,function(co){switch(co.label){case 0:return hn=(fn=Array).from,[4,an.data()];case 1:return ln=hn.apply(fn,[co.sent()]),Xr=ln.filter(function(lo,uo){return isEven(uo)}),Mi=ln.filter(function(lo,uo){return!isEven(uo)}),[2,new FaceLandmarks68(Array(68).fill(0).map(function(lo,uo){return new Point(Xr[uo],Mi[uo])}),{height:Ye.getInputHeight(sn),width:Ye.getInputWidth(sn)})]}})})}))];case 2:return Je=nn.sent(),Qe.forEach(function(an){return an.dispose()}),[2,Ye.isBatchInput?Je:Je[0]]}})})},Ge.prototype.getClassifierChannelsOut=function(){return 136},Ge}(FaceProcessor),FaceLandmark68Net=function(Ke){__extends(Ge,Ke);function Ge($e){return $e===void 0&&($e=new FaceFeatureExtractor),Ke.call(this,"FaceLandmark68Net",$e)||this}return Ge.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},Ge.prototype.getClassifierChannelsIn=function(){return 256},Ge}(FaceLandmark68NetBase);function extractParamsFromWeigthMapTiny(Ke){var Ge=[],$e=loadParamsFactory$1(Ke,Ge).extractDenseBlock3Params,Ye={dense0:$e("dense0",!0),dense1:$e("dense1"),dense2:$e("dense2")};return disposeUnusedWeightTensors(Ke,Ge),{params:Ye,paramMappings:Ge}}function extractParamsTiny(Ke){var Ge=[],$e=extractWeightsFactory(Ke),Ye=$e.extractWeights,Qe=$e.getRemainingWeights,Je=extractorsFactory$9(Ye,Ge).extractDenseBlock3Params,Mt=Je(3,32,"dense0",!0),nn=Je(32,64,"dense1"),an=Je(64,128,"dense2");if(Qe().length!==0)throw new Error("weights remaing after extract: "+Qe().length);return{paramMappings:Ge,params:{dense0:Mt,dense1:nn,dense2:an}}}var TinyFaceFeatureExtractor=function(Ke){__extends(Ge,Ke);function Ge(){return Ke.call(this,"TinyFaceFeatureExtractor")||this}return Ge.prototype.forwardInput=function($e){var Ye=this.params;if(!Ye)throw new Error("TinyFaceFeatureExtractor - load model before inference");return Ze(function(){var Qe=$e.toBatchTensor(112,!0),Je=[122.782,117.001,104.298],Mt=normalize$1(Qe,Je).div(On(255)),nn=denseBlock3(Mt,Ye.dense0,!0);return nn=denseBlock3(nn,Ye.dense1),nn=denseBlock3(nn,Ye.dense2),nn=fl(nn,[14,14],[2,2],"valid"),nn})},Ge.prototype.forward=function($e){return __awaiter(this,void 0,void 0,function(){var Ye;return __generator(this,function(Qe){switch(Qe.label){case 0:return Ye=this.forwardInput,[4,toNetInput($e)];case 1:return[2,Ye.apply(this,[Qe.sent()])]}})})},Ge.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},Ge.prototype.extractParamsFromWeigthMap=function($e){return extractParamsFromWeigthMapTiny($e)},Ge.prototype.extractParams=function($e){return extractParamsTiny($e)},Ge}(NeuralNetwork),FaceLandmark68TinyNet=function(Ke){__extends(Ge,Ke);function Ge($e){return $e===void 0&&($e=new TinyFaceFeatureExtractor),Ke.call(this,"FaceLandmark68TinyNet",$e)||this}return Ge.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},Ge.prototype.getClassifierChannelsIn=function(){return 128},Ge}(FaceLandmark68NetBase);(function(Ke){__extends(Ge,Ke);function Ge(){return Ke!==null&&Ke.apply(this,arguments)||this}return Ge})(FaceLandmark68Net);function scale(Ke,Ge){return rc(gc(Ke,Ge.weights),Ge.biases)}function convLayer(Ke,Ge,$e,Ye,Qe){Qe===void 0&&(Qe="same");var Je=Ge.conv,Mt=Je.filters,nn=Je.bias,an=qc(Ke,Mt,$e,Qe);return an=rc(an,nn),an=scale(an,Ge.scale),Ye?Bl(an):an}function conv(Ke,Ge){return convLayer(Ke,Ge,[1,1],!0)}function convNoRelu(Ke,Ge){return convLayer(Ke,Ge,[1,1],!1)}function convDown(Ke,Ge){return convLayer(Ke,Ge,[2,2],!0,"valid")}function extractorsFactory$7(Ke,Ge){function $e(nn,an,sn){var ln=Ke(nn),fn=ln.length/(an*sn*sn);if(isFloat(fn))throw new Error("depth has to be an integer: "+fn+", weights.length: "+ln.length+", numFilters: "+an+", filterSize: "+sn);return Ze(function(){return Wl(Ln(ln,[an,fn,sn,sn]),[2,3,1,0])})}function Ye(nn,an,sn,ln){var fn=$e(nn,an,sn),hn=Mn(Ke(an));return Ge.push({paramPath:ln+"/filters"},{paramPath:ln+"/bias"}),{filters:fn,bias:hn}}function Qe(nn,an){var sn=Mn(Ke(nn)),ln=Mn(Ke(nn));return Ge.push({paramPath:an+"/weights"},{paramPath:an+"/biases"}),{weights:sn,biases:ln}}function Je(nn,an,sn,ln){var fn=Ye(nn,an,sn,ln+"/conv"),hn=Qe(an,ln+"/scale");return{conv:fn,scale:hn}}function Mt(nn,an,sn,ln,fn){fn===void 0&&(fn=!1);var hn=Je((fn?.5:1)*nn,an,sn,ln+"/conv1"),Xr=Je(nn,an,sn,ln+"/conv2");return{conv1:hn,conv2:Xr}}return{extractConvLayerParams:Je,extractResidualLayerParams:Mt}}function extractParams$3(Ke){var Ge=extractWeightsFactory(Ke),$e=Ge.extractWeights,Ye=Ge.getRemainingWeights,Qe=[],Je=extractorsFactory$7($e,Qe),Mt=Je.extractConvLayerParams,nn=Je.extractResidualLayerParams,an=Mt(4704,32,7,"conv32_down"),sn=nn(9216,32,3,"conv32_1"),ln=nn(9216,32,3,"conv32_2"),fn=nn(9216,32,3,"conv32_3"),hn=nn(36864,64,3,"conv64_down",!0),Xr=nn(36864,64,3,"conv64_1"),Mi=nn(36864,64,3,"conv64_2"),co=nn(36864,64,3,"conv64_3"),lo=nn(147456,128,3,"conv128_down",!0),uo=nn(147456,128,3,"conv128_1"),ho=nn(147456,128,3,"conv128_2"),mo=nn(589824,256,3,"conv256_down",!0),_d=nn(589824,256,3,"conv256_1"),ep=nn(589824,256,3,"conv256_2"),rp=nn(589824,256,3,"conv256_down_out"),sp=Ze(function(){return Wl(Bn($e(256*128),[128,256]),[1,0])});if(Qe.push({paramPath:"fc"}),Ye().length!==0)throw new Error("weights remaing after extract: "+Ye().length);var op={conv32_down:an,conv32_1:sn,conv32_2:ln,conv32_3:fn,conv64_down:hn,conv64_1:Xr,conv64_2:Mi,conv64_3:co,conv128_down:lo,conv128_1:uo,conv128_2:ho,conv256_down:mo,conv256_1:_d,conv256_2:ep,conv256_down_out:rp,fc:sp};return{params:op,paramMappings:Qe}}function extractorsFactory$6(Ke,Ge){var $e=extractWeightEntryFactory(Ke,Ge);function Ye(Mt){var nn=$e(Mt+"/scale/weights",1),an=$e(Mt+"/scale/biases",1);return{weights:nn,biases:an}}function Qe(Mt){var nn=$e(Mt+"/conv/filters",4),an=$e(Mt+"/conv/bias",1),sn=Ye(Mt);return{conv:{filters:nn,bias:an},scale:sn}}function Je(Mt){return{conv1:Qe(Mt+"/conv1"),conv2:Qe(Mt+"/conv2")}}return{extractConvLayerParams:Qe,extractResidualLayerParams:Je}}function extractParamsFromWeigthMap$3(Ke){var Ge=[],$e=extractorsFactory$6(Ke,Ge),Ye=$e.extractConvLayerParams,Qe=$e.extractResidualLayerParams,Je=Ye("conv32_down"),Mt=Qe("conv32_1"),nn=Qe("conv32_2"),an=Qe("conv32_3"),sn=Qe("conv64_down"),ln=Qe("conv64_1"),fn=Qe("conv64_2"),hn=Qe("conv64_3"),Xr=Qe("conv128_down"),Mi=Qe("conv128_1"),co=Qe("conv128_2"),lo=Qe("conv256_down"),uo=Qe("conv256_1"),ho=Qe("conv256_2"),mo=Qe("conv256_down_out"),_d=Ke.fc;if(Ge.push({originalPath:"fc",paramPath:"fc"}),!isTensor2D(_d))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+_d);var ep={conv32_down:Je,conv32_1:Mt,conv32_2:nn,conv32_3:an,conv64_down:sn,conv64_1:ln,conv64_2:fn,conv64_3:hn,conv128_down:Xr,conv128_1:Mi,conv128_2:co,conv256_down:lo,conv256_1:uo,conv256_2:ho,conv256_down_out:mo,fc:_d};return disposeUnusedWeightTensors(Ke,Ge),{params:ep,paramMappings:Ge}}function residual(Ke,Ge){var $e=conv(Ke,Ge.conv1);return $e=convNoRelu($e,Ge.conv2),$e=rc($e,Ke),$e=Bl($e),$e}function residualDown(Ke,Ge){var $e=convDown(Ke,Ge.conv1);$e=convNoRelu($e,Ge.conv2);var Ye=fl(Ke,2,2,"valid"),Qe=Gn(Ye.shape),Je=Ye.shape[3]!==$e.shape[3],Mt=Ye.shape[1]!==$e.shape[1]||Ye.shape[2]!==$e.shape[2];if(Mt){var nn=__spreadArrays($e.shape);nn[1]=1;var an=Gn(nn);$e=Yn([$e,an],1);var sn=__spreadArrays($e.shape);sn[2]=1;var ln=Gn(sn);$e=Yn([$e,ln],2)}return Ye=Je?Yn([Ye,Qe],3):Ye,$e=rc(Ye,$e),$e=Bl($e),$e}var FaceRecognitionNet=function(Ke){__extends(Ge,Ke);function Ge(){return Ke.call(this,"FaceRecognitionNet")||this}return Ge.prototype.forwardInput=function($e){var Ye=this.params;if(!Ye)throw new Error("FaceRecognitionNet - load model before inference");return Ze(function(){var Qe=$e.toBatchTensor(150,!0).toFloat(),Je=[122.782,117.001,104.298],Mt=normalize$1(Qe,Je).div(On(256)),nn=convDown(Mt,Ye.conv32_down);nn=hl(nn,3,2,"valid"),nn=residual(nn,Ye.conv32_1),nn=residual(nn,Ye.conv32_2),nn=residual(nn,Ye.conv32_3),nn=residualDown(nn,Ye.conv64_down),nn=residual(nn,Ye.conv64_1),nn=residual(nn,Ye.conv64_2),nn=residual(nn,Ye.conv64_3),nn=residualDown(nn,Ye.conv128_down),nn=residual(nn,Ye.conv128_1),nn=residual(nn,Ye.conv128_2),nn=residualDown(nn,Ye.conv256_down),nn=residual(nn,Ye.conv256_1),nn=residual(nn,Ye.conv256_2),nn=residualDown(nn,Ye.conv256_down_out);var an=nn.mean([1,2]),sn=el(an,Ye.fc);return sn})},Ge.prototype.forward=function($e){return __awaiter(this,void 0,void 0,function(){var Ye;return __generator(this,function(Qe){switch(Qe.label){case 0:return Ye=this.forwardInput,[4,toNetInput($e)];case 1:return[2,Ye.apply(this,[Qe.sent()])]}})})},Ge.prototype.computeFaceDescriptor=function($e){return __awaiter(this,void 0,void 0,function(){var Ye,Qe,Je,Mt=this;return __generator(this,function(nn){switch(nn.label){case 0:return[4,toNetInput($e)];case 1:return Ye=nn.sent(),Qe=Ze(function(){return Ur(Mt.forwardInput(Ye))}),[4,Promise.all(Qe.map(function(an){return an.data()}))];case 2:return Je=nn.sent(),Qe.forEach(function(an){return an.dispose()}),[2,Ye.isBatchInput?Je:Je[0]]}})})},Ge.prototype.getDefaultModelName=function(){return"face_recognition_model"},Ge.prototype.extractParamsFromWeigthMap=function($e){return extractParamsFromWeigthMap$3($e)},Ge.prototype.extractParams=function($e){return extractParams$3($e)},Ge}(NeuralNetwork);function extendWithFaceDescriptor(Ke,Ge){var $e={descriptor:Ge};return Object.assign({},Ke,$e)}function extendWithAge(Ke,Ge){var $e={age:Ge};return Object.assign({},Ke,$e)}function extendWithGender(Ke,Ge,$e){var Ye={gender:Ge,genderProbability:$e};return Object.assign({},Ke,Ye)}var MtcnnOptions=function(){function Ke(Ge){var $e=Ge===void 0?{}:Ge,Ye=$e.minFaceSize,Qe=$e.scaleFactor,Je=$e.maxNumScales,Mt=$e.scoreThresholds,nn=$e.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=Ye||20,this._scaleFactor=Qe||.709,this._maxNumScales=Je||10,this._scoreThresholds=Mt||[.6,.7,.7],this._scaleSteps=nn,typeof this._minFaceSize!="number"||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if(typeof this._scaleFactor!="number"||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if(typeof this._maxNumScales!="number"||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||this._scoreThresholds.length!==3||this._scoreThresholds.some(function(an){return typeof an!="number"}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(an){return typeof an!="number"})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(Ke.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),Ke}();function extractorsFactory$5(Ke,Ge){function $e(an,sn){var ln=Ln(Ke(9*an),[3,3,an,1]),fn=Mn(Ke(an)),hn=Mn(Ke(an)),Xr=Mn(Ke(an)),Mi=Mn(Ke(an));return Ge.push({paramPath:sn+"/filters"},{paramPath:sn+"/batch_norm_scale"},{paramPath:sn+"/batch_norm_offset"},{paramPath:sn+"/batch_norm_mean"},{paramPath:sn+"/batch_norm_variance"}),{filters:ln,batch_norm_scale:fn,batch_norm_offset:hn,batch_norm_mean:Xr,batch_norm_variance:Mi}}function Ye(an,sn,ln,fn,hn){var Xr=Ln(Ke(an*sn*ln*ln),[ln,ln,an,sn]),Mi=Mn(Ke(sn));return Ge.push({paramPath:fn+"/filters"},{paramPath:fn+"/"+(hn?"batch_norm_offset":"bias")}),{filters:Xr,bias:Mi}}function Qe(an,sn,ln,fn){var hn=Ye(an,sn,ln,fn,!0),Xr=hn.filters,Mi=hn.bias;return{filters:Xr,batch_norm_offset:Mi}}function Je(an,sn,ln){var fn=$e(an,ln+"/depthwise_conv"),hn=Qe(an,sn,1,ln+"/pointwise_conv");return{depthwise_conv:fn,pointwise_conv:hn}}function Mt(){var an=Qe(3,32,3,"mobilenetv1/conv_0"),sn=Je(32,64,"mobilenetv1/conv_1"),ln=Je(64,128,"mobilenetv1/conv_2"),fn=Je(128,128,"mobilenetv1/conv_3"),hn=Je(128,256,"mobilenetv1/conv_4"),Xr=Je(256,256,"mobilenetv1/conv_5"),Mi=Je(256,512,"mobilenetv1/conv_6"),co=Je(512,512,"mobilenetv1/conv_7"),lo=Je(512,512,"mobilenetv1/conv_8"),uo=Je(512,512,"mobilenetv1/conv_9"),ho=Je(512,512,"mobilenetv1/conv_10"),mo=Je(512,512,"mobilenetv1/conv_11"),_d=Je(512,1024,"mobilenetv1/conv_12"),ep=Je(1024,1024,"mobilenetv1/conv_13");return{conv_0:an,conv_1:sn,conv_2:ln,conv_3:fn,conv_4:hn,conv_5:Xr,conv_6:Mi,conv_7:co,conv_8:lo,conv_9:uo,conv_10:ho,conv_11:mo,conv_12:_d,conv_13:ep}}function nn(){var an=Qe(1024,256,1,"prediction_layer/conv_0"),sn=Qe(256,512,3,"prediction_layer/conv_1"),ln=Qe(512,128,1,"prediction_layer/conv_2"),fn=Qe(128,256,3,"prediction_layer/conv_3"),hn=Qe(256,128,1,"prediction_layer/conv_4"),Xr=Qe(128,256,3,"prediction_layer/conv_5"),Mi=Qe(256,64,1,"prediction_layer/conv_6"),co=Qe(64,128,3,"prediction_layer/conv_7"),lo=Ye(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),uo=Ye(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),ho=Ye(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),mo=Ye(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),_d=Ye(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),ep=Ye(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),rp=Ye(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),sp=Ye(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),op=Ye(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),ip=Ye(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),lp=Ye(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),vp=Ye(128,18,1,"prediction_layer/box_predictor_5/class_predictor"),gp={box_encoding_predictor:lo,class_predictor:uo},Op={box_encoding_predictor:ho,class_predictor:mo},Mp={box_encoding_predictor:_d,class_predictor:ep},Np={box_encoding_predictor:rp,class_predictor:sp},wp={box_encoding_predictor:op,class_predictor:ip},Sp={box_encoding_predictor:lp,class_predictor:vp};return{conv_0:an,conv_1:sn,conv_2:ln,conv_3:fn,conv_4:hn,conv_5:Xr,conv_6:Mi,conv_7:co,box_predictor_0:gp,box_predictor_1:Op,box_predictor_2:Mp,box_predictor_3:Np,box_predictor_4:wp,box_predictor_5:Sp}}return{extractMobilenetV1Params:Mt,extractPredictionLayerParams:nn}}function extractParams$2(Ke){var Ge=[],$e=extractWeightsFactory(Ke),Ye=$e.extractWeights,Qe=$e.getRemainingWeights,Je=extractorsFactory$5(Ye,Ge),Mt=Je.extractMobilenetV1Params,nn=Je.extractPredictionLayerParams,an=Mt(),sn=nn(),ln=Pn(Ye(5118*4),[1,5118,4]),fn={extra_dim:ln};if(Ge.push({paramPath:"output_layer/extra_dim"}),Qe().length!==0)throw new Error("weights remaing after extract: "+Qe().length);return{params:{mobilenetv1:an,prediction_layer:sn,output_layer:fn},paramMappings:Ge}}function extractorsFactory$4(Ke,Ge){var $e=extractWeightEntryFactory(Ke,Ge);function Ye(sn,ln,fn){var hn=$e(sn+"/Conv2d_"+ln+"_pointwise/weights",4,fn+"/filters"),Xr=$e(sn+"/Conv2d_"+ln+"_pointwise/convolution_bn_offset",1,fn+"/batch_norm_offset");return{filters:hn,batch_norm_offset:Xr}}function Qe(sn){var ln="mobilenetv1/conv_"+sn,fn="MobilenetV1/Conv2d_"+sn+"_depthwise",hn=ln+"/depthwise_conv",Xr=ln+"/pointwise_conv",Mi=$e(fn+"/depthwise_weights",4,hn+"/filters"),co=$e(fn+"/BatchNorm/gamma",1,hn+"/batch_norm_scale"),lo=$e(fn+"/BatchNorm/beta",1,hn+"/batch_norm_offset"),uo=$e(fn+"/BatchNorm/moving_mean",1,hn+"/batch_norm_mean"),ho=$e(fn+"/BatchNorm/moving_variance",1,hn+"/batch_norm_variance");return{depthwise_conv:{filters:Mi,batch_norm_scale:co,batch_norm_offset:lo,batch_norm_mean:uo,batch_norm_variance:ho},pointwise_conv:Ye("MobilenetV1",sn,Xr)}}function Je(){return{conv_0:Ye("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:Qe(1),conv_2:Qe(2),conv_3:Qe(3),conv_4:Qe(4),conv_5:Qe(5),conv_6:Qe(6),conv_7:Qe(7),conv_8:Qe(8),conv_9:Qe(9),conv_10:Qe(10),conv_11:Qe(11),conv_12:Qe(12),conv_13:Qe(13)}}function Mt(sn,ln){var fn=$e(sn+"/weights",4,ln+"/filters"),hn=$e(sn+"/biases",1,ln+"/bias");return{filters:fn,bias:hn}}function nn(sn){var ln=Mt("Prediction/BoxPredictor_"+sn+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+sn+"/box_encoding_predictor"),fn=Mt("Prediction/BoxPredictor_"+sn+"/ClassPredictor","prediction_layer/box_predictor_"+sn+"/class_predictor");return{box_encoding_predictor:ln,class_predictor:fn}}function an(){return{conv_0:Ye("Prediction",0,"prediction_layer/conv_0"),conv_1:Ye("Prediction",1,"prediction_layer/conv_1"),conv_2:Ye("Prediction",2,"prediction_layer/conv_2"),conv_3:Ye("Prediction",3,"prediction_layer/conv_3"),conv_4:Ye("Prediction",4,"prediction_layer/conv_4"),conv_5:Ye("Prediction",5,"prediction_layer/conv_5"),conv_6:Ye("Prediction",6,"prediction_layer/conv_6"),conv_7:Ye("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:nn(0),box_predictor_1:nn(1),box_predictor_2:nn(2),box_predictor_3:nn(3),box_predictor_4:nn(4),box_predictor_5:nn(5)}}return{extractMobilenetV1Params:Je,extractPredictionLayerParams:an}}function extractParamsFromWeigthMap$2(Ke){var Ge=[],$e=extractorsFactory$4(Ke,Ge),Ye=$e.extractMobilenetV1Params,Qe=$e.extractPredictionLayerParams,Je=Ke["Output/extra_dim"];if(Ge.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!isTensor3D(Je))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+Je);var Mt={mobilenetv1:Ye(),prediction_layer:Qe(),output_layer:{extra_dim:Je}};return disposeUnusedWeightTensors(Ke,Ge),{params:Mt,paramMappings:Ge}}function pointwiseConvLayer(Ke,Ge,$e){return Ze(function(){var Ye=qc(Ke,Ge.filters,$e,"same");return Ye=rc(Ye,Ge.batch_norm_offset),hu(Ye,0,6)})}var epsilon=.0010000000474974513;function depthwiseConvLayer(Ke,Ge,$e){return Ze(function(){var Ye=Yc(Ke,Ge.filters,$e,"same");return Ye=ju(Ye,Ge.batch_norm_mean,Ge.batch_norm_variance,Ge.batch_norm_offset,Ge.batch_norm_scale,epsilon),hu(Ye,0,6)})}function getStridesForLayerIdx(Ke){return[2,4,6,12].some(function(Ge){return Ge===Ke})?[2,2]:[1,1]}function mobileNetV1(Ke,Ge){return Ze(function(){var $e=null,Ye=pointwiseConvLayer(Ke,Ge.conv_0,[2,2]),Qe=[Ge.conv_1,Ge.conv_2,Ge.conv_3,Ge.conv_4,Ge.conv_5,Ge.conv_6,Ge.conv_7,Ge.conv_8,Ge.conv_9,Ge.conv_10,Ge.conv_11,Ge.conv_12,Ge.conv_13];if(Qe.forEach(function(Je,Mt){var nn=Mt+1,an=getStridesForLayerIdx(nn);Ye=depthwiseConvLayer(Ye,Je.depthwise_conv,an),Ye=pointwiseConvLayer(Ye,Je.pointwise_conv,[1,1]),nn===11&&($e=Ye)}),$e===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:Ye,conv11:$e}})}function nonMaxSuppression(Ke,Ge,$e,Ye,Qe){var Je=Ke.shape[0],Mt=Math.min($e,Je),nn=Ge.map(function(ln,fn){return{score:ln,boxIndex:fn}}).filter(function(ln){return ln.score>Qe}).sort(function(ln,fn){return fn.score-ln.score}),an=function(ln){return ln<=Ye?1:0},sn=[];return nn.forEach(function(ln){if(!(sn.length>=Mt)){for(var fn=ln.score,hn=sn.length-1;hn>=0;--hn){var Xr=IOU(Ke,ln.boxIndex,sn[hn]);if(Xr!==0&&(ln.score*=an(Xr),ln.score<=Qe))break}fn===ln.score&&sn.push(ln.boxIndex)}}),sn}function IOU(Ke,Ge,$e){var Ye=Ke.arraySync(),Qe=Math.min(Ye[Ge][0],Ye[Ge][2]),Je=Math.min(Ye[Ge][1],Ye[Ge][3]),Mt=Math.max(Ye[Ge][0],Ye[Ge][2]),nn=Math.max(Ye[Ge][1],Ye[Ge][3]),an=Math.min(Ye[$e][0],Ye[$e][2]),sn=Math.min(Ye[$e][1],Ye[$e][3]),ln=Math.max(Ye[$e][0],Ye[$e][2]),fn=Math.max(Ye[$e][1],Ye[$e][3]),hn=(Mt-Qe)*(nn-Je),Xr=(ln-an)*(fn-sn);if(hn<=0||Xr<=0)return 0;var Mi=Math.max(Qe,an),co=Math.max(Je,sn),lo=Math.min(Mt,ln),uo=Math.min(nn,fn),ho=Math.max(lo-Mi,0)*Math.max(uo-co,0);return ho/(hn+Xr-ho)}function getCenterCoordinatesAndSizesLayer(Ke){var Ge=Ur(Wl(Ke,[1,0])),$e=[Cc(Ge[2],Ge[0]),Cc(Ge[3],Ge[1])],Ye=[rc(Ge[0],sc($e[0],On(2))),rc(Ge[1],sc($e[1],On(2)))];return{sizes:$e,centers:Ye}}function decodeBoxesLayer(Ke,Ge){var $e=getCenterCoordinatesAndSizesLayer(Ke),Ye=$e.sizes,Qe=$e.centers,Je=Ur(Wl(Ge,[1,0])),Mt=sc(gc(vu(sc(Je[2],On(5))),Ye[0]),On(2)),nn=rc(gc(sc(Je[0],On(10)),Ye[0]),Qe[0]),an=sc(gc(vu(sc(Je[3],On(5))),Ye[1]),On(2)),sn=rc(gc(sc(Je[1],On(10)),Ye[1]),Qe[1]);return Wl(Pr([Cc(nn,Mt),Cc(sn,an),rc(nn,Mt),rc(sn,an)]),[1,0])}function outputLayer(Ke,Ge,$e){return Ze(function(){var Ye=Ke.shape[0],Qe=decodeBoxesLayer(Or(Lr($e.extra_dim,[Ye,1,1]),[-1,4]),Or(Ke,[-1,4]));Qe=Or(Qe,[Ye,Qe.shape[0]/Ye,4]);var Je=Iu(ml(Ge,[0,0,1],[-1,-1,-1])),Mt=ml(Je,[0,0,0],[-1,-1,1]);Mt=Or(Mt,[Ye,Mt.shape[1]]);var nn=Ur(Qe),an=Ur(Mt);return{boxes:nn,scores:an}})}function boxPredictionLayer(Ke,Ge){return Ze(function(){var $e=Ke.shape[0],Ye=Or(convLayer$1(Ke,Ge.box_encoding_predictor),[$e,-1,1,4]),Qe=Or(convLayer$1(Ke,Ge.class_predictor),[$e,-1,3]);return{boxPredictionEncoding:Ye,classPrediction:Qe}})}function predictionLayer(Ke,Ge,$e){return Ze(function(){var Ye=pointwiseConvLayer(Ke,$e.conv_0,[1,1]),Qe=pointwiseConvLayer(Ye,$e.conv_1,[2,2]),Je=pointwiseConvLayer(Qe,$e.conv_2,[1,1]),Mt=pointwiseConvLayer(Je,$e.conv_3,[2,2]),nn=pointwiseConvLayer(Mt,$e.conv_4,[1,1]),an=pointwiseConvLayer(nn,$e.conv_5,[2,2]),sn=pointwiseConvLayer(an,$e.conv_6,[1,1]),ln=pointwiseConvLayer(sn,$e.conv_7,[2,2]),fn=boxPredictionLayer(Ge,$e.box_predictor_0),hn=boxPredictionLayer(Ke,$e.box_predictor_1),Xr=boxPredictionLayer(Qe,$e.box_predictor_2),Mi=boxPredictionLayer(Mt,$e.box_predictor_3),co=boxPredictionLayer(an,$e.box_predictor_4),lo=boxPredictionLayer(ln,$e.box_predictor_5),uo=Yn([fn.boxPredictionEncoding,hn.boxPredictionEncoding,Xr.boxPredictionEncoding,Mi.boxPredictionEncoding,co.boxPredictionEncoding,lo.boxPredictionEncoding],1),ho=Yn([fn.classPrediction,hn.classPrediction,Xr.classPrediction,Mi.classPrediction,co.classPrediction,lo.classPrediction],1);return{boxPredictions:uo,classPredictions:ho}})}var SsdMobilenetv1Options=function(){function Ke(Ge){var $e=Ge===void 0?{}:Ge,Ye=$e.minConfidence,Qe=$e.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=Ye||.5,this._maxResults=Qe||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if(typeof this._maxResults!="number")throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(Ke.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),Ke}(),SsdMobilenetv1=function(Ke){__extends(Ge,Ke);function Ge(){return Ke.call(this,"SsdMobilenetv1")||this}return Ge.prototype.forwardInput=function($e){var Ye=this.params;if(!Ye)throw new Error("SsdMobilenetv1 - load model before inference");return Ze(function(){var Qe=$e.toBatchTensor(512,!1).toFloat(),Je=Cc(gc(Qe,On(.007843137718737125)),On(1)),Mt=mobileNetV1(Je,Ye.mobilenetv1),nn=predictionLayer(Mt.out,Mt.conv11,Ye.prediction_layer),an=nn.boxPredictions,sn=nn.classPredictions;return outputLayer(an,sn,Ye.output_layer)})},Ge.prototype.forward=function($e){return __awaiter(this,void 0,void 0,function(){var Ye;return __generator(this,function(Qe){switch(Qe.label){case 0:return Ye=this.forwardInput,[4,toNetInput($e)];case 1:return[2,Ye.apply(this,[Qe.sent()])]}})})},Ge.prototype.locateFaces=function($e,Ye){return Ye===void 0&&(Ye={}),__awaiter(this,void 0,void 0,function(){var Qe,Je,Mt,nn,an,sn,ln,fn,hn,Xr,Mi,co,lo,uo,ho,mo,_d,ep,rp,sp,op;return __generator(this,function(ip){switch(ip.label){case 0:return Qe=new SsdMobilenetv1Options(Ye),Je=Qe.maxResults,Mt=Qe.minConfidence,[4,toNetInput($e)];case 1:for(nn=ip.sent(),an=this.forwardInput(nn),sn=an.boxes,ln=an.scores,fn=sn[0],hn=ln[0],Xr=1;Xr<sn.length;Xr++)sn[Xr].dispose(),ln[Xr].dispose();return lo=(co=Array).from,[4,hn.data()];case 2:return Mi=lo.apply(co,[ip.sent()]),uo=.5,ho=nonMaxSuppression(fn,Mi,Je,uo,Mt),mo=nn.getReshapedInputDimensions(0),_d=nn.inputSize,ep=_d/mo.width,rp=_d/mo.height,sp=fn.arraySync(),op=ho.map(function(lp){var vp=[Math.max(0,sp[lp][0]),Math.min(1,sp[lp][2])].map(function(Sp){return Sp*rp}),gp=vp[0],Op=vp[1],Mp=[Math.max(0,sp[lp][1]),Math.min(1,sp[lp][3])].map(function(Sp){return Sp*ep}),Np=Mp[0],wp=Mp[1];return new FaceDetection(Mi[lp],new Rect(Np,gp,wp-Np,Op-gp),{height:nn.getInputHeight(0),width:nn.getInputWidth(0)})}),fn.dispose(),hn.dispose(),[2,op]}})})},Ge.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},Ge.prototype.extractParamsFromWeigthMap=function($e){return extractParamsFromWeigthMap$2($e)},Ge.prototype.extractParams=function($e){return extractParams$2($e)},Ge}(NeuralNetwork);(function(Ke){__extends(Ge,Ke);function Ge(){return Ke!==null&&Ke.apply(this,arguments)||this}return Ge})(SsdMobilenetv1);var IOU_THRESHOLD$1=.4,BOX_ANCHORS$1=[new Point(.738768,.874946),new Point(2.42204,2.65704),new Point(4.30971,7.04493),new Point(10.246,4.59428),new Point(12.6868,11.8741)],BOX_ANCHORS_SEPARABLE=[new Point(1.603231,2.094468),new Point(6.041143,7.080126),new Point(2.882459,3.518061),new Point(4.266906,5.178857),new Point(9.041765,10.66308)],MEAN_RGB_SEPARABLE=[117.001,114.697,97.404],DEFAULT_MODEL_NAME="tiny_yolov2_model",DEFAULT_MODEL_NAME_SEPARABLE_CONV="tiny_yolov2_separable_conv_model",isNumber=function(Ke){return typeof Ke=="number"};function validateConfig(Ke){if(!Ke)throw new Error("invalid config: "+Ke);if(typeof Ke.withSeparableConvs!="boolean")throw new Error("config.withSeparableConvs has to be a boolean, have: "+Ke.withSeparableConvs);if(!isNumber(Ke.iouThreshold)||Ke.iouThreshold<0||Ke.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+Ke.iouThreshold);if(!Array.isArray(Ke.classes)||!Ke.classes.length||!Ke.classes.every(function(Ge){return typeof Ge=="string"}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(Ke.classes));if(!Array.isArray(Ke.anchors)||!Ke.anchors.length||!Ke.anchors.map(function(Ge){return Ge||{}}).every(function(Ge){return isNumber(Ge.x)&&isNumber(Ge.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(Ke.anchors));if(Ke.meanRgb&&(!Array.isArray(Ke.meanRgb)||Ke.meanRgb.length!==3||!Ke.meanRgb.every(isNumber)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(Ke.meanRgb))}function leaky(Ke){return Ze(function(){var Ge=gc(Ke,On(.10000000149011612));return rc(Bl(Cc(Ke,Ge)),Ge)})}function convWithBatchNorm(Ke,Ge){return Ze(function(){var $e=Ir(Ke,[[0,0],[1,1],[1,1],[0,0]]);return $e=qc($e,Ge.conv.filters,[1,1],"valid"),$e=Cc($e,Ge.bn.sub),$e=gc($e,Ge.bn.truediv),$e=rc($e,Ge.conv.bias),leaky($e)})}function depthwiseSeparableConv(Ke,Ge){return Ze(function(){var $e=Ir(Ke,[[0,0],[1,1],[1,1],[0,0]]);return $e=Jc($e,Ge.depthwise_filter,Ge.pointwise_filter,[1,1],"valid"),$e=rc($e,Ge.bias),leaky($e)})}function extractorsFactory$3(Ke,Ge){var $e=extractConvParamsFactory(Ke,Ge);function Ye(Mt,nn){var an=Mn(Ke(Mt)),sn=Mn(Ke(Mt));return Ge.push({paramPath:nn+"/sub"},{paramPath:nn+"/truediv"}),{sub:an,truediv:sn}}function Qe(Mt,nn,an){var sn=$e(Mt,nn,3,an+"/conv"),ln=Ye(nn,an+"/bn");return{conv:sn,bn:ln}}var Je=extractSeparableConvParamsFactory(Ke,Ge);return{extractConvParams:$e,extractConvWithBatchNormParams:Qe,extractSeparableConvParams:Je}}function extractParams$1(Ke,Ge,$e,Ye){var Qe=extractWeightsFactory(Ke),Je=Qe.extractWeights,Mt=Qe.getRemainingWeights,nn=[],an=extractorsFactory$3(Je,nn),sn=an.extractConvParams,ln=an.extractConvWithBatchNormParams,fn=an.extractSeparableConvParams,hn;if(Ge.withSeparableConvs){var Xr=Ye[0],Mi=Ye[1],co=Ye[2],lo=Ye[3],uo=Ye[4],ho=Ye[5],mo=Ye[6],_d=Ye[7],ep=Ye[8],rp=Ge.isFirstLayerConv2d?sn(Xr,Mi,3,"conv0"):fn(Xr,Mi,"conv0"),sp=fn(Mi,co,"conv1"),op=fn(co,lo,"conv2"),ip=fn(lo,uo,"conv3"),lp=fn(uo,ho,"conv4"),vp=fn(ho,mo,"conv5"),gp=_d?fn(mo,_d,"conv6"):void 0,Op=ep?fn(_d,ep,"conv7"):void 0,Mp=sn(ep||_d||mo,5*$e,1,"conv8");hn={conv0:rp,conv1:sp,conv2:op,conv3:ip,conv4:lp,conv5:vp,conv6:gp,conv7:Op,conv8:Mp}}else{var Xr=Ye[0],Mi=Ye[1],co=Ye[2],lo=Ye[3],uo=Ye[4],ho=Ye[5],mo=Ye[6],_d=Ye[7],ep=Ye[8],rp=ln(Xr,Mi,"conv0"),sp=ln(Mi,co,"conv1"),op=ln(co,lo,"conv2"),ip=ln(lo,uo,"conv3"),lp=ln(uo,ho,"conv4"),vp=ln(ho,mo,"conv5"),gp=ln(mo,_d,"conv6"),Op=ln(_d,ep,"conv7"),Mp=sn(ep,5*$e,1,"conv8");hn={conv0:rp,conv1:sp,conv2:op,conv3:ip,conv4:lp,conv5:vp,conv6:gp,conv7:Op,conv8:Mp}}if(Mt().length!==0)throw new Error("weights remaing after extract: "+Mt().length);return{params:hn,paramMappings:nn}}function extractorsFactory$2(Ke,Ge){var $e=extractWeightEntryFactory(Ke,Ge);function Ye(nn){var an=$e(nn+"/sub",1),sn=$e(nn+"/truediv",1);return{sub:an,truediv:sn}}function Qe(nn){var an=$e(nn+"/filters",4),sn=$e(nn+"/bias",1);return{filters:an,bias:sn}}function Je(nn){var an=Qe(nn+"/conv"),sn=Ye(nn+"/bn");return{conv:an,bn:sn}}var Mt=loadSeparableConvParamsFactory($e);return{extractConvParams:Qe,extractConvWithBatchNormParams:Je,extractSeparableConvParams:Mt}}function extractParamsFromWeigthMap$1(Ke,Ge){var $e=[],Ye=extractorsFactory$2(Ke,$e),Qe=Ye.extractConvParams,Je=Ye.extractConvWithBatchNormParams,Mt=Ye.extractSeparableConvParams,nn;if(Ge.withSeparableConvs){var an=Ge.filterSizes&&Ge.filterSizes.length||9;nn={conv0:Ge.isFirstLayerConv2d?Qe("conv0"):Mt("conv0"),conv1:Mt("conv1"),conv2:Mt("conv2"),conv3:Mt("conv3"),conv4:Mt("conv4"),conv5:Mt("conv5"),conv6:an>7?Mt("conv6"):void 0,conv7:an>8?Mt("conv7"):void 0,conv8:Qe("conv8")}}else nn={conv0:Je("conv0"),conv1:Je("conv1"),conv2:Je("conv2"),conv3:Je("conv3"),conv4:Je("conv4"),conv5:Je("conv5"),conv6:Je("conv6"),conv7:Je("conv7"),conv8:Qe("conv8")};return disposeUnusedWeightTensors(Ke,$e),{params:nn,paramMappings:$e}}var TinyYolov2SizeType;(function(Ke){Ke[Ke.XS=224]="XS",Ke[Ke.SM=320]="SM",Ke[Ke.MD=416]="MD",Ke[Ke.LG=608]="LG"})(TinyYolov2SizeType||(TinyYolov2SizeType={}));var TinyYolov2Options=function(){function Ke(Ge){var $e=Ge===void 0?{}:Ge,Ye=$e.inputSize,Qe=$e.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=Ye||416,this._scoreThreshold=Qe||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(Ke.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),Ke}(),TinyYolov2Base=function(Ke){__extends(Ge,Ke);function Ge($e){var Ye=Ke.call(this,"TinyYolov2")||this;return validateConfig($e),Ye._config=$e,Ye}return Object.defineProperty(Ge.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(Ge.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(Ge.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),Ge.prototype.runTinyYolov2=function($e,Ye){var Qe=convWithBatchNorm($e,Ye.conv0);return Qe=hl(Qe,[2,2],[2,2],"same"),Qe=convWithBatchNorm(Qe,Ye.conv1),Qe=hl(Qe,[2,2],[2,2],"same"),Qe=convWithBatchNorm(Qe,Ye.conv2),Qe=hl(Qe,[2,2],[2,2],"same"),Qe=convWithBatchNorm(Qe,Ye.conv3),Qe=hl(Qe,[2,2],[2,2],"same"),Qe=convWithBatchNorm(Qe,Ye.conv4),Qe=hl(Qe,[2,2],[2,2],"same"),Qe=convWithBatchNorm(Qe,Ye.conv5),Qe=hl(Qe,[2,2],[1,1],"same"),Qe=convWithBatchNorm(Qe,Ye.conv6),Qe=convWithBatchNorm(Qe,Ye.conv7),convLayer$1(Qe,Ye.conv8,"valid",!1)},Ge.prototype.runMobilenet=function($e,Ye){var Qe=this.config.isFirstLayerConv2d?leaky(convLayer$1($e,Ye.conv0,"valid",!1)):depthwiseSeparableConv($e,Ye.conv0);return Qe=hl(Qe,[2,2],[2,2],"same"),Qe=depthwiseSeparableConv(Qe,Ye.conv1),Qe=hl(Qe,[2,2],[2,2],"same"),Qe=depthwiseSeparableConv(Qe,Ye.conv2),Qe=hl(Qe,[2,2],[2,2],"same"),Qe=depthwiseSeparableConv(Qe,Ye.conv3),Qe=hl(Qe,[2,2],[2,2],"same"),Qe=depthwiseSeparableConv(Qe,Ye.conv4),Qe=hl(Qe,[2,2],[2,2],"same"),Qe=depthwiseSeparableConv(Qe,Ye.conv5),Qe=hl(Qe,[2,2],[1,1],"same"),Qe=Ye.conv6?depthwiseSeparableConv(Qe,Ye.conv6):Qe,Qe=Ye.conv7?depthwiseSeparableConv(Qe,Ye.conv7):Qe,convLayer$1(Qe,Ye.conv8,"valid",!1)},Ge.prototype.forwardInput=function($e,Ye){var Qe=this,Je=this.params;if(!Je)throw new Error("TinyYolov2 - load model before inference");return Ze(function(){var Mt=$e.toBatchTensor(Ye,!1).toFloat();return Mt=Qe.config.meanRgb?normalize$1(Mt,Qe.config.meanRgb):Mt,Mt=Mt.div(On(256)),Qe.config.withSeparableConvs?Qe.runMobilenet(Mt,Je):Qe.runTinyYolov2(Mt,Je)})},Ge.prototype.forward=function($e,Ye){return __awaiter(this,void 0,void 0,function(){var Qe;return __generator(this,function(Je){switch(Je.label){case 0:return Qe=this.forwardInput,[4,toNetInput($e)];case 1:return[4,Qe.apply(this,[Je.sent(),Ye])];case 2:return[2,Je.sent()]}})})},Ge.prototype.detect=function($e,Ye){return Ye===void 0&&(Ye={}),__awaiter(this,void 0,void 0,function(){var Qe,Je,Mt,nn,an,sn,ln,fn,hn,Xr,Mi,co,lo,uo,ho=this;return __generator(this,function(mo){switch(mo.label){case 0:return Qe=new TinyYolov2Options(Ye),Je=Qe.inputSize,Mt=Qe.scoreThreshold,[4,toNetInput($e)];case 1:return nn=mo.sent(),[4,this.forwardInput(nn,Je)];case 2:return an=mo.sent(),sn=Ze(function(){return Ur(an)[0].expandDims()}),ln={width:nn.getInputWidth(0),height:nn.getInputHeight(0)},[4,this.extractBoxes(sn,nn.getReshapedInputDimensions(0),Mt)];case 3:return fn=mo.sent(),an.dispose(),sn.dispose(),hn=fn.map(function(_d){return _d.box}),Xr=fn.map(function(_d){return _d.score}),Mi=fn.map(function(_d){return _d.classScore}),co=fn.map(function(_d){return ho.config.classes[_d.label]}),lo=nonMaxSuppression$1(hn.map(function(_d){return _d.rescale(Je)}),Xr,this.config.iouThreshold,!0),uo=lo.map(function(_d){return new ObjectDetection(Xr[_d],Mi[_d],co[_d],hn[_d],ln)}),[2,uo]}})})},Ge.prototype.getDefaultModelName=function(){return""},Ge.prototype.extractParamsFromWeigthMap=function($e){return extractParamsFromWeigthMap$1($e,this.config)},Ge.prototype.extractParams=function($e){var Ye=this.config.filterSizes||Ge.DEFAULT_FILTER_SIZES,Qe=Ye?Ye.length:void 0;if(Qe!==7&&Qe!==8&&Qe!==9)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+Qe+" filterSizes in config");return extractParams$1($e,this.config,this.boxEncodingSize,Ye)},Ge.prototype.extractBoxes=function($e,Ye,Qe){return __awaiter(this,void 0,void 0,function(){var Je,Mt,nn,an,sn,ln,fn,hn,Xr,Mi,co,lo,uo,ho,mo,_d,ep,rp,sp,op,ip,lp,vp,gp,Op,Mp,Np,wp,Sp,Cp=this;return __generator(this,function(Ip){switch(Ip.label){case 0:return Je=Ye.width,Mt=Ye.height,nn=Math.max(Je,Mt),an=nn/Je,sn=nn/Mt,ln=$e.shape[1],fn=this.config.anchors.length,hn=Ze(function(){var cp=$e.reshape([ln,ln,fn,Cp.boxEncodingSize]),Ep=cp.slice([0,0,0,0],[ln,ln,fn,4]),Fp=cp.slice([0,0,0,4],[ln,ln,fn,1]),Hp=Cp.withClassScores?go(cp.slice([0,0,0,5],[ln,ln,fn,Cp.config.classes.length]),3):On(0);return[Ep,Fp,Hp]}),Xr=hn[0],Mi=hn[1],co=hn[2],lo=[],[4,Mi.array()];case 1:return uo=Ip.sent(),[4,Xr.array()];case 2:ho=Ip.sent(),mo=0,Ip.label=3;case 3:if(!(mo<ln))return[3,12];_d=0,Ip.label=4;case 4:if(!(_d<ln))return[3,11];ep=0,Ip.label=5;case 5:return ep<fn?(rp=sigmoid(uo[mo][_d][ep][0]),!Qe||rp>Qe?(sp=(_d+sigmoid(ho[mo][_d][ep][0]))/ln*an,op=(mo+sigmoid(ho[mo][_d][ep][1]))/ln*sn,ip=Math.exp(ho[mo][_d][ep][2])*this.config.anchors[ep].x/ln*an,lp=Math.exp(ho[mo][_d][ep][3])*this.config.anchors[ep].y/ln*sn,vp=sp-ip/2,gp=op-lp/2,Op={row:mo,col:_d,anchor:ep},this.withClassScores?[4,this.extractPredictedClass(co,Op)]:[3,7]):[3,9]):[3,10];case 6:return Sp=Ip.sent(),[3,8];case 7:Sp={classScore:1,label:0},Ip.label=8;case 8:Mp=Sp,Np=Mp.classScore,wp=Mp.label,lo.push(__assign({box:new BoundingBox(vp,gp,vp+ip,gp+lp),score:rp,classScore:rp*Np,label:wp},Op)),Ip.label=9;case 9:return ep++,[3,5];case 10:return _d++,[3,4];case 11:return mo++,[3,3];case 12:return Xr.dispose(),Mi.dispose(),co.dispose(),[2,lo]}})})},Ge.prototype.extractPredictedClass=function($e,Ye){return __awaiter(this,void 0,void 0,function(){var Qe,Je,Mt,nn;return __generator(this,function(an){switch(an.label){case 0:return Qe=Ye.row,Je=Ye.col,Mt=Ye.anchor,[4,$e.array()];case 1:return nn=an.sent(),[2,Array(this.config.classes.length).fill(0).map(function(sn,ln){return nn[Qe][Je][Mt][ln]}).map(function(sn,ln){return{classScore:sn,label:ln}}).reduce(function(sn,ln){return sn.classScore>ln.classScore?sn:ln})]}})})},Ge.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],Ge}(NeuralNetwork),TinyYolov2=function(Ke){__extends(Ge,Ke);function Ge($e){$e===void 0&&($e=!0);var Ye=this,Qe=Object.assign({},{withSeparableConvs:$e,iouThreshold:IOU_THRESHOLD$1,classes:["face"]},$e?{anchors:BOX_ANCHORS_SEPARABLE,meanRgb:MEAN_RGB_SEPARABLE}:{anchors:BOX_ANCHORS$1,withClassScores:!0});return Ye=Ke.call(this,Qe)||this,Ye}return Object.defineProperty(Ge.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(Ge.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),Ge.prototype.locateFaces=function($e,Ye){return __awaiter(this,void 0,void 0,function(){var Qe;return __generator(this,function(Je){switch(Je.label){case 0:return[4,this.detect($e,Ye)];case 1:return Qe=Je.sent(),[2,Qe.map(function(Mt){return new FaceDetection(Mt.score,Mt.relativeBox,{width:Mt.imageWidth,height:Mt.imageHeight})})]}})})},Ge.prototype.getDefaultModelName=function(){return this.withSeparableConvs?DEFAULT_MODEL_NAME_SEPARABLE_CONV:DEFAULT_MODEL_NAME},Ge.prototype.extractParamsFromWeigthMap=function($e){return Ke.prototype.extractParamsFromWeigthMap.call(this,$e)},Ge}(TinyYolov2Base),TinyFaceDetectorOptions=function(Ke){__extends(Ge,Ke);function Ge(){var $e=Ke!==null&&Ke.apply(this,arguments)||this;return $e._name="TinyFaceDetectorOptions",$e}return Ge}(TinyYolov2Options),ComposableTask=function(){function Ke(){}return Ke.prototype.then=function(Ge){return __awaiter(this,void 0,void 0,function(){var $e;return __generator(this,function(Ye){switch(Ye.label){case 0:return $e=Ge,[4,this.run()];case 1:return[2,$e.apply(void 0,[Ye.sent()])]}})})},Ke.prototype.run=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(Ge){throw new Error("ComposableTask - run is not implemented")})})},Ke}();function extractAllFacesAndComputeResults(Ke,Ge,$e,Ye,Qe){return Qe===void 0&&(Qe=function(Je){var Mt=Je.alignedRect;return Mt}),__awaiter(this,void 0,void 0,function(){var Je,Mt,nn,an,sn;return __generator(this,function(ln){switch(ln.label){case 0:return Je=Ke.map(function(fn){return isWithFaceLandmarks(fn)?Qe(fn):fn.detection}),nn=Ye,nn?[3,5]:Ge instanceof wt?[4,extractFaceTensors(Ge,Je)]:[3,2];case 1:return an=ln.sent(),[3,4];case 2:return[4,extractFaces(Ge,Je)];case 3:an=ln.sent(),ln.label=4;case 4:nn=an,ln.label=5;case 5:return Mt=nn,[4,$e(Mt)];case 6:return sn=ln.sent(),Mt.forEach(function(fn){return fn instanceof wt&&fn.dispose()}),[2,sn]}})})}function extractSingleFaceAndComputeResult(Ke,Ge,$e,Ye,Qe){return __awaiter(this,void 0,void 0,function(){var Je=this;return __generator(this,function(Mt){return[2,extractAllFacesAndComputeResults([Ke],Ge,function(nn){return __awaiter(Je,void 0,void 0,function(){return __generator(this,function(an){return[2,$e(nn[0])]})})},Ye,Qe)]})})}function bgrToRgbTensor(Ke){return Ze(function(){return Pr(Ur(Ke,3).reverse(),3)})}var CELL_STRIDE=2,CELL_SIZE=12;function extractorsFactory$1(Ke,Ge){var $e=extractConvParamsFactory(Ke,Ge),Ye=extractFCParamsFactory(Ke,Ge);function Qe(sn,ln){var fn=Mn(Ke(sn));return Ge.push({paramPath:ln}),fn}function Je(sn,ln,fn){fn===void 0&&(fn=!1);var hn=$e(sn[0],sn[1],3,ln+"/conv1"),Xr=Qe(sn[1],ln+"/prelu1_alpha"),Mi=$e(sn[1],sn[2],3,ln+"/conv2"),co=Qe(sn[2],ln+"/prelu2_alpha"),lo=$e(sn[2],sn[3],fn?2:3,ln+"/conv3"),uo=Qe(sn[3],ln+"/prelu3_alpha");return{conv1:hn,prelu1_alpha:Xr,conv2:Mi,prelu2_alpha:co,conv3:lo,prelu3_alpha:uo}}function Mt(){var sn=Je([3,10,16,32],"pnet"),ln=$e(32,2,1,"pnet/conv4_1"),fn=$e(32,4,1,"pnet/conv4_2");return __assign(__assign({},sn),{conv4_1:ln,conv4_2:fn})}function nn(){var sn=Je([3,28,48,64],"rnet",!0),ln=Ye(576,128,"rnet/fc1"),fn=Qe(128,"rnet/prelu4_alpha"),hn=Ye(128,2,"rnet/fc2_1"),Xr=Ye(128,4,"rnet/fc2_2");return __assign(__assign({},sn),{fc1:ln,prelu4_alpha:fn,fc2_1:hn,fc2_2:Xr})}function an(){var sn=Je([3,32,64,64],"onet"),ln=$e(64,128,2,"onet/conv4"),fn=Qe(128,"onet/prelu4_alpha"),hn=Ye(1152,256,"onet/fc1"),Xr=Qe(256,"onet/prelu5_alpha"),Mi=Ye(256,2,"onet/fc2_1"),co=Ye(256,4,"onet/fc2_2"),lo=Ye(256,10,"onet/fc2_3");return __assign(__assign({},sn),{conv4:ln,prelu4_alpha:fn,fc1:hn,prelu5_alpha:Xr,fc2_1:Mi,fc2_2:co,fc2_3:lo})}return{extractPNetParams:Mt,extractRNetParams:nn,extractONetParams:an}}function extractParams(Ke){var Ge=extractWeightsFactory(Ke),$e=Ge.extractWeights,Ye=Ge.getRemainingWeights,Qe=[],Je=extractorsFactory$1($e,Qe),Mt=Je.extractPNetParams,nn=Je.extractRNetParams,an=Je.extractONetParams,sn=Mt(),ln=nn(),fn=an();if(Ye().length!==0)throw new Error("weights remaing after extract: "+Ye().length);return{params:{pnet:sn,rnet:ln,onet:fn},paramMappings:Qe}}function extractorsFactory(Ke,Ge){var $e=extractWeightEntryFactory(Ke,Ge);function Ye(ln){var fn=$e(ln+"/weights",4,ln+"/filters"),hn=$e(ln+"/bias",1);return{filters:fn,bias:hn}}function Qe(ln){var fn=$e(ln+"/weights",2),hn=$e(ln+"/bias",1);return{weights:fn,bias:hn}}function Je(ln){return $e(ln,1)}function Mt(ln){var fn=Ye(ln+"/conv1"),hn=Je(ln+"/prelu1_alpha"),Xr=Ye(ln+"/conv2"),Mi=Je(ln+"/prelu2_alpha"),co=Ye(ln+"/conv3"),lo=Je(ln+"/prelu3_alpha");return{conv1:fn,prelu1_alpha:hn,conv2:Xr,prelu2_alpha:Mi,conv3:co,prelu3_alpha:lo}}function nn(){var ln=Mt("pnet"),fn=Ye("pnet/conv4_1"),hn=Ye("pnet/conv4_2");return __assign(__assign({},ln),{conv4_1:fn,conv4_2:hn})}function an(){var ln=Mt("rnet"),fn=Qe("rnet/fc1"),hn=Je("rnet/prelu4_alpha"),Xr=Qe("rnet/fc2_1"),Mi=Qe("rnet/fc2_2");return __assign(__assign({},ln),{fc1:fn,prelu4_alpha:hn,fc2_1:Xr,fc2_2:Mi})}function sn(){var ln=Mt("onet"),fn=Ye("onet/conv4"),hn=Je("onet/prelu4_alpha"),Xr=Qe("onet/fc1"),Mi=Je("onet/prelu5_alpha"),co=Qe("onet/fc2_1"),lo=Qe("onet/fc2_2"),uo=Qe("onet/fc2_3");return __assign(__assign({},ln),{conv4:fn,prelu4_alpha:hn,fc1:Xr,prelu5_alpha:Mi,fc2_1:co,fc2_2:lo,fc2_3:uo})}return{extractPNetParams:nn,extractRNetParams:an,extractONetParams:sn}}function extractParamsFromWeigthMap(Ke){var Ge=[],$e=extractorsFactory(Ke,Ge),Ye=$e.extractPNetParams,Qe=$e.extractRNetParams,Je=$e.extractONetParams,Mt=Ye(),nn=Qe(),an=Je();return disposeUnusedWeightTensors(Ke,Ge),{params:{pnet:Mt,rnet:nn,onet:an},paramMappings:Ge}}function getSizesForScale(Ke,Ge){var $e=Ge[0],Ye=Ge[1];return{height:Math.floor($e*Ke),width:Math.floor(Ye*Ke)}}function pyramidDown(Ke,Ge,$e){for(var Ye=$e[0],Qe=$e[1],Je=CELL_SIZE/Ke,Mt=[],nn=Math.min(Ye,Qe)*Je,an=0;nn>=12;)Mt.push(Je*Math.pow(Ge,an)),nn=nn*Ge,an+=1;return Mt}var MtcnnBox=function(Ke){__extends(Ge,Ke);function Ge($e,Ye,Qe,Je){return Ke.call(this,{left:$e,top:Ye,right:Qe,bottom:Je},!0)||this}return Ge}(Box);function normalize(Ke){return Ze(function(){return gc(Cc(Ke,On(127.5)),On(.0078125))})}function prelu(Ke,Ge){return Ze(function(){return rc(Bl(Ke),gc(Ge,wu(Bl(wu(Ke)))))})}function sharedLayer(Ke,Ge,$e){return $e===void 0&&($e=!1),Ze(function(){var Ye=convLayer$1(Ke,Ge.conv1,"valid");return Ye=prelu(Ye,Ge.prelu1_alpha),Ye=hl(Ye,$e?[2,2]:[3,3],[2,2],"same"),Ye=convLayer$1(Ye,Ge.conv2,"valid"),Ye=prelu(Ye,Ge.prelu2_alpha),Ye=$e?Ye:hl(Ye,[3,3],[2,2],"valid"),Ye=convLayer$1(Ye,Ge.conv3,"valid"),Ye=prelu(Ye,Ge.prelu3_alpha),Ye})}function PNet(Ke,Ge){return Ze(function(){var $e=sharedLayer(Ke,Ge,!0),Ye=convLayer$1($e,Ge.conv4_1,"valid"),Qe=wr(Sl(Ye,3),3),Je=go(Cc(Ye,Qe),3),Mt=convLayer$1($e,Ge.conv4_2,"valid");return{prob:Je,regions:Mt}})}function rescaleAndNormalize(Ke,Ge){return Ze(function(){var $e=getSizesForScale(Ge,Ke.shape.slice(1)),Ye=$e.height,Qe=$e.width,Je=Oh.resizeBilinear(Ke,[Ye,Qe]),Mt=normalize(Je);return Wl(Mt,[0,2,1,3])})}function extractBoundingBoxes(Ke,Ge,$e,Ye){for(var Qe=[],Je=Ke.arraySync(),Mt=0;Mt<Ke.shape[0];Mt++)for(var nn=0;nn<Ke.shape[1];nn++)Je[Mt][nn]>=Ye&&Qe.push(new Point(nn,Mt));var an=Qe.map(function(sn){var ln=new BoundingBox(Math.round((sn.y*CELL_STRIDE+1)/$e),Math.round((sn.x*CELL_STRIDE+1)/$e),Math.round((sn.y*CELL_STRIDE+CELL_SIZE)/$e),Math.round((sn.x*CELL_STRIDE+CELL_SIZE)/$e)),fn=Je[sn.y][sn.x],hn=Ge.arraySync(),Xr=new MtcnnBox(hn[sn.y][sn.x][0],hn[sn.y][sn.x][1],hn[sn.y][sn.x][2],hn[sn.y][sn.x][3]);return{cell:ln,score:fn,region:Xr}});return an}function stage1(Ke,Ge,$e,Ye,Qe){Qe.stage1=[];var Je=Ge.map(function(hn){return Ze(function(){var Xr={scale:hn},Mi=rescaleAndNormalize(Ke,hn),co=Date.now(),lo=PNet(Mi,Ye),uo=lo.prob,ho=lo.regions;Xr.pnet=Date.now()-co;var mo=Ur(Ur(uo,3)[1])[0],_d=Ur(ho)[0];return{scoresTensor:mo,regionsTensor:_d,scale:hn,statsForScale:Xr}})}),Mt=Je.map(function(hn){var Xr=hn.scoresTensor,Mi=hn.regionsTensor,co=hn.scale,lo=hn.statsForScale,uo=extractBoundingBoxes(Xr,Mi,co,$e);if(Xr.dispose(),Mi.dispose(),!uo.length)return Qe.stage1.push(lo),[];var ho=Date.now(),mo=nonMaxSuppression$1(uo.map(function(_d){return _d.cell}),uo.map(function(_d){return _d.score}),.5);return lo.nms=Date.now()-ho,lo.numBoxes=mo.length,Qe.stage1.push(lo),mo.map(function(_d){return uo[_d]})}),nn=Mt.reduce(function(hn,Xr){return hn.concat(Xr)},[]),an=[],sn=[];if(nn.length>0){var ln=Date.now(),fn=nonMaxSuppression$1(nn.map(function(hn){return hn.cell}),nn.map(function(hn){return hn.score}),.7);Qe.stage1_nms=Date.now()-ln,sn=fn.map(function(hn){return nn[hn].score}),an=fn.map(function(hn){return nn[hn]}).map(function(hn){var Xr=hn.cell,Mi=hn.region;return new BoundingBox(Xr.left+Mi.left*Xr.width,Xr.top+Mi.top*Xr.height,Xr.right+Mi.right*Xr.width,Xr.bottom+Mi.bottom*Xr.height).toSquare().round()})}return{boxes:an,scores:sn}}function extractImagePatches(Ke,Ge,$e){var Ye=$e.width,Qe=$e.height;return __awaiter(this,void 0,void 0,function(){var Je,Mt,nn,an=this;return __generator(this,function(sn){switch(sn.label){case 0:return Je=getContext2dOrThrow(Ke),[4,Promise.all(Ge.map(function(ln){return __awaiter(an,void 0,void 0,function(){var fn,hn,Xr,Mi,co,lo,uo,ho;return __generator(this,function(mo){return fn=ln.padAtBorders(Ke.height,Ke.width),hn=fn.y,Xr=fn.ey,Mi=fn.x,co=fn.ex,lo=Mi-1,uo=hn-1,ho=Je.getImageData(lo,uo,co-lo,Xr-uo),[2,env.isNodejs()?createCanvasFromMedia(ho):createImageBitmap(ho)]})})}))];case 1:return Mt=sn.sent(),nn=[],Mt.forEach(function(ln){var fn=createCanvas({width:Ye,height:Qe}),hn=getContext2dOrThrow(fn);hn.drawImage(ln,0,0,Ye,Qe);for(var Xr=hn.getImageData(0,0,Ye,Qe).data,Mi=[],co=0;co<Xr.length;co+=4)Mi.push(Xr[co+2]),Mi.push(Xr[co+1]),Mi.push(Xr[co]);nn.push(Mi)}),[2,nn.map(function(ln){var fn=Ze(function(){var hn=Wl(Ln(ln,[1,Ye,Qe,3]),[0,2,1,3]).toFloat();return normalize(hn)});return fn})]}})})}function RNet(Ke,Ge){return Ze(function(){var $e=sharedLayer(Ke,Ge),Ye=Or($e,[$e.shape[0],Ge.fc1.weights.shape[0]]),Qe=fullyConnectedLayer(Ye,Ge.fc1),Je=prelu(Qe,Ge.prelu4_alpha),Mt=fullyConnectedLayer(Je,Ge.fc2_1),nn=wr(Sl(Mt,1),1),an=go(Cc(Mt,nn),1),sn=fullyConnectedLayer(Je,Ge.fc2_2),ln=Ur(an,1)[1];return{scores:ln,regions:sn}})}function stage2(Ke,Ge,$e,Ye,Qe){return __awaiter(this,void 0,void 0,function(){var Je,Mt,nn,an,sn,ln,fn,hn,Xr,Mi,co,lo,uo,ho;return __generator(this,function(mo){switch(mo.label){case 0:return Je=Date.now(),[4,extractImagePatches(Ke,Ge,{width:24,height:24})];case 1:return Mt=mo.sent(),Qe.stage2_extractImagePatches=Date.now()-Je,Je=Date.now(),nn=Mt.map(function(_d){var ep=RNet(_d,Ye);return _d.dispose(),ep}),Qe.stage2_rnet=Date.now()-Je,an=nn.length>1?Yn(nn.map(function(_d){return _d.scores})):nn[0].scores,fn=(ln=Array).from,[4,an.data()];case 2:return sn=fn.apply(ln,[mo.sent()]),an.dispose(),hn=sn.map(function(_d,ep){return{score:_d,idx:ep}}).filter(function(_d){return _d.score>$e}).map(function(_d){var ep=_d.idx;return ep}),Xr=hn.map(function(_d){return Ge[_d]}),Mi=hn.map(function(_d){return sn[_d]}),co=[],lo=[],Xr.length>0&&(Je=Date.now(),uo=nonMaxSuppression$1(Xr,Mi,.7),Qe.stage2_nms=Date.now()-Je,ho=uo.map(function(_d){var ep=nn[hn[_d]].regions.arraySync();return new MtcnnBox(ep[0][0],ep[0][1],ep[0][2],ep[0][3])}),lo=uo.map(function(_d){return Mi[_d]}),co=uo.map(function(_d,ep){return Xr[_d].calibrate(ho[ep])})),nn.forEach(function(_d){_d.regions.dispose(),_d.scores.dispose()}),[2,{boxes:co,scores:lo}]}})})}function ONet(Ke,Ge){return Ze(function(){var $e=sharedLayer(Ke,Ge);$e=hl($e,[2,2],[2,2],"same"),$e=convLayer$1($e,Ge.conv4,"valid"),$e=prelu($e,Ge.prelu4_alpha);var Ye=Or($e,[$e.shape[0],Ge.fc1.weights.shape[0]]),Qe=fullyConnectedLayer(Ye,Ge.fc1),Je=prelu(Qe,Ge.prelu5_alpha),Mt=fullyConnectedLayer(Je,Ge.fc2_1),nn=wr(Sl(Mt,1),1),an=go(Cc(Mt,nn),1),sn=fullyConnectedLayer(Je,Ge.fc2_2),ln=fullyConnectedLayer(Je,Ge.fc2_3),fn=Ur(an,1)[1];return{scores:fn,regions:sn,points:ln}})}function stage3(Ke,Ge,$e,Ye,Qe){return __awaiter(this,void 0,void 0,function(){var Je,Mt,nn,an,sn,ln,fn,hn,Xr,Mi,co,lo,uo,ho,mo;return __generator(this,function(_d){switch(_d.label){case 0:return Je=Date.now(),[4,extractImagePatches(Ke,Ge,{width:48,height:48})];case 1:return Mt=_d.sent(),Qe.stage3_extractImagePatches=Date.now()-Je,Je=Date.now(),nn=Mt.map(function(ep){var rp=ONet(ep,Ye);return ep.dispose(),rp}),Qe.stage3_onet=Date.now()-Je,an=nn.length>1?Yn(nn.map(function(ep){return ep.scores})):nn[0].scores,fn=(ln=Array).from,[4,an.data()];case 2:return sn=fn.apply(ln,[_d.sent()]),an.dispose(),hn=sn.map(function(ep,rp){return{score:ep,idx:rp}}).filter(function(ep){return ep.score>$e}).map(function(ep){var rp=ep.idx;return rp}),Xr=hn.map(function(ep){var rp=nn[ep].regions.arraySync();return new MtcnnBox(rp[0][0],rp[0][1],rp[0][2],rp[0][3])}),Mi=hn.map(function(ep,rp){return Ge[ep].calibrate(Xr[rp])}),co=hn.map(function(ep){return sn[ep]}),lo=[],uo=[],ho=[],Mi.length>0&&(Je=Date.now(),mo=nonMaxSuppression$1(Mi,co,.7,!1),Qe.stage3_nms=Date.now()-Je,lo=mo.map(function(ep){return Mi[ep]}),uo=mo.map(function(ep){return co[ep]}),ho=mo.map(function(ep,rp){return Array(5).fill(0).map(function(sp,op){var ip=nn[ep].points.arraySync();return new Point(ip[0][op]*(lo[rp].width+1)+lo[rp].left,ip[0][op+5]*(lo[rp].height+1)+lo[rp].top)})})),nn.forEach(function(ep){ep.regions.dispose(),ep.scores.dispose(),ep.points.dispose()}),[2,{boxes:lo,scores:uo,points:ho}]}})})}var Mtcnn=function(Ke){__extends(Ge,Ke);function Ge(){return Ke.call(this,"Mtcnn")||this}return Ge.prototype.load=function($e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(Ye){return console.warn("mtcnn is deprecated and will be removed soon"),[2,Ke.prototype.load.call(this,$e)]})})},Ge.prototype.loadFromDisk=function($e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(Ye){return console.warn("mtcnn is deprecated and will be removed soon"),[2,Ke.prototype.loadFromDisk.call(this,$e)]})})},Ge.prototype.forwardInput=function($e,Ye){return Ye===void 0&&(Ye={}),__awaiter(this,void 0,void 0,function(){var Qe,Je,Mt,nn,an,sn,ln,fn,hn,Xr,Mi,co,lo,uo,ho,mo,_d,ep,rp,sp,op;return __generator(this,function(ip){switch(ip.label){case 0:if(Qe=this.params,!Qe)throw new Error("Mtcnn - load model before inference");if(Je=$e.canvases[0],!Je)throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return Mt={},nn=Date.now(),an=Ze(function(){return bgrToRgbTensor(wr(id.fromPixels(Je)).toFloat())}),sn=function(lp){return an.dispose(),Mt.total=Date.now()-nn,lp},ln=an.shape.slice(1),fn=ln[0],hn=ln[1],Xr=new MtcnnOptions(Ye),Mi=Xr.minFaceSize,co=Xr.scaleFactor,lo=Xr.maxNumScales,uo=Xr.scoreThresholds,ho=Xr.scaleSteps,mo=(ho||pyramidDown(Mi,co,[fn,hn])).filter(function(lp){var vp=getSizesForScale(lp,[fn,hn]);return Math.min(vp.width,vp.height)>CELL_SIZE}).slice(0,lo),Mt.scales=mo,Mt.pyramid=mo.map(function(lp){return getSizesForScale(lp,[fn,hn])}),_d=Date.now(),[4,stage1(an,mo,uo[0],Qe.pnet,Mt)];case 1:return ep=ip.sent(),Mt.total_stage1=Date.now()-_d,ep.boxes.length?(Mt.stage2_numInputBoxes=ep.boxes.length,_d=Date.now(),[4,stage2(Je,ep.boxes,uo[1],Qe.rnet,Mt)]):[2,sn({results:[],stats:Mt})];case 2:return rp=ip.sent(),Mt.total_stage2=Date.now()-_d,rp.boxes.length?(Mt.stage3_numInputBoxes=rp.boxes.length,_d=Date.now(),[4,stage3(Je,rp.boxes,uo[2],Qe.onet,Mt)]):[2,sn({results:[],stats:Mt})];case 3:return sp=ip.sent(),Mt.total_stage3=Date.now()-_d,op=sp.boxes.map(function(lp,vp){return extendWithFaceLandmarks(extendWithFaceDetection({},new FaceDetection(sp.scores[vp],new Rect(lp.left/hn,lp.top/fn,lp.width/hn,lp.height/fn),{height:fn,width:hn})),new FaceLandmarks5(sp.points[vp].map(function(gp){return gp.sub(new Point(lp.left,lp.top)).div(new Point(lp.width,lp.height))}),{width:lp.width,height:lp.height}))}),[2,sn({results:op,stats:Mt})]}})})},Ge.prototype.forward=function($e,Ye){return Ye===void 0&&(Ye={}),__awaiter(this,void 0,void 0,function(){var Qe;return __generator(this,function(Je){switch(Je.label){case 0:return Qe=this.forwardInput,[4,toNetInput($e)];case 1:return[4,Qe.apply(this,[Je.sent(),Ye])];case 2:return[2,Je.sent().results]}})})},Ge.prototype.forwardWithStats=function($e,Ye){return Ye===void 0&&(Ye={}),__awaiter(this,void 0,void 0,function(){var Qe;return __generator(this,function(Je){switch(Je.label){case 0:return Qe=this.forwardInput,[4,toNetInput($e)];case 1:return[2,Qe.apply(this,[Je.sent(),Ye])]}})})},Ge.prototype.getDefaultModelName=function(){return"mtcnn_model"},Ge.prototype.extractParamsFromWeigthMap=function($e){return extractParamsFromWeigthMap($e)},Ge.prototype.extractParams=function($e){return extractParams($e)},Ge}(NeuralNetwork),IOU_THRESHOLD=.4,BOX_ANCHORS=[new Point(1.603231,2.094468),new Point(6.041143,7.080126),new Point(2.882459,3.518061),new Point(4.266906,5.178857),new Point(9.041765,10.66308)],MEAN_RGB=[117.001,114.697,97.404],TinyFaceDetector=function(Ke){__extends(Ge,Ke);function Ge(){var $e=this,Ye={withSeparableConvs:!0,iouThreshold:IOU_THRESHOLD,classes:["face"],anchors:BOX_ANCHORS,meanRgb:MEAN_RGB,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return $e=Ke.call(this,Ye)||this,$e}return Object.defineProperty(Ge.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),Ge.prototype.locateFaces=function($e,Ye){return __awaiter(this,void 0,void 0,function(){var Qe;return __generator(this,function(Je){switch(Je.label){case 0:return[4,this.detect($e,Ye)];case 1:return Qe=Je.sent(),[2,Qe.map(function(Mt){return new FaceDetection(Mt.score,Mt.relativeBox,{width:Mt.imageWidth,height:Mt.imageHeight})})]}})})},Ge.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},Ge.prototype.extractParamsFromWeigthMap=function($e){return Ke.prototype.extractParamsFromWeigthMap.call(this,$e)},Ge}(TinyYolov2Base),nets={ssdMobilenetv1:new SsdMobilenetv1,tinyFaceDetector:new TinyFaceDetector,tinyYolov2:new TinyYolov2,mtcnn:new Mtcnn,faceLandmark68Net:new FaceLandmark68Net,faceLandmark68TinyNet:new FaceLandmark68TinyNet,faceRecognitionNet:new FaceRecognitionNet,faceExpressionNet:new FaceExpressionNet,ageGenderNet:new AgeGenderNet},PredictFaceExpressionsTaskBase=function(Ke){__extends(Ge,Ke);function Ge($e,Ye,Qe){var Je=Ke.call(this)||this;return Je.parentTask=$e,Je.input=Ye,Je.extractedFaces=Qe,Je}return Ge}(ComposableTask),PredictAllFaceExpressionsTask=function(Ke){__extends(Ge,Ke);function Ge(){return Ke!==null&&Ke.apply(this,arguments)||this}return Ge.prototype.run=function(){return __awaiter(this,void 0,void 0,function(){var $e,Ye,Qe=this;return __generator(this,function(Je){switch(Je.label){case 0:return[4,this.parentTask];case 1:return $e=Je.sent(),[4,extractAllFacesAndComputeResults($e,this.input,function(Mt){return __awaiter(Qe,void 0,void 0,function(){return __generator(this,function(nn){switch(nn.label){case 0:return[4,Promise.all(Mt.map(function(an){return nets.faceExpressionNet.predictExpressions(an)}))];case 1:return[2,nn.sent()]}})})},this.extractedFaces)];case 2:return Ye=Je.sent(),[2,$e.map(function(Mt,nn){return extendWithFaceExpressions(Mt,Ye[nn])})]}})})},Ge.prototype.withAgeAndGender=function(){return new PredictAllAgeAndGenderTask(this,this.input)},Ge}(PredictFaceExpressionsTaskBase),PredictSingleFaceExpressionsTask=function(Ke){__extends(Ge,Ke);function Ge(){return Ke!==null&&Ke.apply(this,arguments)||this}return Ge.prototype.run=function(){return __awaiter(this,void 0,void 0,function(){var $e,Ye;return __generator(this,function(Qe){switch(Qe.label){case 0:return[4,this.parentTask];case 1:return $e=Qe.sent(),$e?[4,extractSingleFaceAndComputeResult($e,this.input,function(Je){return nets.faceExpressionNet.predictExpressions(Je)},this.extractedFaces)]:[2];case 2:return Ye=Qe.sent(),[2,extendWithFaceExpressions($e,Ye)]}})})},Ge.prototype.withAgeAndGender=function(){return new PredictSingleAgeAndGenderTask(this,this.input)},Ge}(PredictFaceExpressionsTaskBase),PredictAllFaceExpressionsWithFaceAlignmentTask=function(Ke){__extends(Ge,Ke);function Ge(){return Ke!==null&&Ke.apply(this,arguments)||this}return Ge.prototype.withAgeAndGender=function(){return new PredictAllAgeAndGenderWithFaceAlignmentTask(this,this.input)},Ge.prototype.withFaceDescriptors=function(){return new ComputeAllFaceDescriptorsTask(this,this.input)},Ge}(PredictAllFaceExpressionsTask),PredictSingleFaceExpressionsWithFaceAlignmentTask=function(Ke){__extends(Ge,Ke);function Ge(){return Ke!==null&&Ke.apply(this,arguments)||this}return Ge.prototype.withAgeAndGender=function(){return new PredictSingleAgeAndGenderWithFaceAlignmentTask(this,this.input)},Ge.prototype.withFaceDescriptor=function(){return new ComputeSingleFaceDescriptorTask(this,this.input)},Ge}(PredictSingleFaceExpressionsTask),PredictAgeAndGenderTaskBase=function(Ke){__extends(Ge,Ke);function Ge($e,Ye,Qe){var Je=Ke.call(this)||this;return Je.parentTask=$e,Je.input=Ye,Je.extractedFaces=Qe,Je}return Ge}(ComposableTask),PredictAllAgeAndGenderTask=function(Ke){__extends(Ge,Ke);function Ge(){return Ke!==null&&Ke.apply(this,arguments)||this}return Ge.prototype.run=function(){return __awaiter(this,void 0,void 0,function(){var $e,Ye,Qe=this;return __generator(this,function(Je){switch(Je.label){case 0:return[4,this.parentTask];case 1:return $e=Je.sent(),[4,extractAllFacesAndComputeResults($e,this.input,function(Mt){return __awaiter(Qe,void 0,void 0,function(){return __generator(this,function(nn){switch(nn.label){case 0:return[4,Promise.all(Mt.map(function(an){return nets.ageGenderNet.predictAgeAndGender(an)}))];case 1:return[2,nn.sent()]}})})},this.extractedFaces)];case 2:return Ye=Je.sent(),[2,$e.map(function(Mt,nn){var an=Ye[nn],sn=an.age,ln=an.gender,fn=an.genderProbability;return extendWithAge(extendWithGender(Mt,ln,fn),sn)})]}})})},Ge.prototype.withFaceExpressions=function(){return new PredictAllFaceExpressionsTask(this,this.input)},Ge}(PredictAgeAndGenderTaskBase),PredictSingleAgeAndGenderTask=function(Ke){__extends(Ge,Ke);function Ge(){return Ke!==null&&Ke.apply(this,arguments)||this}return Ge.prototype.run=function(){return __awaiter(this,void 0,void 0,function(){var $e,Ye,Qe,Je,Mt;return __generator(this,function(nn){switch(nn.label){case 0:return[4,this.parentTask];case 1:return $e=nn.sent(),$e?[4,extractSingleFaceAndComputeResult($e,this.input,function(an){return nets.ageGenderNet.predictAgeAndGender(an)},this.extractedFaces)]:[2];case 2:return Ye=nn.sent(),Qe=Ye.age,Je=Ye.gender,Mt=Ye.genderProbability,[2,extendWithAge(extendWithGender($e,Je,Mt),Qe)]}})})},Ge.prototype.withFaceExpressions=function(){return new PredictSingleFaceExpressionsTask(this,this.input)},Ge}(PredictAgeAndGenderTaskBase),PredictAllAgeAndGenderWithFaceAlignmentTask=function(Ke){__extends(Ge,Ke);function Ge(){return Ke!==null&&Ke.apply(this,arguments)||this}return Ge.prototype.withFaceExpressions=function(){return new PredictAllFaceExpressionsWithFaceAlignmentTask(this,this.input)},Ge.prototype.withFaceDescriptors=function(){return new ComputeAllFaceDescriptorsTask(this,this.input)},Ge}(PredictAllAgeAndGenderTask),PredictSingleAgeAndGenderWithFaceAlignmentTask=function(Ke){__extends(Ge,Ke);function Ge(){return Ke!==null&&Ke.apply(this,arguments)||this}return Ge.prototype.withFaceExpressions=function(){return new PredictSingleFaceExpressionsWithFaceAlignmentTask(this,this.input)},Ge.prototype.withFaceDescriptor=function(){return new ComputeSingleFaceDescriptorTask(this,this.input)},Ge}(PredictSingleAgeAndGenderTask),ComputeFaceDescriptorsTaskBase=function(Ke){__extends(Ge,Ke);function Ge($e,Ye){var Qe=Ke.call(this)||this;return Qe.parentTask=$e,Qe.input=Ye,Qe}return Ge}(ComposableTask),ComputeAllFaceDescriptorsTask=function(Ke){__extends(Ge,Ke);function Ge(){return Ke!==null&&Ke.apply(this,arguments)||this}return Ge.prototype.run=function(){return __awaiter(this,void 0,void 0,function(){var $e,Ye;return __generator(this,function(Qe){switch(Qe.label){case 0:return[4,this.parentTask];case 1:return $e=Qe.sent(),[4,extractAllFacesAndComputeResults($e,this.input,function(Je){return Promise.all(Je.map(function(Mt){return nets.faceRecognitionNet.computeFaceDescriptor(Mt)}))},null,function(Je){return Je.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return Ye=Qe.sent(),[2,Ye.map(function(Je,Mt){return extendWithFaceDescriptor($e[Mt],Je)})]}})})},Ge.prototype.withFaceExpressions=function(){return new PredictAllFaceExpressionsWithFaceAlignmentTask(this,this.input)},Ge.prototype.withAgeAndGender=function(){return new PredictAllAgeAndGenderWithFaceAlignmentTask(this,this.input)},Ge}(ComputeFaceDescriptorsTaskBase),ComputeSingleFaceDescriptorTask=function(Ke){__extends(Ge,Ke);function Ge(){return Ke!==null&&Ke.apply(this,arguments)||this}return Ge.prototype.run=function(){return __awaiter(this,void 0,void 0,function(){var $e,Ye;return __generator(this,function(Qe){switch(Qe.label){case 0:return[4,this.parentTask];case 1:return $e=Qe.sent(),$e?[4,extractSingleFaceAndComputeResult($e,this.input,function(Je){return nets.faceRecognitionNet.computeFaceDescriptor(Je)},null,function(Je){return Je.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return Ye=Qe.sent(),[2,extendWithFaceDescriptor($e,Ye)]}})})},Ge.prototype.withFaceExpressions=function(){return new PredictSingleFaceExpressionsWithFaceAlignmentTask(this,this.input)},Ge.prototype.withAgeAndGender=function(){return new PredictSingleAgeAndGenderWithFaceAlignmentTask(this,this.input)},Ge}(ComputeFaceDescriptorsTaskBase),DetectFaceLandmarksTaskBase=function(Ke){__extends(Ge,Ke);function Ge($e,Ye,Qe){var Je=Ke.call(this)||this;return Je.parentTask=$e,Je.input=Ye,Je.useTinyLandmarkNet=Qe,Je}return Object.defineProperty(Ge.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?nets.faceLandmark68TinyNet:nets.faceLandmark68Net},enumerable:!0,configurable:!0}),Ge}(ComposableTask),DetectAllFaceLandmarksTask=function(Ke){__extends(Ge,Ke);function Ge(){return Ke!==null&&Ke.apply(this,arguments)||this}return Ge.prototype.run=function(){return __awaiter(this,void 0,void 0,function(){var $e,Ye,Qe,Je,Mt,nn=this;return __generator(this,function(an){switch(an.label){case 0:return[4,this.parentTask];case 1:return $e=an.sent(),Ye=$e.map(function(sn){return sn.detection}),this.input instanceof wt?[4,extractFaceTensors(this.input,Ye)]:[3,3];case 2:return Je=an.sent(),[3,5];case 3:return[4,extractFaces(this.input,Ye)];case 4:Je=an.sent(),an.label=5;case 5:return Qe=Je,[4,Promise.all(Qe.map(function(sn){return nn.landmarkNet.detectLandmarks(sn)}))];case 6:return Mt=an.sent(),Qe.forEach(function(sn){return sn instanceof wt&&sn.dispose()}),[2,$e.map(function(sn,ln){return extendWithFaceLandmarks(sn,Mt[ln])})]}})})},Ge.prototype.withFaceExpressions=function(){return new PredictAllFaceExpressionsWithFaceAlignmentTask(this,this.input)},Ge.prototype.withAgeAndGender=function(){return new PredictAllAgeAndGenderWithFaceAlignmentTask(this,this.input)},Ge.prototype.withFaceDescriptors=function(){return new ComputeAllFaceDescriptorsTask(this,this.input)},Ge}(DetectFaceLandmarksTaskBase),DetectSingleFaceLandmarksTask=function(Ke){__extends(Ge,Ke);function Ge(){return Ke!==null&&Ke.apply(this,arguments)||this}return Ge.prototype.run=function(){return __awaiter(this,void 0,void 0,function(){var $e,Ye,Qe,Je,Mt;return __generator(this,function(nn){switch(nn.label){case 0:return[4,this.parentTask];case 1:return $e=nn.sent(),$e?(Ye=$e.detection,this.input instanceof wt?[4,extractFaceTensors(this.input,[Ye])]:[3,3]):[2];case 2:return Je=nn.sent(),[3,5];case 3:return[4,extractFaces(this.input,[Ye])];case 4:Je=nn.sent(),nn.label=5;case 5:return Qe=Je,[4,this.landmarkNet.detectLandmarks(Qe[0])];case 6:return Mt=nn.sent(),Qe.forEach(function(an){return an instanceof wt&&an.dispose()}),[2,extendWithFaceLandmarks($e,Mt)]}})})},Ge.prototype.withFaceExpressions=function(){return new PredictSingleFaceExpressionsWithFaceAlignmentTask(this,this.input)},Ge.prototype.withAgeAndGender=function(){return new PredictSingleAgeAndGenderWithFaceAlignmentTask(this,this.input)},Ge.prototype.withFaceDescriptor=function(){return new ComputeSingleFaceDescriptorTask(this,this.input)},Ge}(DetectFaceLandmarksTaskBase),DetectFacesTaskBase=function(Ke){__extends(Ge,Ke);function Ge($e,Ye){Ye===void 0&&(Ye=new SsdMobilenetv1Options);var Qe=Ke.call(this)||this;return Qe.input=$e,Qe.options=Ye,Qe}return Ge}(ComposableTask),DetectAllFacesTask=function(Ke){__extends(Ge,Ke);function Ge(){return Ke!==null&&Ke.apply(this,arguments)||this}return Ge.prototype.run=function(){return __awaiter(this,void 0,void 0,function(){var $e,Ye,Qe,Je;return __generator(this,function(Mt){switch(Mt.label){case 0:return $e=this,Ye=$e.input,Qe=$e.options,Qe instanceof MtcnnOptions?[4,nets.mtcnn.forward(Ye,Qe)]:[3,2];case 1:return[2,Mt.sent().map(function(nn){return nn.detection})];case 2:if(Je=Qe instanceof TinyFaceDetectorOptions?function(nn){return nets.tinyFaceDetector.locateFaces(nn,Qe)}:Qe instanceof SsdMobilenetv1Options?function(nn){return nets.ssdMobilenetv1.locateFaces(nn,Qe)}:Qe instanceof TinyYolov2Options?function(nn){return nets.tinyYolov2.locateFaces(nn,Qe)}:null,!Je)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,Je(Ye)]}})})},Ge.prototype.runAndExtendWithFaceDetections=function(){var $e=this;return new Promise(function(Ye){return __awaiter($e,void 0,void 0,function(){var Qe;return __generator(this,function(Je){switch(Je.label){case 0:return[4,this.run()];case 1:return Qe=Je.sent(),[2,Ye(Qe.map(function(Mt){return extendWithFaceDetection({},Mt)}))]}})})})},Ge.prototype.withFaceLandmarks=function($e){return $e===void 0&&($e=!1),new DetectAllFaceLandmarksTask(this.runAndExtendWithFaceDetections(),this.input,$e)},Ge.prototype.withFaceExpressions=function(){return new PredictAllFaceExpressionsTask(this.runAndExtendWithFaceDetections(),this.input)},Ge.prototype.withAgeAndGender=function(){return new PredictAllAgeAndGenderTask(this.runAndExtendWithFaceDetections(),this.input)},Ge}(DetectFacesTaskBase),DetectSingleFaceTask=function(Ke){__extends(Ge,Ke);function Ge(){return Ke!==null&&Ke.apply(this,arguments)||this}return Ge.prototype.run=function(){return __awaiter(this,void 0,void 0,function(){var $e,Ye;return __generator(this,function(Qe){switch(Qe.label){case 0:return[4,new DetectAllFacesTask(this.input,this.options)];case 1:return $e=Qe.sent(),Ye=$e[0],$e.forEach(function(Je){Je.score>Ye.score&&(Ye=Je)}),[2,Ye]}})})},Ge.prototype.runAndExtendWithFaceDetection=function(){var $e=this;return new Promise(function(Ye){return __awaiter($e,void 0,void 0,function(){var Qe;return __generator(this,function(Je){switch(Je.label){case 0:return[4,this.run()];case 1:return Qe=Je.sent(),[2,Ye(Qe?extendWithFaceDetection({},Qe):void 0)]}})})})},Ge.prototype.withFaceLandmarks=function($e){return $e===void 0&&($e=!1),new DetectSingleFaceLandmarksTask(this.runAndExtendWithFaceDetection(),this.input,$e)},Ge.prototype.withFaceExpressions=function(){return new PredictSingleFaceExpressionsTask(this.runAndExtendWithFaceDetection(),this.input)},Ge.prototype.withAgeAndGender=function(){return new PredictSingleAgeAndGenderTask(this.runAndExtendWithFaceDetection(),this.input)},Ge}(DetectFacesTaskBase);function detectSingleFace(Ke,Ge){return Ge===void 0&&(Ge=new SsdMobilenetv1Options),new DetectSingleFaceTask(Ke,Ge)}function euclideanDistance(Ke,Ge){if(Ke.length!==Ge.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var $e=Array.from(Ke),Ye=Array.from(Ge);return Math.sqrt($e.map(function(Qe,Je){return Qe-Ye[Je]}).reduce(function(Qe,Je){return Qe+Math.pow(Je,2)},0))}(function(){function Ke(Ge,$e){$e===void 0&&($e=.6),this._distanceThreshold=$e;var Ye=Array.isArray(Ge)?Ge:[Ge];if(!Ye.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var Qe=1,Je=function(){return"person "+Qe++};this._labeledDescriptors=Ye.map(function(Mt){if(Mt instanceof LabeledFaceDescriptors)return Mt;if(Mt instanceof Float32Array)return new LabeledFaceDescriptors(Je(),[Mt]);if(Mt.descriptor&&Mt.descriptor instanceof Float32Array)return new LabeledFaceDescriptors(Je(),[Mt.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}return Object.defineProperty(Ke.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(Ke.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),Ke.prototype.computeMeanDistance=function(Ge,$e){return $e.map(function(Ye){return euclideanDistance(Ye,Ge)}).reduce(function(Ye,Qe){return Ye+Qe},0)/($e.length||1)},Ke.prototype.matchDescriptor=function(Ge){var $e=this;return this.labeledDescriptors.map(function(Ye){var Qe=Ye.descriptors,Je=Ye.label;return new FaceMatch(Je,$e.computeMeanDistance(Ge,Qe))}).reduce(function(Ye,Qe){return Ye.distance<Qe.distance?Ye:Qe})},Ke.prototype.findBestMatch=function(Ge){var $e=this.matchDescriptor(Ge);return $e.distance<this.distanceThreshold?$e:new FaceMatch("unknown",$e.distance)},Ke.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(Ge){return Ge.toJSON()})}},Ke.fromJSON=function(Ge){var $e=Ge.labeledDescriptors.map(function(Ye){return LabeledFaceDescriptors.fromJSON(Ye)});return new Ke($e,Ge.distanceThreshold)},Ke})();lookup("https://video-call-backend-y8v1.onrender.com",{transports:["websocket"],withCredentials:!0});const VideoCall=()=>{const[Ke,Ge]=reactExports.useState(),[$e,Ye]=reactExports.useState(""),[Qe,Je]=reactExports.useState({}),[Mt,nn]=reactExports.useState(!1),[an,sn]=reactExports.useState(!1),[ln,fn]=reactExports.useState(!1),[hn,Xr]=reactExports.useState(""),Mi=reactExports.useRef(),co=reactExports.useRef(),lo=reactExports.useRef(),{callId:uo}=useParams(),ho=lookup("https://video-call-backend-y8v1.onrender.com",{transports:["websocket"],withCredentials:!0});reactExports.useEffect(()=>{(async()=>{const op="/models";try{await nets.tinyFaceDetector.loadFromUri(op),await nets.faceExpressionNet.loadFromUri(op),fn(!0)}catch(ip){console.error("Error loading face-api models:",ip)}})()},[]),reactExports.useEffect(()=>{if(!ln||!Ke||!Mi.current)return;const sp=setInterval(async()=>{try{const op=await detectSingleFace(Mi.current,new TinyFaceDetectorOptions).withFaceExpressions();if(op!=null&&op.expressions){const ip=Object.entries(op.expressions).sort((gp,Op)=>Op[1]-gp[1]),[lp,vp]=ip[0];vp>.5?Xr(lp):Xr("Uncertain")}else Xr("No Face")}catch(op){console.error("Emotion detection error:",op),Xr("Error")}},2e3);return()=>clearInterval(sp)},[ln,Ke]),reactExports.useEffect(()=>(navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then(sp=>{Ge(sp),Mi.current&&(Mi.current.srcObject=sp)}).catch(sp=>{console.error("Failed to get media stream:",sp)}),ho.on("connect",()=>{Ye(ho.id)}),ho.on("incomingCall",sp=>{Je({isReceivingCall:!0,from:sp.from,name:sp.name,signal:sp.signal})}),uo&&setTimeout(()=>{_d(uo)},1e3),()=>{ho.off("connect"),ho.off("incomingCall")}),[uo]);const mo=()=>{nn(!0);const sp=new Peer({initiator:!1,trickle:!1,stream:Ke});sp.on("signal",op=>{ho.emit("answerCall",{signal:op,to:Qe.from})}),sp.on("stream",op=>{co.current&&(co.current.srcObject=op)}),sp.signal(Qe.signal),lo.current=sp},_d=sp=>{const op=new Peer({initiator:!0,trickle:!1,stream:Ke});op.on("signal",ip=>{ho.emit("callUser",{userToCall:sp,signalData:ip,from:$e,name:"User"})}),op.on("stream",ip=>{co.current&&(co.current.srcObject=ip)}),ho.on("callAccepted",ip=>{nn(!0),op.signal(ip)}),lo.current=op},ep=()=>{var sp;sn(!0),(sp=lo.current)==null||sp.destroy(),window.location.reload()},rp=()=>{navigator.clipboard.writeText(`${window.location.origin}/video-call/${$e}`)};return jsxRuntimeExports.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-purple-200 to-indigo-300 p-6 text-indigo-900",children:[jsxRuntimeExports.jsx("h1",{className:"text-4xl font-bold mb-6",children:" Emo Call"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-6 mb-8",children:[jsxRuntimeExports.jsx("video",{playsInline:!0,muted:!0,ref:Mi,autoPlay:!0,className:"w-72 h-52 bg-black rounded-lg shadow-lg border-2 border-indigo-500"}),Mt&&!an?jsxRuntimeExports.jsx("video",{playsInline:!0,ref:co,autoPlay:!0,className:"w-72 h-52 bg-black rounded-lg shadow-lg border-2 border-green-500"}):jsxRuntimeExports.jsx("div",{className:"w-72 h-52 flex items-center justify-center text-sm text-gray-600 border-2 border-dashed border-gray-400 rounded-lg",children:"Waiting for other user..."})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center gap-3 mb-6",children:[jsxRuntimeExports.jsx("label",{className:"font-medium",children:"Share this call link:"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("input",{readOnly:!0,value:`${window.location.origin}/video-call/${$e}`,className:"w-72 px-3 py-2 border rounded-md text-center shadow"}),jsxRuntimeExports.jsx("button",{onClick:rp,className:"bg-indigo-600 hover:bg-indigo-700 text-white p-2 rounded-md",title:"Copy Link",children:jsxRuntimeExports.jsx(FaCopy,{})})]})]}),Qe.isReceivingCall&&!Mt&&jsxRuntimeExports.jsxs("div",{className:"bg-white p-6 rounded-md shadow-md text-center mb-6",children:[jsxRuntimeExports.jsxs("h2",{className:"text-lg font-semibold mb-2",children:[Qe.name||"Someone"," is calling..."]}),jsxRuntimeExports.jsx("button",{onClick:mo,className:"bg-blue-600 text-white px-5 py-2 rounded hover:bg-blue-700",children:"Answer"})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-4",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>_d(uo||""),className:"bg-green-600 hover:bg-green-700 text-white px-5 py-2 rounded-md flex items-center gap-2",children:[jsxRuntimeExports.jsx(FaPhone,{})," Call"]}),jsxRuntimeExports.jsxs("button",{onClick:ep,className:"bg-red-600 hover:bg-red-700 text-white px-5 py-2 rounded-md flex items-center gap-2",children:[jsxRuntimeExports.jsx(FaPhoneSlash,{})," End Call"]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white px-4 py-2 rounded shadow text-indigo-800 font-bold absolute bottom-4 left-4",children:["Current Emotion: ",hn?hn.toUpperCase():"N/A"]})]})},videoCallImage="/vidcall.jpg.jpg",Home=()=>{const Ke=useNavigate(),Ge=()=>{const $e=localStorage.getItem("auth"),Ye=$e?JSON.parse($e):null;Ye&&Ye.user===null?Ke("/login"):Ke("/video-call")};return jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gradient-to-r from-purple-100 to-indigo-300 text-indigo-800",children:jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center px-4 pt-28 pb-16",children:jsxRuntimeExports.jsxs("div",{className:"max-w-6xl w-full flex flex-col md:flex-row items-center justify-between gap-10",children:[jsxRuntimeExports.jsxs("div",{className:"md:w-1/2 text-center md:text-left",children:[jsxRuntimeExports.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-4",children:"Crystal Clear Video Calls"}),jsxRuntimeExports.jsx("p",{className:"text-lg mb-6",children:"Connect with anyone, anywhere, anytime. Experience high-quality video calls with a modern interface."}),jsxRuntimeExports.jsx("button",{onClick:Ge,className:"bg-indigo-600 hover:bg-indigo-700 text-white font-semibold px-6 py-3 rounded-xl shadow-md transition",children:"Join Now"})]}),jsxRuntimeExports.jsx("div",{className:"md:w-1/2 flex justify-center",children:jsxRuntimeExports.jsx("img",{src:videoCallImage,alt:"Video Call Illustration",className:"w-full max-w-md rounded-xl shadow-lg"})})]})})})};var gapi=window.gapi=window.gapi||{};gapi._bs=new Date().getTime();(function(){var aa=typeof Object.defineProperties=="function"?Object.defineProperty:function(Ke,Ge,$e){return Ke==Array.prototype||Ke==Object.prototype||(Ke[Ge]=$e.value),Ke},da=function(Ke){Ke=[typeof globalThis=="object"&&globalThis,Ke,typeof window=="object"&&window,typeof self=="object"&&self,typeof global=="object"&&global];for(var Ge=0;Ge<Ke.length;++Ge){var $e=Ke[Ge];if($e&&$e.Math==Math)return $e}throw Error("Cannot find global object")},ea=da(this),fa=function(Ke,Ge){if(Ge)e:{var $e=ea;Ke=Ke.split(".");for(var Ye=0;Ye<Ke.length-1;Ye++){var Qe=Ke[Ye];if(!(Qe in $e))break e;$e=$e[Qe]}Ke=Ke[Ke.length-1],Ye=$e[Ke],Ge=Ge(Ye),Ge!=Ye&&Ge!=null&&aa($e,Ke,{configurable:!0,writable:!0,value:Ge})}},ha=function(Ke){var Ge=0;return function(){return Ge<Ke.length?{done:!1,value:Ke[Ge++]}:{done:!0}}};fa("Symbol",function(Ke){if(Ke)return Ke;var Ge=function(Qe,Je){this.ba=Qe,aa(this,"description",{configurable:!0,writable:!0,value:Je})};Ge.prototype.toString=function(){return this.ba};var $e=0,Ye=function(Qe){if(this instanceof Ye)throw new TypeError("Symbol is not a constructor");return new Ge("jscomp_symbol_"+(Qe||"")+"_"+$e++,Qe)};return Ye}),fa("Symbol.iterator",function(Ke){if(Ke)return Ke;Ke=Symbol("Symbol.iterator");for(var Ge="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),$e=0;$e<Ge.length;$e++){var Ye=ea[Ge[$e]];typeof Ye=="function"&&typeof Ye.prototype[Ke]!="function"&&aa(Ye.prototype,Ke,{configurable:!0,writable:!0,value:function(){return ia(ha(this))}})}return Ke});var ia=function(Ke){return Ke={next:Ke},Ke[Symbol.iterator]=function(){return this},Ke},ja=function(Ke,Ge){Ke instanceof String&&(Ke+="");var $e=0,Ye=!1,Qe={next:function(){if(!Ye&&$e<Ke.length){var Je=$e++;return{value:Ge(Je,Ke[Je]),done:!1}}return Ye=!0,{done:!0,value:void 0}}};return Qe[Symbol.iterator]=function(){return Qe},Qe};fa("Array.prototype.keys",function(Ke){return Ke||function(){return ja(this,function(Ge){return Ge})}});var m=this||self,ka=function(Ke){var Ge=typeof Ke;return Ge!="object"?Ge:Ke?Array.isArray(Ke)?"array":Ge:"null"},la=function(Ke,Ge,$e){return Ke.call.apply(Ke.bind,arguments)},ma=function(Ke,Ge,$e){if(!Ke)throw Error();if(2<arguments.length){var Ye=Array.prototype.slice.call(arguments,2);return function(){var Qe=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Qe,Ye),Ke.apply(Ge,Qe)}}return function(){return Ke.apply(Ge,arguments)}},na=function(Ke,Ge,$e){return na=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?la:ma,na.apply(null,arguments)},oa=function(Ke,Ge){function $e(){}$e.prototype=Ge.prototype,Ke.ma=Ge.prototype,Ke.prototype=new $e,Ke.prototype.constructor=Ke,Ke.A=function(Ye,Qe,Je){for(var Mt=Array(arguments.length-2),nn=2;nn<arguments.length;nn++)Mt[nn-2]=arguments[nn];return Ge.prototype[Qe].apply(Ye,Mt)}},pa=function(Ke){return Ke},qa=function(Ke){var Ge=null,$e=m.trustedTypes;if(!$e||!$e.createPolicy)return Ge;try{Ge=$e.createPolicy(Ke,{createHTML:pa,createScript:pa,createScriptURL:pa})}catch(Ye){m.console&&m.console.error(Ye.message)}return Ge};function q(Ke){if(Error.captureStackTrace)Error.captureStackTrace(this,q);else{var Ge=Error().stack;Ge&&(this.stack=Ge)}Ke&&(this.message=String(Ke))}oa(q,Error),q.prototype.name="CustomError";var ra=function(Ke,Ge){Ke=Ke.split("%s");for(var $e="",Ye=Ke.length-1,Qe=0;Qe<Ye;Qe++)$e+=Ke[Qe]+(Qe<Ge.length?Ge[Qe]:"%s");q.call(this,$e+Ke[Ye])};oa(ra,q),ra.prototype.name="AssertionError";var sa=function(Ke,Ge,$e,Ye){var Qe="Assertion failed";if($e){Qe+=": "+$e;var Je=Ye}else Ke&&(Qe+=": "+Ke,Je=Ge);throw new ra(""+Qe,Je||[])},ta=function(Ke,Ge,$e){return Ke||sa("",null,Ge,Array.prototype.slice.call(arguments,2)),Ke},ua=function(Ke,Ge){throw new ra("Failure"+(Ke?": "+Ke:""),Array.prototype.slice.call(arguments,1))},va=function(Ke,Ge,$e){typeof Ke!="string"&&sa("Expected string but got %s: %s.",[ka(Ke),Ke],Ge,Array.prototype.slice.call(arguments,2))},xa=function(Ke,Ge){e:{try{var $e=Ke&&Ke.ownerDocument,Ye=$e&&($e.defaultView||$e.parentWindow);if(Ye=Ye||m,Ye.Element&&Ye.Location){var Qe=Ye;break e}}catch{}Qe=null}if(Qe&&typeof Qe[Ge]<"u"&&(!Ke||!(Ke instanceof Qe[Ge])&&(Ke instanceof Qe.Location||Ke instanceof Qe.Element))){if(Qe=typeof Ke,Qe=="object"&&Ke!=null||Qe=="function")try{var Je=Ke.constructor.displayName||Ke.constructor.name||Object.prototype.toString.call(Ke)}catch{Je="<object could not be stringified>"}else Je=Ke===void 0?"undefined":Ke===null?"null":typeof Ke;ua("Argument is not a %s (or a non-Element, non-Location mock); got: %s",Ge,Je)}return Ke},ya,t=function(Ke,Ge){this.P=Ke===za&&Ge||"",this.ca=Aa};t.prototype.J=!0,t.prototype.H=function(){return this.P},t.prototype.toString=function(){return"Const{"+this.P+"}"};var Ba=function(Ke){return Ke instanceof t&&Ke.constructor===t&&Ke.ca===Aa?Ke.P:(ua("expected object of type Const, got '"+Ke+"'"),"type_error:Const")},Aa={},za={},v=function(Ke,Ge){this.N=Ge===Ca?Ke:""};v.prototype.J=!0,v.prototype.H=function(){return this.N.toString()},v.prototype.toString=function(){return"SafeUrl{"+this.N+"}"};var Da=function(Ke){return Ke instanceof v&&Ke.constructor===v?Ke.N:(ua("expected object of type SafeUrl, got '"+Ke+"' of type "+ka(Ke)),"type_error:SafeUrl")},Ea=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i,Fa=function(Ke){return Ke instanceof v?Ke:(Ke=typeof Ke=="object"&&Ke.J?Ke.H():String(Ke),ta(Ea.test(Ke),"%s does not match the safe URL pattern",Ke)||(Ke="about:invalid#zClosurez"),new v(Ke,Ca))},Ca={},w=function(Ke,Ge,$e){this.M=$e===Ga?Ke:""};w.prototype.J=!0,w.prototype.H=function(){return this.M.toString()},w.prototype.toString=function(){return"SafeHtml{"+this.M+"}"};var Ha=function(Ke){return Ke instanceof w&&Ke.constructor===w?Ke.M:(ua("expected object of type SafeHtml, got '"+Ke+"' of type "+ka(Ke)),"type_error:SafeHtml")},Ga={},Ia=new w(m.trustedTypes&&m.trustedTypes.emptyHTML||"",0,Ga),Ja={MATH:!0,SCRIPT:!0,STYLE:!0,SVG:!0,TEMPLATE:!0},Ka=function(Ke){var Ge=!1,$e;return function(){return Ge||($e=Ke(),Ge=!0),$e}}(function(){if(typeof document>"u")return!1;var Ke=document.createElement("div"),Ge=document.createElement("div");return Ge.appendChild(document.createElement("div")),Ke.appendChild(Ge),Ke.firstChild?(Ge=Ke.firstChild.firstChild,Ke.innerHTML=Ha(Ia),!Ge.parentElement):!1}),x=window,z=document,La=x.location,Ma=function(){},Na=/\[native code\]/,A=function(Ke,Ge,$e){return Ke[Ge]=Ke[Ge]||$e},Oa=function(Ke){for(var Ge=0;Ge<this.length;Ge++)if(this[Ge]===Ke)return Ge;return-1},Pa=function(Ke){Ke=Ke.sort();for(var Ge=[],$e=void 0,Ye=0;Ye<Ke.length;Ye++){var Qe=Ke[Ye];Qe!=$e&&Ge.push(Qe),$e=Qe}return Ge},Qa=/&/g,Ra=/</g,Sa=/>/g,Ua=/"/g,Va=/'/g,Wa=function(Ke){return String(Ke).replace(Qa,"&amp;").replace(Ra,"&lt;").replace(Sa,"&gt;").replace(Ua,"&quot;").replace(Va,"&#39;")},B=function(){var Ke;if((Ke=Object.create)&&Na.test(Ke))Ke=Ke(null);else{Ke={};for(var Ge in Ke)Ke[Ge]=void 0}return Ke},C=function(Ke,Ge){return Object.prototype.hasOwnProperty.call(Ke,Ge)},Xa=function(Ke){if(Na.test(Object.keys))return Object.keys(Ke);var Ge=[],$e;for($e in Ke)C(Ke,$e)&&Ge.push($e);return Ge},D=function(Ke,Ge){Ke=Ke||{};for(var $e in Ke)C(Ke,$e)&&(Ge[$e]=Ke[$e])},Ya=function(Ke){return function(){x.setTimeout(Ke,0)}},E=function(Ke,Ge){if(!Ke)throw Error(Ge||"")},F=A(x,"gapi",{}),H=function(Ke,Ge,$e){var Ye=new RegExp("([#].*&|[#])"+Ge+"=([^&#]*)","g");if(Ge=new RegExp("([?#].*&|[?#])"+Ge+"=([^&#]*)","g"),Ke=Ke&&(Ye.exec(Ke)||Ge.exec(Ke)))try{$e=decodeURIComponent(Ke[2])}catch{}return $e},Za=new RegExp(/^/.source+/([a-zA-Z][-+.a-zA-Z0-9]*:)?/.source+/(\/\/[^\/?#]*)?/.source+/([^?#]*)?/.source+/(\?([^#]*))?/.source+/(#((#|[^#])*))?/.source+/$/.source),$a=/[\ud800-\udbff][\udc00-\udfff]|[^!-~]/g,ab=new RegExp(/(%([^0-9a-fA-F%]|[0-9a-fA-F]([^0-9a-fA-F%])?)?)*/.source+/%($|[^0-9a-fA-F]|[0-9a-fA-F]($|[^0-9a-fA-F]))/.source,"g"),bb=/%([a-f]|[0-9a-fA-F][a-f])/g,cb=/^(https?|ftp|file|chrome-extension):$/i,I=function(Ke){Ke=String(Ke),Ke=Ke.replace($a,function(Qe){try{return encodeURIComponent(Qe)}catch{return encodeURIComponent(Qe.replace(/^[^%]+$/g,""))}}).replace(ab,function(Qe){return Qe.replace(/%/g,"%25")}).replace(bb,function(Qe){return Qe.toUpperCase()}),Ke=Ke.match(Za)||[];var Ge=B(),$e=function(Qe){return Qe.replace(/\\/g,"%5C").replace(/\^/g,"%5E").replace(/`/g,"%60").replace(/\{/g,"%7B").replace(/\|/g,"%7C").replace(/\}/g,"%7D")},Ye=!!(Ke[1]||"").match(cb);return Ge.A=$e((Ke[1]||"")+(Ke[2]||"")+(Ke[3]||(Ke[2]&&Ye?"/":""))),Ye=function(Qe){return $e(Qe.replace(/\?/g,"%3F").replace(/#/g,"%23"))},Ge.query=Ke[5]?[Ye(Ke[5])]:[],Ge.g=Ke[7]?[Ye(Ke[7])]:[],Ge},db=function(Ke){return Ke.A+(0<Ke.query.length?"?"+Ke.query.join("&"):"")+(0<Ke.g.length?"#"+Ke.g.join("&"):"")},eb=function(Ke,Ge){var $e=[];if(Ke){for(var Ye in Ke)if(C(Ke,Ye)&&Ke[Ye]!=null){var Qe=Ge?Ge(Ke[Ye]):Ke[Ye];$e.push(encodeURIComponent(Ye)+"="+encodeURIComponent(Qe))}}return $e},fb=function(Ke,Ge,$e,Ye){return Ke=I(Ke),Ke.query.push.apply(Ke.query,eb(Ge,Ye)),Ke.g.push.apply(Ke.g,eb($e,Ye)),db(Ke)},gb=new RegExp(/\/?\??#?/.source+"("+/[\/?#]/i.source+"|"+/[\uD800-\uDBFF]/i.source+"|"+/%[c-f][0-9a-f](%[89ab][0-9a-f]){0,2}(%[89ab]?)?/i.source+"|"+/%[0-9a-f]?/i.source+")$","i"),hb=function(Ke,Ge){var $e=I(Ge);Ge=$e.A,$e.query.length&&(Ge+="?"+$e.query.join("")),$e.g.length&&(Ge+="#"+$e.g.join(""));var Ye="";2e3<Ge.length&&(Ye=Ge,Ge=Ge.substr(0,2e3),Ge=Ge.replace(gb,""),Ye=Ye.substr(Ge.length));var Qe=Ke.createElement("div");if(Ke=Ke.createElement("a"),$e=I(Ge),Ge=$e.A,$e.query.length&&(Ge+="?"+$e.query.join("")),$e.g.length&&(Ge+="#"+$e.g.join("")),Ge=new v(Ge,Ca),xa(Ke,"HTMLAnchorElement"),Ge=Ge instanceof v?Ge:Fa(Ge),Ke.href=Da(Ge),Qe.appendChild(Ke),Ge=Qe.innerHTML,$e=new t(za,"Assignment to self."),va(Ba($e),"must provide justification"),ta(!/^[\s\xa0]*$/.test(Ba($e)),"must provide non-empty justification"),ya===void 0&&(ya=qa("gapi#html")),Ge=($e=ya)?$e.createHTML(Ge):Ge,Ge=new w(Ge,null,Ga),Qe.tagName&&Ja[Qe.tagName.toUpperCase()])throw Error("goog.dom.safe.setInnerHtml cannot be used to set content of "+Qe.tagName+".");if(Ka())for(;Qe.lastChild;)Qe.removeChild(Qe.lastChild);return Qe.innerHTML=Ha(Ge),Ge=String(Qe.firstChild.href),Qe.parentNode&&Qe.parentNode.removeChild(Qe),$e=I(Ge+Ye),Ye=$e.A,$e.query.length&&(Ye+="?"+$e.query.join("")),$e.g.length&&(Ye+="#"+$e.g.join("")),Ye},ib=/^https?:\/\/[^\/%\\?#\s]+\/[^\s]*$/i,jb=function(Ke,Ge,$e,Ye){x[$e+"EventListener"]?x[$e+"EventListener"](Ke,Ge,!1):x[Ye+"tachEvent"]&&x[Ye+"tachEvent"]("on"+Ke,Ge)},kb=function(){var Ke=z.readyState;return Ke==="complete"||Ke==="interactive"&&navigator.userAgent.indexOf("MSIE")==-1},nb=function(Ke){var Ge=lb;if(!kb())try{Ge()}catch{}mb(Ke)},mb=function(Ke){if(kb())Ke();else{var Ge=!1,$e=function(){if(!Ge)return Ge=!0,Ke.apply(this,arguments)};x.addEventListener?(x.addEventListener("load",$e,!1),x.addEventListener("DOMContentLoaded",$e,!1)):x.attachEvent&&(x.attachEvent("onreadystatechange",function(){kb()&&$e.apply(this,arguments)}),x.attachEvent("onload",$e))}},ob=function(Ke){for(;Ke.firstChild;)Ke.removeChild(Ke.firstChild)},pb={button:!0,div:!0,span:!0},K;K=A(x,"___jsl",B()),A(K,"I",0),A(K,"hel",10);var qb=function(Ke){return K.dpo?K.h:H(Ke,"jsh",K.h)},rb=function(Ke){var Ge=A(K,"sws",[]);Ge.push.apply(Ge,Ke)},sb=function(Ke){return A(K,"watt",B())[Ke]},tb=function(Ke){var Ge=A(K,"PQ",[]);K.PQ=[];var $e=Ge.length;if($e===0)Ke();else for(var Ye=0,Qe=function(){++Ye===$e&&Ke()},Je=0;Je<$e;Je++)Ge[Je](Qe)},ub=function(Ke){return A(A(K,"H",B()),Ke,B())},vb=A(K,"perf",B()),wb=A(vb,"g",B()),xb=A(vb,"i",B());A(vb,"r",[]),B(),B();var yb=function(Ke,Ge,$e){var Ye=vb.r;typeof Ye=="function"?Ye(Ke,Ge,$e):Ye.push([Ke,Ge,$e])},L=function(Ke,Ge,$e){wb[Ke]=!Ge&&wb[Ke]||$e||new Date().getTime(),yb(Ke)},Ab=function(Ke,Ge,$e){Ge&&0<Ge.length&&(Ge=zb(Ge),$e&&0<$e.length&&(Ge+="___"+zb($e)),28<Ge.length&&(Ge=Ge.substr(0,28)+(Ge.length-28)),$e=Ge,Ge=A(xb,"_p",B()),A(Ge,$e,B())[Ke]=new Date().getTime(),yb(Ke,"_p",$e))},zb=function(Ke){return Ke.join("__").replace(/\./g,"_").replace(/\-/g,"_").replace(/,/g,"_")},Bb=B(),N=[],O=function(Ke){throw Error("Bad hint"+(Ke?": "+Ke:""))};N.push(["jsl",function(Ke){for(var Ge in Ke)if(C(Ke,Ge)){var $e=Ke[Ge];typeof $e=="object"?K[Ge]=A(K,Ge,[]).concat($e):A(K,Ge,$e)}(Ge=Ke.u)&&(Ke=A(K,"us",[]),Ke.push(Ge),(Ge=/^https:(.*)$/.exec(Ge))&&Ke.push("http:"+Ge[1]))}]);var Cb=/^(\/[a-zA-Z0-9_\-]+)+$/,Db=[/\/amp\//,/\/amp$/,/^\/amp$/],Eb=/^[a-zA-Z0-9\-_\.,!]+$/,Fb=/^gapi\.loaded_[0-9]+$/,Gb=/^[a-zA-Z0-9,._-]+$/,Kb=function(Ke,Ge,$e,Ye){var Qe=Ke.split(";"),Je=Qe.shift(),Mt=Bb[Je],nn=null;return Mt?nn=Mt(Qe,Ge,$e,Ye):O("no hint processor for: "+Je),nn||O("failed to generate load url"),Ge=nn,$e=Ge.match(Hb),(Ye=Ge.match(Ib))&&Ye.length===1&&Jb.test(Ge)&&$e&&$e.length===1||O("failed sanity: "+Ke),nn},Nb=function(Ke,Ge,$e,Ye){Ke=Lb(Ke),Fb.test($e)||O("invalid_callback"),Ge=Mb(Ge),Ye=Ye&&Ye.length?Mb(Ye):null;var Qe=function(Je){return encodeURIComponent(Je).replace(/%2C/g,",")};return[encodeURIComponent(Ke.pathPrefix).replace(/%2C/g,",").replace(/%2F/g,"/"),"/k=",Qe(Ke.version),"/m=",Qe(Ge),Ye?"/exm="+Qe(Ye):"","/rt=j/sv=1/d=1/ed=1",Ke.S?"/am="+Qe(Ke.S):"",Ke.Z?"/rs="+Qe(Ke.Z):"",Ke.aa?"/t="+Qe(Ke.aa):"","/cb=",Qe($e)].join("")},Lb=function(Ke){Ke.charAt(0)!=="/"&&O("relative path");for(var Ge=Ke.substring(1).split("/"),$e=[];Ge.length;){if(Ke=Ge.shift(),!Ke.length||Ke.indexOf(".")==0)O("empty/relative directory");else if(0<Ke.indexOf("=")){Ge.unshift(Ke);break}$e.push(Ke)}Ke={};for(var Ye=0,Qe=Ge.length;Ye<Qe;++Ye){var Je=Ge[Ye].split("="),Mt=decodeURIComponent(Je[0]),nn=decodeURIComponent(Je[1]);Je.length==2&&Mt&&nn&&(Ke[Mt]=Ke[Mt]||nn)}for(Ge="/"+$e.join("/"),Cb.test(Ge)||O("invalid_prefix"),$e=0,Ye=Db.length;$e<Ye;++$e)Db[$e].test(Ge)&&O("invalid_prefix");return $e=Ob(Ke,"k",!0),Ye=Ob(Ke,"am"),Qe=Ob(Ke,"rs"),Ke=Ob(Ke,"t"),{pathPrefix:Ge,version:$e,S:Ye,Z:Qe,aa:Ke}},Mb=function(Ke){for(var Ge=[],$e=0,Ye=Ke.length;$e<Ye;++$e){var Qe=Ke[$e].replace(/\./g,"_").replace(/-/g,"_");Gb.test(Qe)&&Ge.push(Qe)}return Ge.join(",")},Ob=function(Ke,Ge,$e){if(Ke=Ke[Ge],!Ke&&$e&&O("missing: "+Ge),Ke){if(Eb.test(Ke))return Ke;O("invalid: "+Ge)}return null},Jb=/^https?:\/\/[a-z0-9_.-]+\.google(rs)?\.com(:\d+)?\/[a-zA-Z0-9_.,!=\-\/]+$/,Ib=/\/cb=/g,Hb=/\/\//g,Pb=function(){var Ke=qb(La.href);if(!Ke)throw Error("Bad hint");return Ke};Bb.m=function(Ke,Ge,$e,Ye){return(Ke=Ke[0])||O("missing_hint"),"https://apis.google.com"+Nb(Ke,Ge,$e,Ye)};var Qb=decodeURI("%73cript"),Rb=/^[-+_0-9\/A-Za-z]+={0,2}$/,Sb=function(Ke,Ge){for(var $e=[],Ye=0;Ye<Ke.length;++Ye){var Qe=Ke[Ye];Qe&&0>Oa.call(Ge,Qe)&&$e.push(Qe)}return $e},Tb=function(){var Ke=K.nonce;return Ke!==void 0?Ke&&Ke===String(Ke)&&Ke.match(Rb)?Ke:K.nonce=null:z.querySelector&&(Ke=z.querySelector("script[nonce]"))?(Ke=Ke.nonce||Ke.getAttribute("nonce")||"",Ke&&Ke===String(Ke)&&Ke.match(Rb)?K.nonce=Ke:K.nonce=null):null},Wb=function(Ke){if(z.readyState!="loading")Ub(Ke);else{var Ge=Tb(),$e="";Ge!==null&&($e=' nonce="'+Ge+'"'),Ke="<"+Qb+' src="'+encodeURI(Ke)+'"'+$e+"></"+Qb+">",z.write(Vb?Vb.createHTML(Ke):Ke)}},Ub=function(Ke){var Ge=z.createElement(Qb);Ge.setAttribute("src",Vb?Vb.createScriptURL(Ke):Ke),Ke=Tb(),Ke!==null&&Ge.setAttribute("nonce",Ke),Ge.async="true",(Ke=z.getElementsByTagName(Qb)[0])?Ke.parentNode.insertBefore(Ge,Ke):(z.head||z.body||z.documentElement).appendChild(Ge)},Xb=function(Ke,Ge){var $e=Ge&&Ge._c;if($e)for(var Ye=0;Ye<N.length;Ye++){var Qe=N[Ye][0],Je=N[Ye][1];Je&&C($e,Qe)&&Je($e[Qe],Ke,Ge)}},Zb=function(Ke,Ge,$e){Yb(function(){var Ye=Ge===qb(La.href)?A(F,"_",B()):B();Ye=A(ub(Ge),"_",Ye),Ke(Ye)},$e)},ac=function(Ke,Ge){var $e=Ge||{};typeof Ge=="function"&&($e={},$e.callback=Ge),Xb(Ke,$e),Ge=Ke?Ke.split(":"):[];var Ye=$e.h||Pb(),Qe=A(K,"ah",B());if(Qe["::"]&&Ge.length){Ke=[];for(var Je=null;Je=Ge.shift();){var Mt=Je.split(".");Mt=Qe[Je]||Qe[Mt[1]&&"ns:"+Mt[0]||""]||Ye;var nn=Ke.length&&Ke[Ke.length-1]||null,an=nn;nn&&nn.hint==Mt||(an={hint:Mt,V:[]},Ke.push(an)),an.V.push(Je)}var sn=Ke.length;if(1<sn){var ln=$e.callback;ln&&($e.callback=function(){--sn==0&&ln()})}for(;Ge=Ke.shift();)$b(Ge.V,$e,Ge.hint)}else $b(Ge||[],$e,Ye)},$b=function(Ke,Ge,$e){Ke=Pa(Ke)||[];var Ye=Ge.callback,Qe=Ge.config,Je=Ge.timeout,Mt=Ge.ontimeout,nn=Ge.onerror,an=void 0;typeof nn=="function"&&(an=nn);var sn=null,ln=!1;if(Je&&!Mt||!Je&&Mt)throw"Timeout requires both the timeout parameter and ontimeout parameter to be set";nn=A(ub($e),"r",[]).sort();var fn=A(ub($e),"L",[]).sort(),hn=[].concat(nn),Xr=function(ho,mo){if(ln)return 0;x.clearTimeout(sn),fn.push.apply(fn,Mi);var _d=((F||{}).config||{}).update;if(_d?_d(Qe):Qe&&A(K,"cu",[]).push(Qe),mo){Ab("me0",ho,hn);try{Zb(mo,$e,an)}finally{Ab("me1",ho,hn)}}return 1};0<Je&&(sn=x.setTimeout(function(){ln=!0,Mt()},Je));var Mi=Sb(Ke,fn);if(Mi.length){Mi=Sb(Ke,nn);var co=A(K,"CP",[]),lo=co.length;if(co[lo]=function(ho){if(!ho)return 0;Ab("ml1",Mi,hn);var mo=function(ep){co[lo]=null,Xr(Mi,ho)&&tb(function(){Ye&&Ye(),ep()})},_d=function(){var ep=co[lo+1];ep&&ep()};0<lo&&co[lo-1]?co[lo]=function(){mo(_d)}:mo(_d)},Mi.length){var uo="loaded_"+K.I++;F[uo]=function(ho){co[lo](ho),F[uo]=null},Ke=Kb($e,Mi,"gapi."+uo,nn),nn.push.apply(nn,Mi),Ab("ml0",Mi,hn),Ge.sync||x.___gapisync?Wb(Ke):Ub(Ke)}else co[lo](Ma)}else Xr(Mi)&&Ye&&Ye()},Vb=qa("gapi#gapi"),Yb=function(Ke,Ge){if(K.hee&&0<K.hel)try{return Ke()}catch($e){Ge&&Ge($e),K.hel--,ac("debug_error",function(){try{window.___jsl.hefn($e)}catch{throw $e}})}else try{return Ke()}catch($e){throw Ge&&Ge($e),$e}};F.load=function(Ke,Ge){return Yb(function(){return ac(Ke,Ge)})};var bc=function(Ke){var Ge=window.___jsl=window.___jsl||{};return Ge[Ke]=Ge[Ke]||[],Ge[Ke]},cc=function(Ke){var Ge=window.___jsl=window.___jsl||{};return Ge.cfg=!Ke&&Ge.cfg||{},Ge.cfg},dc=function(Ke){return typeof Ke=="object"&&/\[native code\]/.test(Ke.push)},P=function(Ke,Ge,$e){if(Ge&&typeof Ge=="object")for(var Ye in Ge)!Object.prototype.hasOwnProperty.call(Ge,Ye)||$e&&Ye==="___goc"&&typeof Ge[Ye]>"u"||(Ke[Ye]&&Ge[Ye]&&typeof Ke[Ye]=="object"&&typeof Ge[Ye]=="object"&&!dc(Ke[Ye])&&!dc(Ge[Ye])?P(Ke[Ye],Ge[Ye]):Ge[Ye]&&typeof Ge[Ye]=="object"?(Ke[Ye]=dc(Ge[Ye])?[]:{},P(Ke[Ye],Ge[Ye])):Ke[Ye]=Ge[Ye])},ec=function(Ke){if(Ke&&!/^\s+$/.test(Ke)){for(;Ke.charCodeAt(Ke.length-1)==0;)Ke=Ke.substring(0,Ke.length-1);try{var Ge=window.JSON.parse(Ke)}catch{}if(typeof Ge=="object")return Ge;try{Ge=new Function("return ("+Ke+`
)`)()}catch{}if(typeof Ge=="object")return Ge;try{Ge=new Function("return ({"+Ke+`
})`)()}catch{}return typeof Ge=="object"?Ge:{}}},fc=function(Ke,Ge){var $e={___goc:void 0};Ke.length&&Ke[Ke.length-1]&&Object.hasOwnProperty.call(Ke[Ke.length-1],"___goc")&&typeof Ke[Ke.length-1].___goc>"u"&&($e=Ke.pop()),P($e,Ge),Ke.push($e)},gc=function(Ke){cc(!0);var Ge=window.___gcfg,$e=bc("cu"),Ye=window.___gu;Ge&&Ge!==Ye&&(fc($e,Ge),window.___gu=Ge),Ge=bc("cu");var Qe=document.scripts||document.getElementsByTagName("script")||[];Ye=[];var Je=[];Je.push.apply(Je,bc("us"));for(var Mt=0;Mt<Qe.length;++Mt)for(var nn=Qe[Mt],an=0;an<Je.length;++an)nn.src&&nn.src.indexOf(Je[an])==0&&Ye.push(nn);for(Ye.length==0&&0<Qe.length&&Qe[Qe.length-1].src&&Ye.push(Qe[Qe.length-1]),Qe=0;Qe<Ye.length;++Qe)Ye[Qe].getAttribute("gapi_processed")||(Ye[Qe].setAttribute("gapi_processed",!0),(Je=Ye[Qe])?(Mt=Je.nodeType,Je=Mt==3||Mt==4?Je.nodeValue:Je.textContent||Je.innerText||Je.innerHTML||""):Je=void 0,(Je=ec(Je))&&Ge.push(Je));for(Ke&&fc($e,Ke),Ye=bc("cd"),Ke=0,Ge=Ye.length;Ke<Ge;++Ke)P(cc(),Ye[Ke],!0);for(Ye=bc("ci"),Ke=0,Ge=Ye.length;Ke<Ge;++Ke)P(cc(),Ye[Ke],!0);for(Ke=0,Ge=$e.length;Ke<Ge;++Ke)P(cc(),$e[Ke],!0)},Q=function(Ke){var Ge=cc();if(!Ke)return Ge;Ke=Ke.split("/");for(var $e=0,Ye=Ke.length;Ge&&typeof Ge=="object"&&$e<Ye;++$e)Ge=Ge[Ke[$e]];return $e===Ke.length&&Ge!==void 0?Ge:void 0},hc=function(Ke,Ge){var $e;if(typeof Ke=="string"){var Ye=$e={};Ke=Ke.split("/");for(var Qe=0,Je=Ke.length;Qe<Je-1;++Qe){var Mt={};Ye=Ye[Ke[Qe]]=Mt}Ye[Ke[Qe]]=Ge}else $e=Ke;gc($e)},ic=function(){var Ke=window.__GOOGLEAPIS;Ke&&(Ke.googleapis&&!Ke["googleapis.config"]&&(Ke["googleapis.config"]=Ke.googleapis),A(K,"ci",[]).push(Ke),window.__GOOGLEAPIS=void 0)},jc={callback:1,clientid:1,cookiepolicy:1,openidrealm:-1,includegrantedscopes:-1,requestvisibleactions:1,scope:1},kc=!1,lc=B(),mc=function(){if(!kc){for(var Ke=document.getElementsByTagName("meta"),Ge=0;Ge<Ke.length;++Ge){var $e=Ke[Ge].name.toLowerCase();if($e.lastIndexOf("google-signin-",0)==0){$e=$e.substring(14);var Ye=Ke[Ge].content;jc[$e]&&Ye&&(lc[$e]=Ye)}}if(window.self!==window.top){Ke=document.location.toString();for(var Qe in jc)0<jc[Qe]&&(Ge=H(Ke,Qe,""))&&(lc[Qe]=Ge)}kc=!0}return Qe=B(),D(lc,Qe),Qe},nc=function(Ke){return!!(Ke.clientid&&Ke.scope&&Ke.callback)},oc=window.console,pc=function(Ke){oc&&oc.log&&oc.log(Ke)},qc=function(){return!!K.oa},rc=function(){},R=A(K,"rw",B()),sc=function(Ke){for(var Ge in R)Ke(R[Ge])},tc=function(Ke,Ge){(Ke=R[Ke])&&Ke.state<Ge&&(Ke.state=Ge)},vc=/^https?:\/\/(?:\w|[\-\.])+\.google\.(?:\w|[\-:\.])+(?:\/[^\?#]*)?\/u\/(\d)\//,wc=/^https?:\/\/(?:\w|[\-\.])+\.google\.(?:\w|[\-:\.])+(?:\/[^\?#]*)?\/b\/(\d{10,21})\//,xc=function(Ke){var Ge=Q("googleapis.config/sessionIndex");if(typeof Ge=="string"&&254<Ge.length&&(Ge=null),Ge==null&&(Ge=window.__X_GOOG_AUTHUSER),typeof Ge=="string"&&254<Ge.length&&(Ge=null),Ge==null){var $e=window.google;$e&&(Ge=$e.authuser)}return typeof Ge=="string"&&254<Ge.length&&(Ge=null),Ge==null&&(Ke=Ke||window.location.href,Ge=H(Ke,"authuser")||null,Ge==null&&(Ge=(Ge=Ke.match(vc))?Ge[1]:null)),Ge==null?null:(Ge=String(Ge),254<Ge.length&&(Ge=null),Ge)},yc=function(Ke){var Ge=Q("googleapis.config/sessionDelegate");return typeof Ge=="string"&&21<Ge.length&&(Ge=null),Ge==null&&(Ge=(Ke=(Ke||window.location.href).match(wc))?Ke[1]:null),Ge==null?null:(Ge=String(Ge),21<Ge.length&&(Ge=null),Ge)},zc,S,T=void 0,U=function(Ke){try{return m.JSON.parse.call(m.JSON,Ke)}catch{return!1}},V=function(Ke){return Object.prototype.toString.call(Ke)},Ac=V(0),Bc=V(new Date(0)),Cc=V(!0),Dc=V(""),Ec=V({}),Fc=V([]),W=function(Ke,Ge){if(Ge){for(var $e=0,Ye=Ge.length;$e<Ye;++$e)if(Ke===Ge[$e])throw new TypeError("Converting circular structure to JSON")}if(Ye=typeof Ke,Ye!=="undefined"){$e=Array.prototype.slice.call(Ge||[],0),$e[$e.length]=Ke,Ge=[];var Qe=V(Ke);if(Ke!=null&&typeof Ke.toJSON=="function"&&(Object.prototype.hasOwnProperty.call(Ke,"toJSON")||(Qe!==Fc||Ke.constructor!==Array&&Ke.constructor!==Object)&&(Qe!==Ec||Ke.constructor!==Array&&Ke.constructor!==Object)&&Qe!==Dc&&Qe!==Ac&&Qe!==Cc&&Qe!==Bc))return W(Ke.toJSON.call(Ke),$e);if(Ke==null)Ge[Ge.length]="null";else if(Qe===Ac)Ke=Number(Ke),isNaN(Ke)||isNaN(Ke-Ke)?Ke="null":Ke===-0&&0>1/Ke&&(Ke="-0"),Ge[Ge.length]=String(Ke);else if(Qe===Cc)Ge[Ge.length]=String(!!Number(Ke));else{if(Qe===Bc)return W(Ke.toISOString.call(Ke),$e);if(Qe===Fc&&V(Ke.length)===Ac){Ge[Ge.length]="[";var Je=0;for(Ye=Number(Ke.length)>>0;Je<Ye;++Je)Je&&(Ge[Ge.length]=","),Ge[Ge.length]=W(Ke[Je],$e)||"null";Ge[Ge.length]="]"}else if(Qe==Dc&&V(Ke.length)===Ac){for(Ge[Ge.length]='"',Je=0,$e=Number(Ke.length)>>0;Je<$e;++Je)Ye=String.prototype.charAt.call(Ke,Je),Qe=String.prototype.charCodeAt.call(Ke,Je),Ge[Ge.length]=Ye==="\b"?"\\b":Ye==="\f"?"\\f":Ye===`
`?"\\n":Ye==="\r"?"\\r":Ye==="	"?"\\t":Ye==="\\"||Ye==='"'?"\\"+Ye:31>=Qe?"\\u"+(Qe+65536).toString(16).substr(1):32<=Qe&&65535>=Qe?Ye:"";Ge[Ge.length]='"'}else if(Ye==="object"){Ge[Ge.length]="{",Ye=0;for(Je in Ke)Object.prototype.hasOwnProperty.call(Ke,Je)&&(Qe=W(Ke[Je],$e),Qe!==void 0&&(Ye++&&(Ge[Ge.length]=","),Ge[Ge.length]=W(Je),Ge[Ge.length]=":",Ge[Ge.length]=Qe));Ge[Ge.length]="}"}else return}return Ge.join("")}},Gc=/[\0-\x07\x0b\x0e-\x1f]/,Hc=/^([^"]*"([^\\"]|\\.)*")*[^"]*"([^"\\]|\\.)*[\0-\x1f]/,Ic=/^([^"]*"([^\\"]|\\.)*")*[^"]*"([^"\\]|\\.)*\\[^\\\/"bfnrtu]/,Jc=/^([^"]*"([^\\"]|\\.)*")*[^"]*"([^"\\]|\\.)*\\u([0-9a-fA-F]{0,3}[^0-9a-fA-F])/,Kc=/"([^\0-\x1f\\"]|\\[\\\/"bfnrt]|\\u[0-9a-fA-F]{4})*"/g,Lc=/-?(0|[1-9][0-9]*)(\.[0-9]+)?([eE][-+]?[0-9]+)?/g,Mc=/[ \t\n\r]+/g,Nc=/[^"]:/,Oc=/""/g,Pc=/true|false|null/g,Qc=/00/,Rc=/[\{]([^0\}]|0[^:])/,Sc=/(^|\[)[,:]|[,:](\]|\}|[,:]|$)/,Tc=/[^\[,:][\[\{]/,Uc=/^(\{|\}|\[|\]|,|:|0)+/,Vc=/\u2028/g,Wc=/\u2029/g,Xc=function(a){if(a=String(a),Gc.test(a)||Hc.test(a)||Ic.test(a)||Jc.test(a))return!1;var b=a.replace(Kc,'""');if(b=b.replace(Lc,"0"),b=b.replace(Mc,""),Nc.test(b)||(b=b.replace(Oc,"0"),b=b.replace(Pc,"0"),Qc.test(b)||Rc.test(b)||Sc.test(b)||Tc.test(b)||!b||(b=b.replace(Uc,""))))return!1;a=a.replace(Vc,"\\u2028").replace(Wc,"\\u2029"),b=void 0;try{b=T?[U(a)]:eval(`(function (var_args) {
  return Array.prototype.slice.call(arguments, 0);
})(
`+a+`
)`)}catch(Ke){return!1}return b&&b.length===1?b[0]:!1},Yc=function(){var Ke=((m.document||{}).scripts||[]).length;if((zc===void 0||T===void 0||S!==Ke)&&S!==-1){zc=T=!1,S=-1;try{try{T=!!m.JSON&&m.JSON.stringify.call(m.JSON,{a:[3,!0,new Date(0)],c:function(){}})==='{"a":[3,true,"1970-01-01T00:00:00.000Z"]}'&&U("true")===!0&&U('[{"a":3}]')[0].a===3}catch{}zc=T&&!U("[00]")&&!U('"\x07"')&&!U('"\\0"')&&!U('"\\v"')}finally{S=Ke}}},Zc=function(Ke){return S===-1?!1:(Yc(),(zc?U:Xc)(Ke))},$c=function(Ke){if(S!==-1)return Yc(),T?m.JSON.stringify.call(m.JSON,Ke):W(Ke)},ad=!Date.prototype.toISOString||typeof Date.prototype.toISOString!="function"||new Date(0).toISOString()!=="1970-01-01T00:00:00.000Z",bd=function(){var Ke=Date.prototype.getUTCFullYear.call(this);return[0>Ke?"-"+String(1e6-Ke).substr(1):9999>=Ke?String(1e4+Ke).substr(1):"+"+String(1e6+Ke).substr(1),"-",String(101+Date.prototype.getUTCMonth.call(this)).substr(1),"-",String(100+Date.prototype.getUTCDate.call(this)).substr(1),"T",String(100+Date.prototype.getUTCHours.call(this)).substr(1),":",String(100+Date.prototype.getUTCMinutes.call(this)).substr(1),":",String(100+Date.prototype.getUTCSeconds.call(this)).substr(1),".",String(1e3+Date.prototype.getUTCMilliseconds.call(this)).substr(1),"Z"].join("")};Date.prototype.toISOString=ad?bd:Date.prototype.toISOString;var cd=function(){this.j=-1},dd=function(){this.j=64,this.b=[],this.G=[],this.da=[],this.C=[],this.C[0]=128;for(var Ke=1;Ke<this.j;++Ke)this.C[Ke]=0;this.D=this.o=0,this.reset()};oa(dd,cd),dd.prototype.reset=function(){this.b[0]=1732584193,this.b[1]=4023233417,this.b[2]=2562383102,this.b[3]=271733878,this.b[4]=3285377520,this.D=this.o=0};var ed=function(Ke,Ge,$e){$e||($e=0);var Ye=Ke.da;if(typeof Ge=="string")for(var Qe=0;16>Qe;Qe++)Ye[Qe]=Ge.charCodeAt($e)<<24|Ge.charCodeAt($e+1)<<16|Ge.charCodeAt($e+2)<<8|Ge.charCodeAt($e+3),$e+=4;else for(Qe=0;16>Qe;Qe++)Ye[Qe]=Ge[$e]<<24|Ge[$e+1]<<16|Ge[$e+2]<<8|Ge[$e+3],$e+=4;for(Qe=16;80>Qe;Qe++){var Je=Ye[Qe-3]^Ye[Qe-8]^Ye[Qe-14]^Ye[Qe-16];Ye[Qe]=(Je<<1|Je>>>31)&4294967295}Ge=Ke.b[0],$e=Ke.b[1];var Mt=Ke.b[2],nn=Ke.b[3],an=Ke.b[4];for(Qe=0;80>Qe;Qe++){if(40>Qe)if(20>Qe){Je=nn^$e&(Mt^nn);var sn=1518500249}else Je=$e^Mt^nn,sn=1859775393;else 60>Qe?(Je=$e&Mt|nn&($e|Mt),sn=2400959708):(Je=$e^Mt^nn,sn=3395469782);Je=(Ge<<5|Ge>>>27)+Je+an+sn+Ye[Qe]&4294967295,an=nn,nn=Mt,Mt=($e<<30|$e>>>2)&4294967295,$e=Ge,Ge=Je}Ke.b[0]=Ke.b[0]+Ge&4294967295,Ke.b[1]=Ke.b[1]+$e&4294967295,Ke.b[2]=Ke.b[2]+Mt&4294967295,Ke.b[3]=Ke.b[3]+nn&4294967295,Ke.b[4]=Ke.b[4]+an&4294967295};dd.prototype.update=function(Ke,Ge){if(Ke!=null){Ge===void 0&&(Ge=Ke.length);for(var $e=Ge-this.j,Ye=0,Qe=this.G,Je=this.o;Ye<Ge;){if(Je==0)for(;Ye<=$e;)ed(this,Ke,Ye),Ye+=this.j;if(typeof Ke=="string"){for(;Ye<Ge;)if(Qe[Je]=Ke.charCodeAt(Ye),++Je,++Ye,Je==this.j){ed(this,Qe),Je=0;break}}else for(;Ye<Ge;)if(Qe[Je]=Ke[Ye],++Je,++Ye,Je==this.j){ed(this,Qe),Je=0;break}}this.o=Je,this.D+=Ge}},dd.prototype.digest=function(){var Ke=[],Ge=8*this.D;56>this.o?this.update(this.C,56-this.o):this.update(this.C,this.j-(this.o-56));for(var $e=this.j-1;56<=$e;$e--)this.G[$e]=Ge&255,Ge/=256;for(ed(this,this.G),$e=Ge=0;5>$e;$e++)for(var Ye=24;0<=Ye;Ye-=8)Ke[Ge]=this.b[$e]>>Ye&255,++Ge;return Ke};var fd=function(){this.O=new dd};fd.prototype.reset=function(){this.O.reset()};var gd=x.crypto,hd=!1,id=0,jd=0,kd=1,ld=0,md="",nd=function(Ke){Ke=Ke||x.event;var Ge=Ke.screenX+Ke.clientX<<16;Ge+=Ke.screenY+Ke.clientY,Ge*=new Date().getTime()%1e6,kd=kd*Ge%ld,0<id&&++jd==id&&jb("mousemove",nd,"remove","de")},od=function(Ke){var Ge=new fd;Ke=unescape(encodeURIComponent(Ke));for(var $e=[],Ye=0,Qe=Ke.length;Ye<Qe;++Ye)$e.push(Ke.charCodeAt(Ye));for(Ge.O.update($e),Ge=Ge.O.digest(),Ke="",$e=0;$e<Ge.length;$e++)Ke+="0123456789ABCDEF".charAt(Math.floor(Ge[$e]/16))+"0123456789ABCDEF".charAt(Ge[$e]%16);return Ke};hd=!!gd&&typeof gd.getRandomValues=="function",hd||(ld=1e6*(screen.width*screen.width+screen.height),md=od(z.cookie+"|"+z.location+"|"+new Date().getTime()+"|"+Math.random()),id=Q("random/maxObserveMousemove")||0,id!=0&&jb("mousemove",nd,"add","at"));var pd=function(){var Ke=kd;return Ke+=parseInt(md.substr(0,20),16),md=od(md),Ke/(ld+Math.pow(16,20))},qd=function(){var Ke=new x.Uint32Array(1);return gd.getRandomValues(Ke),+("0."+Ke[0])},rd=function(){var Ke=K.onl;if(!Ke){Ke=B(),K.onl=Ke;var Ge=B();Ke.e=function($e){var Ye=Ge[$e];Ye&&(delete Ge[$e],Ye())},Ke.a=function($e,Ye){Ge[$e]=Ye},Ke.r=function($e){delete Ge[$e]}}return Ke},sd=function(Ke,Ge){return Ge=Ge.onload,typeof Ge=="function"?(rd().a(Ke,Ge),Ge):null},td=function(Ke){return E(/^\w+$/.test(Ke),"Unsupported id - "+Ke),rd(),'onload="window.___jsl.onl.e(&#34;'+Ke+'&#34;)"'},ud=function(Ke){rd().r(Ke)},vd={allowtransparency:"true",frameborder:"0",hspace:"0",marginheight:"0",marginwidth:"0",scrolling:"no",style:"",tabindex:"0",vspace:"0",width:"100%"},wd={allowtransparency:!0,onload:!0},xd=0,yd=function(Ke){E(!Ke||ib.test(Ke),"Illegal url for new iframe - "+Ke)},zd=function(Ke,Ge,$e,Ye,Qe){yd($e.src);var Je,Mt=sd(Ye,$e),nn=Mt?td(Ye):"";try{document.all&&(Je=Ke.createElement('<iframe frameborder="'+Wa(String($e.frameborder))+'" scrolling="'+Wa(String($e.scrolling))+'" '+nn+' name="'+Wa(String($e.name))+'"/>'))}catch{}finally{Je||(Je=Ke.createElement("iframe"),Mt&&(Je.onload=function(){Je.onload=null,Mt.call(this)},ud(Ye)))}Je.setAttribute("ng-non-bindable","");for(var an in $e)Ke=$e[an],an==="style"&&typeof Ke=="object"?D(Ke,Je.style):wd[an]||Je.setAttribute(an,String(Ke));return(an=Qe&&Qe.beforeNode||null)||Qe&&Qe.dontclear||ob(Ge),Ge.insertBefore(Je,an),Je=an?an.previousSibling:Ge.lastChild,$e.allowtransparency&&(Je.allowTransparency=!0),Je},Ad=/^:[\w]+$/,Bd=/:([a-zA-Z_]+):/g,Cd=function(){var Ke=xc()||"0",Ge=yc(),$e=xc(void 0)||Ke,Ye=yc(void 0),Qe="";$e&&(Qe+="u/"+encodeURIComponent(String($e))+"/"),Ye&&(Qe+="b/"+encodeURIComponent(String(Ye))+"/"),$e=Qe||null,(Qe=(Ye=Q("isLoggedIn")===!1)?"_/im/":"")&&($e="");var Je=Q("iframes/:socialhost:"),Mt=Q("iframes/:im_socialhost:");return{socialhost:Je,ctx_socialhost:Ye?Mt:Je,session_index:Ke,session_delegate:Ge,session_prefix:$e,im_prefix:Qe}},Dd=function(Ke,Ge){return Cd()[Ge]||""},Ed=function(Ke){return function(Ge,$e){return Ke?Cd()[$e]||Ke[$e]||"":Cd()[$e]||""}},Fd=function(Ke){var Ge;return Ke.match(/^https?%3A/i)&&(Ge=decodeURIComponent(Ke)),hb(document,Ge||Ke)},Gd=function(Ke){Ke=Ke||"canonical";for(var Ge=document.getElementsByTagName("link"),$e=0,Ye=Ge.length;$e<Ye;$e++){var Qe=Ge[$e],Je=Qe.getAttribute("rel");if(Je&&Je.toLowerCase()==Ke&&(Qe=Qe.getAttribute("href"))&&(Qe=Fd(Qe))&&Qe.match(/^https?:\/\/[\w\-_\.]+/i)!=null)return Qe}return window.location.href},Hd={se:"0"},Id={post:!0},Jd={style:"position:absolute;top:-10000px;width:450px;margin:0px;border-style:none"},Kd="onPlusOne _ready _close _open _resizeMe _renderstart oncircled drefresh erefresh".split(" "),Ld=A(K,"WI",B()),Md=function(Ke,Ge,$e){var Ye,Qe={},Je=Ye=Ke;Ke=="plus"&&Ge.action&&(Ye=Ke+"_"+Ge.action,Je=Ke+"/"+Ge.action),(Ye=Q("iframes/"+Ye+"/url"))||(Ye=":im_socialhost:/:session_prefix::im_prefix:_/widget/render/"+Je+"?usegapi=1");for(var Mt in Hd)Qe[Mt]=Mt+"/"+(Ge[Mt]||Hd[Mt])+"/";if(Qe=hb(z,Ye.replace(Bd,Ed(Qe))),Mt="iframes/"+Ke+"/params/",Je={},D(Ge,Je),(Ye=Q("lang")||Q("gwidget/lang"))&&(Je.hl=Ye),Id[Ke]||(Je.origin=window.location.origin||window.location.protocol+"//"+window.location.host),Je.exp=Q(Mt+"exp"),Mt=Q(Mt+"location"))for(Ye=0;Ye<Mt.length;Ye++){var nn=Mt[Ye];Je[nn]=x.location[nn]}switch(Ke){case"plus":case"follow":Mt=Je.href,Ye=Ge.action?void 0:"publisher",Mt=(Mt=typeof Mt=="string"?Mt:void 0)?Fd(Mt):Gd(Ye),Je.url=Mt,delete Je.href;break;case"plusone":Mt=(Mt=Ge.href)?Fd(Mt):Gd(),Je.url=Mt,Mt=Ge.db,Ye=Q(),Mt==null&&Ye&&(Mt=Ye.db,Mt==null&&(Mt=Ye.gwidget&&Ye.gwidget.db)),Je.db=Mt||void 0,Mt=Ge.ecp,Ye=Q(),Mt==null&&Ye&&(Mt=Ye.ecp,Mt==null&&(Mt=Ye.gwidget&&Ye.gwidget.ecp)),Je.ecp=Mt||void 0,delete Je.href;break;case"signin":Je.url=Gd()}K.ILI&&(Je.iloader="1"),delete Je["data-onload"],delete Je.rd;for(var an in Hd)Je[an]&&delete Je[an];Je.gsrc=Q("iframes/:source:"),an=Q("inline/css"),typeof an<"u"&&0<$e&&an>=$e&&(Je.ic="1"),an=/^#|^fr-/,$e={};for(var sn in Je)C(Je,sn)&&an.test(sn)&&($e[sn.replace(an,"")]=Je[sn],delete Je[sn]);sn=Q("iframes/"+Ke+"/params/si")=="q"?Je:$e,an=mc();for(var ln in an)!C(an,ln)||C(Je,ln)||C($e,ln)||(sn[ln]=an[ln]);ln=[].concat(Kd),(sn=Q("iframes/"+Ke+"/methods"))&&typeof sn=="object"&&Na.test(sn.push)&&(ln=ln.concat(sn));for(var fn in Ge)C(Ge,fn)&&/^on/.test(fn)&&(Ke!="plus"||fn!="onconnect")&&(ln.push(fn),delete Je[fn]);return delete Je.callback,$e._methods=ln.join(","),fb(Qe,Je,$e)},Nd=["style","data-gapiscan"],Pd=function(Ke){for(var Ge=B(),$e=Ke.nodeName.toLowerCase().indexOf("g:")!=0,Ye=0,Qe=Ke.attributes.length;Ye<Qe;Ye++){var Je=Ke.attributes[Ye],Mt=Je.name,nn=Je.value;0<=Oa.call(Nd,Mt)||$e&&Mt.indexOf("data-")!=0||nn==="null"||"specified"in Je&&!Je.specified||($e&&(Mt=Mt.substr(5)),Ge[Mt.toLowerCase()]=nn)}return Ke=Ke.style,($e=Od(Ke&&Ke.height))&&(Ge.height=String($e)),(Ke=Od(Ke&&Ke.width))&&(Ge.width=String(Ke)),Ge},Od=function(Ke){var Ge=void 0;return typeof Ke=="number"?Ge=Ke:typeof Ke=="string"&&(Ge=parseInt(Ke,10)),Ge},Rd=function(){var Ke=K.drw;sc(function(Ge){if(Ke!==Ge.id&&Ge.state!=4&&Ge.type!="share"){var $e=Ge.id,Ye=Ge.type,Qe=Ge.url;Ge=Ge.userParams;var Je=z.getElementById($e);if(Je){var Mt=Md(Ye,Ge,0);Mt?(Je=Je.parentNode,Qe.replace(/#.*/,"").replace(/(\?|&)ic=1/,"")!==Mt.replace(/#.*/,"").replace(/(\?|&)ic=1/,"")&&(Ge.dontclear=!0,Ge.rd=!0,Ge.ri=!0,Ge.type=Ye,Qd(Je,Ge),(Ye=R[Je.lastChild.id])&&(Ye.oid=$e),tc($e,4))):delete R[$e]}else delete R[$e]}})},Sd,Td,X,Ud,Vd,Wd=/(?:^|\s)g-((\S)*)(?:$|\s)/,Xd={plusone:!0,autocomplete:!0,profile:!0,signin:!0,signin2:!0};Sd=A(K,"SW",B()),Td=A(K,"SA",B()),X=A(K,"SM",B()),Ud=A(K,"FW",[]),Vd=null;var Zd=function(Ke,Ge){Yd(void 0,!1,Ke,Ge)},Yd=function(Ke,Ge,$e,Ye){L("ps0",!0),$e=(typeof $e=="string"?document.getElementById($e):$e)||z;var Qe=z.documentMode;if($e.querySelectorAll&&(!Qe||8<Qe)){Qe=Ye?[Ye]:Xa(Sd).concat(Xa(Td)).concat(Xa(X));for(var Je=[],Mt=0;Mt<Qe.length;Mt++){var nn=Qe[Mt];Je.push(".g-"+nn,"g\\:"+nn)}Qe=$e.querySelectorAll(Je.join(","))}else Qe=$e.getElementsByTagName("*");for($e=B(),Je=0;Je<Qe.length;Je++){Mt=Qe[Je];var an=Mt;nn=Ye;var sn=an.nodeName.toLowerCase(),ln=void 0;if(an.getAttribute("data-gapiscan"))nn=null;else{var fn=sn.indexOf("g:");fn==0?ln=sn.substr(2):(fn=(fn=String(an.className||an.getAttribute("class")))&&Wd.exec(fn))&&(ln=fn[1]),nn=!ln||!(Sd[ln]||Td[ln]||X[ln])||nn&&ln!==nn?null:ln}nn&&(Xd[nn]||Mt.nodeName.toLowerCase().indexOf("g:")==0||Xa(Pd(Mt)).length!=0)&&(Mt.setAttribute("data-gapiscan",!0),A($e,nn,[]).push(Mt))}if(Ge)for(var hn in $e)for(Ge=$e[hn],Ye=0;Ye<Ge.length;Ye++)Ge[Ye].setAttribute("data-onload",!0);for(var Xr in $e)Ud.push(Xr);if(L("ps1",!0),(hn=Ud.join(":"))||Ke)try{F.load(hn,Ke)}catch(co){pc(co);return}if($d(Vd||{}))for(var Mi in $e){for(Ke=$e[Mi],Xr=0,Ge=Ke.length;Xr<Ge;Xr++)Ke[Xr].removeAttribute("data-gapiscan");ae(Mi)}else{Ye=[];for(Mi in $e)for(Ke=$e[Mi],Xr=0,Ge=Ke.length;Xr<Ge;Xr++)Qe=Ke[Xr],be(Mi,Qe,Pd(Qe),Ye,Ge);ce(hn,Ye)}},de=function(Ke){var Ge=A(F,Ke,{});Ge.go||(Ge.go=function($e){return Zd($e,Ke)},Ge.render=function($e,Ye){return Ye=Ye||{},Ye.type=Ke,Qd($e,Ye)})},ee=function(Ke){Sd[Ke]=!0},fe=function(Ke){Td[Ke]=!0},ge=function(Ke){X[Ke]=!0},ae=function(Ke,Ge){var $e=sb(Ke);Ge&&$e?($e(Ge),($e=Ge.iframeNode)&&$e.setAttribute("data-gapiattached",!0)):F.load(Ke,function(){var Ye=sb(Ke),Qe=Ge&&Ge.iframeNode,Je=Ge&&Ge.userParams;Qe&&Ye?(Ye(Ge),Qe.setAttribute("data-gapiattached",!0)):(Ye=F[Ke].go,Ke=="signin2"?Ye(Qe,Je):Ye(Qe&&Qe.parentNode,Je))})},$d=function(){return!1},ce=function(){},be=function(Ke,Ge,$e,Ye,Qe,Je,Mt){switch(he(Ge,Ke,Je)){case 0:Ke=X[Ke]?Ke+"_annotation":Ke,Ye={},Ye.iframeNode=Ge,Ye.userParams=$e,ae(Ke,Ye);break;case 1:if(Ge.parentNode){for(var nn in $e)if((Je=C($e,nn))&&(Je=$e[nn],Je=!!Je&&typeof Je=="object"&&(!Je.toString||Je.toString===Object.prototype.toString||Je.toString===Array.prototype.toString)),Je)try{$e[nn]=$c($e[nn])}catch{delete $e[nn]}if(Je=!0,$e.dontclear&&(Je=!1),delete $e.dontclear,rc(),nn=Md(Ke,$e,Qe),Qe=Mt||{},Qe.allowPost=1,Qe.attributes=Jd,Qe.dontclear=!Je,Mt={},Mt.userParams=$e,Mt.url=nn,Mt.type=Ke,$e.rd)var an=Ge;else an=document.createElement("div"),Ge.setAttribute("data-gapistub",!0),an.style.cssText="position:absolute;width:450px;left:-10000px;",Ge.parentNode.insertBefore(an,Ge);Mt.siteElement=an,an.id||(Ge=an,A(Ld,Ke,0),Je="___"+Ke+"_"+Ld[Ke]++,Ge.id=Je),Ge=B(),Ge[">type"]=Ke,D($e,Ge),Je=nn,$e=an,nn=Qe||{},Ge=nn.attributes||{},E(!(nn.allowPost||nn.forcePost)||!Ge.onload,"onload is not supported by post iframe (allowPost or forcePost)"),Qe=Ge=Je,Ad.test(Ge)&&(Qe=Q("iframes/"+Qe.substring(1)+"/url"),E(!!Qe,"Unknown iframe url config for - "+Ge)),Je=hb(z,Qe.replace(Bd,Dd)),Ge=$e.ownerDocument||z,an=0;do Qe=nn.id||["I",xd++,"_",new Date().getTime()].join("");while(Ge.getElementById(Qe)&&5>++an);E(5>an,"Error creating iframe id"),an={};var sn={};Ge.documentMode&&9>Ge.documentMode&&(an.hostiemode=Ge.documentMode),D(nn.queryParams||{},an),D(nn.fragmentParams||{},sn);var ln=nn.pfname,fn=B();Q("iframes/dropLegacyIdParam")||(fn.id=Qe),fn._gfid=Qe,fn.parent=Ge.location.protocol+"//"+Ge.location.host;var hn=H(Ge.location.href,"parent");if(ln=ln||"",!ln&&hn&&(hn=H(Ge.location.href,"_gfid","")||H(Ge.location.href,"id",""),ln=H(Ge.location.href,"pfname",""),ln=hn?ln+"/"+hn:""),ln||(hn=Zc(H(Ge.location.href,"jcp","")))&&typeof hn=="object"&&(ln=(ln=hn.id)?hn.pfname+"/"+ln:""),fn.pfname=ln,nn.connectWithJsonParam&&(hn={},hn.jcp=$c(fn),fn=hn),hn=H(Je,"rpctoken")||an.rpctoken||sn.rpctoken,hn||(hn=nn.rpctoken||String(Math.round(1e8*(hd?qd():pd()))),fn.rpctoken=hn),nn.rpctoken=hn,D(fn,nn.connectWithQueryParams?an:sn),hn=Ge.location.href,fn=B(),(ln=H(hn,"_bsh",K.bsh))&&(fn._bsh=ln),(hn=qb(hn))&&(fn.jsh=hn),nn.hintInFragment?D(fn,sn):D(fn,an),Je=fb(Je,an,sn,nn.paramsSerializer),sn=B(),D(vd,sn),D(nn.attributes,sn),sn.name=sn.id=Qe,sn.src=Je,nn.eurl=Je,an=nn||{},fn=!!an.allowPost,an.forcePost||fn&&2e3<Je.length){if(an=I(Je),sn.src="",nn.dropDataPostorigin||(sn["data-postorigin"]=Je),Je=zd(Ge,$e,sn,Qe),navigator.userAgent.indexOf("WebKit")!=-1){var Xr=Je.contentWindow.document;Xr.open(),sn=Xr.createElement("div"),fn={},hn=Qe+"_inner",fn.name=hn,fn.src="",fn.style="display:none",zd(Ge,sn,fn,hn,nn)}for(sn=(nn=an.query[0])?nn.split("&"):[],nn=[],fn=0;fn<sn.length;fn++)hn=sn[fn].split("=",2),nn.push([decodeURIComponent(hn[0]),decodeURIComponent(hn[1])]);for(an.query=[],sn=db(an),E(ib.test(sn),"Invalid URL: "+sn),an=Ge.createElement("form"),an.method="POST",an.target=Qe,an.style.display="none",Qe=sn instanceof v?sn:Fa(sn),xa(an,"HTMLFormElement").action=Da(Qe),Qe=0;Qe<nn.length;Qe++)sn=Ge.createElement("input"),sn.type="hidden",sn.name=nn[Qe][0],sn.value=nn[Qe][1],an.appendChild(sn);$e.appendChild(an),an.submit(),an.parentNode.removeChild(an),Xr&&Xr.close(),Xr=Je}else Xr=zd(Ge,$e,sn,Qe,nn);Mt.iframeNode=Xr,Mt.id=Xr.getAttribute("id"),Xr=Mt.id,$e=B(),$e.id=Xr,$e.userParams=Mt.userParams,$e.url=Mt.url,$e.type=Mt.type,$e.state=1,R[Xr]=$e,Xr=Mt}else Xr=null;Xr&&((Mt=Xr.id)&&Ye.push(Mt),ae(Ke,Xr))}},he=function(Ke,Ge,$e){if(Ke&&Ke.nodeType===1&&Ge){if($e)return 1;if(X[Ge]){if(pb[Ke.nodeName.toLowerCase()])return(Ke=Ke.innerHTML)&&Ke.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")?0:1}else{if(Td[Ge])return 0;if(Sd[Ge])return 1}}return null},Qd=function(Ke,Ge){var $e=Ge.type;delete Ge.type;var Ye=(typeof Ke=="string"?document.getElementById(Ke):Ke)||void 0;if(Ye){Ke={};for(var Qe in Ge)C(Ge,Qe)&&(Ke[Qe.toLowerCase()]=Ge[Qe]);Ke.rd=1,(Ge=!!Ke.ri)&&delete Ke.ri,Qe=[],be($e,Ye,Ke,Qe,0,Ge,void 0),ce($e,Qe)}else pc("gapi."+$e+".render: missing element "+typeof Ke=="string"?Ke:"")};A(F,"platform",{}).go=Zd,$d=function(Ke){for(var Ge=["_c","jsl","h"],$e=0;$e<Ge.length&&Ke;$e++)Ke=Ke[Ge[$e]];return Ge=qb(La.href),!Ke||Ke.indexOf("n;")!=0&&Ge.indexOf("n;")!=0&&Ke!==Ge},ce=function(Ke,Ge){ie(Ke,Ge)};var lb=function(Ke){Yd(Ke,!0)},je=function(Ke,Ge){Ge=Ge||[];for(var $e=0;$e<Ge.length;++$e)Ke(Ge[$e]);for(Ke=0;Ke<Ge.length;Ke++)de(Ge[Ke])};N.push(["platform",function(Ke,Ge,$e){if(Vd=$e,Ge&&Ud.push(Ge),je(ee,Ke),je(fe,$e._c.annotation),je(ge,$e._c.bimodal),ic(),gc(),Q("parsetags")!="explicit"){if(rb(Ke),nc(mc())&&!Q("disableRealtimeCallback")&&rc(),$e&&(Ke=$e.callback)){var Ye=Ya(Ke);delete $e.callback}nb(function(){lb(Ye)})}}]),F._pl=!0;var ke=function(Ke){if(Ke=(Ke=R[Ke])?Ke.oid:void 0,Ke){var Ge=z.getElementById(Ke);Ge&&Ge.parentNode.removeChild(Ge),delete R[Ke],ke(Ke)}},le=/^\{h:'/,me=/^!_/,ne="",ie=function(Ke,Ge){function $e(){jb("message",Ye,"remove","de")}function Ye(Je){var Mt=Je.data,nn=Je.origin;if(oe(Mt,Ge)){var an=Qe;Qe=!1,an&&L("rqe"),pe(Ke,function(){an&&L("rqd"),$e();for(var sn=A(K,"RPMQ",[]),ln=0;ln<sn.length;ln++)sn[ln]({data:Mt,origin:nn})})}}if(Ge.length!==0){ne=H(La.href,"pfname","");var Qe=!0;jb("message",Ye,"add","at"),ac(Ke,$e)}},oe=function(Ke,Ge){if(Ke=String(Ke),le.test(Ke))return!0;var $e=!1;if(me.test(Ke)&&($e=!0,Ke=Ke.substr(2)),!/^\{/.test(Ke))return!1;var Ye=Zc(Ke);if(!Ye)return!1;if(Ke=Ye.f,Ye.s&&Ke&&Oa.call(Ge,Ke)!=-1){if((Ye.s==="_renderstart"||Ye.s===ne+"/"+Ke+"::_renderstart")&&(Ye=Ye.a&&Ye.a[$e?0:1],Ge=z.getElementById(Ke),tc(Ke,2),Ye&&Ge&&Ye.width&&Ye.height)){e:{if($e=Ge.parentNode,Ke=Ye||{},qc()){var Qe=Ge.id;if(Qe){if(Ye=(Ye=R[Qe])?Ye.state:void 0,Ye===1||Ye===4)break e;ke(Qe)}}(Ye=$e.nextSibling)&&Ye.getAttribute&&Ye.getAttribute("data-gapistub")&&($e.parentNode.removeChild(Ye),$e.style.cssText=""),Ye=Ke.width;var Je=Ke.height,Mt=$e.style;Mt.textIndent="0",Mt.margin="0",Mt.padding="0",Mt.background="transparent",Mt.borderStyle="none",Mt.cssFloat="none",Mt.styleFloat="none",Mt.lineHeight="normal",Mt.fontSize="1px",Mt.verticalAlign="baseline",$e=$e.style,$e.display="inline-block",Mt=Ge.style,Mt.position="static",Mt.left="0",Mt.top="0",Mt.visibility="visible",Ye&&($e.width=Mt.width=Ye+"px"),Je&&($e.height=Mt.height=Je+"px"),Ke.verticalAlign&&($e.verticalAlign=Ke.verticalAlign),Qe&&tc(Qe,3)}Ge["data-csi-wdt"]=new Date().getTime()}return!0}return!1},pe=function(Ke,Ge){ac(Ke,Ge)},qe=function(Ke,Ge){this.L=Ke,Ke=Ge||{},this.fa=Number(Ke.maxAge)||0,this.U=Ke.domain,this.X=Ke.path,this.ga=!!Ke.secure};qe.prototype.read=function(){for(var Ke=this.L+"=",Ge=document.cookie.split(/;\s*/),$e=0;$e<Ge.length;++$e){var Ye=Ge[$e];if(Ye.indexOf(Ke)==0)return Ye.substr(Ke.length)}},qe.prototype.write=function(Ke,Ge){if(!re.test(this.L))throw"Invalid cookie name";if(!se.test(Ke))throw"Invalid cookie value";if(Ke=this.L+"="+Ke,this.U&&(Ke+=";domain="+this.U),this.X&&(Ke+=";path="+this.X),Ge=typeof Ge=="number"?Ge:this.fa,0<=Ge){var $e=new Date;$e.setSeconds($e.getSeconds()+Ge),Ke+=";expires="+$e.toUTCString()}return this.ga&&(Ke+=";secure"),document.cookie=Ke,!0},qe.prototype.clear=function(){this.write("",0)};var se=/^[-+/_=.:|%&a-zA-Z0-9@]*$/,re=/^[A-Z_][A-Z0-9_]{0,63}$/;qe.iterate=function(Ke){for(var Ge=document.cookie.split(/;\s*/),$e=0;$e<Ge.length;++$e){var Ye=Ge[$e].split("="),Qe=Ye.shift();Ke(Qe,Ye.join("="))}};var te=function(Ke){this.B=Ke};te.prototype.read=function(){if(Y.hasOwnProperty(this.B))return Y[this.B]},te.prototype.write=function(Ke){return Y[this.B]=Ke,!0},te.prototype.clear=function(){delete Y[this.B]};var Y={};te.iterate=function(Ke){for(var Ge in Y)Y.hasOwnProperty(Ge)&&Ke(Ge,Y[Ge])};var ue=window.location.protocol==="https:",ve=ue||window.location.protocol==="http:"?qe:te,we=function(Ke){var Ge=Ke.substr(1),$e="",Ye=window.location.hostname;if(Ge!==""){if($e=parseInt(Ge,10),isNaN($e)||(Ge=Ye.split("."),Ge.length<$e-1))return null;Ge.length==$e-1&&(Ye="."+Ye)}else Ye="";return{i:Ke.charAt(0)=="S",domain:Ye,l:$e}},xe=function(){var Ke,Ge=null;return ve.iterate(function($e,Ye){$e.indexOf("G_AUTHUSER_")===0&&($e=we($e.substring(11)),!Ke||$e.i&&!Ke.i||$e.i==Ke.i&&$e.l>Ke.l)&&(Ke=$e,Ge=Ye)}),{ea:Ke,F:Ge}},ye=function(Ke){if(Ke.indexOf("GCSC")!==0)return null;var Ge={W:!1};if(Ke=Ke.substr(4),!Ke)return Ge;var $e=Ke.charAt(0);Ke=Ke.substr(1);var Ye=Ke.lastIndexOf("_");if(Ye==-1)return Ge;var Qe=we(Ke.substr(Ye+1));return Qe==null||(Ke=Ke.substring(0,Ye),Ke.charAt(0)!=="_")?Ge:(Ye=$e==="E"&&Qe.i,!Ye&&($e!=="U"||Qe.i)||Ye&&!ue?Ge:{W:!0,i:Ye,ja:Ke.substr(1),domain:Qe.domain,l:Qe.l})},ze=function(Ke){return Ke?(Ke=Ke.split("="),Ke[1]?Ke[1].split("|"):[]):[]},Ae=function(Ke){return Ke=Ke.split(":"),{clientId:Ke[0].split("=")[1],ia:ze(Ke[1]),la:ze(Ke[2]),ka:ze(Ke[3])}},Be=function(){var Ke=xe(),Ge=Ke.ea;if(Ke=Ke.F,Ke!==null){var $e;if(ve.iterate(function(Je,Mt){(Je=ye(Je))&&Je.W&&Je.i==Ge.i&&Je.l==Ge.l&&($e=Mt)}),$e){var Ye=Ae($e),Qe=Ye&&Ye.ia[Number(Ke)];if(Ye=Ye&&Ye.clientId,Qe)return{F:Ke,ha:Qe,clientId:Ye}}}return null},Z=function(){this.T=Ce};Z.prototype.$=function(){this.K||(this.v=0,this.K=!0,this.Y())},Z.prototype.Y=function(){this.K&&(this.T()?this.v=this.R:this.v=Math.min(2*(this.v||this.R),120),window.setTimeout(na(this.Y,this),1e3*this.v))},Z.prototype.v=0,Z.prototype.R=2,Z.prototype.T=null,Z.prototype.K=!1;var Ee=null;qc=function(){return K.oa=!0},rc=function(){K.oa=!0;var Ke=Be();(Ke=Ke&&Ke.F)&&hc("googleapis.config/sessionIndex",Ke),Ee||(Ee=A(K,"ss",new Z)),Ke=Ee,Ke.$&&Ke.$()};var Ce=function(){var Ke=Be(),Ge=Ke&&Ke.ha||null,$e=Ke&&Ke.clientId;return ac("auth",{callback:function(){var Ye=x.gapi.auth,Qe={client_id:$e,session_state:Ge};Ye.checkSessionState(Qe,function(Je){var Mt=Qe.session_state,nn=Q("isLoggedIn");Je=Q("debug/forceIm")?!1:Mt&&Je||!Mt&&!Je,(nn=nn!=Je)&&(hc("isLoggedIn",Je),rc(),Rd(),Je||((Je=Ye.signOut)?Je():(Je=Ye.setToken)&&Je(null))),Je=mc();var an=Q("savedUserState");Mt=Ye._guss(Je.cookiepolicy),an=an!=Mt&&typeof an<"u",hc("savedUserState",Mt),(nn||an)&&nc(Je)&&!Q("disableRealtimeCallback")&&Ye._pimf(Je,!0)})}}),!0};L("bs0",!0,window.gapi._bs),L("bs1",!0),delete window.gapi._bs}).call(void 0);gapi.load("",{callback:window.gapi_onload,_c:{jsl:{ci:{deviceType:"desktop","oauth-flow":{authUrl:"https://accounts.google.com/o/oauth2/auth",proxyUrl:"https://accounts.google.com/o/oauth2/postmessageRelay",disableOpt:!0,idpIframeUrl:"https://accounts.google.com/o/oauth2/iframe",usegapi:!1},debug:{reportExceptionRate:.05,forceIm:!1,rethrowException:!1,host:"https://apis.google.com"},enableMultilogin:!0,"googleapis.config":{auth:{useFirstPartyAuthV2:!0}},isPlusUser:!1,inline:{css:1},disableRealtimeCallback:!1,drive_share:{skipInitCommand:!0},csi:{rate:.01},client:{cors:!1},isLoggedIn:!0,signInDeprecation:{rate:0},include_granted_scopes:!0,llang:"pt",iframes:{youtube:{params:{location:["search","hash"]},url:":socialhost:/:session_prefix:_/widget/render/youtube?usegapi=1",methods:["scroll","openwindow"]},ytsubscribe:{url:"https://www.youtube.com/subscribe_embed?usegapi=1"},plus_circle:{params:{url:""},url:":socialhost:/:session_prefix::se:_/widget/plus/circle?usegapi=1"},plus_share:{params:{url:""},url:":socialhost:/:session_prefix::se:_/+1/sharebutton?plusShare=true&usegapi=1"},rbr_s:{params:{url:""},url:":socialhost:/:session_prefix::se:_/widget/render/recobarsimplescroller"},":source:":"3p",playemm:{url:"https://play.google.com/work/embedded/search?usegapi=1&usegapi=1"},savetoandroidpay:{url:"https://pay.google.com/gp/v/widget/save"},blogger:{params:{location:["search","hash"]},url:":socialhost:/:session_prefix:_/widget/render/blogger?usegapi=1",methods:["scroll","openwindow"]},evwidget:{params:{url:""},url:":socialhost:/:session_prefix:_/events/widget?usegapi=1"},partnersbadge:{url:"https://www.gstatic.com/partners/badge/templates/badge.html?usegapi=1"},dataconnector:{url:"https://dataconnector.corp.google.com/:session_prefix:ui/widgetview?usegapi=1"},surveyoptin:{url:"https://www.google.com/shopping/customerreviews/optin?usegapi=1"},":socialhost:":"https://apis.google.com",shortlists:{url:""},hangout:{url:"https://talkgadget.google.com/:session_prefix:talkgadget/_/widget"},plus_followers:{params:{url:""},url:":socialhost:/_/im/_/widget/render/plus/followers?usegapi=1"},post:{params:{url:""},url:":socialhost:/:session_prefix::im_prefix:_/widget/render/post?usegapi=1"},":gplus_url:":"https://plus.google.com",signin:{params:{url:""},url:":socialhost:/:session_prefix:_/widget/render/signin?usegapi=1",methods:["onauth"]},rbr_i:{params:{url:""},url:":socialhost:/:session_prefix::se:_/widget/render/recobarinvitation"},share:{url:":socialhost:/:session_prefix::im_prefix:_/widget/render/share?usegapi=1"},plusone:{params:{count:"",size:"",url:""},url:":socialhost:/:session_prefix::se:_/+1/fastbutton?usegapi=1"},comments:{params:{location:["search","hash"]},url:":socialhost:/:session_prefix:_/widget/render/comments?usegapi=1",methods:["scroll","openwindow"]},":im_socialhost:":"https://plus.googleapis.com",backdrop:{url:"https://clients3.google.com/cast/chromecast/home/widget/backdrop?usegapi=1"},visibility:{params:{url:""},url:":socialhost:/:session_prefix:_/widget/render/visibility?usegapi=1"},autocomplete:{params:{url:""},url:":socialhost:/:session_prefix:_/widget/render/autocomplete"},additnow:{url:"https://apis.google.com/marketplace/button?usegapi=1",methods:["launchurl"]},":signuphost:":"https://plus.google.com",ratingbadge:{url:"https://www.google.com/shopping/customerreviews/badge?usegapi=1"},appcirclepicker:{url:":socialhost:/:session_prefix:_/widget/render/appcirclepicker"},follow:{url:":socialhost:/:session_prefix:_/widget/render/follow?usegapi=1"},community:{url:":ctx_socialhost:/:session_prefix::im_prefix:_/widget/render/community?usegapi=1"},sharetoclassroom:{url:"https://classroom.google.com/sharewidget?usegapi=1"},ytshare:{params:{url:""},url:":socialhost:/:session_prefix:_/widget/render/ytshare?usegapi=1"},plus:{url:":socialhost:/:session_prefix:_/widget/render/badge?usegapi=1"},family_creation:{params:{url:""},url:"https://families.google.com/webcreation?usegapi=1&usegapi=1"},commentcount:{url:":socialhost:/:session_prefix:_/widget/render/commentcount?usegapi=1"},configurator:{url:":socialhost:/:session_prefix:_/plusbuttonconfigurator?usegapi=1"},zoomableimage:{url:"https://ssl.gstatic.com/microscope/embed/"},appfinder:{url:"https://workspace.google.com/:session_prefix:marketplace/appfinder?usegapi=1"},savetowallet:{url:"https://pay.google.com/gp/v/widget/save"},person:{url:":socialhost:/:session_prefix:_/widget/render/person?usegapi=1"},savetodrive:{url:"https://drive.google.com/savetodrivebutton?usegapi=1",methods:["save"]},page:{url:":socialhost:/:session_prefix:_/widget/render/page?usegapi=1"},card:{url:":socialhost:/:session_prefix:_/hovercard/card"}}},h:"m;/_/scs/apps-static/_/js/k=oz.gapi.pt_BR.l4Bv_WkVC6g.O/am=wQE/d=1/ct=zgms/rs=AGLTcCOuH5S2uqmF6E8zOW7n3yiqiwhzNQ/m=__features__",u:"https://apis.google.com/js/platform.js",hee:!0,fp:"821a251b140e4add32f87f4a7a08f044a59aa0e9",dpo:!1},platform:["additnow","backdrop","blogger","comments","commentcount","community","donation","family_creation","follow","hangout","health","page","partnersbadge","person","playemm","playreview","plus","plusone","post","ratingbadge","savetoandroidpay","savetodrive","savetowallet","sharetoclassroom","shortlists","signin2","surveyoptin","visibility","youtube","ytsubscribe","zoomableimage"],fp:"821a251b140e4add32f87f4a7a08f044a59aa0e9",annotation:["interactivepost","recobar","signin2","autocomplete","profile"],bimodal:["signin","share"]}});const CLIENT_ID="827556858367-o16prqd900voc4avps423mbtlugi203g.apps.googleusercontent.com",SCOPES="https://www.googleapis.com/auth/contacts.readonly",GoogleContacts=()=>{reactExports.useEffect(()=>{const Ge=()=>{gapi.client.init({clientId:CLIENT_ID,scope:SCOPES})};gapi.load("client:auth2",Ge)},[]);const Ke=()=>{gapi.auth2.getAuthInstance().signIn().then(()=>{gapi.client.people.people.connections.list({resourceName:"people/me",personFields:"names,emailAddresses,phoneNumbers"}).then(Ge=>{var Ye;console.log("Full Response:",Ge);const $e=(Ye=Ge==null?void 0:Ge.result)==null?void 0:Ye.connections;$e&&$e.length>0?console.log("Contacts:",$e):console.warn("No contacts found or response was undefined.")}).catch(Ge=>{console.error("Error fetching contacts:",Ge)})}).catch(Ge=>{console.error("Google Sign-In Error:",Ge)})};return jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded",onClick:Ke,children:"Import Google Contacts"})})};function Navbar(){return jsxRuntimeExports.jsxs("nav",{className:"w-full px-6 py-4 flex justify-between items-center bg-white shadow-md fixed top-0 left-0 z-50",children:[jsxRuntimeExports.jsx(Link,{to:"/",className:"text-2xl font-bold text-indigo-700",children:"EmoCall"}),jsxRuntimeExports.jsxs("div",{className:"space-x-6",children:[jsxRuntimeExports.jsx(Link,{to:"/",className:"hover:text-indigo-500 font-medium",children:"Home"}),jsxRuntimeExports.jsx(Link,{to:"/login",className:"hover:text-indigo-500 font-medium",children:"Login"}),jsxRuntimeExports.jsx(Link,{to:"/register",className:"hover:text-indigo-500 font-medium",children:"Register"})]})]})}function App(){const[Ke,Ge]=reactExports.useState(0);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Navbar,{}),jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{path:"/login",element:jsxRuntimeExports.jsx(Login,{})}),jsxRuntimeExports.jsx(Route,{path:"/register",element:jsxRuntimeExports.jsx(Register,{})}),jsxRuntimeExports.jsx(Route,{path:"/video-call",element:jsxRuntimeExports.jsx(VideoCall,{})}),jsxRuntimeExports.jsx(Route,{path:"/",element:jsxRuntimeExports.jsx(Home,{})}),jsxRuntimeExports.jsx(Route,{path:"/GoogleContacts",element:jsxRuntimeExports.jsx(GoogleContacts,{})}),jsxRuntimeExports.jsx(Route,{path:"/video-call/:callId?",element:jsxRuntimeExports.jsx(VideoCall,{})}),jsxRuntimeExports.jsx(Route,{path:"/video-call/:roomId",element:jsxRuntimeExports.jsx(VideoCall,{})})]})]})}clientExports.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsxs(BrowserRouter,{children:[jsxRuntimeExports.jsx(reactExports.StrictMode,{children:jsxRuntimeExports.jsxs(AuthProvider,{children:[jsxRuntimeExports.jsx(App,{}),jsxRuntimeExports.jsx(Oe$1,{})]})}),","]}))});export default yS();
